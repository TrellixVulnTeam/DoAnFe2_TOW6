var bP=Object.defineProperty,IP=Object.defineProperties;var EP=Object.getOwnPropertyDescriptors;var Kw=Object.getOwnPropertySymbols;var TP=Object.prototype.hasOwnProperty,SP=Object.prototype.propertyIsEnumerable;var Hw=(t,e,n)=>e in t?bP(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rh=(t,e)=>{for(var n in e||(e={}))TP.call(e,n)&&Hw(t,n,e[n]);if(Kw)for(var n of Kw(e))SP.call(e,n)&&Hw(t,n,e[n]);return t},ih=(t,e)=>IP(t,EP(e));const CP=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerpolicy&&(i.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?i.credentials="include":r.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}};CP();function m_(t,e){const n=Object.create(null),s=t.split(",");for(let r=0;r<s.length;r++)n[s[r]]=!0;return e?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const kP="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",AP=m_(kP);function lT(t){return!!t||t===""}function __(t){if(le(t)){const e={};for(let n=0;n<t.length;n++){const s=t[n],r=It(s)?NP(s):__(s);if(r)for(const i in r)e[i]=r[i]}return e}else{if(It(t))return t;if(Et(t))return t}}const RP=/;(?![^(]*\))/g,xP=/:(.+)/;function NP(t){const e={};return t.split(RP).forEach(n=>{if(n){const s=n.split(xP);s.length>1&&(e[s[0].trim()]=s[1].trim())}}),e}function pt(t){let e="";if(It(t))e=t;else if(le(t))for(let n=0;n<t.length;n++){const s=pt(t[n]);s&&(e+=s+" ")}else if(Et(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}const ht=t=>It(t)?t:t==null?"":le(t)||Et(t)&&(t.toString===fT||!he(t.toString))?JSON.stringify(t,uT,2):String(t),uT=(t,e)=>e&&e.__v_isRef?uT(t,e.value):ga(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[s,r])=>(n[`${s} =>`]=r,n),{})}:hT(e)?{[`Set(${e.size})`]:[...e.values()]}:Et(e)&&!le(e)&&!pT(e)?String(e):e,$e={},pa=[],bs=()=>{},PP=()=>!1,DP=/^on[^a-z]/,Jd=t=>DP.test(t),y_=t=>t.startsWith("onUpdate:"),In=Object.assign,v_=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},OP=Object.prototype.hasOwnProperty,we=(t,e)=>OP.call(t,e),le=Array.isArray,ga=t=>Zd(t)==="[object Map]",hT=t=>Zd(t)==="[object Set]",he=t=>typeof t=="function",It=t=>typeof t=="string",w_=t=>typeof t=="symbol",Et=t=>t!==null&&typeof t=="object",dT=t=>Et(t)&&he(t.then)&&he(t.catch),fT=Object.prototype.toString,Zd=t=>fT.call(t),MP=t=>Zd(t).slice(8,-1),pT=t=>Zd(t)==="[object Object]",b_=t=>It(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Rh=m_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),ef=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},LP=/-(\w)/g,Ys=ef(t=>t.replace(LP,(e,n)=>n?n.toUpperCase():"")),FP=/\B([A-Z])/g,$o=ef(t=>t.replace(FP,"-$1").toLowerCase()),tf=ef(t=>t.charAt(0).toUpperCase()+t.slice(1)),Fp=ef(t=>t?`on${tf(t)}`:""),Il=(t,e)=>!Object.is(t,e),xh=(t,e)=>{for(let n=0;n<t.length;n++)t[n](e)},Hh=(t,e,n)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:n})},$g=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Ww;const $P=()=>Ww||(Ww=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let Os;class gT{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Os&&(this.parent=Os,this.index=(Os.scopes||(Os.scopes=[])).push(this)-1)}run(e){if(this.active){const n=Os;try{return Os=this,e()}finally{Os=n}}}on(){Os=this}off(){Os=this.parent}stop(e){if(this.active){let n,s;for(n=0,s=this.effects.length;n<s;n++)this.effects[n].stop();for(n=0,s=this.cleanups.length;n<s;n++)this.cleanups[n]();if(this.scopes)for(n=0,s=this.scopes.length;n<s;n++)this.scopes[n].stop(!0);if(this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function mT(t){return new gT(t)}function UP(t,e=Os){e&&e.active&&e.effects.push(t)}const I_=t=>{const e=new Set(t);return e.w=0,e.n=0,e},_T=t=>(t.w&ci)>0,yT=t=>(t.n&ci)>0,BP=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=ci},VP=t=>{const{deps:e}=t;if(e.length){let n=0;for(let s=0;s<e.length;s++){const r=e[s];_T(r)&&!yT(r)?r.delete(t):e[n++]=r,r.w&=~ci,r.n&=~ci}e.length=n}},Ug=new WeakMap;let Kc=0,ci=1;const Bg=30;let ms;const oo=Symbol(""),Vg=Symbol("");class E_{constructor(e,n=null,s){this.fn=e,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,UP(this,s)}run(){if(!this.active)return this.fn();let e=ms,n=Zr;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=ms,ms=this,Zr=!0,ci=1<<++Kc,Kc<=Bg?BP(this):zw(this),this.fn()}finally{Kc<=Bg&&VP(this),ci=1<<--Kc,ms=this.parent,Zr=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ms===this?this.deferStop=!0:this.active&&(zw(this),this.onStop&&this.onStop(),this.active=!1)}}function zw(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}let Zr=!0;const vT=[];function tc(){vT.push(Zr),Zr=!1}function nc(){const t=vT.pop();Zr=t===void 0?!0:t}function Qn(t,e,n){if(Zr&&ms){let s=Ug.get(t);s||Ug.set(t,s=new Map);let r=s.get(n);r||s.set(n,r=I_()),wT(r)}}function wT(t,e){let n=!1;Kc<=Bg?yT(t)||(t.n|=ci,n=!_T(t)):n=!t.has(ms),n&&(t.add(ms),ms.deps.push(t))}function Er(t,e,n,s,r,i){const o=Ug.get(t);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(n==="length"&&le(t))o.forEach((c,l)=>{(l==="length"||l>=s)&&a.push(c)});else switch(n!==void 0&&a.push(o.get(n)),e){case"add":le(t)?b_(n)&&a.push(o.get("length")):(a.push(o.get(oo)),ga(t)&&a.push(o.get(Vg)));break;case"delete":le(t)||(a.push(o.get(oo)),ga(t)&&a.push(o.get(Vg)));break;case"set":ga(t)&&a.push(o.get(oo));break}if(a.length===1)a[0]&&qg(a[0]);else{const c=[];for(const l of a)l&&c.push(...l);qg(I_(c))}}function qg(t,e){const n=le(t)?t:[...t];for(const s of n)s.computed&&Gw(s);for(const s of n)s.computed||Gw(s)}function Gw(t,e){(t!==ms||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const qP=m_("__proto__,__v_isRef,__isVue"),bT=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(w_)),jP=T_(),KP=T_(!1,!0),HP=T_(!0),Qw=WP();function WP(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const s=Ce(this);for(let i=0,o=this.length;i<o;i++)Qn(s,"get",i+"");const r=s[e](...n);return r===-1||r===!1?s[e](...n.map(Ce)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){tc();const s=Ce(this)[e].apply(this,n);return nc(),s}}),t}function T_(t=!1,e=!1){return function(s,r,i){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_isShallow")return e;if(r==="__v_raw"&&i===(t?e?cD:CT:e?ST:TT).get(s))return s;const o=le(s);if(!t&&o&&we(Qw,r))return Reflect.get(Qw,r,i);const a=Reflect.get(s,r,i);return(w_(r)?bT.has(r):qP(r))||(t||Qn(s,"get",r),e)?a:ct(a)?o&&b_(r)?a:a.value:Et(a)?t?kT(a):cs(a):a}}const zP=IT(),GP=IT(!0);function IT(t=!1){return function(n,s,r,i){let o=n[s];if(El(o)&&ct(o)&&!ct(r))return!1;if(!t&&!El(r)&&(jg(r)||(r=Ce(r),o=Ce(o)),!le(n)&&ct(o)&&!ct(r)))return o.value=r,!0;const a=le(n)&&b_(s)?Number(s)<n.length:we(n,s),c=Reflect.set(n,s,r,i);return n===Ce(i)&&(a?Il(r,o)&&Er(n,"set",s,r):Er(n,"add",s,r)),c}}function QP(t,e){const n=we(t,e);t[e];const s=Reflect.deleteProperty(t,e);return s&&n&&Er(t,"delete",e,void 0),s}function YP(t,e){const n=Reflect.has(t,e);return(!w_(e)||!bT.has(e))&&Qn(t,"has",e),n}function XP(t){return Qn(t,"iterate",le(t)?"length":oo),Reflect.ownKeys(t)}const ET={get:jP,set:zP,deleteProperty:QP,has:YP,ownKeys:XP},JP={get:HP,set(t,e){return!0},deleteProperty(t,e){return!0}},ZP=In({},ET,{get:KP,set:GP}),S_=t=>t,nf=t=>Reflect.getPrototypeOf(t);function oh(t,e,n=!1,s=!1){t=t.__v_raw;const r=Ce(t),i=Ce(e);n||(e!==i&&Qn(r,"get",e),Qn(r,"get",i));const{has:o}=nf(r),a=s?S_:n?A_:Tl;if(o.call(r,e))return a(t.get(e));if(o.call(r,i))return a(t.get(i));t!==r&&t.get(e)}function ah(t,e=!1){const n=this.__v_raw,s=Ce(n),r=Ce(t);return e||(t!==r&&Qn(s,"has",t),Qn(s,"has",r)),t===r?n.has(t):n.has(t)||n.has(r)}function ch(t,e=!1){return t=t.__v_raw,!e&&Qn(Ce(t),"iterate",oo),Reflect.get(t,"size",t)}function Yw(t){t=Ce(t);const e=Ce(this);return nf(e).has.call(e,t)||(e.add(t),Er(e,"add",t,t)),this}function Xw(t,e){e=Ce(e);const n=Ce(this),{has:s,get:r}=nf(n);let i=s.call(n,t);i||(t=Ce(t),i=s.call(n,t));const o=r.call(n,t);return n.set(t,e),i?Il(e,o)&&Er(n,"set",t,e):Er(n,"add",t,e),this}function Jw(t){const e=Ce(this),{has:n,get:s}=nf(e);let r=n.call(e,t);r||(t=Ce(t),r=n.call(e,t)),s&&s.call(e,t);const i=e.delete(t);return r&&Er(e,"delete",t,void 0),i}function Zw(){const t=Ce(this),e=t.size!==0,n=t.clear();return e&&Er(t,"clear",void 0,void 0),n}function lh(t,e){return function(s,r){const i=this,o=i.__v_raw,a=Ce(o),c=e?S_:t?A_:Tl;return!t&&Qn(a,"iterate",oo),o.forEach((l,u)=>s.call(r,c(l),c(u),i))}}function uh(t,e,n){return function(...s){const r=this.__v_raw,i=Ce(r),o=ga(i),a=t==="entries"||t===Symbol.iterator&&o,c=t==="keys"&&o,l=r[t](...s),u=n?S_:e?A_:Tl;return!e&&Qn(i,"iterate",c?Vg:oo),{next(){const{value:h,done:d}=l.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function $r(t){return function(...e){return t==="delete"?!1:this}}function eD(){const t={get(i){return oh(this,i)},get size(){return ch(this)},has:ah,add:Yw,set:Xw,delete:Jw,clear:Zw,forEach:lh(!1,!1)},e={get(i){return oh(this,i,!1,!0)},get size(){return ch(this)},has:ah,add:Yw,set:Xw,delete:Jw,clear:Zw,forEach:lh(!1,!0)},n={get(i){return oh(this,i,!0)},get size(){return ch(this,!0)},has(i){return ah.call(this,i,!0)},add:$r("add"),set:$r("set"),delete:$r("delete"),clear:$r("clear"),forEach:lh(!0,!1)},s={get(i){return oh(this,i,!0,!0)},get size(){return ch(this,!0)},has(i){return ah.call(this,i,!0)},add:$r("add"),set:$r("set"),delete:$r("delete"),clear:$r("clear"),forEach:lh(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{t[i]=uh(i,!1,!1),n[i]=uh(i,!0,!1),e[i]=uh(i,!1,!0),s[i]=uh(i,!0,!0)}),[t,n,e,s]}const[tD,nD,sD,rD]=eD();function C_(t,e){const n=e?t?rD:sD:t?nD:tD;return(s,r,i)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?s:Reflect.get(we(n,r)&&r in s?n:s,r,i)}const iD={get:C_(!1,!1)},oD={get:C_(!1,!0)},aD={get:C_(!0,!1)},TT=new WeakMap,ST=new WeakMap,CT=new WeakMap,cD=new WeakMap;function lD(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function uD(t){return t.__v_skip||!Object.isExtensible(t)?0:lD(MP(t))}function cs(t){return El(t)?t:k_(t,!1,ET,iD,TT)}function hD(t){return k_(t,!1,ZP,oD,ST)}function kT(t){return k_(t,!0,JP,aD,CT)}function k_(t,e,n,s,r){if(!Et(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const i=r.get(t);if(i)return i;const o=uD(t);if(o===0)return t;const a=new Proxy(t,o===2?s:n);return r.set(t,a),a}function ei(t){return El(t)?ei(t.__v_raw):!!(t&&t.__v_isReactive)}function El(t){return!!(t&&t.__v_isReadonly)}function jg(t){return!!(t&&t.__v_isShallow)}function AT(t){return ei(t)||El(t)}function Ce(t){const e=t&&t.__v_raw;return e?Ce(e):t}function Ra(t){return Hh(t,"__v_skip",!0),t}const Tl=t=>Et(t)?cs(t):t,A_=t=>Et(t)?kT(t):t;function RT(t){Zr&&ms&&(t=Ce(t),wT(t.dep||(t.dep=I_())))}function xT(t,e){t=Ce(t),t.dep&&qg(t.dep)}function ct(t){return!!(t&&t.__v_isRef===!0)}function _s(t){return NT(t,!1)}function dD(t){return NT(t,!0)}function NT(t,e){return ct(t)?t:new fD(t,e)}class fD{constructor(e,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?e:Ce(e),this._value=n?e:Tl(e)}get value(){return RT(this),this._value}set value(e){e=this.__v_isShallow?e:Ce(e),Il(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:Tl(e),xT(this))}}function Pn(t){return ct(t)?t.value:t}const pD={get:(t,e,n)=>Pn(Reflect.get(t,e,n)),set:(t,e,n,s)=>{const r=t[e];return ct(r)&&!ct(n)?(r.value=n,!0):Reflect.set(t,e,n,s)}};function PT(t){return ei(t)?t:new Proxy(t,pD)}function DT(t){const e=le(t)?new Array(t.length):{};for(const n in t)e[n]=mD(t,n);return e}class gD{constructor(e,n,s){this._object=e,this._key=n,this._defaultValue=s,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}}function mD(t,e,n){const s=t[e];return ct(s)?s:new gD(t,e,n)}class _D{constructor(e,n,s,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new E_(e,()=>{this._dirty||(this._dirty=!0,xT(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=s}get value(){const e=Ce(this);return RT(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function yD(t,e,n=!1){let s,r;const i=he(t);return i?(s=t,r=bs):(s=t.get,r=t.set),new _D(s,r,i||!r,n)}function ti(t,e,n,s){let r;try{r=s?t(...s):t()}catch(i){sf(i,e,n)}return r}function Is(t,e,n,s){if(he(t)){const i=ti(t,e,n,s);return i&&dT(i)&&i.catch(o=>{sf(o,e,n)}),i}const r=[];for(let i=0;i<t.length;i++)r.push(Is(t[i],e,n,s));return r}function sf(t,e,n,s=!0){const r=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=n;for(;i;){const l=i.ec;if(l){for(let u=0;u<l.length;u++)if(l[u](t,o,a)===!1)return}i=i.parent}const c=e.appContext.config.errorHandler;if(c){ti(c,null,10,[t,o,a]);return}}vD(t,n,r,s)}function vD(t,e,n,s=!0){console.error(t)}let Wh=!1,Kg=!1;const Vn=[];let ur=0;const Xc=[];let Hc=null,oa=0;const Jc=[];let Kr=null,aa=0;const OT=Promise.resolve();let R_=null,Hg=null;function x_(t){const e=R_||OT;return t?e.then(this?t.bind(this):t):e}function wD(t){let e=ur+1,n=Vn.length;for(;e<n;){const s=e+n>>>1;Sl(Vn[s])<t?e=s+1:n=s}return e}function MT(t){(!Vn.length||!Vn.includes(t,Wh&&t.allowRecurse?ur+1:ur))&&t!==Hg&&(t.id==null?Vn.push(t):Vn.splice(wD(t.id),0,t),LT())}function LT(){!Wh&&!Kg&&(Kg=!0,R_=OT.then(UT))}function bD(t){const e=Vn.indexOf(t);e>ur&&Vn.splice(e,1)}function FT(t,e,n,s){le(t)?n.push(...t):(!e||!e.includes(t,t.allowRecurse?s+1:s))&&n.push(t),LT()}function ID(t){FT(t,Hc,Xc,oa)}function ED(t){FT(t,Kr,Jc,aa)}function rf(t,e=null){if(Xc.length){for(Hg=e,Hc=[...new Set(Xc)],Xc.length=0,oa=0;oa<Hc.length;oa++)Hc[oa]();Hc=null,oa=0,Hg=null,rf(t,e)}}function $T(t){if(rf(),Jc.length){const e=[...new Set(Jc)];if(Jc.length=0,Kr){Kr.push(...e);return}for(Kr=e,Kr.sort((n,s)=>Sl(n)-Sl(s)),aa=0;aa<Kr.length;aa++)Kr[aa]();Kr=null,aa=0}}const Sl=t=>t.id==null?1/0:t.id;function UT(t){Kg=!1,Wh=!0,rf(t),Vn.sort((n,s)=>Sl(n)-Sl(s));const e=bs;try{for(ur=0;ur<Vn.length;ur++){const n=Vn[ur];n&&n.active!==!1&&ti(n,null,14)}}finally{ur=0,Vn.length=0,$T(),Wh=!1,R_=null,(Vn.length||Xc.length||Jc.length)&&UT(t)}}function TD(t,e,...n){if(t.isUnmounted)return;const s=t.vnode.props||$e;let r=n;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in s){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:h,trim:d}=s[u]||$e;d&&(r=n.map(f=>f.trim())),h&&(r=n.map($g))}let a,c=s[a=Fp(e)]||s[a=Fp(Ys(e))];!c&&i&&(c=s[a=Fp($o(e))]),c&&Is(c,t,6,r);const l=s[a+"Once"];if(l){if(!t.emitted)t.emitted={};else if(t.emitted[a])return;t.emitted[a]=!0,Is(l,t,6,r)}}function BT(t,e,n=!1){const s=e.emitsCache,r=s.get(t);if(r!==void 0)return r;const i=t.emits;let o={},a=!1;if(!he(t)){const c=l=>{const u=BT(l,e,!0);u&&(a=!0,In(o,u))};!n&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}return!i&&!a?(s.set(t,null),null):(le(i)?i.forEach(c=>o[c]=null):In(o,i),s.set(t,o),o)}function of(t,e){return!t||!Jd(e)?!1:(e=e.slice(2).replace(/Once$/,""),we(t,e[0].toLowerCase()+e.slice(1))||we(t,$o(e))||we(t,e))}let sn=null,VT=null;function zh(t){const e=sn;return sn=t,VT=t&&t.type.__scopeId||null,e}function dt(t,e=sn,n){if(!e||t._n)return t;const s=(...r)=>{s._d&&lb(-1);const i=zh(e),o=t(...r);return zh(i),s._d&&lb(1),o};return s._n=!0,s._c=!0,s._d=!0,s}function $p(t){const{type:e,vnode:n,proxy:s,withProxy:r,props:i,propsOptions:[o],slots:a,attrs:c,emit:l,render:u,renderCache:h,data:d,setupState:f,ctx:p,inheritAttrs:_}=t;let v,b;const N=zh(t);try{if(n.shapeFlag&4){const $=r||s;v=Ms(u.call($,$,h,i,f,d,p)),b=c}else{const $=e;v=Ms($.length>1?$(i,{attrs:c,slots:a,emit:l}):$(i,null)),b=e.props?c:SD(c)}}catch($){tl.length=0,sf($,t,1),v=L(li)}let T=v;if(b&&_!==!1){const $=Object.keys(b),{shapeFlag:z}=T;$.length&&z&7&&(o&&$.some(y_)&&(b=CD(b,o)),T=xa(T,b))}return n.dirs&&(T=xa(T),T.dirs=T.dirs?T.dirs.concat(n.dirs):n.dirs),n.transition&&(T.transition=n.transition),v=T,zh(N),v}const SD=t=>{let e;for(const n in t)(n==="class"||n==="style"||Jd(n))&&((e||(e={}))[n]=t[n]);return e},CD=(t,e)=>{const n={};for(const s in t)(!y_(s)||!(s.slice(9)in e))&&(n[s]=t[s]);return n};function kD(t,e,n){const{props:s,children:r,component:i}=t,{props:o,children:a,patchFlag:c}=e,l=i.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&c>=0){if(c&1024)return!0;if(c&16)return s?eb(s,o,l):!!o;if(c&8){const u=e.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(o[d]!==s[d]&&!of(l,d))return!0}}}else return(r||a)&&(!a||!a.$stable)?!0:s===o?!1:s?o?eb(s,o,l):!0:!!o;return!1}function eb(t,e,n){const s=Object.keys(e);if(s.length!==Object.keys(t).length)return!0;for(let r=0;r<s.length;r++){const i=s[r];if(e[i]!==t[i]&&!of(n,i))return!0}return!1}function AD({vnode:t,parent:e},n){for(;e&&e.subTree===t;)(t=e.vnode).el=n,e=e.parent}const RD=t=>t.__isSuspense;function xD(t,e){e&&e.pendingBranch?le(t)?e.effects.push(...t):e.effects.push(t):ED(t)}function Nh(t,e){if(Pt){let n=Pt.provides;const s=Pt.parent&&Pt.parent.provides;s===n&&(n=Pt.provides=Object.create(s)),n[t]=e}}function Ks(t,e,n=!1){const s=Pt||sn;if(s){const r=s.parent==null?s.vnode.appContext&&s.vnode.appContext.provides:s.parent.provides;if(r&&t in r)return r[t];if(arguments.length>1)return n&&he(e)?e.call(s.proxy):e}}const tb={};function Zc(t,e,n){return qT(t,e,n)}function qT(t,e,{immediate:n,deep:s,flush:r,onTrack:i,onTrigger:o}=$e){const a=Pt;let c,l=!1,u=!1;if(ct(t)?(c=()=>t.value,l=jg(t)):ei(t)?(c=()=>t,s=!0):le(t)?(u=!0,l=t.some(b=>ei(b)||jg(b)),c=()=>t.map(b=>{if(ct(b))return b.value;if(ei(b))return Yi(b);if(he(b))return ti(b,a,2)})):he(t)?e?c=()=>ti(t,a,2):c=()=>{if(!(a&&a.isUnmounted))return h&&h(),Is(t,a,3,[d])}:c=bs,e&&s){const b=c;c=()=>Yi(b())}let h,d=b=>{h=v.onStop=()=>{ti(b,a,4)}};if(Al)return d=bs,e?n&&Is(e,a,3,[c(),u?[]:void 0,d]):c(),bs;let f=u?[]:tb;const p=()=>{if(!!v.active)if(e){const b=v.run();(s||l||(u?b.some((N,T)=>Il(N,f[T])):Il(b,f)))&&(h&&h(),Is(e,a,3,[b,f===tb?void 0:f,d]),f=b)}else v.run()};p.allowRecurse=!!e;let _;r==="sync"?_=p:r==="post"?_=()=>Tn(p,a&&a.suspense):_=()=>ID(p);const v=new E_(c,_);return e?n?p():f=v.run():r==="post"?Tn(v.run.bind(v),a&&a.suspense):v.run(),()=>{v.stop(),a&&a.scope&&v_(a.scope.effects,v)}}function ND(t,e,n){const s=this.proxy,r=It(t)?t.includes(".")?jT(s,t):()=>s[t]:t.bind(s,s);let i;he(e)?i=e:(i=e.handler,n=e);const o=Pt;Na(this);const a=qT(r,i.bind(s),n);return o?Na(o):ao(),a}function jT(t,e){const n=e.split(".");return()=>{let s=t;for(let r=0;r<n.length&&s;r++)s=s[n[r]];return s}}function Yi(t,e){if(!Et(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),ct(t))Yi(t.value,e);else if(le(t))for(let n=0;n<t.length;n++)Yi(t[n],e);else if(hT(t)||ga(t))t.forEach(n=>{Yi(n,e)});else if(pT(t))for(const n in t)Yi(t[n],e);return t}function xe(t){return he(t)?{setup:t,name:t.name}:t}const el=t=>!!t.type.__asyncLoader,KT=t=>t.type.__isKeepAlive;function PD(t,e){HT(t,"a",e)}function DD(t,e){HT(t,"da",e)}function HT(t,e,n=Pt){const s=t.__wdc||(t.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(af(e,s,n),n){let r=n.parent;for(;r&&r.parent;)KT(r.parent.vnode)&&OD(s,e,n,r),r=r.parent}}function OD(t,e,n,s){const r=af(e,t,s,!0);P_(()=>{v_(s[e],r)},n)}function af(t,e,n=Pt,s=!1){if(n){const r=n[t]||(n[t]=[]),i=e.__weh||(e.__weh=(...o)=>{if(n.isUnmounted)return;tc(),Na(n);const a=Is(e,n,t,o);return ao(),nc(),a});return s?r.unshift(i):r.push(i),i}}const Rr=t=>(e,n=Pt)=>(!Al||t==="sp")&&af(t,e,n),MD=Rr("bm"),N_=Rr("m"),LD=Rr("bu"),WT=Rr("u"),FD=Rr("bum"),P_=Rr("um"),$D=Rr("sp"),UD=Rr("rtg"),BD=Rr("rtc");function VD(t,e=Pt){af("ec",t,e)}function Xi(t,e){const n=sn;if(n===null)return t;const s=uf(n)||n.proxy,r=t.dirs||(t.dirs=[]);for(let i=0;i<e.length;i++){let[o,a,c,l=$e]=e[i];he(o)&&(o={mounted:o,updated:o}),o.deep&&Yi(a),r.push({dir:o,instance:s,value:a,oldValue:void 0,arg:c,modifiers:l})}return t}function Oi(t,e,n,s){const r=t.dirs,i=e&&e.dirs;for(let o=0;o<r.length;o++){const a=r[o];i&&(a.oldValue=i[o].value);let c=a.dir[s];c&&(tc(),Is(c,n,8,[t.el,a,t,e]),nc())}}const D_="components";function An(t,e){return GT(D_,t,!0,e)||t}const zT=Symbol();function qD(t){return It(t)?GT(D_,t,!1)||t:t||zT}function GT(t,e,n=!0,s=!1){const r=sn||Pt;if(r){const i=r.type;if(t===D_){const a=_O(i,!1);if(a&&(a===e||a===Ys(e)||a===tf(Ys(e))))return i}const o=nb(r[t]||i[t],e)||nb(r.appContext[t],e);return!o&&s?i:o}}function nb(t,e){return t&&(t[e]||t[Ys(e)]||t[tf(Ys(e))])}function ss(t,e,n,s){let r;const i=n&&n[s];if(le(t)||It(t)){r=new Array(t.length);for(let o=0,a=t.length;o<a;o++)r[o]=e(t[o],o,void 0,i&&i[o])}else if(typeof t=="number"){r=new Array(t);for(let o=0;o<t;o++)r[o]=e(o+1,o,void 0,i&&i[o])}else if(Et(t))if(t[Symbol.iterator])r=Array.from(t,(o,a)=>e(o,a,void 0,i&&i[a]));else{const o=Object.keys(t);r=new Array(o.length);for(let a=0,c=o.length;a<c;a++){const l=o[a];r[a]=e(t[l],l,a,i&&i[a])}}else r=[];return n&&(n[s]=r),r}function O_(t,e,n={},s,r){if(sn.isCE||sn.parent&&el(sn.parent)&&sn.parent.isCE)return L("slot",e==="default"?null:{name:e},s&&s());let i=t[e];i&&i._c&&(i._d=!1),W();const o=i&&QT(i(n)),a=ui(je,{key:n.key||`_${e}`},o||(s?s():[]),o&&t._===1?64:-2);return!r&&a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function QT(t){return t.some(e=>Yh(e)?!(e.type===li||e.type===je&&!QT(e.children)):!0)?t:null}const Wg=t=>t?cS(t)?uf(t)||t.proxy:Wg(t.parent):null,Gh=In(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Wg(t.parent),$root:t=>Wg(t.root),$emit:t=>t.emit,$options:t=>XT(t),$forceUpdate:t=>t.f||(t.f=()=>MT(t.update)),$nextTick:t=>t.n||(t.n=x_.bind(t.proxy)),$watch:t=>ND.bind(t)}),jD={get({_:t},e){const{ctx:n,setupState:s,data:r,props:i,accessCache:o,type:a,appContext:c}=t;let l;if(e[0]!=="$"){const f=o[e];if(f!==void 0)switch(f){case 1:return s[e];case 2:return r[e];case 4:return n[e];case 3:return i[e]}else{if(s!==$e&&we(s,e))return o[e]=1,s[e];if(r!==$e&&we(r,e))return o[e]=2,r[e];if((l=t.propsOptions[0])&&we(l,e))return o[e]=3,i[e];if(n!==$e&&we(n,e))return o[e]=4,n[e];zg&&(o[e]=0)}}const u=Gh[e];let h,d;if(u)return e==="$attrs"&&Qn(t,"get",e),u(t);if((h=a.__cssModules)&&(h=h[e]))return h;if(n!==$e&&we(n,e))return o[e]=4,n[e];if(d=c.config.globalProperties,we(d,e))return d[e]},set({_:t},e,n){const{data:s,setupState:r,ctx:i}=t;return r!==$e&&we(r,e)?(r[e]=n,!0):s!==$e&&we(s,e)?(s[e]=n,!0):we(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(i[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:s,appContext:r,propsOptions:i}},o){let a;return!!n[o]||t!==$e&&we(t,o)||e!==$e&&we(e,o)||(a=i[0])&&we(a,o)||we(s,o)||we(Gh,o)||we(r.config.globalProperties,o)},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:we(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};let zg=!0;function KD(t){const e=XT(t),n=t.proxy,s=t.ctx;zg=!1,e.beforeCreate&&sb(e.beforeCreate,t,"bc");const{data:r,computed:i,methods:o,watch:a,provide:c,inject:l,created:u,beforeMount:h,mounted:d,beforeUpdate:f,updated:p,activated:_,deactivated:v,beforeDestroy:b,beforeUnmount:N,destroyed:T,unmounted:$,render:z,renderTracked:te,renderTriggered:J,errorCaptured:ae,serverPrefetch:Ne,expose:tn,inheritAttrs:ln,components:Fn,directives:Fr,filters:Zn}=e;if(l&&HD(l,s,null,t.appContext.config.unwrapInjectedRef),o)for(const Be in o){const Pe=o[Be];he(Pe)&&(s[Be]=Pe.bind(n))}if(r){const Be=r.call(n,n);Et(Be)&&(t.data=cs(Be))}if(zg=!0,i)for(const Be in i){const Pe=i[Be],$n=he(Pe)?Pe.bind(n,n):he(Pe.get)?Pe.get.bind(n,n):bs,Yo=!he(Pe)&&he(Pe.set)?Pe.set.bind(n):bs,or=Qe({get:$n,set:Yo});Object.defineProperty(s,Be,{enumerable:!0,configurable:!0,get:()=>or.value,set:Ns=>or.value=Ns})}if(a)for(const Be in a)YT(a[Be],s,n,Be);if(c){const Be=he(c)?c.call(n):c;Reflect.ownKeys(Be).forEach(Pe=>{Nh(Pe,Be[Pe])})}u&&sb(u,t,"c");function yt(Be,Pe){le(Pe)?Pe.forEach($n=>Be($n.bind(n))):Pe&&Be(Pe.bind(n))}if(yt(MD,h),yt(N_,d),yt(LD,f),yt(WT,p),yt(PD,_),yt(DD,v),yt(VD,ae),yt(BD,te),yt(UD,J),yt(FD,N),yt(P_,$),yt($D,Ne),le(tn))if(tn.length){const Be=t.exposed||(t.exposed={});tn.forEach(Pe=>{Object.defineProperty(Be,Pe,{get:()=>n[Pe],set:$n=>n[Pe]=$n})})}else t.exposed||(t.exposed={});z&&t.render===bs&&(t.render=z),ln!=null&&(t.inheritAttrs=ln),Fn&&(t.components=Fn),Fr&&(t.directives=Fr)}function HD(t,e,n=bs,s=!1){le(t)&&(t=Gg(t));for(const r in t){const i=t[r];let o;Et(i)?"default"in i?o=Ks(i.from||r,i.default,!0):o=Ks(i.from||r):o=Ks(i),ct(o)&&s?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>o.value,set:a=>o.value=a}):e[r]=o}}function sb(t,e,n){Is(le(t)?t.map(s=>s.bind(e.proxy)):t.bind(e.proxy),e,n)}function YT(t,e,n,s){const r=s.includes(".")?jT(n,s):()=>n[s];if(It(t)){const i=e[t];he(i)&&Zc(r,i)}else if(he(t))Zc(r,t.bind(n));else if(Et(t))if(le(t))t.forEach(i=>YT(i,e,n,s));else{const i=he(t.handler)?t.handler.bind(n):e[t.handler];he(i)&&Zc(r,i,t)}}function XT(t){const e=t.type,{mixins:n,extends:s}=e,{mixins:r,optionsCache:i,config:{optionMergeStrategies:o}}=t.appContext,a=i.get(e);let c;return a?c=a:!r.length&&!n&&!s?c=e:(c={},r.length&&r.forEach(l=>Qh(c,l,o,!0)),Qh(c,e,o)),i.set(e,c),c}function Qh(t,e,n,s=!1){const{mixins:r,extends:i}=e;i&&Qh(t,i,n,!0),r&&r.forEach(o=>Qh(t,o,n,!0));for(const o in e)if(!(s&&o==="expose")){const a=WD[o]||n&&n[o];t[o]=a?a(t[o],e[o]):e[o]}return t}const WD={data:rb,props:$i,emits:$i,methods:$i,computed:$i,beforeCreate:hn,created:hn,beforeMount:hn,mounted:hn,beforeUpdate:hn,updated:hn,beforeDestroy:hn,beforeUnmount:hn,destroyed:hn,unmounted:hn,activated:hn,deactivated:hn,errorCaptured:hn,serverPrefetch:hn,components:$i,directives:$i,watch:GD,provide:rb,inject:zD};function rb(t,e){return e?t?function(){return In(he(t)?t.call(this,this):t,he(e)?e.call(this,this):e)}:e:t}function zD(t,e){return $i(Gg(t),Gg(e))}function Gg(t){if(le(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function hn(t,e){return t?[...new Set([].concat(t,e))]:e}function $i(t,e){return t?In(In(Object.create(null),t),e):e}function GD(t,e){if(!t)return e;if(!e)return t;const n=In(Object.create(null),t);for(const s in e)n[s]=hn(t[s],e[s]);return n}function QD(t,e,n,s=!1){const r={},i={};Hh(i,cf,1),t.propsDefaults=Object.create(null),JT(t,e,r,i);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);n?t.props=s?r:hD(r):t.type.props?t.props=r:t.props=i,t.attrs=i}function YD(t,e,n,s){const{props:r,attrs:i,vnode:{patchFlag:o}}=t,a=Ce(r),[c]=t.propsOptions;let l=!1;if((s||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(of(t.emitsOptions,d))continue;const f=e[d];if(c)if(we(i,d))f!==i[d]&&(i[d]=f,l=!0);else{const p=Ys(d);r[p]=Qg(c,a,p,f,t,!1)}else f!==i[d]&&(i[d]=f,l=!0)}}}else{JT(t,e,r,i)&&(l=!0);let u;for(const h in a)(!e||!we(e,h)&&((u=$o(h))===h||!we(e,u)))&&(c?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=Qg(c,a,h,void 0,t,!0)):delete r[h]);if(i!==a)for(const h in i)(!e||!we(e,h)&&!0)&&(delete i[h],l=!0)}l&&Er(t,"set","$attrs")}function JT(t,e,n,s){const[r,i]=t.propsOptions;let o=!1,a;if(e)for(let c in e){if(Rh(c))continue;const l=e[c];let u;r&&we(r,u=Ys(c))?!i||!i.includes(u)?n[u]=l:(a||(a={}))[u]=l:of(t.emitsOptions,c)||(!(c in s)||l!==s[c])&&(s[c]=l,o=!0)}if(i){const c=Ce(n),l=a||$e;for(let u=0;u<i.length;u++){const h=i[u];n[h]=Qg(r,c,h,l[h],t,!we(l,h))}}return o}function Qg(t,e,n,s,r,i){const o=t[n];if(o!=null){const a=we(o,"default");if(a&&s===void 0){const c=o.default;if(o.type!==Function&&he(c)){const{propsDefaults:l}=r;n in l?s=l[n]:(Na(r),s=l[n]=c.call(null,e),ao())}else s=c}o[0]&&(i&&!a?s=!1:o[1]&&(s===""||s===$o(n))&&(s=!0))}return s}function ZT(t,e,n=!1){const s=e.propsCache,r=s.get(t);if(r)return r;const i=t.props,o={},a=[];let c=!1;if(!he(t)){const u=h=>{c=!0;const[d,f]=ZT(h,e,!0);In(o,d),f&&a.push(...f)};!n&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!i&&!c)return s.set(t,pa),pa;if(le(i))for(let u=0;u<i.length;u++){const h=Ys(i[u]);ib(h)&&(o[h]=$e)}else if(i)for(const u in i){const h=Ys(u);if(ib(h)){const d=i[u],f=o[h]=le(d)||he(d)?{type:d}:d;if(f){const p=cb(Boolean,f.type),_=cb(String,f.type);f[0]=p>-1,f[1]=_<0||p<_,(p>-1||we(f,"default"))&&a.push(h)}}}const l=[o,a];return s.set(t,l),l}function ib(t){return t[0]!=="$"}function ob(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function ab(t,e){return ob(t)===ob(e)}function cb(t,e){return le(e)?e.findIndex(n=>ab(n,t)):he(e)&&ab(e,t)?0:-1}const eS=t=>t[0]==="_"||t==="$stable",M_=t=>le(t)?t.map(Ms):[Ms(t)],XD=(t,e,n)=>{if(e._n)return e;const s=dt((...r)=>M_(e(...r)),n);return s._c=!1,s},tS=(t,e,n)=>{const s=t._ctx;for(const r in t){if(eS(r))continue;const i=t[r];if(he(i))e[r]=XD(r,i,s);else if(i!=null){const o=M_(i);e[r]=()=>o}}},nS=(t,e)=>{const n=M_(e);t.slots.default=()=>n},JD=(t,e)=>{if(t.vnode.shapeFlag&32){const n=e._;n?(t.slots=Ce(e),Hh(e,"_",n)):tS(e,t.slots={})}else t.slots={},e&&nS(t,e);Hh(t.slots,cf,1)},ZD=(t,e,n)=>{const{vnode:s,slots:r}=t;let i=!0,o=$e;if(s.shapeFlag&32){const a=e._;a?n&&a===1?i=!1:(In(r,e),!n&&a===1&&delete r._):(i=!e.$stable,tS(e,r)),o=e}else e&&(nS(t,e),o={default:1});if(i)for(const a in r)!eS(a)&&!(a in o)&&delete r[a]};function sS(){return{app:null,config:{isNativeTag:PP,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let eO=0;function tO(t,e){return function(s,r=null){he(s)||(s=Object.assign({},s)),r!=null&&!Et(r)&&(r=null);const i=sS(),o=new Set;let a=!1;const c=i.app={_uid:eO++,_component:s,_props:r,_container:null,_context:i,_instance:null,version:vO,get config(){return i.config},set config(l){},use(l,...u){return o.has(l)||(l&&he(l.install)?(o.add(l),l.install(c,...u)):he(l)&&(o.add(l),l(c,...u))),c},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),c},component(l,u){return u?(i.components[l]=u,c):i.components[l]},directive(l,u){return u?(i.directives[l]=u,c):i.directives[l]},mount(l,u,h){if(!a){const d=L(s,r);return d.appContext=i,u&&e?e(d,l):t(d,l,h),a=!0,c._container=l,l.__vue_app__=c,uf(d.component)||d.component.proxy}},unmount(){a&&(t(null,c._container),delete c._container.__vue_app__)},provide(l,u){return i.provides[l]=u,c}};return c}}function Yg(t,e,n,s,r=!1){if(le(t)){t.forEach((d,f)=>Yg(d,e&&(le(e)?e[f]:e),n,s,r));return}if(el(s)&&!r)return;const i=s.shapeFlag&4?uf(s.component)||s.component.proxy:s.el,o=r?null:i,{i:a,r:c}=t,l=e&&e.r,u=a.refs===$e?a.refs={}:a.refs,h=a.setupState;if(l!=null&&l!==c&&(It(l)?(u[l]=null,we(h,l)&&(h[l]=null)):ct(l)&&(l.value=null)),he(c))ti(c,a,12,[o,u]);else{const d=It(c),f=ct(c);if(d||f){const p=()=>{if(t.f){const _=d?u[c]:c.value;r?le(_)&&v_(_,i):le(_)?_.includes(i)||_.push(i):d?(u[c]=[i],we(h,c)&&(h[c]=u[c])):(c.value=[i],t.k&&(u[t.k]=c.value))}else d?(u[c]=o,we(h,c)&&(h[c]=o)):f&&(c.value=o,t.k&&(u[t.k]=o))};o?(p.id=-1,Tn(p,n)):p()}}}const Tn=xD;function nO(t){return sO(t)}function sO(t,e){const n=$P();n.__VUE__=!0;const{insert:s,remove:r,patchProp:i,createElement:o,createText:a,createComment:c,setText:l,setElementText:u,parentNode:h,nextSibling:d,setScopeId:f=bs,cloneNode:p,insertStaticContent:_}=t,v=(g,y,E,R=null,C=null,F=null,j=!1,M=null,B=!!y.dynamicChildren)=>{if(g===y)return;g&&!kc(g,y)&&(R=X(g),es(g,C,F,!0),g=null),y.patchFlag===-2&&(B=!1,y.dynamicChildren=null);const{type:P,ref:Z,shapeFlag:G}=y;switch(P){case L_:b(g,y,E,R);break;case li:N(g,y,E,R);break;case Ph:g==null&&T(y,E,R,j);break;case je:Fr(g,y,E,R,C,F,j,M,B);break;default:G&1?te(g,y,E,R,C,F,j,M,B):G&6?Zn(g,y,E,R,C,F,j,M,B):(G&64||G&128)&&P.process(g,y,E,R,C,F,j,M,B,Ve)}Z!=null&&C&&Yg(Z,g&&g.ref,F,y||g,!y)},b=(g,y,E,R)=>{if(g==null)s(y.el=a(y.children),E,R);else{const C=y.el=g.el;y.children!==g.children&&l(C,y.children)}},N=(g,y,E,R)=>{g==null?s(y.el=c(y.children||""),E,R):y.el=g.el},T=(g,y,E,R)=>{[g.el,g.anchor]=_(g.children,y,E,R,g.el,g.anchor)},$=({el:g,anchor:y},E,R)=>{let C;for(;g&&g!==y;)C=d(g),s(g,E,R),g=C;s(y,E,R)},z=({el:g,anchor:y})=>{let E;for(;g&&g!==y;)E=d(g),r(g),g=E;r(y)},te=(g,y,E,R,C,F,j,M,B)=>{j=j||y.type==="svg",g==null?J(y,E,R,C,F,j,M,B):tn(g,y,C,F,j,M,B)},J=(g,y,E,R,C,F,j,M)=>{let B,P;const{type:Z,props:G,shapeFlag:ee,transition:ce,patchFlag:Ie,dirs:Oe}=g;if(g.el&&p!==void 0&&Ie===-1)B=g.el=p(g.el);else{if(B=g.el=o(g.type,F,G&&G.is,G),ee&8?u(B,g.children):ee&16&&Ne(g.children,B,null,R,C,F&&Z!=="foreignObject",j,M),Oe&&Oi(g,null,R,"created"),G){for(const We in G)We!=="value"&&!Rh(We)&&i(B,We,null,G[We],F,g.children,R,C,V);"value"in G&&i(B,"value",null,G.value),(P=G.onVnodeBeforeMount)&&Ds(P,R,g)}ae(B,g,g.scopeId,j,R)}Oe&&Oi(g,null,R,"beforeMount");const Me=(!C||C&&!C.pendingBranch)&&ce&&!ce.persisted;Me&&ce.beforeEnter(B),s(B,y,E),((P=G&&G.onVnodeMounted)||Me||Oe)&&Tn(()=>{P&&Ds(P,R,g),Me&&ce.enter(B),Oe&&Oi(g,null,R,"mounted")},C)},ae=(g,y,E,R,C)=>{if(E&&f(g,E),R)for(let F=0;F<R.length;F++)f(g,R[F]);if(C){let F=C.subTree;if(y===F){const j=C.vnode;ae(g,j,j.scopeId,j.slotScopeIds,C.parent)}}},Ne=(g,y,E,R,C,F,j,M,B=0)=>{for(let P=B;P<g.length;P++){const Z=g[P]=M?Hr(g[P]):Ms(g[P]);v(null,Z,y,E,R,C,F,j,M)}},tn=(g,y,E,R,C,F,j)=>{const M=y.el=g.el;let{patchFlag:B,dynamicChildren:P,dirs:Z}=y;B|=g.patchFlag&16;const G=g.props||$e,ee=y.props||$e;let ce;E&&Mi(E,!1),(ce=ee.onVnodeBeforeUpdate)&&Ds(ce,E,y,g),Z&&Oi(y,g,E,"beforeUpdate"),E&&Mi(E,!0);const Ie=C&&y.type!=="foreignObject";if(P?ln(g.dynamicChildren,P,M,E,R,Ie,F):j||$n(g,y,M,null,E,R,Ie,F,!1),B>0){if(B&16)Fn(M,y,G,ee,E,R,C);else if(B&2&&G.class!==ee.class&&i(M,"class",null,ee.class,C),B&4&&i(M,"style",G.style,ee.style,C),B&8){const Oe=y.dynamicProps;for(let Me=0;Me<Oe.length;Me++){const We=Oe[Me],ps=G[We],Xo=ee[We];(Xo!==ps||We==="value")&&i(M,We,ps,Xo,C,g.children,E,R,V)}}B&1&&g.children!==y.children&&u(M,y.children)}else!j&&P==null&&Fn(M,y,G,ee,E,R,C);((ce=ee.onVnodeUpdated)||Z)&&Tn(()=>{ce&&Ds(ce,E,y,g),Z&&Oi(y,g,E,"updated")},R)},ln=(g,y,E,R,C,F,j)=>{for(let M=0;M<y.length;M++){const B=g[M],P=y[M],Z=B.el&&(B.type===je||!kc(B,P)||B.shapeFlag&70)?h(B.el):E;v(B,P,Z,null,R,C,F,j,!0)}},Fn=(g,y,E,R,C,F,j)=>{if(E!==R){for(const M in R){if(Rh(M))continue;const B=R[M],P=E[M];B!==P&&M!=="value"&&i(g,M,P,B,j,y.children,C,F,V)}if(E!==$e)for(const M in E)!Rh(M)&&!(M in R)&&i(g,M,E[M],null,j,y.children,C,F,V);"value"in R&&i(g,"value",E.value,R.value)}},Fr=(g,y,E,R,C,F,j,M,B)=>{const P=y.el=g?g.el:a(""),Z=y.anchor=g?g.anchor:a("");let{patchFlag:G,dynamicChildren:ee,slotScopeIds:ce}=y;ce&&(M=M?M.concat(ce):ce),g==null?(s(P,E,R),s(Z,E,R),Ne(y.children,E,Z,C,F,j,M,B)):G>0&&G&64&&ee&&g.dynamicChildren?(ln(g.dynamicChildren,ee,E,C,F,j,M),(y.key!=null||C&&y===C.subTree)&&rS(g,y,!0)):$n(g,y,E,Z,C,F,j,M,B)},Zn=(g,y,E,R,C,F,j,M,B)=>{y.slotScopeIds=M,g==null?y.shapeFlag&512?C.ctx.activate(y,E,R,j,B):_t(y,E,R,C,F,j,B):yt(g,y,B)},_t=(g,y,E,R,C,F,j)=>{const M=g.component=dO(g,R,C);if(KT(g)&&(M.ctx.renderer=Ve),fO(M),M.asyncDep){if(C&&C.registerDep(M,Be),!g.el){const B=M.subTree=L(li);N(null,B,y,E)}return}Be(M,g,y,E,C,F,j)},yt=(g,y,E)=>{const R=y.component=g.component;if(kD(g,y,E))if(R.asyncDep&&!R.asyncResolved){Pe(R,y,E);return}else R.next=y,bD(R.update),R.update();else y.el=g.el,R.vnode=y},Be=(g,y,E,R,C,F,j)=>{const M=()=>{if(g.isMounted){let{next:Z,bu:G,u:ee,parent:ce,vnode:Ie}=g,Oe=Z,Me;Mi(g,!1),Z?(Z.el=Ie.el,Pe(g,Z,j)):Z=Ie,G&&xh(G),(Me=Z.props&&Z.props.onVnodeBeforeUpdate)&&Ds(Me,ce,Z,Ie),Mi(g,!0);const We=$p(g),ps=g.subTree;g.subTree=We,v(ps,We,h(ps.el),X(ps),g,C,F),Z.el=We.el,Oe===null&&AD(g,We.el),ee&&Tn(ee,C),(Me=Z.props&&Z.props.onVnodeUpdated)&&Tn(()=>Ds(Me,ce,Z,Ie),C)}else{let Z;const{el:G,props:ee}=y,{bm:ce,m:Ie,parent:Oe}=g,Me=el(y);if(Mi(g,!1),ce&&xh(ce),!Me&&(Z=ee&&ee.onVnodeBeforeMount)&&Ds(Z,Oe,y),Mi(g,!0),G&&fe){const We=()=>{g.subTree=$p(g),fe(G,g.subTree,g,C,null)};Me?y.type.__asyncLoader().then(()=>!g.isUnmounted&&We()):We()}else{const We=g.subTree=$p(g);v(null,We,E,R,g,C,F),y.el=We.el}if(Ie&&Tn(Ie,C),!Me&&(Z=ee&&ee.onVnodeMounted)){const We=y;Tn(()=>Ds(Z,Oe,We),C)}(y.shapeFlag&256||Oe&&el(Oe.vnode)&&Oe.vnode.shapeFlag&256)&&g.a&&Tn(g.a,C),g.isMounted=!0,y=E=R=null}},B=g.effect=new E_(M,()=>MT(P),g.scope),P=g.update=()=>B.run();P.id=g.uid,Mi(g,!0),P()},Pe=(g,y,E)=>{y.component=g;const R=g.vnode.props;g.vnode=y,g.next=null,YD(g,y.props,R,E),ZD(g,y.children,E),tc(),rf(void 0,g.update),nc()},$n=(g,y,E,R,C,F,j,M,B=!1)=>{const P=g&&g.children,Z=g?g.shapeFlag:0,G=y.children,{patchFlag:ee,shapeFlag:ce}=y;if(ee>0){if(ee&128){or(P,G,E,R,C,F,j,M,B);return}else if(ee&256){Yo(P,G,E,R,C,F,j,M,B);return}}ce&8?(Z&16&&V(P,C,F),G!==P&&u(E,G)):Z&16?ce&16?or(P,G,E,R,C,F,j,M,B):V(P,C,F,!0):(Z&8&&u(E,""),ce&16&&Ne(G,E,R,C,F,j,M,B))},Yo=(g,y,E,R,C,F,j,M,B)=>{g=g||pa,y=y||pa;const P=g.length,Z=y.length,G=Math.min(P,Z);let ee;for(ee=0;ee<G;ee++){const ce=y[ee]=B?Hr(y[ee]):Ms(y[ee]);v(g[ee],ce,E,null,C,F,j,M,B)}P>Z?V(g,C,F,!0,!1,G):Ne(y,E,R,C,F,j,M,B,G)},or=(g,y,E,R,C,F,j,M,B)=>{let P=0;const Z=y.length;let G=g.length-1,ee=Z-1;for(;P<=G&&P<=ee;){const ce=g[P],Ie=y[P]=B?Hr(y[P]):Ms(y[P]);if(kc(ce,Ie))v(ce,Ie,E,null,C,F,j,M,B);else break;P++}for(;P<=G&&P<=ee;){const ce=g[G],Ie=y[ee]=B?Hr(y[ee]):Ms(y[ee]);if(kc(ce,Ie))v(ce,Ie,E,null,C,F,j,M,B);else break;G--,ee--}if(P>G){if(P<=ee){const ce=ee+1,Ie=ce<Z?y[ce].el:R;for(;P<=ee;)v(null,y[P]=B?Hr(y[P]):Ms(y[P]),E,Ie,C,F,j,M,B),P++}}else if(P>ee)for(;P<=G;)es(g[P],C,F,!0),P++;else{const ce=P,Ie=P,Oe=new Map;for(P=Ie;P<=ee;P++){const Un=y[P]=B?Hr(y[P]):Ms(y[P]);Un.key!=null&&Oe.set(Un.key,P)}let Me,We=0;const ps=ee-Ie+1;let Xo=!1,Vw=0;const Cc=new Array(ps);for(P=0;P<ps;P++)Cc[P]=0;for(P=ce;P<=G;P++){const Un=g[P];if(We>=ps){es(Un,C,F,!0);continue}let Ps;if(Un.key!=null)Ps=Oe.get(Un.key);else for(Me=Ie;Me<=ee;Me++)if(Cc[Me-Ie]===0&&kc(Un,y[Me])){Ps=Me;break}Ps===void 0?es(Un,C,F,!0):(Cc[Ps-Ie]=P+1,Ps>=Vw?Vw=Ps:Xo=!0,v(Un,y[Ps],E,null,C,F,j,M,B),We++)}const qw=Xo?rO(Cc):pa;for(Me=qw.length-1,P=ps-1;P>=0;P--){const Un=Ie+P,Ps=y[Un],jw=Un+1<Z?y[Un+1].el:R;Cc[P]===0?v(null,Ps,E,jw,C,F,j,M,B):Xo&&(Me<0||P!==qw[Me]?Ns(Ps,E,jw,2):Me--)}}},Ns=(g,y,E,R,C=null)=>{const{el:F,type:j,transition:M,children:B,shapeFlag:P}=g;if(P&6){Ns(g.component.subTree,y,E,R);return}if(P&128){g.suspense.move(y,E,R);return}if(P&64){j.move(g,y,E,Ve);return}if(j===je){s(F,y,E);for(let G=0;G<B.length;G++)Ns(B[G],y,E,R);s(g.anchor,y,E);return}if(j===Ph){$(g,y,E);return}if(R!==2&&P&1&&M)if(R===0)M.beforeEnter(F),s(F,y,E),Tn(()=>M.enter(F),C);else{const{leave:G,delayLeave:ee,afterLeave:ce}=M,Ie=()=>s(F,y,E),Oe=()=>{G(F,()=>{Ie(),ce&&ce()})};ee?ee(F,Ie,Oe):Oe()}else s(F,y,E)},es=(g,y,E,R=!1,C=!1)=>{const{type:F,props:j,ref:M,children:B,dynamicChildren:P,shapeFlag:Z,patchFlag:G,dirs:ee}=g;if(M!=null&&Yg(M,null,E,g,!0),Z&256){y.ctx.deactivate(g);return}const ce=Z&1&&ee,Ie=!el(g);let Oe;if(Ie&&(Oe=j&&j.onVnodeBeforeUnmount)&&Ds(Oe,y,g),Z&6)Q(g.component,E,R);else{if(Z&128){g.suspense.unmount(E,R);return}ce&&Oi(g,null,y,"beforeUnmount"),Z&64?g.type.remove(g,y,E,C,Ve,R):P&&(F!==je||G>0&&G&64)?V(P,y,E,!1,!0):(F===je&&G&384||!C&&Z&16)&&V(B,y,E),R&&Lp(g)}(Ie&&(Oe=j&&j.onVnodeUnmounted)||ce)&&Tn(()=>{Oe&&Ds(Oe,y,g),ce&&Oi(g,null,y,"unmounted")},E)},Lp=g=>{const{type:y,el:E,anchor:R,transition:C}=g;if(y===je){S(E,R);return}if(y===Ph){z(g);return}const F=()=>{r(E),C&&!C.persisted&&C.afterLeave&&C.afterLeave()};if(g.shapeFlag&1&&C&&!C.persisted){const{leave:j,delayLeave:M}=C,B=()=>j(E,F);M?M(g.el,F,B):B()}else F()},S=(g,y)=>{let E;for(;g!==y;)E=d(g),r(g),g=E;r(y)},Q=(g,y,E)=>{const{bum:R,scope:C,update:F,subTree:j,um:M}=g;R&&xh(R),C.stop(),F&&(F.active=!1,es(j,g,y,E)),M&&Tn(M,y),Tn(()=>{g.isUnmounted=!0},y),y&&y.pendingBranch&&!y.isUnmounted&&g.asyncDep&&!g.asyncResolved&&g.suspenseId===y.pendingId&&(y.deps--,y.deps===0&&y.resolve())},V=(g,y,E,R=!1,C=!1,F=0)=>{for(let j=F;j<g.length;j++)es(g[j],y,E,R,C)},X=g=>g.shapeFlag&6?X(g.component.subTree):g.shapeFlag&128?g.suspense.next():d(g.anchor||g.el),De=(g,y,E)=>{g==null?y._vnode&&es(y._vnode,null,null,!0):v(y._vnode||null,g,y,null,null,null,E),$T(),y._vnode=g},Ve={p:v,um:es,m:Ns,r:Lp,mt:_t,mc:Ne,pc:$n,pbc:ln,n:X,o:t};let ye,fe;return e&&([ye,fe]=e(Ve)),{render:De,hydrate:ye,createApp:tO(De,ye)}}function Mi({effect:t,update:e},n){t.allowRecurse=e.allowRecurse=n}function rS(t,e,n=!1){const s=t.children,r=e.children;if(le(s)&&le(r))for(let i=0;i<s.length;i++){const o=s[i];let a=r[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=r[i]=Hr(r[i]),a.el=o.el),n||rS(o,a))}}function rO(t){const e=t.slice(),n=[0];let s,r,i,o,a;const c=t.length;for(s=0;s<c;s++){const l=t[s];if(l!==0){if(r=n[n.length-1],t[r]<l){e[s]=r,n.push(s);continue}for(i=0,o=n.length-1;i<o;)a=i+o>>1,t[n[a]]<l?i=a+1:o=a;l<t[n[i]]&&(i>0&&(e[s]=n[i-1]),n[i]=s)}}for(i=n.length,o=n[i-1];i-- >0;)n[i]=o,o=e[o];return n}const iO=t=>t.__isTeleport,je=Symbol(void 0),L_=Symbol(void 0),li=Symbol(void 0),Ph=Symbol(void 0),tl=[];let ys=null;function W(t=!1){tl.push(ys=t?null:[])}function oO(){tl.pop(),ys=tl[tl.length-1]||null}let Cl=1;function lb(t){Cl+=t}function iS(t){return t.dynamicChildren=Cl>0?ys||pa:null,oO(),Cl>0&&ys&&ys.push(t),t}function Y(t,e,n,s,r,i){return iS(m(t,e,n,s,r,i,!0))}function ui(t,e,n,s,r){return iS(L(t,e,n,s,r,!0))}function Yh(t){return t?t.__v_isVNode===!0:!1}function kc(t,e){return t.type===e.type&&t.key===e.key}const cf="__vInternal",oS=({key:t})=>t!=null?t:null,Dh=({ref:t,ref_key:e,ref_for:n})=>t!=null?It(t)||ct(t)||he(t)?{i:sn,r:t,k:e,f:!!n}:t:null;function m(t,e=null,n=null,s=0,r=null,i=t===je?0:1,o=!1,a=!1){const c={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&oS(e),ref:e&&Dh(e),scopeId:VT,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:s,dynamicProps:r,dynamicChildren:null,appContext:null};return a?(F_(c,n),i&128&&t.normalize(c)):n&&(c.shapeFlag|=It(n)?8:16),Cl>0&&!o&&ys&&(c.patchFlag>0||i&6)&&c.patchFlag!==32&&ys.push(c),c}const L=aO;function aO(t,e=null,n=null,s=0,r=null,i=!1){if((!t||t===zT)&&(t=li),Yh(t)){const a=xa(t,e,!0);return n&&F_(a,n),Cl>0&&!i&&ys&&(a.shapeFlag&6?ys[ys.indexOf(t)]=a:ys.push(a)),a.patchFlag|=-2,a}if(yO(t)&&(t=t.__vccOpts),e){e=cO(e);let{class:a,style:c}=e;a&&!It(a)&&(e.class=pt(a)),Et(c)&&(AT(c)&&!le(c)&&(c=In({},c)),e.style=__(c))}const o=It(t)?1:RD(t)?128:iO(t)?64:Et(t)?4:he(t)?2:0;return m(t,e,n,s,r,o,i,!0)}function cO(t){return t?AT(t)||cf in t?In({},t):t:null}function xa(t,e,n=!1){const{props:s,ref:r,patchFlag:i,children:o}=t,a=e?lO(s||{},e):s;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:a,key:a&&oS(a),ref:e&&e.ref?n&&r?le(r)?r.concat(Dh(e)):[r,Dh(e)]:Dh(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==je?i===-1?16:i|16:i,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&xa(t.ssContent),ssFallback:t.ssFallback&&xa(t.ssFallback),el:t.el,anchor:t.anchor}}function Je(t=" ",e=0){return L(L_,null,t,e)}function lf(t,e){const n=L(Ph,null,t);return n.staticCount=e,n}function kl(t="",e=!1){return e?(W(),ui(li,null,t)):L(li,null,t)}function Ms(t){return t==null||typeof t=="boolean"?L(li):le(t)?L(je,null,t.slice()):typeof t=="object"?Hr(t):L(L_,null,String(t))}function Hr(t){return t.el===null||t.memo?t:xa(t)}function F_(t,e){let n=0;const{shapeFlag:s}=t;if(e==null)e=null;else if(le(e))n=16;else if(typeof e=="object")if(s&65){const r=e.default;r&&(r._c&&(r._d=!1),F_(t,r()),r._c&&(r._d=!0));return}else{n=32;const r=e._;!r&&!(cf in e)?e._ctx=sn:r===3&&sn&&(sn.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else he(e)?(e={default:e,_ctx:sn},n=32):(e=String(e),s&64?(n=16,e=[Je(e)]):n=8);t.children=e,t.shapeFlag|=n}function lO(...t){const e={};for(let n=0;n<t.length;n++){const s=t[n];for(const r in s)if(r==="class")e.class!==s.class&&(e.class=pt([e.class,s.class]));else if(r==="style")e.style=__([e.style,s.style]);else if(Jd(r)){const i=e[r],o=s[r];o&&i!==o&&!(le(i)&&i.includes(o))&&(e[r]=i?[].concat(i,o):o)}else r!==""&&(e[r]=s[r])}return e}function Ds(t,e,n,s=null){Is(t,e,7,[n,s])}const uO=sS();let hO=0;function dO(t,e,n){const s=t.type,r=(e?e.appContext:t.appContext)||uO,i={uid:hO++,vnode:t,type:s,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new gT(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ZT(s,r),emitsOptions:BT(s,r),emit:null,emitted:null,propsDefaults:$e,inheritAttrs:s.inheritAttrs,ctx:$e,data:$e,props:$e,attrs:$e,slots:$e,refs:$e,setupState:$e,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=TD.bind(null,i),t.ce&&t.ce(i),i}let Pt=null;const aS=()=>Pt||sn,Na=t=>{Pt=t,t.scope.on()},ao=()=>{Pt&&Pt.scope.off(),Pt=null};function cS(t){return t.vnode.shapeFlag&4}let Al=!1;function fO(t,e=!1){Al=e;const{props:n,children:s}=t.vnode,r=cS(t);QD(t,n,r,e),JD(t,s);const i=r?pO(t,e):void 0;return Al=!1,i}function pO(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=Ra(new Proxy(t.ctx,jD));const{setup:s}=n;if(s){const r=t.setupContext=s.length>1?mO(t):null;Na(t),tc();const i=ti(s,t,0,[t.props,r]);if(nc(),ao(),dT(i)){if(i.then(ao,ao),e)return i.then(o=>{ub(t,o,e)}).catch(o=>{sf(o,t,0)});t.asyncDep=i}else ub(t,i,e)}else lS(t,e)}function ub(t,e,n){he(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:Et(e)&&(t.setupState=PT(e)),lS(t,n)}let hb;function lS(t,e,n){const s=t.type;if(!t.render){if(!e&&hb&&!s.render){const r=s.template;if(r){const{isCustomElement:i,compilerOptions:o}=t.appContext.config,{delimiters:a,compilerOptions:c}=s,l=In(In({isCustomElement:i,delimiters:a},o),c);s.render=hb(r,l)}}t.render=s.render||bs}Na(t),tc(),KD(t),nc(),ao()}function gO(t){return new Proxy(t.attrs,{get(e,n){return Qn(t,"get","$attrs"),e[n]}})}function mO(t){const e=s=>{t.exposed=s||{}};let n;return{get attrs(){return n||(n=gO(t))},slots:t.slots,emit:t.emit,expose:e}}function uf(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(PT(Ra(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in Gh)return Gh[n](t)}}))}function _O(t,e=!0){return he(t)?t.displayName||t.name:t.name||e&&t.__name}function yO(t){return he(t)&&"__vccOpts"in t}const Qe=(t,e)=>yD(t,e,Al);function nl(t,e,n){const s=arguments.length;return s===2?Et(e)&&!le(e)?Yh(e)?L(t,null,[e]):L(t,e):L(t,null,e):(s>3?n=Array.prototype.slice.call(arguments,2):s===3&&Yh(n)&&(n=[n]),L(t,e,n))}const vO="3.2.37",wO="http://www.w3.org/2000/svg",ji=typeof document!="undefined"?document:null,db=ji&&ji.createElement("template"),bO={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,s)=>{const r=e?ji.createElementNS(wO,t):ji.createElement(t,n?{is:n}:void 0);return t==="select"&&s&&s.multiple!=null&&r.setAttribute("multiple",s.multiple),r},createText:t=>ji.createTextNode(t),createComment:t=>ji.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ji.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,n,s,r,i){const o=n?n.previousSibling:e.lastChild;if(r&&(r===i||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),n),!(r===i||!(r=r.nextSibling)););else{db.innerHTML=s?`<svg>${t}</svg>`:t;const a=db.content;if(s){const c=a.firstChild;for(;c.firstChild;)a.appendChild(c.firstChild);a.removeChild(c)}e.insertBefore(a,n)}return[o?o.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}};function IO(t,e,n){const s=t._vtc;s&&(e=(e?[e,...s]:[...s]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}function EO(t,e,n){const s=t.style,r=It(n);if(n&&!r){for(const i in n)Xg(s,i,n[i]);if(e&&!It(e))for(const i in e)n[i]==null&&Xg(s,i,"")}else{const i=s.display;r?e!==n&&(s.cssText=n):e&&t.removeAttribute("style"),"_vod"in t&&(s.display=i)}}const fb=/\s*!important$/;function Xg(t,e,n){if(le(n))n.forEach(s=>Xg(t,e,s));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const s=TO(t,e);fb.test(n)?t.setProperty($o(s),n.replace(fb,""),"important"):t[s]=n}}const pb=["Webkit","Moz","ms"],Up={};function TO(t,e){const n=Up[e];if(n)return n;let s=Ys(e);if(s!=="filter"&&s in t)return Up[e]=s;s=tf(s);for(let r=0;r<pb.length;r++){const i=pb[r]+s;if(i in t)return Up[e]=i}return e}const gb="http://www.w3.org/1999/xlink";function SO(t,e,n,s,r){if(s&&e.startsWith("xlink:"))n==null?t.removeAttributeNS(gb,e.slice(6,e.length)):t.setAttributeNS(gb,e,n);else{const i=AP(e);n==null||i&&!lT(n)?t.removeAttribute(e):t.setAttribute(e,i?"":n)}}function CO(t,e,n,s,r,i,o){if(e==="innerHTML"||e==="textContent"){s&&o(s,r,i),t[e]=n==null?"":n;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=n;const c=n==null?"":n;(t.value!==c||t.tagName==="OPTION")&&(t.value=c),n==null&&t.removeAttribute(e);return}let a=!1;if(n===""||n==null){const c=typeof t[e];c==="boolean"?n=lT(n):n==null&&c==="string"?(n="",a=!0):c==="number"&&(n=0,a=!0)}try{t[e]=n}catch{}a&&t.removeAttribute(e)}const[uS,kO]=(()=>{let t=Date.now,e=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(n&&Number(n[1])<=53)}return[t,e]})();let Jg=0;const AO=Promise.resolve(),RO=()=>{Jg=0},xO=()=>Jg||(AO.then(RO),Jg=uS());function ca(t,e,n,s){t.addEventListener(e,n,s)}function NO(t,e,n,s){t.removeEventListener(e,n,s)}function PO(t,e,n,s,r=null){const i=t._vei||(t._vei={}),o=i[e];if(s&&o)o.value=s;else{const[a,c]=DO(e);if(s){const l=i[e]=OO(s,r);ca(t,a,l,c)}else o&&(NO(t,a,o,c),i[e]=void 0)}}const mb=/(?:Once|Passive|Capture)$/;function DO(t){let e;if(mb.test(t)){e={};let n;for(;n=t.match(mb);)t=t.slice(0,t.length-n[0].length),e[n[0].toLowerCase()]=!0}return[$o(t.slice(2)),e]}function OO(t,e){const n=s=>{const r=s.timeStamp||uS();(kO||r>=n.attached-1)&&Is(MO(s,n.value),e,5,[s])};return n.value=t,n.attached=xO(),n}function MO(t,e){if(le(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(s=>r=>!r._stopped&&s&&s(r))}else return e}const _b=/^on[a-z]/,LO=(t,e,n,s,r=!1,i,o,a,c)=>{e==="class"?IO(t,s,r):e==="style"?EO(t,n,s):Jd(e)?y_(e)||PO(t,e,n,s,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):FO(t,e,s,r))?CO(t,e,s,i,o,a,c):(e==="true-value"?t._trueValue=s:e==="false-value"&&(t._falseValue=s),SO(t,e,s,r))};function FO(t,e,n,s){return s?!!(e==="innerHTML"||e==="textContent"||e in t&&_b.test(e)&&he(n)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||_b.test(e)&&It(n)?!1:e in t}const yb=t=>{const e=t.props["onUpdate:modelValue"]||!1;return le(e)?n=>xh(e,n):e};function $O(t){t.target.composing=!0}function vb(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Ji={created(t,{modifiers:{lazy:e,trim:n,number:s}},r){t._assign=yb(r);const i=s||r.props&&r.props.type==="number";ca(t,e?"change":"input",o=>{if(o.target.composing)return;let a=t.value;n&&(a=a.trim()),i&&(a=$g(a)),t._assign(a)}),n&&ca(t,"change",()=>{t.value=t.value.trim()}),e||(ca(t,"compositionstart",$O),ca(t,"compositionend",vb),ca(t,"change",vb))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:n,trim:s,number:r}},i){if(t._assign=yb(i),t.composing||document.activeElement===t&&t.type!=="range"&&(n||s&&t.value.trim()===e||(r||t.type==="number")&&$g(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},UO=["ctrl","shift","alt","meta"],BO={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>UO.some(n=>t[`${n}Key`]&&!e.includes(n))},hS=(t,e)=>(n,...s)=>{for(let r=0;r<e.length;r++){const i=BO[e[r]];if(i&&i(n,e))return}return t(n,...s)},VO={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},qO=(t,e)=>n=>{if(!("key"in n))return;const s=$o(n.key);if(e.some(r=>r===s||VO[r]===s))return t(n)},jO=In({patchProp:LO},bO);let wb;function KO(){return wb||(wb=nO(jO))}const HO=(...t)=>{const e=KO().createApp(...t),{mount:n}=e;return e.mount=s=>{const r=WO(s);if(!r)return;const i=e._component;!he(i)&&!i.render&&!i.template&&(i.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function WO(t){return It(t)?document.querySelector(t):t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O=function(t,e){if(!t)throw sc(e)},sc=function(t){return new Error("Firebase Database ("+dS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},zO=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],a=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},hf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,a=o?t[r+1]:0,c=r+2<t.length,l=c?t[r+2]:0,u=i>>2,h=(i&3)<<4|a>>4;let d=(a&15)<<2|l>>6,f=l&63;c||(f=64,o||(d=64)),s.push(n[u],n[h],n[d],n[f])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):zO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],a=r<t.length?n[t.charAt(r)]:0;++r;const l=r<t.length?n[t.charAt(r)]:64;++r;const h=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||a==null||l==null||h==null)throw Error();const d=i<<2|a>>4;if(s.push(d),l!==64){const f=a<<4&240|l>>2;if(s.push(f),h!==64){const p=l<<6&192|h;s.push(p)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},pS=function(t){const e=fS(t);return hf.encodeByteArray(e,!0)},Xh=function(t){return pS(t).replace(/\./g,"")},Zg=function(t){try{return hf.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GO(t){return Rl(void 0,t)}function Rl(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!QO(n)||(t[n]=Rl(t[n],e[n]));return t}function QO(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Xh(JSON.stringify(n)),Xh(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ge(){return typeof navigator!="undefined"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function df(){return typeof window!="undefined"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ge())}function U_(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function YO(){return typeof self=="object"&&self.self===self}function yu(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function vu(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function XO(){return Ge().indexOf("Electron/")>=0}function B_(){const t=Ge();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function JO(){return Ge().indexOf("MSAppHost/")>=0}function gS(){return dS.NODE_ADMIN===!0}function ZO(){return!U_()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Mn(){return typeof indexedDB=="object"}function wu(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}function ff(){return!(typeof navigator=="undefined"||!navigator.cookieEnabled)}function eM(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tM="FirebaseError";class lt extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=tM,Object.setPrototypeOf(this,lt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,En.prototype.create)}}class En{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?nM(i,s):"Error",a=`${this.serviceName}: ${o} (${r}).`;return new lt(r,a,s)}}function nM(t,e){return t.replace(sM,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const sM=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(t){return JSON.parse(t)}function bt(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V_=function(t){let e={},n={},s={},r="";try{const i=t.split(".");e=xl(Zg(i[0])||""),n=xl(Zg(i[1])||""),r=i[2],s=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:s,signature:r}},rM=function(t){const e=V_(t).claims;return typeof e=="object"&&e.hasOwnProperty("iat")?e.iat:null},iM=function(t){const e=V_(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},oM=function(t){const e=V_(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function po(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function Jh(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Zh(t,e,n){const s={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(s[r]=e.call(n,t[r],r,t));return s}function Nl(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(bb(i)&&bb(o)){if(!Nl(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function bb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uo(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function ha(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function Wc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aM{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const s=this.W_;if(typeof e=="string")for(let h=0;h<16;h++)s[h]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let h=0;h<16;h++)s[h]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let h=16;h<80;h++){const d=s[h-3]^s[h-8]^s[h-14]^s[h-16];s[h]=(d<<1|d>>>31)&4294967295}let r=this.chain_[0],i=this.chain_[1],o=this.chain_[2],a=this.chain_[3],c=this.chain_[4],l,u;for(let h=0;h<80;h++){h<40?h<20?(l=a^i&(o^a),u=1518500249):(l=i^o^a,u=1859775393):h<60?(l=i&o|a&(i|o),u=2400959708):(l=i^o^a,u=3395469782);const d=(r<<5|r>>>27)+l+c+u+s[h]&4294967295;c=a,a=o,o=(i<<30|i>>>2)&4294967295,i=r,r=d}this.chain_[0]=this.chain_[0]+r&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const s=n-this.blockSize;let r=0;const i=this.buf_;let o=this.inbuf_;for(;r<n;){if(o===0)for(;r<=s;)this.compress_(e,r),r+=this.blockSize;if(typeof e=="string"){for(;r<n;)if(i[o]=e.charCodeAt(r),++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<n;)if(i[o]=e[r],++o,++r,o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);let s=0;for(let r=0;r<5;r++)for(let i=24;i>=0;i-=8)e[s]=this.chain_[r]>>i&255,++s;return e}}function mS(t,e){const n=new cM(t,e);return n.subscribe.bind(n)}class cM{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");lM(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=Bp),r.error===void 0&&(r.error=Bp),r.complete===void 0&&(r.complete=Bp);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console!="undefined"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function lM(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se=function(t,e,n,s){let r;if(s<e?r="at least "+e:s>n&&(r=n===0?"none":"no more than "+n),r){const i=t+" failed: Was called with "+s+(s===1?" argument.":" arguments.")+" Expects "+r+".";throw new Error(i)}};function Dn(t,e){return`${t} failed: ${e} argument `}function At(t,e,n,s){if(!(s&&!n)&&typeof n!="function")throw new Error(Dn(t,e)+"must be a valid function.")}function Ib(t,e,n,s){if(!(s&&!n)&&(typeof n!="object"||n===null))throw new Error(Dn(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);if(r>=55296&&r<=56319){const i=r-55296;s++,O(s<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(s)-56320;r=65536+(i<<10)+o}r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):r<65536?(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},pf=function(t){let e=0;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);s<128?e++:s<2048?e+=2:s>=55296&&s<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM=1e3,dM=2,fM=4*60*60*1e3,pM=.5;function ed(t,e=hM,n=dM){const s=e*Math.pow(n,t),r=Math.round(pM*s*(Math.random()-.5)*2);return Math.min(fM,s+r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(t){return t&&t._delegate?t._delegate:t}class Te{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ui="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new wt;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(mM(e))try{this.getOrInitializeService({instanceIdentifier:Ui})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=Ui){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ui){return this.instances.has(e)}getOptions(e=Ui){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);s===a&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(!!s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:gM(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=Ui){return this.component?this.component.multipleInstances?e:Ui:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function gM(t){return t===Ui?void 0:t}function mM(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yS{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _S(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_=[];var pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(pe||(pe={}));const vS={debug:pe.DEBUG,verbose:pe.VERBOSE,info:pe.INFO,warn:pe.WARN,error:pe.ERROR,silent:pe.SILENT},_M=pe.INFO,yM={[pe.DEBUG]:"log",[pe.VERBOSE]:"log",[pe.INFO]:"info",[pe.WARN]:"warn",[pe.ERROR]:"error"},vM=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=yM[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class rr{constructor(e){this.name=e,this._logLevel=_M,this._logHandler=vM,this._userLogHandler=null,q_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?vS[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,pe.DEBUG,...e),this._logHandler(this,pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,pe.VERBOSE,...e),this._logHandler(this,pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,pe.INFO,...e),this._logHandler(this,pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,pe.WARN,...e),this._logHandler(this,pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,pe.ERROR,...e),this._logHandler(this,pe.ERROR,...e)}}function wM(t){q_.forEach(e=>{e.setLogLevel(t)})}function bM(t,e){for(const n of q_){let s=null;e&&e.level&&(s=vS[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(r,i,...o)=>{const a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");i>=(s!=null?s:r.logLevel)&&t({level:pe[i].toLowerCase(),message:a,args:o,type:r.name})}}}const IM=(t,e)=>e.some(n=>t instanceof n);let Eb,Tb;function EM(){return Eb||(Eb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function TM(){return Tb||(Tb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const wS=new WeakMap,em=new WeakMap,bS=new WeakMap,Vp=new WeakMap,j_=new WeakMap;function SM(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(mr(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&wS.set(n,t)}).catch(()=>{}),j_.set(e,t),e}function CM(t){if(em.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});em.set(t,e)}let tm={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return em.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return mr(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function kM(t){tm=t(tm)}function AM(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(qp(this),e,...n);return bS.set(s,e.sort?e.sort():[e]),mr(s)}:TM().includes(t)?function(...e){return t.apply(qp(this),e),mr(wS.get(this))}:function(...e){return mr(t.apply(qp(this),e))}}function RM(t){return typeof t=="function"?AM(t):(t instanceof IDBTransaction&&CM(t),IM(t,EM())?new Proxy(t,tm):t)}function mr(t){if(t instanceof IDBRequest)return SM(t);if(Vp.has(t))return Vp.get(t);const e=RM(t);return e!==t&&(Vp.set(t,e),j_.set(e,t)),e}const qp=t=>j_.get(t);function rc(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),a=mr(o);return s&&o.addEventListener("upgradeneeded",c=>{s(mr(o.result),c.oldVersion,c.newVersion,mr(o.transaction))}),n&&o.addEventListener("blocked",()=>n()),a.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",()=>r())}).catch(()=>{}),a}function ma(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",()=>e()),mr(n).then(()=>{})}const xM=["get","getKey","getAll","getAllKeys","count"],NM=["put","add","delete","clear"],jp=new Map;function Sb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(jp.get(e))return jp.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=NM.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||xM.includes(n)))return;const i=async function(o,...a){const c=this.transaction(o,r?"readwrite":"readonly");let l=c.store;return s&&(l=l.index(a.shift())),(await Promise.all([l[n](...a),r&&c.done]))[0]};return jp.set(e,i),i}kM(t=>ih(rh({},t),{get:(e,n,s)=>Sb(e,n)||t.get(e,n,s),has:(e,n)=>!!Sb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DM(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function DM(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nm="@firebase/app",Cb="0.7.26";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K_=new rr("@firebase/app"),OM="@firebase/app-compat",MM="@firebase/analytics-compat",LM="@firebase/analytics",FM="@firebase/app-check-compat",$M="@firebase/app-check",UM="@firebase/auth",BM="@firebase/auth-compat",VM="@firebase/database",qM="@firebase/database-compat",jM="@firebase/functions",KM="@firebase/functions-compat",HM="@firebase/installations",WM="@firebase/installations-compat",zM="@firebase/messaging",GM="@firebase/messaging-compat",QM="@firebase/performance",YM="@firebase/performance-compat",XM="@firebase/remote-config",JM="@firebase/remote-config-compat",ZM="@firebase/storage",eL="@firebase/storage-compat",tL="@firebase/firestore",nL="@firebase/firestore-compat",sL="firebase",rL="9.8.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="[DEFAULT]",iL={[nm]:"fire-core",[OM]:"fire-core-compat",[LM]:"fire-analytics",[MM]:"fire-analytics-compat",[$M]:"fire-app-check",[FM]:"fire-app-check-compat",[UM]:"fire-auth",[BM]:"fire-auth-compat",[VM]:"fire-rtdb",[qM]:"fire-rtdb-compat",[jM]:"fire-fn",[KM]:"fire-fn-compat",[HM]:"fire-iid",[WM]:"fire-iid-compat",[zM]:"fire-fcm",[GM]:"fire-fcm-compat",[QM]:"fire-perf",[YM]:"fire-perf-compat",[XM]:"fire-rc",[JM]:"fire-rc-compat",[ZM]:"fire-gcs",[eL]:"fire-gcs-compat",[tL]:"fire-fst",[nL]:"fire-fst-compat","fire-js":"fire-js",[sL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=new Map,Pl=new Map;function td(t,e){try{t.container.addComponent(e)}catch(n){K_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function IS(t,e){t.container.addOrOverwriteComponent(e)}function st(t){const e=t.name;if(Pl.has(e))return K_.debug(`There were multiple attempts to register component ${e}.`),!1;Pl.set(e,t);for(const n of hi.values())td(n,t);return!0}function ds(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function oL(t,e,n=go){ds(t,e).clearInstance(n)}function aL(){Pl.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cL={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}."},di=new En("app","Firebase",cL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Te("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw di.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ir=rL;function H_(t,e={}){typeof e!="object"&&(e={name:e});const n=Object.assign({name:go,automaticDataCollectionEnabled:!1},e),s=n.name;if(typeof s!="string"||!s)throw di.create("bad-app-name",{appName:String(s)});const r=hi.get(s);if(r){if(Nl(t,r.options)&&Nl(n,r.config))return r;throw di.create("duplicate-app",{appName:s})}const i=new yS(s);for(const a of Pl.values())i.addComponent(a);const o=new lL(t,n,i);return hi.set(s,o),o}function bu(t=go){const e=hi.get(t);if(!e)throw di.create("no-app",{appName:t});return e}function uL(){return Array.from(hi.values())}async function ES(t){const e=t.name;hi.has(e)&&(hi.delete(e),await Promise.all(t.container.getProviders().map(n=>n.delete())),t.isDeleted=!0)}function Ae(t,e,n){var s;let r=(s=iL[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${r}" with version "${e}":`];i&&a.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),K_.warn(a.join(" "));return}st(new Te(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}function TS(t,e){if(t!==null&&typeof t!="function")throw di.create("invalid-log-argument");bM(t,e)}function SS(t){wM(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hL="firebase-heartbeat-database",dL=1,Dl="firebase-heartbeat-store";let Kp=null;function CS(){return Kp||(Kp=rc(hL,dL,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Dl)}}}).catch(t=>{throw di.create("storage-open",{originalErrorMessage:t.message})})),Kp}async function fL(t){var e;try{return(await CS()).transaction(Dl).objectStore(Dl).get(kS(t))}catch(n){throw di.create("storage-get",{originalErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}async function kb(t,e){var n;try{const r=(await CS()).transaction(Dl,"readwrite");return await r.objectStore(Dl).put(e,kS(t)),r.done}catch(s){throw di.create("storage-set",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message})}}function kS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pL=1024,gL=30*24*60*60*1e3;class mL{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new yL(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Ab();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(r=>r.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(r=>{const i=new Date(r.date).valueOf();return Date.now()-i<=gL}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Ab(),{heartbeatsToSend:n,unsentEntries:s}=_L(this._heartbeatsCache.heartbeats),r=Xh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function Ab(){return new Date().toISOString().substring(0,10)}function _L(t,e=pL){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Rb(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Rb(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class yL{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Mn()?wu().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await fL(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return kb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Rb(t){return Xh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(t){st(new Te("platform-logger",e=>new PM(e),"PRIVATE")),st(new Te("heartbeat",e=>new mL(e),"PRIVATE")),Ae(nm,Cb,t),Ae(nm,Cb,"esm2017"),Ae("fire-js","")}vL("");var wL=Object.freeze(Object.defineProperty({__proto__:null,SDK_VERSION:ir,_DEFAULT_ENTRY_NAME:go,_addComponent:td,_addOrOverwriteComponent:IS,_apps:hi,_clearComponents:aL,_components:Pl,_getProvider:ds,_registerComponent:st,_removeServiceInstance:oL,deleteApp:ES,getApp:bu,getApps:uL,initializeApp:H_,onLog:TS,registerVersion:Ae,setLogLevel:SS,FirebaseError:lt},Symbol.toStringTag,{value:"Module"}));function W_(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}const Ac={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},Jo={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bL(){return{["admin-restricted-operation"]:"This operation is restricted to administrators only.",["argument-error"]:"",["app-not-authorized"]:"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.",["app-not-installed"]:"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.",["captcha-check-failed"]:"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.",["code-expired"]:"The SMS code has expired. Please re-send the verification code to try again.",["cordova-not-ready"]:"Cordova framework is not ready.",["cors-unsupported"]:"This browser is not supported.",["credential-already-in-use"]:"This credential is already associated with a different user account.",["custom-token-mismatch"]:"The custom token corresponds to a different audience.",["requires-recent-login"]:"This operation is sensitive and requires recent authentication. Log in again before retrying this request.",["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.",["dynamic-link-not-activated"]:"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.",["email-change-needs-verification"]:"Multi-factor users must always have a verified email.",["email-already-in-use"]:"The email address is already in use by another account.",["emulator-config-failed"]:'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',["expired-action-code"]:"The action code has expired.",["cancelled-popup-request"]:"This operation has been cancelled due to another conflicting popup being opened.",["internal-error"]:"An internal AuthError has occurred.",["invalid-app-credential"]:"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.",["invalid-app-id"]:"The mobile app identifier is not registed for the current project.",["invalid-user-token"]:"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.",["invalid-auth-event"]:"An internal AuthError has occurred.",["invalid-verification-code"]:"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.",["invalid-continue-uri"]:"The continue URL provided in the request is invalid.",["invalid-cordova-configuration"]:"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.",["invalid-custom-token"]:"The custom token format is incorrect. Please check the documentation.",["invalid-dynamic-link-domain"]:"The provided dynamic link domain is not configured or authorized for the current project.",["invalid-email"]:"The email address is badly formatted.",["invalid-emulator-scheme"]:"Emulator URL must start with a valid scheme (http:// or https://).",["invalid-api-key"]:"Your API key is invalid, please check you have copied it correctly.",["invalid-cert-hash"]:"The SHA-1 certificate hash provided is invalid.",["invalid-credential"]:"The supplied auth credential is malformed or has expired.",["invalid-message-payload"]:"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-multi-factor-session"]:"The request does not contain a valid proof of first factor successful sign-in.",["invalid-oauth-provider"]:"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.",["invalid-oauth-client-id"]:"The OAuth client ID provided is either invalid or does not match the specified API key.",["unauthorized-domain"]:"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.",["invalid-action-code"]:"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.",["wrong-password"]:"The password is invalid or the user does not have a password.",["invalid-persistence-type"]:"The specified persistence type is invalid. It can only be local, session or none.",["invalid-phone-number"]:"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].",["invalid-provider-id"]:"The specified provider ID is invalid.",["invalid-recipient-email"]:"The email corresponding to this action failed to send as the provided recipient email address is invalid.",["invalid-sender"]:"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.",["invalid-verification-id"]:"The verification ID used to create the phone auth credential is invalid.",["invalid-tenant-id"]:"The Auth instance's tenant ID is invalid.",["login-blocked"]:"Login blocked by user-provided method: {$originalMessage}",["missing-android-pkg-name"]:"An Android Package Name must be provided if the Android App is required to be installed.",["auth-domain-config-required"]:"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.",["missing-app-credential"]:"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.",["missing-verification-code"]:"The phone auth credential was created with an empty SMS verification code.",["missing-continue-uri"]:"A continue URL must be provided in the request.",["missing-iframe-start"]:"An internal AuthError has occurred.",["missing-ios-bundle-id"]:"An iOS Bundle ID must be provided if an App Store ID is provided.",["missing-or-invalid-nonce"]:"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.",["missing-multi-factor-info"]:"No second factor identifier is provided.",["missing-multi-factor-session"]:"The request is missing proof of first factor successful sign-in.",["missing-phone-number"]:"To send verification codes, provide a phone number for the recipient.",["missing-verification-id"]:"The phone auth credential was created with an empty verification ID.",["app-deleted"]:"This instance of FirebaseApp has been deleted.",["multi-factor-info-not-found"]:"The user does not have a second factor matching the identifier provided.",["multi-factor-auth-required"]:"Proof of ownership of a second factor is required to complete sign-in.",["account-exists-with-different-credential"]:"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.",["network-request-failed"]:"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.",["no-auth-event"]:"An internal AuthError has occurred.",["no-such-provider"]:"User was not linked to an account with the given provider.",["null-user"]:"A null user object was provided as the argument for an operation which requires a non-null user object.",["operation-not-allowed"]:"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.",["operation-not-supported-in-this-environment"]:'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',["popup-blocked"]:"Unable to establish a connection with the popup. It may have been blocked by the browser.",["popup-closed-by-user"]:"The popup has been closed by the user before finalizing the operation.",["provider-already-linked"]:"User can only be linked to one identity for the given provider.",["quota-exceeded"]:"The project's quota for this operation has been exceeded.",["redirect-cancelled-by-user"]:"The redirect operation has been cancelled by the user before finalizing.",["redirect-operation-pending"]:"A redirect sign-in operation is already pending.",["rejected-credential"]:"The request contains malformed or mismatching credentials.",["second-factor-already-in-use"]:"The second factor is already enrolled on this account.",["maximum-second-factor-count-exceeded"]:"The maximum allowed number of second factors on a user has been exceeded.",["tenant-id-mismatch"]:"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.",["user-token-expired"]:"The user's credential is no longer valid. The user must sign in again.",["too-many-requests"]:"We have blocked all requests from this device due to unusual activity. Try again later.",["unauthorized-continue-uri"]:"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.",["unsupported-first-factor"]:"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.",["unsupported-persistence-type"]:"The current environment does not support the specified persistence type.",["unsupported-tenant-operation"]:"This operation is not supported in a multi-tenant context.",["unverified-email"]:"The operation requires a verified email.",["user-cancelled"]:"The user did not grant your application the permissions it requested.",["user-not-found"]:"There is no user record corresponding to this identifier. The user may have been deleted.",["user-disabled"]:"The user account has been disabled by an administrator.",["user-mismatch"]:"The supplied credentials do not correspond to the previously signed in user.",["user-signed-out"]:"",["weak-password"]:"The password must be 6 characters long or more.",["web-storage-unsupported"]:"This browser is not supported or 3rd party cookies and data may be disabled.",["already-initialized"]:"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}}function AS(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const IL=bL,EL=AS,RS=new En("auth","Firebase",AS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xb=new rr("@firebase/auth");function Oh(t,...e){xb.logLevel<=pe.ERROR&&xb.error(`Auth (${ir}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lt(t,...e){throw z_(t,...e)}function Yt(t,...e){return z_(t,...e)}function xS(t,e,n){const s=Object.assign(Object.assign({},EL()),{[e]:n});return new En("auth","Firebase",s).create(e,{appName:t.name})}function ic(t,e,n){const s=n;if(!(e instanceof s))throw s.name!==e.constructor.name&&Lt(t,"argument-error"),xS(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function z_(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return RS.create(t,...e)}function D(t,e,...n){if(!t)throw z_(e,...n)}function Bs(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Oh(e),new Error(e)}function Ss(t,e){t||Bs(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb=new Map;function Hn(t){Ss(t instanceof Function,"Expected a class definition");let e=Nb.get(t);return e?(Ss(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Nb.set(t,e),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TL(t,e){const n=ds(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(Nl(i,e!=null?e:{}))return r;Lt(r,"already-initialized")}return n.initialize({options:e})}function SL(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(Hn);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ol(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function G_(){return Pb()==="http:"||Pb()==="https:"}function Pb(){var t;return typeof self!="undefined"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CL(){return typeof navigator!="undefined"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(G_()||yu()||"connection"in navigator)?navigator.onLine:!0}function kL(){if(typeof navigator=="undefined")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ss(n>e,"Short delay should be less than long delay!"),this.isMobile=df()||vu()}get(){return CL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q_(t,e){Ss(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NS{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self!="undefined"&&"fetch"in self)return self.fetch;Bs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self!="undefined"&&"Headers"in self)return self.Headers;Bs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self!="undefined"&&"Response"in self)return self.Response;Bs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=new Iu(3e4,6e4);function St(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function qt(t,e,n,s,r={}){return PS(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const a=Uo(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),NS.fetch()(DS(t,t.config.apiHost,n,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},i))})}async function PS(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},AL),e);try{const r=new xL(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw zc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[c,l]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw zc(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw zc(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw zc(t,"user-disabled",o);const u=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw xS(t,u,l);Lt(t,u)}}catch(r){if(r instanceof lt)throw r;Lt(t,"network-request-failed")}}async function xr(t,e,n,s,r={}){const i=await qt(t,e,n,s,r);return"mfaPendingCredential"in i&&Lt(t,"multi-factor-auth-required",{_serverResponse:i}),i}function DS(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?Q_(t.config,r):`${t.config.apiScheme}://${r}`}class xL{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(Yt(this.auth,"network-request-failed")),RL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function zc(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=Yt(t,e,s);return r.customData._tokenResponse=n,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NL(t,e){return qt(t,"POST","/v1/accounts:delete",e)}async function PL(t,e){return qt(t,"POST","/v1/accounts:update",e)}async function DL(t,e){return qt(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sl(t){if(!!t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function OL(t,e=!1){const n=A(t),s=await n.getIdToken(e),r=gf(s);D(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:sl(Hp(r.auth_time)),issuedAtTime:sl(Hp(r.iat)),expirationTime:sl(Hp(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Hp(t){return Number(t)*1e3}function gf(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return Oh("JWT malformed, contained fewer than 3 sections"),null;try{const r=Zg(n);return r?JSON.parse(r):(Oh("Failed to decode base64 JWT payload"),null)}catch(r){return Oh("Caught error parsing JWT payload as JSON",r),null}}function ML(t){const e=gf(t);return D(e,"internal-error"),D(typeof e.exp!="undefined","internal-error"),D(typeof e.iat!="undefined","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Tr(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof lt&&LL(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function LL({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FL{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sl(this.lastLoginAt),this.creationTime=sl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ml(t){var e;const n=t.auth,s=await t.getIdToken(),r=await Tr(t,DL(n,{idToken:s}));D(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?BL(i.providerUserInfo):[],a=UL(t.providerData,o),c=t.isAnonymous,l=!(t.email&&i.passwordHash)&&!(a!=null&&a.length),u=c?l:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new OS(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(t,h)}async function $L(t){const e=A(t);await Ml(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UL(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function BL(t){return t.map(e=>{var{providerId:n}=e,s=W_(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function VL(t,e){const n=await PS(t,{},async()=>{const s=Uo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=DS(t,r,"/v1/token",`key=${i}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",NS.fetch()(o,{method:"POST",headers:a,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){D(e.idToken,"internal-error"),D(typeof e.idToken!="undefined","internal-error"),D(typeof e.refreshToken!="undefined","internal-error");const n="expiresIn"in e&&typeof e.expiresIn!="undefined"?Number(e.expiresIn):ML(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}async getToken(e,n=!1){return D(!this.accessToken||this.refreshToken,e,"user-token-expired"),!n&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await VL(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Ll;return s&&(D(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(D(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(D(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ll,this.toJSON())}_performRefresh(){return Bs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(t,e){D(typeof t=="string"||typeof t=="undefined","internal-error",{appName:e})}class co{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=W_(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new FL(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new OS(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Tr(this,this.stsTokenManager.getToken(this.auth,e));return D(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return OL(this,e)}reload(){return $L(this)}_assign(e){this!==e&&(D(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new co(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){D(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Ml(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await Tr(this,NL(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,a,c,l,u;const h=(s=n.displayName)!==null&&s!==void 0?s:void 0,d=(r=n.email)!==null&&r!==void 0?r:void 0,f=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,p=(o=n.photoURL)!==null&&o!==void 0?o:void 0,_=(a=n.tenantId)!==null&&a!==void 0?a:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,b=(l=n.createdAt)!==null&&l!==void 0?l:void 0,N=(u=n.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:T,emailVerified:$,isAnonymous:z,providerData:te,stsTokenManager:J}=n;D(T&&J,e,"internal-error");const ae=Ll.fromJSON(this.name,J);D(typeof T=="string",e,"internal-error"),Ur(h,e.name),Ur(d,e.name),D(typeof $=="boolean",e,"internal-error"),D(typeof z=="boolean",e,"internal-error"),Ur(f,e.name),Ur(p,e.name),Ur(_,e.name),Ur(v,e.name),Ur(b,e.name),Ur(N,e.name);const Ne=new co({uid:T,auth:e,email:d,emailVerified:$,displayName:h,isAnonymous:z,photoURL:p,phoneNumber:f,tenantId:_,stsTokenManager:ae,createdAt:b,lastLoginAt:N});return te&&Array.isArray(te)&&(Ne.providerData=te.map(tn=>Object.assign({},tn))),v&&(Ne._redirectEventId=v),Ne}static async _fromIdTokenResponse(e,n,s=!1){const r=new Ll;r.updateFromServerResponse(n);const i=new co({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Ml(i),i}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}MS.type="NONE";const Pa=MS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lo(t,e,n){return`firebase:${t}:${e}:${n}`}class _a{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=lo(this.userKey,r.apiKey,i),this.fullPersistenceKey=lo("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?co._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new _a(Hn(Pa),e,s);const r=(await Promise.all(n.map(async l=>{if(await l._isAvailable())return l}))).filter(l=>l);let i=r[0]||Hn(Pa);const o=lo(s,e.config.apiKey,e.name);let a=null;for(const l of n)try{const u=await l._get(o);if(u){const h=co._fromJSON(e,u);l!==i&&(a=h),i=l;break}}catch{}const c=r.filter(l=>l._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new _a(i,e,s):(i=c[0],a&&await i._set(o,a.toJSON()),await Promise.all(n.map(async l=>{if(l!==i)try{await l._remove(o)}catch{}})),new _a(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Db(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($S(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(LS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(US(e))return"Blackberry";if(BS(e))return"Webos";if(Y_(e))return"Safari";if((e.includes("chrome/")||FS(e))&&!e.includes("edge/"))return"Chrome";if(Eu(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function LS(t=Ge()){return/firefox\//i.test(t)}function Y_(t=Ge()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function FS(t=Ge()){return/crios\//i.test(t)}function $S(t=Ge()){return/iemobile/i.test(t)}function Eu(t=Ge()){return/android/i.test(t)}function US(t=Ge()){return/blackberry/i.test(t)}function BS(t=Ge()){return/webos/i.test(t)}function oc(t=Ge()){return/iphone|ipad|ipod/i.test(t)}function qL(t=Ge()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function jL(t=Ge()){var e;return oc(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KL(){return B_()&&document.documentMode===10}function VS(t=Ge()){return oc(t)||Eu(t)||BS(t)||US(t)||/windows phone/i.test(t)||$S(t)}function HL(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(t,e=[]){let n;switch(t){case"Browser":n=Db(Ge());break;case"Worker":n=`${Db(Ge())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ir}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WL{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,a)=>{try{const c=e(i);o(c)}catch(c){a(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var n;if(this.auth.currentUser===e)return;const s=[];try{for(const r of this.queue)await r(e),r.onAbort&&s.push(r.onAbort)}catch(r){s.reverse();for(const i of s)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:(n=r)===null||n===void 0?void 0:n.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zL{constructor(e,n,s){this.app=e,this.heartbeatServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ob(this),this.idTokenSubscription=new Ob(this),this.beforeStateQueue=new WL(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=RS,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Hn(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await _a.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var n;const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&(c==null?void 0:c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return D(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Ml(e)}catch(n){if(n.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=kL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const n=e?A(e):null;return n&&D(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&D(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Hn(e))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new En("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Hn(e)||this._popupRedirectResolver;D(n,this,"argument-error"),this.redirectPersistenceManager=await _a.create(this,[Hn(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n),o=this._isInitialized?Promise.resolve():this._initializationPromise;return D(o,this,"internal-error"),o.then(()=>i(this.currentUser)),typeof n=="function"?e.addObserver(n,s,r):e.addObserver(n)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return D(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=qS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={["X-Client-Version"]:this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());return s&&(n["X-Firebase-Client"]=s),n}}function Ft(t){return A(t)}class Ob{constructor(e){this.auth=e,this.observer=null,this.addObserver=mS(n=>this.observer=n)}get next(){return D(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function GL(t,e,n){const s=Ft(t);D(s._canInitEmulator,s,"emulator-config-failed"),D(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!!(n!=null&&n.disableWarnings),i=jS(e),{host:o,port:a}=QL(e),c=a===null?"":`:${a}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||YL()}function jS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function QL(t){const e=jS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:Mb(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:Mb(o)}}}function Mb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function YL(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console!="undefined"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window!="undefined"&&typeof document!="undefined"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Bs("not implemented")}_getIdTokenResponse(e){return Bs("not implemented")}_linkToIdToken(e,n){return Bs("not implemented")}_getReauthenticationResolver(e){return Bs("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function KS(t,e){return qt(t,"POST","/v1/accounts:resetPassword",St(t,e))}async function HS(t,e){return qt(t,"POST","/v1/accounts:update",e)}async function XL(t,e){return qt(t,"POST","/v1/accounts:update",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JL(t,e){return xr(t,"POST","/v1/accounts:signInWithPassword",St(t,e))}async function mf(t,e){return qt(t,"POST","/v1/accounts:sendOobCode",St(t,e))}async function ZL(t,e){return mf(t,e)}async function e2(t,e){return mf(t,e)}async function t2(t,e){return mf(t,e)}async function n2(t,e){return mf(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s2(t,e){return xr(t,"POST","/v1/accounts:signInWithEmailLink",St(t,e))}async function r2(t,e){return xr(t,"POST","/v1/accounts:signInWithEmailLink",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl extends ac{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new Fl(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new Fl(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if((n==null?void 0:n.email)&&(n==null?void 0:n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return JL(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return s2(e,{email:this._email,oobCode:this._password});default:Lt(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":return HS(e,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return r2(e,{idToken:n,email:this._email,oobCode:this._password});default:Lt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _r(t,e){return xr(t,"POST","/v1/accounts:signInWithIdp",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i2="http://localhost";class Xs extends ac{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Xs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Lt("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=W_(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Xs(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return _r(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,_r(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,_r(e,n)}buildRequest(){const e={requestUri:i2,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Uo(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o2(t,e){return qt(t,"POST","/v1/accounts:sendVerificationCode",St(t,e))}async function a2(t,e){return xr(t,"POST","/v1/accounts:signInWithPhoneNumber",St(t,e))}async function c2(t,e){const n=await xr(t,"POST","/v1/accounts:signInWithPhoneNumber",St(t,e));if(n.temporaryProof)throw zc(t,"account-exists-with-different-credential",n);return n}const l2={USER_NOT_FOUND:"user-not-found"};async function u2(t,e){const n=Object.assign(Object.assign({},e),{operation:"REAUTH"});return xr(t,"POST","/v1/accounts:signInWithPhoneNumber",St(t,n),l2)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo extends ac{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,n){return new uo({verificationId:e,verificationCode:n})}static _fromTokenResponse(e,n){return new uo({phoneNumber:e,temporaryProof:n})}_getIdTokenResponse(e){return a2(e,this._makeVerificationRequest())}_linkToIdToken(e,n){return c2(e,Object.assign({idToken:n},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return u2(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:n,verificationId:s,verificationCode:r}=this.params;return e&&n?{temporaryProof:e,phoneNumber:n}:{sessionInfo:s,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));const{verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i}=e;return!s&&!n&&!r&&!i?null:new uo({verificationId:n,verificationCode:s,phoneNumber:r,temporaryProof:i})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h2(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function d2(t){const e=ha(Wc(t)).link,n=e?ha(Wc(e)).deep_link_id:null,s=ha(Wc(t)).deep_link_id;return(s?ha(Wc(s)).link:null)||s||n||e||t}class _f{constructor(e){var n,s,r,i,o,a;const c=ha(Wc(e)),l=(n=c.apiKey)!==null&&n!==void 0?n:null,u=(s=c.oobCode)!==null&&s!==void 0?s:null,h=h2((r=c.mode)!==null&&r!==void 0?r:null);D(l&&u&&h,"argument-error"),this.apiKey=l,this.operation=h,this.code=u,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=d2(e);try{return new _f(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Si{constructor(){this.providerId=Si.PROVIDER_ID}static credential(e,n){return Fl._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=_f.parseLink(n);return D(s,"argument-error"),Fl._fromEmailAndCode(e,s.code,s.tenantId)}}Si.PROVIDER_ID="password";Si.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Si.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends Nr{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class ya extends cc{static credentialFromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;return D("providerId"in n&&"signInMethod"in n,"argument-error"),Xs._fromParams(n)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return D(e.idToken||e.accessToken,"argument-error"),Xs._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return ya.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return ya.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s,oauthTokenSecret:r,pendingToken:i,nonce:o,providerId:a}=e;if(!s&&!r&&!n&&!i||!a)return null;try{return new ya(a)._credential({idToken:n,accessToken:s,nonce:o,pendingToken:i})}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn extends cc{constructor(){super("facebook.com")}static credential(e){return Xs._fromParams({providerId:qn.PROVIDER_ID,signInMethod:qn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qn.credentialFromTaggedObject(e)}static credentialFromError(e){return qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return qn.credential(e.oauthAccessToken)}catch{return null}}}qn.FACEBOOK_SIGN_IN_METHOD="facebook.com";qn.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn extends cc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Xs._fromParams({providerId:jn.PROVIDER_ID,signInMethod:jn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return jn.credentialFromTaggedObject(e)}static credentialFromError(e){return jn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return jn.credential(n,s)}catch{return null}}}jn.GOOGLE_SIGN_IN_METHOD="google.com";jn.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fs extends cc{constructor(){super("github.com")}static credential(e){return Xs._fromParams({providerId:Fs.PROVIDER_ID,signInMethod:Fs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fs.credentialFromTaggedObject(e)}static credentialFromError(e){return Fs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fs.credential(e.oauthAccessToken)}catch{return null}}}Fs.GITHUB_SIGN_IN_METHOD="github.com";Fs.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f2="http://localhost";class Da extends ac{constructor(e,n){super(e,e),this.pendingToken=n}_getIdTokenResponse(e){const n=this.buildRequest();return _r(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,_r(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,_r(e,n)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r,pendingToken:i}=n;return!s||!r||!i||s!==r?null:new Da(s,i)}static _create(e,n){return new Da(e,n)}buildRequest(){return{requestUri:f2,returnSecureToken:!0,pendingToken:this.pendingToken}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p2="saml.";class nd extends Nr{constructor(e){D(e.startsWith(p2),"argument-error"),super(e)}static credentialFromResult(e){return nd.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return nd.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const n=Da.fromJSON(e);return D(n,"argument-error"),n}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:n,providerId:s}=e;if(!n||!s)return null;try{return Da._create(s,n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $s extends cc{constructor(){super("twitter.com")}static credential(e,n){return Xs._fromParams({providerId:$s.PROVIDER_ID,signInMethod:$s.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return $s.credentialFromTaggedObject(e)}static credentialFromError(e){return $s.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return $s.credential(n,s)}catch{return null}}}$s.TWITTER_SIGN_IN_METHOD="twitter.com";$s.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WS(t,e){return xr(t,"POST","/v1/accounts:signUp",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await co._fromIdTokenResponse(e,s,r),o=Lb(s);return new ls({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=Lb(s);return new ls({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function Lb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function g2(t){var e;const n=Ft(t);if(await n._initializationPromise,!((e=n.currentUser)===null||e===void 0)&&e.isAnonymous)return new ls({user:n.currentUser,providerId:null,operationType:"signIn"});const s=await WS(n,{returnSecureToken:!0}),r=await ls._fromIdTokenResponse(n,"signIn",s,!0);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd extends lt{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,sd.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new sd(e,n,s,r)}}function zS(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?sd._fromErrorAndOperation(t,i,e,s):i})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t){return new Set(t.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2(t,e){const n=A(t);await yf(!0,n,e);const{providerUserInfo:s}=await PL(n.auth,{idToken:await n.getIdToken(),deleteProvider:[e]}),r=GS(s||[]);return n.providerData=n.providerData.filter(i=>r.has(i.providerId)),r.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function X_(t,e,n=!1){const s=await Tr(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ls._forOperation(t,"link",s)}async function yf(t,e,n){await Ml(e);const s=GS(e.providerData),r=t===!1?"provider-already-linked":"no-such-provider";D(s.has(n)===t,e.auth,r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QS(t,e,n=!1){const{auth:s}=t,r="reauthenticate";try{const i=await Tr(t,zS(s,r,e,t),n);D(i.idToken,s,"internal-error");const o=gf(i.idToken);D(o,s,"internal-error");const{sub:a}=o;return D(t.uid===a,s,"user-mismatch"),ls._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Lt(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YS(t,e,n=!1){const s="signIn",r=await zS(t,s,e),i=await ls._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function vf(t,e){return YS(Ft(t),e)}async function XS(t,e){const n=A(t);return await yf(!1,n,e.providerId),X_(n,e)}async function JS(t,e){return QS(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _2(t,e){return xr(t,"POST","/v1/accounts:signInWithCustomToken",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y2(t,e){const n=Ft(t),s=await _2(n,{token:e,returnSecureToken:!0}),r=await ls._fromIdTokenResponse(n,"signIn",s);return await n._updateCurrentUser(r.user),r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wf{constructor(e,n){this.factorId=e,this.uid=n.mfaEnrollmentId,this.enrollmentTime=new Date(n.enrolledAt).toUTCString(),this.displayName=n.displayName}static _fromServerResponse(e,n){return"phoneInfo"in n?J_._fromServerResponse(e,n):Lt(e,"internal-error")}}class J_ extends wf{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,n){return new J_(n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bf(t,e,n){var s;D(((s=n.url)===null||s===void 0?void 0:s.length)>0,t,"invalid-continue-uri"),D(typeof n.dynamicLinkDomain=="undefined"||n.dynamicLinkDomain.length>0,t,"invalid-dynamic-link-domain"),e.continueUrl=n.url,e.dynamicLinkDomain=n.dynamicLinkDomain,e.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(D(n.iOS.bundleId.length>0,t,"missing-ios-bundle-id"),e.iOSBundleId=n.iOS.bundleId),n.android&&(D(n.android.packageName.length>0,t,"missing-android-pkg-name"),e.androidInstallApp=n.android.installApp,e.androidMinimumVersionCode=n.android.minimumVersion,e.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2(t,e,n){const s=A(t),r={requestType:"PASSWORD_RESET",email:e};n&&bf(s,r,n),await e2(s,r)}async function w2(t,e,n){await KS(A(t),{oobCode:e,newPassword:n})}async function b2(t,e){await XL(A(t),{oobCode:e})}async function ZS(t,e){const n=A(t),s=await KS(n,{oobCode:e}),r=s.requestType;switch(D(r,n,"internal-error"),r){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":D(s.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":D(s.mfaInfo,n,"internal-error");default:D(s.email,n,"internal-error")}let i=null;return s.mfaInfo&&(i=wf._fromServerResponse(Ft(n),s.mfaInfo)),{data:{email:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.newEmail:s.email)||null,previousEmail:(s.requestType==="VERIFY_AND_CHANGE_EMAIL"?s.email:s.newEmail)||null,multiFactorInfo:i},operation:r}}async function I2(t,e){const{data:n}=await ZS(A(t),e);return n.email}async function eC(t,e,n){const s=Ft(t),r=await WS(s,{returnSecureToken:!0,email:e,password:n}),i=await ls._fromIdTokenResponse(s,"signIn",r);return await s._updateCurrentUser(i.user),i}function tC(t,e,n){return vf(A(t),Si.credential(e,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E2(t,e,n){const s=A(t),r={requestType:"EMAIL_SIGNIN",email:e};D(n.handleCodeInApp,s,"argument-error"),n&&bf(s,r,n),await t2(s,r)}function T2(t,e){const n=_f.parseLink(e);return(n==null?void 0:n.operation)==="EMAIL_SIGNIN"}async function S2(t,e,n){const s=A(t),r=Si.credentialWithLink(e,n||Ol());return D(r._tenantId===(s.tenantId||null),s,"tenant-id-mismatch"),vf(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C2(t,e){return qt(t,"POST","/v1/accounts:createAuthUri",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k2(t,e){const n=G_()?Ol():"http://localhost",s={identifier:e,continueUri:n},{signinMethods:r}=await C2(A(t),s);return r||[]}async function A2(t,e){const n=A(t),s=await t.getIdToken(),r={requestType:"VERIFY_EMAIL",idToken:s};e&&bf(n.auth,r,e);const{email:i}=await ZL(n.auth,r);i!==t.email&&await t.reload()}async function R2(t,e,n){const s=A(t),r=await t.getIdToken(),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:r,newEmail:e};n&&bf(s.auth,i,n);const{email:o}=await n2(s.auth,i);o!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x2(t,e){return qt(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N2(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=A(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Tr(s,x2(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const a=s.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=s.displayName,a.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}function P2(t,e){return nC(A(t),e,null)}function D2(t,e){return nC(A(t),null,e)}async function nC(t,e,n){const{auth:s}=t,i={idToken:await t.getIdToken(),returnSecureToken:!0};e&&(i.email=e),n&&(i.password=n);const o=await Tr(t,HS(s,i));await t._updateTokensIfNecessary(o,!0)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(t){var e,n;if(!t)return null;const{providerId:s}=t,r=t.rawUserInfo?JSON.parse(t.rawUserInfo):{},i=t.isNewUser||t.kind==="identitytoolkit#SignupNewUserResponse";if(!s&&(t==null?void 0:t.idToken)){const o=(n=(e=gf(t.idToken))===null||e===void 0?void 0:e.firebase)===null||n===void 0?void 0:n.sign_in_provider;if(o){const a=o!=="anonymous"&&o!=="custom"?o:null;return new va(i,a)}}if(!s)return null;switch(s){case"facebook.com":return new M2(i,r);case"github.com":return new L2(i,r);case"google.com":return new F2(i,r);case"twitter.com":return new $2(i,r,t.screenName||null);case"custom":case"anonymous":return new va(i,null);default:return new va(i,s,r)}}class va{constructor(e,n,s={}){this.isNewUser=e,this.providerId=n,this.profile=s}}class sC extends va{constructor(e,n,s,r){super(e,n,s),this.username=r}}class M2 extends va{constructor(e,n){super(e,"facebook.com",n)}}class L2 extends sC{constructor(e,n){super(e,"github.com",n,typeof(n==null?void 0:n.login)=="string"?n==null?void 0:n.login:null)}}class F2 extends va{constructor(e,n){super(e,"google.com",n)}}class $2 extends sC{constructor(e,n,s){super(e,"twitter.com",n,s)}}function U2(t){const{user:e,_tokenResponse:n}=t;return e.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:O2(n)}function rC(t,e,n,s){return A(t).onAuthStateChanged(e,n,s)}class Zi{constructor(e,n){this.type=e,this.credential=n}static _fromIdtoken(e){return new Zi("enroll",e)}static _fromMfaPendingCredential(e){return new Zi("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var n,s;if(e!=null&&e.multiFactorSession){if(!((n=e.multiFactorSession)===null||n===void 0)&&n.pendingCredential)return Zi._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((s=e.multiFactorSession)===null||s===void 0)&&s.idToken)return Zi._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{constructor(e,n,s){this.session=e,this.hints=n,this.signInResolver=s}static _fromError(e,n){const s=Ft(e),r=n.customData._serverResponse,i=(r.mfaInfo||[]).map(a=>wf._fromServerResponse(s,a));D(r.mfaPendingCredential,s,"internal-error");const o=Zi._fromMfaPendingCredential(r.mfaPendingCredential);return new Z_(o,i,async a=>{const c=await a._process(s,o);delete r.mfaInfo,delete r.mfaPendingCredential;const l=Object.assign(Object.assign({},r),{idToken:c.idToken,refreshToken:c.refreshToken});switch(n.operationType){case"signIn":const u=await ls._fromIdTokenResponse(s,n.operationType,l);return await s._updateCurrentUser(u.user),u;case"reauthenticate":return D(n.user,s,"internal-error"),ls._forOperation(n.user,n.operationType,l);default:Lt(s,"internal-error")}})}async resolveSignIn(e){const n=e;return this.signInResolver(n)}}function B2(t,e){var n;const s=A(t),r=e;return D(e.customData.operationType,s,"argument-error"),D((n=r.customData._serverResponse)===null||n===void 0?void 0:n.mfaPendingCredential,s,"argument-error"),Z_._fromError(s,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V2(t,e){return qt(t,"POST","/v2/accounts/mfaEnrollment:start",St(t,e))}function q2(t,e){return qt(t,"POST","/v2/accounts/mfaEnrollment:finalize",St(t,e))}function j2(t,e){return qt(t,"POST","/v2/accounts/mfaEnrollment:withdraw",St(t,e))}class ey{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(n=>{n.mfaInfo&&(this.enrolledFactors=n.mfaInfo.map(s=>wf._fromServerResponse(e.auth,s)))})}static _fromUser(e){return new ey(e)}async getSession(){return Zi._fromIdtoken(await this.user.getIdToken())}async enroll(e,n){const s=e,r=await this.getSession(),i=await Tr(this.user,s._process(this.user.auth,r,n));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const n=typeof e=="string"?e:e.uid,s=await this.user.getIdToken(),r=await Tr(this.user,j2(this.user.auth,{idToken:s,mfaEnrollmentId:n}));this.enrolledFactors=this.enrolledFactors.filter(({uid:i})=>i!==n),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(i){if(i.code!=="auth/user-token-expired")throw i}}}const Wp=new WeakMap;function K2(t){const e=A(t);return Wp.has(e)||Wp.set(e,ey._fromUser(e)),Wp.get(e)}const rd="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(rd,"1"),this.storage.removeItem(rd),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(){const t=Ge();return Y_(t)||oc(t)}const W2=1e3,z2=10;class oC extends iC{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=H2()&&HL(),this.fallbackToPolling=VS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const s=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(s);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(s,e.newValue):this.storage.removeItem(s);else if(this.localCache[s]===e.newValue&&!n)return}const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);KL()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,z2):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},W2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}oC.type="LOCAL";const If=oC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC extends iC{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}aC.type="SESSION";const fi=aC;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G2(t){return Promise.all(t.map(async e=>{try{const n=await e;return{fulfilled:!0,value:n}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Ef(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const a=Array.from(o).map(async l=>l(n.origin,i)),c=await G2(a);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ef.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tu(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel!="undefined"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((a,c)=>{const l=Tu("",20);r.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(h){const d=h;if(d.data.eventId===l)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:l,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(){return window}function Y2(t){vt().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(){return typeof vt().WorkerGlobalScope!="undefined"&&typeof vt().importScripts=="function"}async function X2(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function J2(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Z2(){return ty()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC="firebaseLocalStorageDb",eF=1,id="firebaseLocalStorage",lC="fbase_key";class Su{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Tf(t,e){return t.transaction([id],e?"readwrite":"readonly").objectStore(id)}function tF(){const t=indexedDB.deleteDatabase(cC);return new Su(t).toPromise()}function sm(){const t=indexedDB.open(cC,eF);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(id,{keyPath:lC})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(id)?e(s):(s.close(),await tF(),e(await sm()))})})}async function Fb(t,e,n){const s=Tf(t,!0).put({[lC]:e,value:n});return new Su(s).toPromise()}async function nF(t,e){const n=Tf(t,!1).get(e),s=await new Su(n).toPromise();return s===void 0?null:s.value}function $b(t,e){const n=Tf(t,!0).delete(e);return new Su(n).toPromise()}const sF=800,rF=3;class uC{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await sm(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>rF)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ty()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ef._getInstance(Z2()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await X2(),!this.activeServiceWorker)return;this.sender=new Q2(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);!s||((e=s[0])===null||e===void 0?void 0:e.fulfilled)&&((n=s[0])===null||n===void 0?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||J2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await sm();return await Fb(e,rd,"1"),await $b(e,rd),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>Fb(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>nF(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>$b(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Tf(r,!1).getAll();return new Su(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),sF)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}uC.type="LOCAL";const Oa=uC;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(t,e){return qt(t,"POST","/v2/accounts/mfaSignIn:start",St(t,e))}function oF(t,e){return qt(t,"POST","/v2/accounts/mfaSignIn:finalize",St(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aF(t){return(await qt(t,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}function hC(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=Yt("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",cF().appendChild(s)})}function dC(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lF=500,uF=6e4,hh=1e12;class hF{constructor(e){this.auth=e,this.counter=hh,this._widgets=new Map}render(e,n){const s=this.counter;return this._widgets.set(s,new dF(e,this.auth.name,n||{})),this.counter++,s}reset(e){var n;const s=e||hh;(n=this._widgets.get(s))===null||n===void 0||n.delete(),this._widgets.delete(s)}getResponse(e){var n;const s=e||hh;return((n=this._widgets.get(s))===null||n===void 0?void 0:n.getResponse())||""}async execute(e){var n;const s=e||hh;return(n=this._widgets.get(s))===null||n===void 0||n.execute(),""}}class dF{constructor(e,n,s){this.params=s,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r=typeof e=="string"?document.getElementById(e):e;D(r,"argument-error",{appName:n}),this.container=r,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=fF(50);const{callback:e,"expired-callback":n}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,n)try{n()}catch{}this.isVisible&&this.execute()},uF)},lF))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function fF(t){const e=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let s=0;s<t;s++)e.push(n.charAt(Math.floor(Math.random()*n.length)));return e.join("")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zp=dC("rcb"),pF=new Iu(3e4,6e4),gF="https://www.google.com/recaptcha/api.js?";class mF{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!vt().grecaptcha}load(e,n=""){return D(_F(n),e,"argument-error"),this.shouldResolveImmediately(n)?Promise.resolve(vt().grecaptcha):new Promise((s,r)=>{const i=vt().setTimeout(()=>{r(Yt(e,"network-request-failed"))},pF.get());vt()[zp]=()=>{vt().clearTimeout(i),delete vt()[zp];const a=vt().grecaptcha;if(!a){r(Yt(e,"internal-error"));return}const c=a.render;a.render=(l,u)=>{const h=c(l,u);return this.counter++,h},this.hostLanguage=n,s(a)};const o=`${gF}?${Uo({onload:zp,render:"explicit",hl:n})}`;hC(o).catch(()=>{clearTimeout(i),r(Yt(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!vt().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function _F(t){return t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t)}class yF{async load(e){return new hF(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="recaptcha",vF={theme:"light",type:"image"};class wF{constructor(e,n=Object.assign({},vF),s){this.parameters=n,this.type=fC,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ft(s),this.isInvisible=this.parameters.size==="invisible",D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment");const r=typeof e=="string"?document.getElementById(e):e;D(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new yF:new mF,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),n=this.getAssertedRecaptcha(),s=n.getResponse(e);return s||new Promise(r=>{const i=o=>{!o||(this.tokenChangeListeners.delete(i),r(o))};this.tokenChangeListeners.add(i),this.isInvisible&&n.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){D(!this.parameters.sitekey,this.auth,"argument-error"),D(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),D(typeof document!="undefined",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return n=>{if(this.tokenChangeListeners.forEach(s=>s(n)),typeof e=="function")e(n);else if(typeof e=="string"){const s=vt()[e];typeof s=="function"&&s(n)}}}assertNotDestroyed(){D(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const n=document.createElement("div");e.appendChild(n),e=n}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){D(G_()&&!ty(),this.auth,"internal-error"),await bF(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await aF(this.auth);D(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return D(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function bF(){let t=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}t=()=>e(),window.addEventListener("load",t)}).catch(e=>{throw t&&window.removeEventListener("load",t),e})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny{constructor(e,n){this.verificationId=e,this.onConfirmation=n}confirm(e){const n=uo._fromVerification(this.verificationId,e);return this.onConfirmation(n)}}async function IF(t,e,n){const s=Ft(t),r=await Sf(s,e,A(n));return new ny(r,i=>vf(s,i))}async function EF(t,e,n){const s=A(t);await yf(!1,s,"phone");const r=await Sf(s.auth,e,A(n));return new ny(r,i=>XS(s,i))}async function TF(t,e,n){const s=A(t),r=await Sf(s.auth,e,A(n));return new ny(r,i=>JS(s,i))}async function Sf(t,e,n){var s;const r=await n.verify();try{D(typeof r=="string",t,"argument-error"),D(n.type===fC,t,"argument-error");let i;if(typeof e=="string"?i={phoneNumber:e}:i=e,"session"in i){const o=i.session;if("phoneNumber"in i)return D(o.type==="enroll",t,"internal-error"),(await V2(t,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:i.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo;{D(o.type==="signin",t,"internal-error");const a=((s=i.multiFactorHint)===null||s===void 0?void 0:s.uid)||i.multiFactorUid;return D(a,t,"missing-multi-factor-info"),(await iF(t,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}else{const{sessionInfo:o}=await o2(t,{phoneNumber:i.phoneNumber,recaptchaToken:r});return o}}finally{n._reset()}}async function SF(t,e){await X_(A(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.providerId=Es.PROVIDER_ID,this.auth=Ft(e)}verifyPhoneNumber(e,n){return Sf(this.auth,e,A(n))}static credential(e,n){return uo._fromVerification(e,n)}static credentialFromResult(e){const n=e;return Es.credentialFromTaggedObject(n)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:n,temporaryProof:s}=e;return n&&s?uo._fromTokenResponse(n,s):null}}Es.PROVIDER_ID="phone";Es.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bo(t,e){return e?Hn(e):(D(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy extends ac{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _r(e,this._buildIdpRequest())}_linkToIdToken(e,n){return _r(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return _r(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function CF(t){return YS(t.auth,new sy(t),t.bypassAuthState)}function kF(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),QS(n,new sy(t),t.bypassAuthState)}async function AF(t){const{auth:e,user:n}=t;return D(n,e,"internal-error"),X_(n,new sy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return CF;case"linkViaPopup":case"linkViaRedirect":return AF;case"reauthViaPopup":case"reauthViaRedirect":return kF;default:Lt(this.auth,"internal-error")}}resolve(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ss(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RF=new Iu(2e3,1e4);async function rm(t,e,n){const s=Ft(t);ic(t,e,Nr);const r=Bo(s,n);return new dr(s,"signInViaPopup",e,r).executeNotNull()}async function xF(t,e,n){const s=A(t);ic(s.auth,e,Nr);const r=Bo(s.auth,n);return new dr(s.auth,"reauthViaPopup",e,r,s).executeNotNull()}async function NF(t,e,n){const s=A(t);ic(s.auth,e,Nr);const r=Bo(s.auth,n);return new dr(s.auth,"linkViaPopup",e,r,s).executeNotNull()}class dr extends pC{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,dr.currentPopupAction&&dr.currentPopupAction.cancel(),dr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return D(e,this.auth,"internal-error"),e}async onExecution(){Ss(this.filter.length===1,"Popup operations only handle one event");const e=Tu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Yt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Yt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,dr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Yt(this.auth,"popup-closed-by-user"))},2e3);return}this.pollId=window.setTimeout(e,RF.get())};e()}}dr.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF="pendingRedirect",rl=new Map;class DF extends pC{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=rl.get(this.auth._key());if(!e){try{const s=await OF(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}rl.set(this.auth._key(),e)}return this.bypassAuthState||rl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OF(t,e){const n=mC(e),s=gC(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}async function ry(t,e){return gC(t)._set(mC(e),"true")}function MF(){rl.clear()}function iy(t,e){rl.set(t._key(),e)}function gC(t){return Hn(t._redirectPersistence)}function mC(t){return lo(PF,t.config.apiKey,t.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LF(t,e,n){return FF(t,e,n)}async function FF(t,e,n){const s=Ft(t);ic(t,e,Nr);const r=Bo(s,n);return await ry(r,s),r._openRedirect(s,e,"signInViaRedirect")}function $F(t,e,n){return UF(t,e,n)}async function UF(t,e,n){const s=A(t);ic(s.auth,e,Nr);const r=Bo(s.auth,n);await ry(r,s.auth);const i=await _C(s);return r._openRedirect(s.auth,e,"reauthViaRedirect",i)}function BF(t,e,n){return VF(t,e,n)}async function VF(t,e,n){const s=A(t);ic(s.auth,e,Nr);const r=Bo(s.auth,n);await yf(!1,s,e.providerId),await ry(r,s.auth);const i=await _C(s);return r._openRedirect(s.auth,e,"linkViaRedirect",i)}async function qF(t,e){return await Ft(t)._initializationPromise,Cf(t,e,!1)}async function Cf(t,e,n=!1){const s=Ft(t),r=Bo(s,e),o=await new DF(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}async function _C(t){const e=Tu(`${t.uid}:::`);return t._redirectEventId=e,await t.auth._setRedirectUser(t),await t.auth._persistUserIfCurrent(t),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jF=10*60*1e3;class yC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KF(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!vC(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(Yt(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jF&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ub(e))}saveEventToCache(e){this.cachedEventUids.add(Ub(e)),this.lastProcessedEventTime=Date.now()}}function Ub(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vC({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KF(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vC(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wC(t,e={}){return qt(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HF=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WF=/^https?/;async function zF(t){if(t.config.emulator)return;const{authorizedDomains:e}=await wC(t);for(const n of e)try{if(GF(n))return}catch{}Lt(t,"unauthorized-domain")}function GF(t){const e=Ol(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!WF.test(n))return!1;if(HF.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QF=new Iu(3e4,6e4);function Bb(){const t=vt().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function YF(t){return new Promise((e,n)=>{var s,r,i;function o(){Bb(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Bb(),n(Yt(t,"network-request-failed"))},timeout:QF.get()})}if(!((r=(s=vt().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=vt().gapi)===null||i===void 0)&&i.load)o();else{const a=dC("iframefcb");return vt()[a]=()=>{gapi.load?o():n(Yt(t,"network-request-failed"))},hC(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>n(c))}}).catch(e=>{throw Mh=null,e})}let Mh=null;function XF(t){return Mh=Mh||YF(t),Mh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JF=new Iu(5e3,15e3),ZF="__/auth/iframe",e$="emulator/auth/iframe",t$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},n$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function s$(t){const e=t.config;D(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Q_(e,e$):`https://${t.config.authDomain}/${ZF}`,s={apiKey:e.apiKey,appName:t.name,v:ir},r=n$.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${Uo(s).slice(1)}`}async function r$(t){const e=await XF(t),n=vt().gapi;return D(n,t,"internal-error"),e.open({where:document.body,url:s$(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:t$,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=Yt(t,"network-request-failed"),a=vt().setTimeout(()=>{i(o)},JF.get());function c(){vt().clearTimeout(a),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},o$=500,a$=600,c$="_blank",l$="http://localhost";class Vb{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function u$(t,e,n,s=o$,r=a$){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let a="";const c=Object.assign(Object.assign({},i$),{width:s.toString(),height:r.toString(),top:i,left:o}),l=Ge().toLowerCase();n&&(a=FS(l)?c$:n),LS(l)&&(e=e||l$,c.scrollbars="yes");const u=Object.entries(c).reduce((d,[f,p])=>`${d}${f}=${p},`,"");if(jL(l)&&a!=="_self")return h$(e||"",a),new Vb(null);const h=window.open(e||"",a,u);D(h,t,"popup-blocked");try{h.focus()}catch{}return new Vb(h)}function h$(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d$="__/auth/handler",f$="emulator/auth/handler";function im(t,e,n,s,r,i){D(t.config.authDomain,t,"auth-domain-config-required"),D(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:ir,eventId:r};if(e instanceof Nr){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Jh(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[c,l]of Object.entries(i||{}))o[c]=l}if(e instanceof cc){const c=e.getScopes().filter(l=>l!=="");c.length>0&&(o.scopes=c.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const c of Object.keys(a))a[c]===void 0&&delete a[c];return`${p$(t)}?${Uo(a).slice(1)}`}function p$({config:t}){return t.emulator?Q_(t,f$):`https://${t.authDomain}/${d$}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gp="webStorageSupport";class g${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fi,this._completeRedirectFn=Cf,this._overrideRedirectResult=iy}async _openPopup(e,n,s,r){var i;Ss((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=im(e,n,s,Ol(),r);return u$(e,o,Tu())}async _openRedirect(e,n,s,r){return await this._originValidation(e),Y2(im(e,n,s,Ol(),r)),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Ss(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await r$(e),s=new yC(e);return n.register("authEvent",r=>(D(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Gp,{type:Gp},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[Gp];o!==void 0&&n(!!o),Lt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=zF(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return VS()||Y_()||oc()}}const bC=g$;class m${constructor(e){this.factorId=e}_process(e,n,s){switch(n.type){case"enroll":return this._finalizeEnroll(e,n.credential,s);case"signin":return this._finalizeSignIn(e,n.credential);default:return Bs("unexpected MultiFactorSessionType")}}}class oy extends m${constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new oy(e)}_finalizeEnroll(e,n,s){return q2(e,{idToken:n,displayName:s,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,n){return oF(e,{mfaPendingCredential:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class IC{constructor(){}static assertion(e){return oy._fromCredential(e)}}IC.FACTOR_ID="phone";var qb="@firebase/auth",jb="0.20.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{var r;e(((r=s)===null||r===void 0?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);!n||(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){D(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y$(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function v$(t){st(new Te("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:o}=s.options;return((a,c)=>{D(i&&!i.includes(":"),"invalid-api-key",{appName:a.name}),D(!(o!=null&&o.includes(":")),"argument-error",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:qS(t)},u=new zL(a,c,l);return SL(u,n),u})(s,r)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),st(new Te("auth-internal",e=>{const n=Ft(e.getProvider("auth").getImmediate());return(s=>new _$(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ae(qb,jb,y$(t)),Ae(qb,jb,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yr(t=bu()){const e=ds(t,"auth");return e.isInitialized()?e.getImmediate():TL(t,{popupRedirectResolver:bC,persistence:[Oa,If,fi]})}v$("Browser");var w$="firebase",b$="9.8.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ae(w$,b$,"app");const EC="@firebase/installations",ay="0.5.10";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TC=1e4,SC=`w:${ay}`,CC="FIS_v2",I$="https://firebaseinstallations.googleapis.com/v1",E$=60*60*1e3,T$="installations",S$="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C$={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["not-registered"]:"Firebase Installation is not registered.",["installation-not-found"]:"Firebase Installation not found.",["request-failed"]:'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',["app-offline"]:"Could not process request. Application offline.",["delete-pending-registration"]:"Can't delete installation while there is a pending registration request."},mo=new En(T$,S$,C$);function kC(t){return t instanceof lt&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AC({projectId:t}){return`${I$}/projects/${t}/installations`}function RC(t){return{token:t.token,requestStatus:2,expiresIn:A$(t.expiresIn),creationTime:Date.now()}}async function xC(t,e){const s=(await e.json()).error;return mo.create("request-failed",{requestName:t,serverCode:s.code,serverMessage:s.message,serverStatus:s.status})}function NC({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function k$(t,{refreshToken:e}){const n=NC(t);return n.append("Authorization",R$(e)),n}async function PC(t){const e=await t();return e.status>=500&&e.status<600?t():e}function A$(t){return Number(t.replace("s","000"))}function R$(t){return`${CC} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x$({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const s=AC(t),r=NC(t),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={fid:n,authVersion:CC,appId:t.appId,sdkVersion:SC},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await PC(()=>fetch(s,a));if(c.ok){const l=await c.json();return{fid:l.fid||n,registrationStatus:2,refreshToken:l.refreshToken,authToken:RC(l.authToken)}}else throw await xC("Create Installation",c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N$(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P$=/^[cdef][\w-]{21}$/,om="";function D$(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=O$(t);return P$.test(n)?n:om}catch{return om}}function O$(t){return N$(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC=new Map;function MC(t,e){const n=kf(t);LC(n,e),M$(n,e)}function LC(t,e){const n=OC.get(t);if(!!n)for(const s of n)s(e)}function M$(t,e){const n=L$();n&&n.postMessage({key:t,fid:e}),F$()}let eo=null;function L$(){return!eo&&"BroadcastChannel"in self&&(eo=new BroadcastChannel("[Firebase] FID Change"),eo.onmessage=t=>{LC(t.data.key,t.data.fid)}),eo}function F$(){OC.size===0&&eo&&(eo.close(),eo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $$="firebase-installations-database",U$=1,_o="firebase-installations-store";let Qp=null;function cy(){return Qp||(Qp=rc($$,U$,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(_o)}}})),Qp}async function od(t,e){const n=kf(t),r=(await cy()).transaction(_o,"readwrite"),i=r.objectStore(_o),o=await i.get(n);return await i.put(e,n),await r.done,(!o||o.fid!==e.fid)&&MC(t,e.fid),e}async function FC(t){const e=kf(t),s=(await cy()).transaction(_o,"readwrite");await s.objectStore(_o).delete(e),await s.done}async function Af(t,e){const n=kf(t),r=(await cy()).transaction(_o,"readwrite"),i=r.objectStore(_o),o=await i.get(n),a=e(o);return a===void 0?await i.delete(n):await i.put(a,n),await r.done,a&&(!o||o.fid!==a.fid)&&MC(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ly(t){let e;const n=await Af(t.appConfig,s=>{const r=B$(s),i=V$(t,r);return e=i.registrationPromise,i.installationEntry});return n.fid===om?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function B$(t){const e=t||{fid:D$(),registrationStatus:0};return $C(e)}function V$(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const r=Promise.reject(mo.create("app-offline"));return{installationEntry:e,registrationPromise:r}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},s=q$(t,n);return{installationEntry:n,registrationPromise:s}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:j$(t)}:{installationEntry:e}}async function q$(t,e){try{const n=await x$(t,e);return od(t.appConfig,n)}catch(n){throw kC(n)&&n.customData.serverCode===409?await FC(t.appConfig):await od(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function j$(t){let e=await Kb(t.appConfig);for(;e.registrationStatus===1;)await DC(100),e=await Kb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:s}=await ly(t);return s||n}return e}function Kb(t){return Af(t,e=>{if(!e)throw mo.create("installation-not-found");return $C(e)})}function $C(t){return K$(t)?{fid:t.fid,registrationStatus:0}:t}function K$(t){return t.registrationStatus===1&&t.registrationTime+TC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function H$({appConfig:t,heartbeatServiceProvider:e},n){const s=W$(t,n),r=k$(t,n),i=e.getImmediate({optional:!0});if(i){const l=await i.getHeartbeatsHeader();l&&r.append("x-firebase-client",l)}const o={installation:{sdkVersion:SC,appId:t.appId}},a={method:"POST",headers:r,body:JSON.stringify(o)},c=await PC(()=>fetch(s,a));if(c.ok){const l=await c.json();return RC(l)}else throw await xC("Generate Auth Token",c)}function W$(t,{fid:e}){return`${AC(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uy(t,e=!1){let n;const s=await Af(t.appConfig,i=>{if(!UC(i))throw mo.create("not-registered");const o=i.authToken;if(!e&&Q$(o))return i;if(o.requestStatus===1)return n=z$(t,e),i;{if(!navigator.onLine)throw mo.create("app-offline");const a=X$(i);return n=G$(t,a),a}});return n?await n:s.authToken}async function z$(t,e){let n=await Hb(t.appConfig);for(;n.authToken.requestStatus===1;)await DC(100),n=await Hb(t.appConfig);const s=n.authToken;return s.requestStatus===0?uy(t,e):s}function Hb(t){return Af(t,e=>{if(!UC(e))throw mo.create("not-registered");const n=e.authToken;return J$(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function G$(t,e){try{const n=await H$(t,e),s=Object.assign(Object.assign({},e),{authToken:n});return await od(t.appConfig,s),n}catch(n){if(kC(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await FC(t.appConfig);else{const s=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await od(t.appConfig,s)}throw n}}function UC(t){return t!==void 0&&t.registrationStatus===2}function Q$(t){return t.requestStatus===2&&!Y$(t)}function Y$(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+E$}function X$(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function J$(t){return t.requestStatus===1&&t.requestTime+TC<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z$(t){const e=t,{installationEntry:n,registrationPromise:s}=await ly(e);return s?s.catch(console.error):uy(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eU(t,e=!1){const n=t;return await tU(n),(await uy(n,e)).token}async function tU(t){const{registrationPromise:e}=await ly(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(t){if(!t||!t.options)throw Yp("App Configuration");if(!t.name)throw Yp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Yp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Yp(t){return mo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="installations",sU="installations-internal",rU=t=>{const e=t.getProvider("app").getImmediate(),n=nU(e),s=ds(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:s,_delete:()=>Promise.resolve()}},iU=t=>{const e=t.getProvider("app").getImmediate(),n=ds(e,BC).getImmediate();return{getId:()=>Z$(n),getToken:r=>eU(n,r)}};function oU(){st(new Te(BC,rU,"PUBLIC")),st(new Te(sU,iU,"PRIVATE"))}oU();Ae(EC,ay);Ae(EC,ay,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad="analytics",aU="firebase_id",cU="origin",lU=60*1e3,uU="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",VC="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xt=new rr("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qC(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function hU(t,e){const n=document.createElement("script");n.src=`${VC}?l=${t}&id=${e}`,n.async=!0,document.head.appendChild(n)}function dU(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function fU(t,e,n,s,r,i){const o=s[r];try{if(o)await e[o];else{const c=(await qC(n)).find(l=>l.measurementId===r);c&&await e[c.appId]}}catch(a){Xt.error(a)}t("config",r,i)}async function pU(t,e,n,s,r){try{let i=[];if(r&&r.send_to){let o=r.send_to;Array.isArray(o)||(o=[o]);const a=await qC(n);for(const c of o){const l=a.find(h=>h.measurementId===c),u=l&&e[l.appId];if(u)i.push(u);else{i=[];break}}}i.length===0&&(i=Object.values(e)),await Promise.all(i),t("event",s,r||{})}catch(i){Xt.error(i)}}function gU(t,e,n,s){async function r(i,o,a){try{i==="event"?await pU(t,e,n,o,a):i==="config"?await fU(t,e,n,s,o,a):t("set",o)}catch(c){Xt.error(c)}}return r}function mU(t,e,n,s,r){let i=function(...o){window[s].push(arguments)};return window[r]&&typeof window[r]=="function"&&(i=window[r]),window[r]=gU(i,t,e,n),{gtagCore:i,wrappedGtag:window[r]}}function _U(){const t=window.document.getElementsByTagName("script");for(const e of Object.values(t))if(e.src&&e.src.includes(VC))return e;return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yU={["already-exists"]:"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",["already-initialized"]:"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.",["already-initialized-settings"]:"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",["interop-component-reg-failed"]:"Firebase Analytics Interop Component failed to instantiate: {$reason}",["invalid-analytics-context"]:"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["indexeddb-unavailable"]:"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",["fetch-throttle"]:"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",["config-fetch-failed"]:"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",["no-api-key"]:'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',["no-app-id"]:'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},zn=new En("analytics","Analytics",yU);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vU=30,wU=1e3;class bU{constructor(e={},n=wU){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const jC=new bU;function IU(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function EU(t){var e;const{appId:n,apiKey:s}=t,r={method:"GET",headers:IU(s)},i=uU.replace("{app-id}",n),o=await fetch(i,r);if(o.status!==200&&o.status!==304){let a="";try{const c=await o.json();!((e=c.error)===null||e===void 0)&&e.message&&(a=c.error.message)}catch{}throw zn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function TU(t,e=jC,n){const{appId:s,apiKey:r,measurementId:i}=t.options;if(!s)throw zn.create("no-app-id");if(!r){if(i)return{measurementId:i,appId:s};throw zn.create("no-api-key")}const o=e.getThrottleMetadata(s)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new kU;return setTimeout(async()=>{a.abort()},n!==void 0?n:lU),KC({appId:s,apiKey:r,measurementId:i},o,a,e)}async function KC(t,{throttleEndTimeMillis:e,backoffCount:n},s,r=jC){const{appId:i,measurementId:o}=t;try{await SU(s,e)}catch(a){if(o)return Xt.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${a.message}]`),{appId:i,measurementId:o};throw a}try{const a=await EU(t);return r.deleteThrottleMetadata(i),a}catch(a){if(!CU(a)){if(r.deleteThrottleMetadata(i),o)return Xt.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${o} provided in the "measurementId" field in the local Firebase config. [${a.message}]`),{appId:i,measurementId:o};throw a}const c=Number(a.customData.httpStatus)===503?ed(n,r.intervalMillis,vU):ed(n,r.intervalMillis),l={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return r.setThrottleMetadata(i,l),Xt.debug(`Calling attemptFetch again in ${c} millis`),KC(t,l,s,r)}}function SU(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(zn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function CU(t){if(!(t instanceof lt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class kU{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AU(){if(Mn())try{await wu()}catch(t){return Xt.warn(zn.create("indexeddb-unavailable",{errorInfo:t}).message),!1}else return Xt.warn(zn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function RU(t,e,n,s,r,i,o){var a;const c=TU(t);c.then(f=>{n[f.measurementId]=f.appId,t.options.measurementId&&f.measurementId!==t.options.measurementId&&Xt.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${f.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(f=>Xt.error(f)),e.push(c);const l=AU().then(f=>{if(f)return s.getId()}),[u,h]=await Promise.all([c,l]);_U()||hU(i,u.measurementId),r("js",new Date);const d=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return d[cU]="firebase",d.update=!0,h!=null&&(d[aU]=h),r("config",u.measurementId,d),u.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e){this.app=e}_delete(){return delete vr[this.app.options.appId],Promise.resolve()}}let vr={},Wb=[];const zb={};let Lh="dataLayer",HC="gtag",Gb,Cu,am=!1;function NU(t){if(am)throw zn.create("already-initialized");t.dataLayerName&&(Lh=t.dataLayerName),t.gtagName&&(HC=t.gtagName)}function PU(){const t=[];if(yu()&&t.push("This is a browser extension environment."),ff()||t.push("Cookies are not available."),t.length>0){const e=t.map((s,r)=>`(${r+1}) ${s}`).join(" "),n=zn.create("invalid-analytics-context",{errorInfo:e});Xt.warn(n.message)}}function DU(t,e,n){PU();const s=t.options.appId;if(!s)throw zn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)Xt.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw zn.create("no-api-key");if(vr[s]!=null)throw zn.create("already-exists",{id:s});if(!am){dU(Lh);const{wrappedGtag:i,gtagCore:o}=mU(vr,Wb,zb,Lh,HC);Cu=i,Gb=o,am=!0}return vr[s]=RU(t,Wb,zb,e,Gb,Lh,n),new xU(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OU(t,e,n,s,r){if(r&&r.global){t("event",n,s);return}else{const i=await e,o=Object.assign(Object.assign({},s),{send_to:i});t("event",n,o)}}async function MU(t,e,n,s){if(s&&s.global)return t("set",{screen_name:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,screen_name:n})}}async function LU(t,e,n,s){if(s&&s.global)return t("set",{user_id:n}),Promise.resolve();{const r=await e;t("config",r,{update:!0,user_id:n})}}async function FU(t,e,n,s){if(s&&s.global){const r={};for(const i of Object.keys(n))r[`user_properties.${i}`]=n[i];return t("set",r),Promise.resolve()}else{const r=await e;t("config",r,{update:!0,user_properties:n})}}async function $U(t,e){const n=await t;window[`ga-disable-${n}`]=!e}function UU(t=bu()){t=A(t);const e=ds(t,ad);return e.isInitialized()?e.getImmediate():BU(t)}function BU(t,e={}){const n=ds(t,ad);if(n.isInitialized()){const r=n.getImmediate();if(Nl(e,n.getOptions()))return r;throw zn.create("already-initialized")}return n.initialize({options:e})}async function VU(){if(yu()||!ff()||!Mn())return!1;try{return await wu()}catch{return!1}}function qU(t,e,n){t=A(t),MU(Cu,vr[t.app.options.appId],e,n).catch(s=>Xt.error(s))}function jU(t,e,n){t=A(t),LU(Cu,vr[t.app.options.appId],e,n).catch(s=>Xt.error(s))}function KU(t,e,n){t=A(t),FU(Cu,vr[t.app.options.appId],e,n).catch(s=>Xt.error(s))}function HU(t,e){t=A(t),$U(vr[t.app.options.appId],e).catch(n=>Xt.error(n))}function WC(t,e,n,s){t=A(t),OU(Cu,vr[t.app.options.appId],e,n,s).catch(r=>Xt.error(r))}const Qb="@firebase/analytics",Yb="0.7.10";function WU(){st(new Te(ad,(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();return DU(s,r,n)},"PUBLIC")),st(new Te("analytics-internal",t,"PRIVATE")),Ae(Qb,Yb),Ae(Qb,Yb,"esm2017");function t(e){try{const n=e.getProvider(ad).getImmediate();return{logEvent:(s,r,i)=>WC(n,s,r,i)}}catch(n){throw zn.create("interop-component-reg-failed",{reason:n})}}}WU();const Xb="@firebase/database",Jb="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zC="";function GC(t){zC=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),bt(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:xl(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GU{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Yn(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC=function(t){try{if(typeof window!="undefined"&&typeof window[t]!="undefined"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new zU(e)}}catch{}return new GU},to=QC("localStorage"),cm=QC("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=new rr("@firebase/database"),YC=function(){let t=1;return function(){return t++}}(),XC=function(t){const e=uM(t),n=new aM;n.update(e);const s=n.digest();return hf.encodeByteArray(s)},ku=function(...t){let e="";for(let n=0;n<t.length;n++){const s=t[n];Array.isArray(s)||s&&typeof s=="object"&&typeof s.length=="number"?e+=ku.apply(null,s):typeof s=="object"?e+=bt(s):e+=s,e+=" "}return e};let ho=null,Zb=!0;const JC=function(t,e){O(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(wa.logLevel=pe.VERBOSE,ho=wa.log.bind(wa),e&&cm.set("logging_enabled",!0)):typeof t=="function"?ho=t:(ho=null,cm.remove("logging_enabled"))},Nt=function(...t){if(Zb===!0&&(Zb=!1,ho===null&&cm.get("logging_enabled")===!0&&JC(!0)),ho){const e=ku.apply(null,t);ho(e)}},Au=function(t){return function(...e){Nt(t,...e)}},lm=function(...t){const e="FIREBASE INTERNAL ERROR: "+ku(...t);wa.error(e)},Js=function(...t){const e=`FIREBASE FATAL ERROR: ${ku(...t)}`;throw wa.error(e),new Error(e)},on=function(...t){const e="FIREBASE WARNING: "+ku(...t);wa.warn(e)},QU=function(){typeof window!="undefined"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&on("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Rf=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},YU=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},Sr="[MIN_NAME]",Zs="[MAX_NAME]",Vo=function(t,e){if(t===e)return 0;if(t===Sr||e===Zs)return-1;if(e===Sr||t===Zs)return 1;{const n=cd(t),s=cd(e);return n!==null?s!==null?n-s===0?t.length-e.length:n-s:-1:s!==null?1:t<e?-1:1}},XU=function(t,e){return t===e?0:t<e?-1:1},Rc=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+bt(e))},hy=function(t){if(typeof t!="object"||t===null)return bt(t);const e=[];for(const s in t)e.push(s);e.sort();let n="{";for(let s=0;s<e.length;s++)s!==0&&(n+=","),n+=bt(e[s]),n+=":",n+=hy(t[e[s]]);return n+="}",n},ZC=function(t,e){const n=t.length;if(n<=e)return[t];const s=[];for(let r=0;r<n;r+=e)r+e>n?s.push(t.substring(r,n)):s.push(t.substring(r,r+e));return s};function $t(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const ek=function(t){O(!Rf(t),"Invalid JSON number");const e=11,n=52,s=(1<<e-1)-1;let r,i,o,a,c;t===0?(i=0,o=0,r=1/t===-1/0?1:0):(r=t<0,t=Math.abs(t),t>=Math.pow(2,1-s)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),s),i=a+s,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(i=0,o=Math.round(t/Math.pow(2,1-s-n))));const l=[];for(c=n;c;c-=1)l.push(o%2?1:0),o=Math.floor(o/2);for(c=e;c;c-=1)l.push(i%2?1:0),i=Math.floor(i/2);l.push(r?1:0),l.reverse();const u=l.join("");let h="";for(c=0;c<64;c+=8){let d=parseInt(u.substr(c,8),2).toString(16);d.length===1&&(d="0"+d),h=h+d}return h.toLowerCase()},JU=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},ZU=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function e4(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const s=new Error(t+" at "+e._path.toString()+": "+n);return s.code=t.toUpperCase(),s}const t4=new RegExp("^-?(0*)\\d{1,10}$"),tk=-2147483648,dy=2147483647,cd=function(t){if(t4.test(t)){const e=Number(t);if(e>=tk&&e<=dy)return e}return null},lc=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw on("Exception was thrown by user callback.",n),e},Math.floor(0))}},n4=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},il=function(t,e){const n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s4{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(s=>this.appCheck=s)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,s)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(s=>s.addTokenListener(e))}notifyForInvalidToken(){on(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r4{constructor(e,n,s){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=s,this.auth_=null,this.auth_=s.getImmediate({optional:!0}),this.auth_||s.onInit(r=>this.auth_=r)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(Nt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,s)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,s):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',on(e)}}class ba{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}ba.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fy="5",nk="v",sk="s",rk="r",ik="f",ok=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,ak="ls",ck="p",um="ac",lk="websocket",uk="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hk{constructor(e,n,s,r,i=!1,o="",a=!1){this.secure=n,this.namespace=s,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=to.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&to.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function i4(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function dk(t,e,n){O(typeof e=="string","typeof type must == string"),O(typeof n=="object","typeof params must == object");let s;if(e===lk)s=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===uk)s=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);i4(t)&&(n.ns=t.namespace);const r=[];return $t(n,(i,o)=>{r.push(i+"="+o)}),s+r.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{constructor(){this.counters_={}}incrementCounter(e,n=1){Yn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return GO(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xp={},Jp={};function py(t){const e=t.toString();return Xp[e]||(Xp[e]=new o4),Xp[e]}function a4(t,e){const n=t.toString();return Jp[n]||(Jp[n]=e()),Jp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c4{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const s=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let r=0;r<s.length;++r)s[r]&&lc(()=>{this.onMessage_(s[r])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0="start",l4="close",u4="pLPCommand",h4="pRTLPCB",fk="id",pk="pw",gk="ser",d4="cb",f4="seg",p4="ts",g4="d",m4="dframe",mk=1870,_k=30,_4=mk-_k,y4=25e3,v4=3e4;class Qr{constructor(e,n,s,r,i,o,a){this.connId=e,this.repoInfo=n,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Au(e),this.stats_=py(n),this.urlFn=c=>(this.appCheckToken&&(c[um]=this.appCheckToken),dk(n,uk,c))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new c4(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(v4)),YU(()=>{if(this.isClosed_)return;this.scriptTagHolder=new gy((...i)=>{const[o,a,c,l,u]=i;if(this.incrementIncomingBytes_(i),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===e0)this.id=a,this.password=c;else if(o===l4)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...i)=>{const[o,a]=i;this.incrementIncomingBytes_(i),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const s={};s[e0]="t",s[gk]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(s[d4]=this.scriptTagHolder.uniqueCallbackIdentifier),s[nk]=fy,this.transportSessionId&&(s[sk]=this.transportSessionId),this.lastSessionId&&(s[ak]=this.lastSessionId),this.applicationId&&(s[ck]=this.applicationId),this.appCheckToken&&(s[um]=this.appCheckToken),typeof location!="undefined"&&location.hostname&&ok.test(location.hostname)&&(s[rk]=ik);const r=this.urlFn(s);this.log_("Connecting via long-poll to "+r),this.scriptTagHolder.addTag(r,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Qr.forceAllow_=!0}static forceDisallow(){Qr.forceDisallow_=!0}static isAvailable(){return Qr.forceAllow_?!0:!Qr.forceDisallow_&&typeof document!="undefined"&&document.createElement!=null&&!JU()&&!ZU()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=bt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=pS(n),r=ZC(s,_4);for(let i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const s={};s[m4]="t",s[fk]=e,s[pk]=n,this.myDisconnFrame.src=this.urlFn(s),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=bt(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class gy{constructor(e,n,s,r){this.onDisconnect=s,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=YC(),window[u4+this.uniqueCallbackIdentifier]=e,window[h4+this.uniqueCallbackIdentifier]=n,this.myIFrame=gy.createIFrame_();let i="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){const a=document.domain;i='<script>document.domain="'+a+'";<\/script>'}const o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Nt("frame writing exception"),a.stack&&Nt(a.stack),Nt(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||Nt("No IE domain setting required")}catch{const s=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+s+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[fk]=this.myID,e[pk]=this.myPW,e[gk]=this.currentSerial;let n=this.urlFn(e),s="",r=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+_k+s.length<=mk;){const o=this.pendingSegs.shift();s=s+"&"+f4+r+"="+o.seg+"&"+p4+r+"="+o.ts+"&"+g4+r+"="+o.d,r++}return n=n+s,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,s){this.pendingSegs.push({seg:e,ts:n,d:s}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const s=()=>{this.outstandingRequests.delete(n),this.newRequest_()},r=setTimeout(s,Math.floor(y4)),i=()=>{clearTimeout(r),s()};this.addTag(e,i)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const s=this.myIFrame.doc.createElement("script");s.type="text/javascript",s.async=!0,s.src=e,s.onload=s.onreadystatechange=function(){const r=s.readyState;(!r||r==="loaded"||r==="complete")&&(s.onload=s.onreadystatechange=null,s.parentNode&&s.parentNode.removeChild(s),n())},s.onerror=()=>{Nt("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(s)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w4=16384,b4=45e3;let ld=null;typeof MozWebSocket!="undefined"?ld=MozWebSocket:typeof WebSocket!="undefined"&&(ld=WebSocket);class ns{constructor(e,n,s,r,i,o,a){this.connId=e,this.applicationId=s,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Au(this.connId),this.stats_=py(n),this.connURL=ns.connectionURL_(n,o,a,r,s),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,s,r,i){const o={};return o[nk]=fy,typeof location!="undefined"&&location.hostname&&ok.test(location.hostname)&&(o[rk]=ik),n&&(o[sk]=n),s&&(o[ak]=s),r&&(o[um]=r),i&&(o[ck]=i),dk(e,lk,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,to.set("previous_websocket_failure",!0);try{let s;gS(),this.mySock=new ld(this.connURL,[],s)}catch(s){this.log_("Error instantiating WebSocket.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=s=>{this.handleIncomingFrame(s)},this.mySock.onerror=s=>{this.log_("WebSocket error.  Closing connection.");const r=s.message||s.data;r&&this.log_(r),this.onClosed_()}}start(){}static forceDisallow(){ns.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator!="undefined"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,s=navigator.userAgent.match(n);s&&s.length>1&&parseFloat(s[1])<4.4&&(e=!0)}return!e&&ld!==null&&!ns.forceDisallow_}static previouslyFailed(){return to.isInMemoryStorage||to.get("previous_websocket_failure")===!0}markConnectionHealthy(){to.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const s=xl(n);this.onMessage(s)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(O(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const s=this.extractFrameCount_(n);s!==null&&this.appendFrame_(s)}}send(e){this.resetKeepAlive();const n=bt(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const s=ZC(n,w4);s.length>1&&this.sendString_(String(s.length));for(let r=0;r<s.length;r++)this.sendString_(s[r])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(b4))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}ns.responsesRequiredToBeHealthy=2;ns.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Qr,ns]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=ns&&ns.isAvailable();let s=n&&!ns.previouslyFailed();if(e.webSocketOnly&&(n||on("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[ns];else{const r=this.transports_=[];for(const i of Ma.ALL_TRANSPORTS)i&&i.isAvailable()&&r.push(i);Ma.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Ma.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I4=6e4,E4=5e3,T4=10*1024,S4=100*1024,Zp="t",t0="d",C4="s",n0="r",k4="e",s0="o",r0="a",i0="n",o0="p",A4="h";class R4{constructor(e,n,s,r,i,o,a,c,l,u){this.id=e,this.repoInfo_=n,this.applicationId_=s,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=c,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Au("c:"+this.id+":"),this.transportManager_=new Ma(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),s=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,s)},Math.floor(0));const r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=il(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>S4?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>T4?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Zp in e){const n=e[Zp];n===r0?this.upgradeIfSecondaryHealthy_():n===n0?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===s0&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=Rc("t",e),s=Rc("d",e);if(n==="c")this.onSecondaryControl_(s);else if(n==="d")this.pendingDataMessages.push(s);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:o0,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:r0,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:i0,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=Rc("t",e),s=Rc("d",e);n==="c"?this.onControl_(s):n==="d"&&this.onDataMessage_(s)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=Rc(Zp,e);if(t0 in e){const s=e[t0];if(n===A4)this.onHandshake_(s);else if(n===i0){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===C4?this.onConnectionShutdown_(s):n===n0?this.onReset_(s):n===k4?lm("Server Error: "+s):n===s0?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):lm("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,s=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),fy!==s&&on("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),s=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,s),il(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(I4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):il(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(E4))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:o0,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(to.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{put(e,n,s,r){}merge(e,n,s,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,s){}onDisconnectMerge(e,n,s){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(e){this.allowedEvents_=e,this.listeners_={},O(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const s=[...this.listeners_[e]];for(let r=0;r<s.length;r++)s[r].callback.apply(s[r].context,n)}}on(e,n,s){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:s});const r=this.getInitialEvent(e);r&&n.apply(s,r)}off(e,n,s){this.validateEventType_(e);const r=this.listeners_[e]||[];for(let i=0;i<r.length;i++)if(r[i].callback===n&&(!s||s===r[i].context)){r.splice(i,1);return}}validateEventType_(e){O(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud extends vk{constructor(){super(["online"]),this.online_=!0,typeof window!="undefined"&&typeof window.addEventListener!="undefined"&&!df()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new ud}getInitialEvent(e){return O(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0=32,c0=768;class ke{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let s=0;for(let r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[s]=this.pieces_[r],s++);this.pieces_.length=s,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function Se(){return new ke("")}function ge(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function pi(t){return t.pieces_.length-t.pieceNum_}function Ue(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ke(t.pieces_,e)}function my(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function x4(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function $l(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function wk(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ke(e,0)}function Xe(t,e){const n=[];for(let s=t.pieceNum_;s<t.pieces_.length;s++)n.push(t.pieces_[s]);if(e instanceof ke)for(let s=e.pieceNum_;s<e.pieces_.length;s++)n.push(e.pieces_[s]);else{const s=e.split("/");for(let r=0;r<s.length;r++)s[r].length>0&&n.push(s[r])}return new ke(n,0)}function me(t){return t.pieceNum_>=t.pieces_.length}function _n(t,e){const n=ge(t),s=ge(e);if(n===null)return e;if(n===s)return _n(Ue(t),Ue(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function N4(t,e){const n=$l(t,0),s=$l(e,0);for(let r=0;r<n.length&&r<s.length;r++){const i=Vo(n[r],s[r]);if(i!==0)return i}return n.length===s.length?0:n.length<s.length?-1:1}function _y(t,e){if(pi(t)!==pi(e))return!1;for(let n=t.pieceNum_,s=e.pieceNum_;n<=t.pieces_.length;n++,s++)if(t.pieces_[n]!==e.pieces_[s])return!1;return!0}function rs(t,e){let n=t.pieceNum_,s=e.pieceNum_;if(pi(t)>pi(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[s])return!1;++n,++s}return!0}class P4{constructor(e,n){this.errorPrefix_=n,this.parts_=$l(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let s=0;s<this.parts_.length;s++)this.byteLength_+=pf(this.parts_[s]);bk(this)}}function D4(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=pf(e),bk(t)}function O4(t){const e=t.parts_.pop();t.byteLength_-=pf(e),t.parts_.length>0&&(t.byteLength_-=1)}function bk(t){if(t.byteLength_>c0)throw new Error(t.errorPrefix_+"has a key path longer than "+c0+" bytes ("+t.byteLength_+").");if(t.parts_.length>a0)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+a0+") or object contains a cycle "+Bi(t))}function Bi(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yy extends vk{constructor(){super(["visible"]);let e,n;typeof document!="undefined"&&typeof document.addEventListener!="undefined"&&(typeof document.hidden!="undefined"?(n="visibilitychange",e="hidden"):typeof document.mozHidden!="undefined"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden!="undefined"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const s=!document[e];s!==this.visible_&&(this.visible_=s,this.trigger("visible",s))},!1)}static getInstance(){return new yy}getInitialEvent(e){return O(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xc=1e3,M4=60*5*1e3,L4=3*1e3,l0=30*1e3,F4=1.3,$4=3e4,U4="server_kill",u0=3;class wr extends yk{constructor(e,n,s,r,i,o,a,c){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=s,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=c,this.id=wr.nextPersistentConnectionId_++,this.log_=Au("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=xc,this.maxReconnectDelay_=M4,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!gS())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");yy.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&ud.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,s){const r=++this.requestNumber_,i={r,a:e,b:n};this.log_(bt(i)),O(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),s&&(this.requestCBHash_[r]=s)}get(e){this.initConnection_();const n=new wt,s={p:e._path.toString(),q:e._queryObject},r={action:"g",request:s,onComplete:o=>{const a=o.d;o.s==="ok"?(this.onDataUpdate_(s.p,a,!1,null),n.resolve(a)):n.reject(a)}};this.outstandingGets_.push(r),this.outstandingGetCount_++;const i=this.outstandingGets_.length-1;return this.connected_||setTimeout(()=>{const o=this.outstandingGets_[i];o===void 0||r!==o||(delete this.outstandingGets_[i],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),this.log_("get "+i+" timed out on connection"),n.reject(new Error("Client is offline.")))},L4),this.connected_&&this.sendGet_(i),n.promise}listen(e,n,s,r){this.initConnection_();const i=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),O(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");const a={onComplete:r,hashFn:n,query:e,tag:s};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,s=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(s)})}sendListen_(e){const n=e.query,s=n._path.toString(),r=n._queryIdentifier;this.log_("Listen on "+s+" for "+r);const i={p:s},o="q";e.tag&&(i.q=n._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest(o,i,a=>{const c=a.d,l=a.s;wr.warnOnListenWarnings_(c,n),(this.listens.get(s)&&this.listens.get(s).get(r))===e&&(this.log_("listen response",a),l!=="ok"&&this.removeListen_(s,r),e.onComplete&&e.onComplete(l,c))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Yn(e,"w")){const s=po(e,"w");if(Array.isArray(s)&&~s.indexOf("no_index")){const r='".indexOn": "'+n._queryParams.getIndex().toString()+'"',i=n._path.toString();on(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${r} at ${i} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||oM(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=l0)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=iM(e)?"auth":"gauth",s={cred:e};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(n,s,r=>{const i=r.s,o=r.d||"error";this.authToken_===e&&(i==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(i,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,s=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,s)})}unlisten(e,n){const s=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+s+" "+r),O(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(s,r)&&this.connected_&&this.sendUnlisten_(s,r,e._queryObject,n)}sendUnlisten_(e,n,s,r){this.log_("Unlisten on "+e+" for "+n);const i={p:e},o="n";r&&(i.q=s,i.t=r),this.sendRequest(o,i)}onDisconnectPut(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:s})}onDisconnectMerge(e,n,s){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,s):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:s})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,s,r){const i={p:n,d:s};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,o=>{r&&setTimeout(()=>{r(o.s,o.d)},Math.floor(0))})}put(e,n,s,r){this.putInternal("p",e,n,s,r)}merge(e,n,s,r){this.putInternal("m",e,n,s,r)}putInternal(e,n,s,r,i){this.initConnection_();const o={p:n,d:s};i!==void 0&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,s=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,s,i=>{this.log_(n+" response",i),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),r&&r(i.s,i.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,s=>{if(s.s!=="ok"){const i=s.d;this.log_("reportStats","Error sending stats: "+i)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+bt(e));const n=e.r,s=this.requestCBHash_[n];s&&(delete this.requestCBHash_[n],s(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):lm("Unrecognized action received from server: "+bt(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){O(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=xc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=xc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>$4&&(this.reconnectDelay_=xc),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*F4)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),s=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+wr.nextConnectionId_++,i=this.lastSessionId;let o=!1,a=null;const c=function(){a?a.close():(o=!0,s())},l=function(h){O(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(h)};this.realtime_={close:c,sendRequest:l};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[h,d]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?Nt("getToken() completed but was canceled"):(Nt("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=d&&d.token,a=new R4(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,s,f=>{on(f+" ("+this.repoInfo_.toString()+")"),this.interrupt(U4)},i))}catch(h){this.log_("Failed to get token: "+h),o||(this.repoInfo_.nodeAdmin&&on(h),c())}}}interrupt(e){Nt("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){Nt("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Jh(this.interruptReasons_)&&(this.reconnectDelay_=xc,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let s;n?s=n.map(i=>hy(i)).join("$"):s="default";const r=this.removeListen_(e,s);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,n){const s=new ke(e).toString();let r;if(this.listens.has(s)){const i=this.listens.get(s);r=i.get(n),i.delete(n),i.size===0&&this.listens.delete(s)}else r=void 0;return r}onAuthRevoked_(e,n){Nt("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=u0&&(this.reconnectDelay_=l0,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){Nt("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=u0&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+zC.replace(/\./g,"-")]=1,df()?e["framework.cordova"]=1:vu()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=ud.getInstance().currentlyOnline();return Jh(this.interruptReasons_)&&e}}wr.nextPersistentConnectionId_=0;wr.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new _e(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const s=new _e(Sr,e),r=new _e(Sr,n);return this.compare(s,r)!==0}minPost(){return _e.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dh;class Ik extends xf{static get __EMPTY_NODE(){return dh}static set __EMPTY_NODE(e){dh=e}compare(e,n){return Vo(e.name,n.name)}isDefinedOn(e){throw sc("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return _e.MIN}maxPost(){return new _e(Zs,dh)}makePost(e,n){return O(typeof e=="string","KeyIndex indexValue must always be a string."),new _e(e,dh)}toString(){return".key"}}const Hs=new Ik;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fh{constructor(e,n,s,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?s(e.key,n):1,r&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class Rt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:Rt.RED,this.left=r!=null?r:Rn.EMPTY_NODE,this.right=i!=null?i:Rn.EMPTY_NODE}copy(e,n,s,r,i){return new Rt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return i<0?r=r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r=r.copy(null,n,null,null,null):r=r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp_()}removeMin_(){if(this.left.isEmpty())return Rn.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let s,r;if(s=this,n(e,s.key)<0)!s.left.isEmpty()&&!s.left.isRed_()&&!s.left.left.isRed_()&&(s=s.moveRedLeft_()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed_()&&(s=s.rotateRight_()),!s.right.isEmpty()&&!s.right.isRed_()&&!s.right.left.isRed_()&&(s=s.moveRedRight_()),n(e,s.key)===0){if(s.right.isEmpty())return Rn.EMPTY_NODE;r=s.right.min_(),s=s.copy(r.key,r.value,null,null,s.right.removeMin_())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,Rt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,Rt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}Rt.RED=!0;Rt.BLACK=!1;class B4{copy(e,n,s,r,i){return this}insert(e,n,s){return new Rt(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Rn{constructor(e,n=Rn.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Rn(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Rt.BLACK,null,null))}remove(e){return new Rn(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Rt.BLACK,null,null))}get(e){let n,s=this.root_;for(;!s.isEmpty();){if(n=this.comparator_(e,s.key),n===0)return s.value;n<0?s=s.left:n>0&&(s=s.right)}return null}getPredecessorKey(e){let n,s=this.root_,r=null;for(;!s.isEmpty();)if(n=this.comparator_(e,s.key),n===0){if(s.left.isEmpty())return r?r.key:null;for(s=s.left;!s.right.isEmpty();)s=s.right;return s.key}else n<0?s=s.left:n>0&&(r=s,s=s.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new fh(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new fh(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new fh(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new fh(this.root_,null,this.comparator_,!0,e)}}Rn.EMPTY_NODE=new B4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V4(t,e){return Vo(t.name,e.name)}function vy(t,e){return Vo(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hm;function q4(t){hm=t}const Ek=function(t){return typeof t=="number"?"number:"+ek(t):"string:"+t},Tk=function(t){if(t.isLeafNode()){const e=t.val();O(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Yn(e,".sv"),"Priority must be a string or number.")}else O(t===hm||t.isEmpty(),"priority of unexpected type.");O(t===hm||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h0;class Ct{constructor(e,n=Ct.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,O(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Tk(this.priorityNode_)}static set __childrenNodeConstructor(e){h0=e}static get __childrenNodeConstructor(){return h0}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new Ct(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:Ct.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return me(e)?this:ge(e)===".priority"?this.priorityNode_:Ct.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:Ct.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const s=ge(e);return s===null?n:n.isEmpty()&&s!==".priority"?this:(O(s!==".priority"||pi(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(s,Ct.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ue(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ek(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=ek(this.value_):e+=this.value_,this.lazyHash_=XC(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===Ct.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof Ct.__childrenNodeConstructor?-1:(O(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,s=typeof this.value_,r=Ct.VALUE_TYPE_ORDER.indexOf(n),i=Ct.VALUE_TYPE_ORDER.indexOf(s);return O(r>=0,"Unknown leaf type: "+n),O(i>=0,"Unknown leaf type: "+s),r===i?s==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:i-r}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}Ct.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sk,Ck;function j4(t){Sk=t}function K4(t){Ck=t}class H4 extends xf{compare(e,n){const s=e.node.getPriority(),r=n.node.getPriority(),i=s.compareTo(r);return i===0?Vo(e.name,n.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return _e.MIN}maxPost(){return new _e(Zs,new Ct("[PRIORITY-POST]",Ck))}makePost(e,n){const s=Sk(e);return new _e(n,new Ct("[PRIORITY-POST]",s))}toString(){return".priority"}}const He=new H4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W4=Math.log(2);class z4{constructor(e){const n=i=>parseInt(Math.log(i)/W4,10),s=i=>parseInt(Array(i+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const r=s(this.count);this.bits_=e+1&r}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const hd=function(t,e,n,s){t.sort(e);const r=function(c,l){const u=l-c;let h,d;if(u===0)return null;if(u===1)return h=t[c],d=n?n(h):h,new Rt(d,h.node,Rt.BLACK,null,null);{const f=parseInt(u/2,10)+c,p=r(c,f),_=r(f+1,l);return h=t[f],d=n?n(h):h,new Rt(d,h.node,Rt.BLACK,p,_)}},i=function(c){let l=null,u=null,h=t.length;const d=function(p,_){const v=h-p,b=h;h-=p;const N=r(v+1,b),T=t[v],$=n?n(T):T;f(new Rt($,T.node,_,null,N))},f=function(p){l?(l.left=p,l=p):(u=p,l=p)};for(let p=0;p<c.count;++p){const _=c.nextBitIsOne(),v=Math.pow(2,c.count-(p+1));_?d(v,Rt.BLACK):(d(v,Rt.BLACK),d(v,Rt.RED))}return u},o=new z4(t.length),a=i(o);return new Rn(s||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eg;const Zo={};class fr{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return O(Zo&&He,"ChildrenNode.ts has not been loaded"),eg=eg||new fr({".priority":Zo},{".priority":He}),eg}get(e){const n=po(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Rn?n:null}hasIndex(e){return Yn(this.indexSet_,e.toString())}addIndex(e,n){O(e!==Hs,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const s=[];let r=!1;const i=n.getIterator(_e.Wrap);let o=i.getNext();for(;o;)r=r||e.isDefinedOn(o.node),s.push(o),o=i.getNext();let a;r?a=hd(s,e.getCompare()):a=Zo;const c=e.toString(),l=Object.assign({},this.indexSet_);l[c]=e;const u=Object.assign({},this.indexes_);return u[c]=a,new fr(u,l)}addToIndexes(e,n){const s=Zh(this.indexes_,(r,i)=>{const o=po(this.indexSet_,i);if(O(o,"Missing index implementation for "+i),r===Zo)if(o.isDefinedOn(e.node)){const a=[],c=n.getIterator(_e.Wrap);let l=c.getNext();for(;l;)l.name!==e.name&&a.push(l),l=c.getNext();return a.push(e),hd(a,o.getCompare())}else return Zo;else{const a=n.get(e.name);let c=r;return a&&(c=c.remove(new _e(e.name,a))),c.insert(e,e.node)}});return new fr(s,this.indexSet_)}removeFromIndexes(e,n){const s=Zh(this.indexes_,r=>{if(r===Zo)return r;{const i=n.get(e.name);return i?r.remove(new _e(e.name,i)):r}});return new fr(s,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nc;class ne{constructor(e,n,s){this.children_=e,this.priorityNode_=n,this.indexMap_=s,this.lazyHash_=null,this.priorityNode_&&Tk(this.priorityNode_),this.children_.isEmpty()&&O(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Nc||(Nc=new ne(new Rn(vy),null,fr.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Nc}updatePriority(e){return this.children_.isEmpty()?this:new ne(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Nc:n}}getChild(e){const n=ge(e);return n===null?this:this.getImmediateChild(n).getChild(Ue(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(O(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const s=new _e(e,n);let r,i;n.isEmpty()?(r=this.children_.remove(e),i=this.indexMap_.removeFromIndexes(s,this.children_)):(r=this.children_.insert(e,n),i=this.indexMap_.addToIndexes(s,this.children_));const o=r.isEmpty()?Nc:this.priorityNode_;return new ne(r,o,i)}}updateChild(e,n){const s=ge(e);if(s===null)return n;{O(ge(e)!==".priority"||pi(e)===1,".priority must be the last token in a path");const r=this.getImmediateChild(s).updateChild(Ue(e),n);return this.updateImmediateChild(s,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let s=0,r=0,i=!0;if(this.forEachChild(He,(o,a)=>{n[o]=a.val(e),s++,i&&ne.INTEGER_REGEXP_.test(o)?r=Math.max(r,Number(o)):i=!1}),!e&&i&&r<2*s){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ek(this.getPriority().val())+":"),this.forEachChild(He,(n,s)=>{const r=s.hash();r!==""&&(e+=":"+n+":"+r)}),this.lazyHash_=e===""?"":XC(e)}return this.lazyHash_}getPredecessorChildName(e,n,s){const r=this.resolveIndex_(s);if(r){const i=r.getPredecessorKey(new _e(e,n));return i?i.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.minKey();return s&&s.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new _e(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const s=n.maxKey();return s&&s.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new _e(n,this.children_.get(n)):null}forEachChild(e,n){const s=this.resolveIndex_(e);return s?s.inorderTraversal(r=>n(r.name,r.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getIteratorFrom(e,r=>r);{const r=this.children_.getIteratorFrom(e.name,_e.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)<0;)r.getNext(),i=r.peek();return r}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const s=this.resolveIndex_(n);if(s)return s.getReverseIteratorFrom(e,r=>r);{const r=this.children_.getReverseIteratorFrom(e.name,_e.Wrap);let i=r.peek();for(;i!=null&&n.compare(i,e)>0;)r.getNext(),i=r.peek();return r}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ru?-1:0}withIndex(e){if(e===Hs||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new ne(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Hs||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const s=this.getIterator(He),r=n.getIterator(He);let i=s.getNext(),o=r.getNext();for(;i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=s.getNext(),o=r.getNext()}return i===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Hs?null:this.indexMap_.get(e.toString())}}ne.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class G4 extends ne{constructor(){super(new Rn(vy),ne.EMPTY_NODE,fr.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ne.EMPTY_NODE}isEmpty(){return!1}}const Ru=new G4;Object.defineProperties(_e,{MIN:{value:new _e(Sr,ne.EMPTY_NODE)},MAX:{value:new _e(Zs,Ru)}});Ik.__EMPTY_NODE=ne.EMPTY_NODE;Ct.__childrenNodeConstructor=ne;q4(Ru);K4(Ru);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4=!0;function et(t,e=null){if(t===null)return ne.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),O(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new Ct(n,et(e))}if(!(t instanceof Array)&&Q4){const n=[];let s=!1;if($t(t,(o,a)=>{if(o.substring(0,1)!=="."){const c=et(a);c.isEmpty()||(s=s||!c.getPriority().isEmpty(),n.push(new _e(o,c)))}}),n.length===0)return ne.EMPTY_NODE;const i=hd(n,V4,o=>o.name,vy);if(s){const o=hd(n,He.getCompare());return new ne(i,et(e),new fr({".priority":o},{".priority":He}))}else return new ne(i,et(e),fr.Default)}else{let n=ne.EMPTY_NODE;return $t(t,(s,r)=>{if(Yn(t,s)&&s.substring(0,1)!=="."){const i=et(r);(i.isLeafNode()||!i.isEmpty())&&(n=n.updateImmediateChild(s,i))}}),n.updatePriority(et(e))}}j4(et);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy extends xf{constructor(e){super(),this.indexPath_=e,O(!me(e)&&ge(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const s=this.extractChild(e.node),r=this.extractChild(n.node),i=s.compareTo(r);return i===0?Vo(e.name,n.name):i}makePost(e,n){const s=et(e),r=ne.EMPTY_NODE.updateChild(this.indexPath_,s);return new _e(n,r)}maxPost(){const e=ne.EMPTY_NODE.updateChild(this.indexPath_,Ru);return new _e(Zs,e)}toString(){return $l(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4 extends xf{compare(e,n){const s=e.node.compareTo(n.node);return s===0?Vo(e.name,n.name):s}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return _e.MIN}maxPost(){return _e.MAX}makePost(e,n){const s=et(e);return new _e(n,s)}toString(){return".value"}}const by=new Y4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const La="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",dm="-",kk="z",Ak=786,X4=function(){let t=0;const e=[];return function(n){const s=n===t;t=n;let r;const i=new Array(8);for(r=7;r>=0;r--)i[r]=La.charAt(n%64),n=Math.floor(n/64);O(n===0,"Cannot push at time == 0");let o=i.join("");if(s){for(r=11;r>=0&&e[r]===63;r--)e[r]=0;e[r]++}else for(r=0;r<12;r++)e[r]=Math.floor(Math.random()*64);for(r=0;r<12;r++)o+=La.charAt(e[r]);return O(o.length===20,"nextPushId: Length should be 20."),o}}(),d0=function(t){if(t===""+dy)return dm;const e=cd(t);if(e!=null)return""+(e+1);const n=new Array(t.length);for(let o=0;o<n.length;o++)n[o]=t.charAt(o);if(n.length<Ak)return n.push(dm),n.join("");let s=n.length-1;for(;s>=0&&n[s]===kk;)s--;if(s===-1)return Zs;const r=n[s],i=La.charAt(La.indexOf(r)+1);return n[s]=i,n.slice(0,s+1).join("")},f0=function(t){if(t===""+tk)return Sr;const e=cd(t);if(e!=null)return""+(e-1);const n=new Array(t.length);for(let s=0;s<n.length;s++)n[s]=t.charAt(s);return n[n.length-1]===dm?n.length===1?""+dy:(delete n[n.length-1],n.join("")):(n[n.length-1]=La.charAt(La.indexOf(n[n.length-1])-1),n.join("")+kk.repeat(Ak-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rk(t){return{type:"value",snapshotNode:t}}function Fa(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function Ul(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Bl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function J4(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this.index_=e}updateChild(e,n,s,r,i,o){O(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(r).equals(s.getChild(r))&&a.isEmpty()===s.isEmpty()||(o!=null&&(s.isEmpty()?e.hasChild(n)?o.trackChildChange(Ul(n,a)):O(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Fa(n,s)):o.trackChildChange(Bl(n,s,a))),e.isLeafNode()&&s.isEmpty())?e:e.updateImmediateChild(n,s).withIndex(this.index_)}updateFullNode(e,n,s){return s!=null&&(e.isLeafNode()||e.forEachChild(He,(r,i)=>{n.hasChild(r)||s.trackChildChange(Ul(r,i))}),n.isLeafNode()||n.forEachChild(He,(r,i)=>{if(e.hasChild(r)){const o=e.getImmediateChild(r);o.equals(i)||s.trackChildChange(Bl(r,i,o))}else s.trackChildChange(Fa(r,i))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?ne.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{constructor(e){this.indexedFilter_=new Iy(e.getIndex()),this.index_=e.getIndex(),this.startPost_=Vl.getStartPost_(e),this.endPost_=Vl.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,n,s,r,i,o){return this.matches(new _e(n,s))||(s=ne.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,s,r,i,o)}updateFullNode(e,n,s){n.isLeafNode()&&(n=ne.EMPTY_NODE);let r=n.withIndex(this.index_);r=r.updatePriority(ne.EMPTY_NODE);const i=this;return n.forEachChild(He,(o,a)=>{i.matches(new _e(o,a))||(r=r.updateImmediateChild(o,ne.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(e){this.rangedFilter_=new Vl(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,n,s,r,i,o){return this.rangedFilter_.matches(new _e(n,s))||(s=ne.EMPTY_NODE),e.getImmediateChild(n).equals(s)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,s,r,i,o):this.fullLimitUpdateChild_(e,n,s,i,o)}updateFullNode(e,n,s){let r;if(n.isLeafNode()||n.isEmpty())r=ne.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){r=ne.EMPTY_NODE.withIndex(this.index_);let i;this.reverse_?i=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):i=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;i.hasNext()&&o<this.limit_;){const a=i.getNext();let c;if(this.reverse_?c=this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:c=this.index_.compare(a,this.rangedFilter_.getEndPost())<=0,c)r=r.updateImmediateChild(a.name,a.node),o++;else break}}else{r=n.withIndex(this.index_),r=r.updatePriority(ne.EMPTY_NODE);let i,o,a,c;if(this.reverse_){c=r.getReverseIterator(this.index_),i=this.rangedFilter_.getEndPost(),o=this.rangedFilter_.getStartPost();const h=this.index_.getCompare();a=(d,f)=>h(f,d)}else c=r.getIterator(this.index_),i=this.rangedFilter_.getStartPost(),o=this.rangedFilter_.getEndPost(),a=this.index_.getCompare();let l=0,u=!1;for(;c.hasNext();){const h=c.getNext();!u&&a(i,h)<=0&&(u=!0),u&&l<this.limit_&&a(h,o)<=0?l++:r=r.updateImmediateChild(h.name,ne.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,s)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,s,r,i){let o;if(this.reverse_){const h=this.index_.getCompare();o=(d,f)=>h(f,d)}else o=this.index_.getCompare();const a=e;O(a.numChildren()===this.limit_,"");const c=new _e(n,s),l=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(c);if(a.hasChild(n)){const h=a.getImmediateChild(n);let d=r.getChildAfterChild(this.index_,l,this.reverse_);for(;d!=null&&(d.name===n||a.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);const f=d==null?1:o(d,c);if(u&&!s.isEmpty()&&f>=0)return i!=null&&i.trackChildChange(Bl(n,s,h)),a.updateImmediateChild(n,s);{i!=null&&i.trackChildChange(Ul(n,h));const _=a.updateImmediateChild(n,ne.EMPTY_NODE);return d!=null&&this.rangedFilter_.matches(d)?(i!=null&&i.trackChildChange(Fa(d.name,d.node)),_.updateImmediateChild(d.name,d.node)):_}}else return s.isEmpty()?e:u&&o(l,c)>=0?(i!=null&&(i.trackChildChange(Ul(l.name,l.node)),i.trackChildChange(Fa(n,s))),a.updateImmediateChild(n,s).updateImmediateChild(l.name,ne.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=He}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return O(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return O(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Sr}hasEnd(){return this.endSet_}getIndexEndValue(){return O(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return O(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Zs}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return O(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===He}copy(){const e=new Nf;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function eB(t){return t.loadsAllData()?new Iy(t.getIndex()):t.hasLimit()?new Z4(t):new Vl(t)}function tB(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function nB(t,e){const n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function fm(t,e,n){const s=t.copy();return s.startSet_=!0,e===void 0&&(e=null),s.indexStartValue_=e,n!=null?(s.startNameSet_=!0,s.indexStartName_=n):(s.startNameSet_=!1,s.indexStartName_=""),s}function sB(t,e,n){let s;if(t.index_===Hs)typeof e=="string"&&(e=d0(e)),s=fm(t,e,n);else{let r;n==null?r=Zs:r=d0(n),s=fm(t,e,r)}return s.startAfterSet_=!0,s}function pm(t,e,n){const s=t.copy();return s.endSet_=!0,e===void 0&&(e=null),s.indexEndValue_=e,n!==void 0?(s.endNameSet_=!0,s.indexEndName_=n):(s.endNameSet_=!1,s.indexEndName_=""),s}function rB(t,e,n){let s,r;return t.index_===Hs?(typeof e=="string"&&(e=f0(e)),r=pm(t,e,n)):(n==null?s=Sr:s=f0(n),r=pm(t,e,s)),r.endBeforeSet_=!0,r}function Pf(t,e){const n=t.copy();return n.index_=e,n}function p0(t){const e={};if(t.isDefault())return e;let n;return t.index_===He?n="$priority":t.index_===by?n="$value":t.index_===Hs?n="$key":(O(t.index_ instanceof wy,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=bt(n),t.startSet_&&(e.startAt=bt(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+bt(t.indexStartName_))),t.endSet_&&(e.endAt=bt(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+bt(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function g0(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==He&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd extends yk{constructor(e,n,s,r){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=s,this.appCheckTokenProvider_=r,this.log_=Au("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(O(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,s,r){const i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);const o=dd.getListenId_(e,s),a={};this.listens_[o]=a;const c=p0(e._queryParams);this.restRequest_(i+".json",c,(l,u)=>{let h=u;if(l===404&&(h=null,l=null),l===null&&this.onDataUpdate_(i,h,!1,s),po(this.listens_,o)===a){let d;l?l===401?d="permission_denied":d="rest_error:"+l:d="ok",r(d,null)}})}unlisten(e,n){const s=dd.getListenId_(e,n);delete this.listens_[s]}get(e){const n=p0(e._queryParams),s=e._path.toString(),r=new wt;return this.restRequest_(s+".json",n,(i,o)=>{let a=o;i===404&&(a=null,i=null),i===null?(this.onDataUpdate_(s,a,!1,null),r.resolve(a)):r.reject(new Error(a))}),r.promise}refreshAuthToken(e){}restRequest_(e,n={},s){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(n.auth=r.accessToken),i&&i.token&&(n.ac=i.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+Uo(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(s&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let c=null;if(a.status>=200&&a.status<300){try{c=xl(a.responseText)}catch{on("Failed to parse JSON response for "+o+": "+a.responseText)}s(null,c)}else a.status!==401&&a.status!==404&&on("Got unsuccessful REST response for "+o+" Status: "+a.status),s(a.status);s=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB{constructor(){this.rootNode_=ne.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fd(){return{value:null,children:new Map}}function uc(t,e,n){if(me(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const s=ge(e);t.children.has(s)||t.children.set(s,fd());const r=t.children.get(s);e=Ue(e),uc(r,e,n)}}function gm(t,e){if(me(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{const n=t.value;return t.value=null,n.forEachChild(He,(s,r)=>{uc(t,new ke(s),r)}),gm(t,e)}}else if(t.children.size>0){const n=ge(e);return e=Ue(e),t.children.has(n)&&gm(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function mm(t,e,n){t.value!==null?n(e,t.value):oB(t,(s,r)=>{const i=new ke(e.toString()+"/"+s);mm(r,i,n)})}function oB(t,e){t.children.forEach((n,s)=>{e(s,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&$t(this.last_,(s,r)=>{n[s]=n[s]-r}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m0=10*1e3,cB=30*1e3,lB=5*60*1e3;class uB{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new aB(e);const s=m0+(cB-m0)*Math.random();il(this.reportStats_.bind(this),Math.floor(s))}reportStats_(){const e=this.statsListener_.get(),n={};let s=!1;$t(e,(r,i)=>{i>0&&Yn(this.statsToReport_,r)&&(n[r]=i,s=!0)}),s&&this.server_.reportStats(n),il(this.reportStats_.bind(this),Math.floor(Math.random()*2*lB))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vs;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(vs||(vs={}));function Ey(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Ty(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Sy(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,n,s){this.path=e,this.affectedTree=n,this.revert=s,this.type=vs.ACK_USER_WRITE,this.source=Ey()}operationForChild(e){if(me(this.path)){if(this.affectedTree.value!=null)return O(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new ke(e));return new pd(Se(),n,this.revert)}}else return O(ge(this.path)===e,"operationForChild called for unrelated child."),new pd(Ue(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ql{constructor(e,n){this.source=e,this.path=n,this.type=vs.LISTEN_COMPLETE}operationForChild(e){return me(this.path)?new ql(this.source,Se()):new ql(this.source,Ue(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yo{constructor(e,n,s){this.source=e,this.path=n,this.snap=s,this.type=vs.OVERWRITE}operationForChild(e){return me(this.path)?new yo(this.source,Se(),this.snap.getImmediateChild(e)):new yo(this.source,Ue(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e,n,s){this.source=e,this.path=n,this.children=s,this.type=vs.MERGE}operationForChild(e){if(me(this.path)){const n=this.children.subtree(new ke(e));return n.isEmpty()?null:n.value?new yo(this.source,Se(),n.value):new $a(this.source,Se(),n)}else return O(ge(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new $a(this.source,Ue(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,n,s){this.node_=e,this.fullyInitialized_=n,this.filtered_=s}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(me(e))return this.isFullyInitialized()&&!this.filtered_;const n=ge(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hB{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function dB(t,e,n,s){const r=[],i=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&i.push(J4(o.childName,o.snapshotNode))}),Pc(t,r,"child_removed",e,s,n),Pc(t,r,"child_added",e,s,n),Pc(t,r,"child_moved",i,s,n),Pc(t,r,"child_changed",e,s,n),Pc(t,r,"value",e,s,n),r}function Pc(t,e,n,s,r,i){const o=s.filter(a=>a.type===n);o.sort((a,c)=>pB(t,a,c)),o.forEach(a=>{const c=fB(t,a,i);r.forEach(l=>{l.respondsTo(a.type)&&e.push(l.createEvent(c,t.query_))})})}function fB(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function pB(t,e,n){if(e.childName==null||n.childName==null)throw sc("Should only compare child_ events.");const s=new _e(e.childName,e.snapshotNode),r=new _e(n.childName,n.snapshotNode);return t.index_.compare(s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Df(t,e){return{eventCache:t,serverCache:e}}function ol(t,e,n,s){return Df(new gi(e,n,s),t.serverCache)}function xk(t,e,n,s){return Df(t.eventCache,new gi(e,n,s))}function gd(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function vo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tg;const gB=()=>(tg||(tg=new Rn(XU)),tg);class qe{constructor(e,n=gB()){this.value=e,this.children=n}static fromObject(e){let n=new qe(null);return $t(e,(s,r)=>{n=n.set(new ke(s),r)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:Se(),value:this.value};if(me(e))return null;{const s=ge(e),r=this.children.get(s);if(r!==null){const i=r.findRootMostMatchingPathAndValue(Ue(e),n);return i!=null?{path:Xe(new ke(s),i.path),value:i.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(me(e))return this;{const n=ge(e),s=this.children.get(n);return s!==null?s.subtree(Ue(e)):new qe(null)}}set(e,n){if(me(e))return new qe(n,this.children);{const s=ge(e),i=(this.children.get(s)||new qe(null)).set(Ue(e),n),o=this.children.insert(s,i);return new qe(this.value,o)}}remove(e){if(me(e))return this.children.isEmpty()?new qe(null):new qe(null,this.children);{const n=ge(e),s=this.children.get(n);if(s){const r=s.remove(Ue(e));let i;return r.isEmpty()?i=this.children.remove(n):i=this.children.insert(n,r),this.value===null&&i.isEmpty()?new qe(null):new qe(this.value,i)}else return this}}get(e){if(me(e))return this.value;{const n=ge(e),s=this.children.get(n);return s?s.get(Ue(e)):null}}setTree(e,n){if(me(e))return n;{const s=ge(e),i=(this.children.get(s)||new qe(null)).setTree(Ue(e),n);let o;return i.isEmpty()?o=this.children.remove(s):o=this.children.insert(s,i),new qe(this.value,o)}}fold(e){return this.fold_(Se(),e)}fold_(e,n){const s={};return this.children.inorderTraversal((r,i)=>{s[r]=i.fold_(Xe(e,r),n)}),n(e,this.value,s)}findOnPath(e,n){return this.findOnPath_(e,Se(),n)}findOnPath_(e,n,s){const r=this.value?s(n,this.value):!1;if(r)return r;if(me(e))return null;{const i=ge(e),o=this.children.get(i);return o?o.findOnPath_(Ue(e),Xe(n,i),s):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,Se(),n)}foreachOnPath_(e,n,s){if(me(e))return this;{this.value&&s(n,this.value);const r=ge(e),i=this.children.get(r);return i?i.foreachOnPath_(Ue(e),Xe(n,r),s):new qe(null)}}foreach(e){this.foreach_(Se(),e)}foreach_(e,n){this.children.inorderTraversal((s,r)=>{r.foreach_(Xe(e,s),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,s)=>{s.value&&e(n,s.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e){this.writeTree_=e}static empty(){return new Ts(new qe(null))}}function al(t,e,n){if(me(e))return new Ts(new qe(n));{const s=t.writeTree_.findRootMostValueAndPath(e);if(s!=null){const r=s.path;let i=s.value;const o=_n(r,e);return i=i.updateChild(o,n),new Ts(t.writeTree_.set(r,i))}else{const r=new qe(n),i=t.writeTree_.setTree(e,r);return new Ts(i)}}}function _m(t,e,n){let s=t;return $t(n,(r,i)=>{s=al(s,Xe(e,r),i)}),s}function _0(t,e){if(me(e))return Ts.empty();{const n=t.writeTree_.setTree(e,new qe(null));return new Ts(n)}}function ym(t,e){return qo(t,e)!=null}function qo(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(_n(n.path,e)):null}function y0(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(He,(s,r)=>{e.push(new _e(s,r))}):t.writeTree_.children.inorderTraversal((s,r)=>{r.value!=null&&e.push(new _e(s,r.value))}),e}function ni(t,e){if(me(e))return t;{const n=qo(t,e);return n!=null?new Ts(new qe(n)):new Ts(t.writeTree_.subtree(e))}}function vm(t){return t.writeTree_.isEmpty()}function Ua(t,e){return Nk(Se(),t.writeTree_,e)}function Nk(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let s=null;return e.children.inorderTraversal((r,i)=>{r===".priority"?(O(i.value!==null,"Priority writes must always be leaf nodes"),s=i.value):n=Nk(Xe(t,r),i,n)}),!n.getChild(t).isEmpty()&&s!==null&&(n=n.updateChild(Xe(t,".priority"),s)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t,e){return Mk(e,t)}function mB(t,e,n,s,r){O(s>t.lastWriteId,"Stacking an older write on top of newer ones"),r===void 0&&(r=!0),t.allWrites.push({path:e,snap:n,writeId:s,visible:r}),r&&(t.visibleWrites=al(t.visibleWrites,e,n)),t.lastWriteId=s}function _B(t,e,n,s){O(s>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:s,visible:!0}),t.visibleWrites=_m(t.visibleWrites,e,n),t.lastWriteId=s}function yB(t,e){for(let n=0;n<t.allWrites.length;n++){const s=t.allWrites[n];if(s.writeId===e)return s}return null}function vB(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);O(n>=0,"removeWrite called with nonexistent writeId.");const s=t.allWrites[n];t.allWrites.splice(n,1);let r=s.visible,i=!1,o=t.allWrites.length-1;for(;r&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&wB(a,s.path)?r=!1:rs(s.path,a.path)&&(i=!0)),o--}if(r){if(i)return bB(t),!0;if(s.snap)t.visibleWrites=_0(t.visibleWrites,s.path);else{const a=s.children;$t(a,c=>{t.visibleWrites=_0(t.visibleWrites,Xe(s.path,c))})}return!0}else return!1}function wB(t,e){if(t.snap)return rs(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&rs(Xe(t.path,n),e))return!0;return!1}function bB(t){t.visibleWrites=Pk(t.allWrites,IB,Se()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function IB(t){return t.visible}function Pk(t,e,n){let s=Ts.empty();for(let r=0;r<t.length;++r){const i=t[r];if(e(i)){const o=i.path;let a;if(i.snap)rs(n,o)?(a=_n(n,o),s=al(s,a,i.snap)):rs(o,n)&&(a=_n(o,n),s=al(s,Se(),i.snap.getChild(a)));else if(i.children){if(rs(n,o))a=_n(n,o),s=_m(s,a,i.children);else if(rs(o,n))if(a=_n(o,n),me(a))s=_m(s,Se(),i.children);else{const c=po(i.children,ge(a));if(c){const l=c.getChild(Ue(a));s=al(s,Se(),l)}}}else throw sc("WriteRecord should have .snap or .children")}}return s}function Dk(t,e,n,s,r){if(!s&&!r){const i=qo(t.visibleWrites,e);if(i!=null)return i;{const o=ni(t.visibleWrites,e);if(vm(o))return n;if(n==null&&!ym(o,Se()))return null;{const a=n||ne.EMPTY_NODE;return Ua(o,a)}}}else{const i=ni(t.visibleWrites,e);if(!r&&vm(i))return n;if(!r&&n==null&&!ym(i,Se()))return null;{const o=function(l){return(l.visible||r)&&(!s||!~s.indexOf(l.writeId))&&(rs(l.path,e)||rs(e,l.path))},a=Pk(t.allWrites,o,e),c=n||ne.EMPTY_NODE;return Ua(a,c)}}}function EB(t,e,n){let s=ne.EMPTY_NODE;const r=qo(t.visibleWrites,e);if(r)return r.isLeafNode()||r.forEachChild(He,(i,o)=>{s=s.updateImmediateChild(i,o)}),s;if(n){const i=ni(t.visibleWrites,e);return n.forEachChild(He,(o,a)=>{const c=Ua(ni(i,new ke(o)),a);s=s.updateImmediateChild(o,c)}),y0(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}else{const i=ni(t.visibleWrites,e);return y0(i).forEach(o=>{s=s.updateImmediateChild(o.name,o.node)}),s}}function TB(t,e,n,s,r){O(s||r,"Either existingEventSnap or existingServerSnap must exist");const i=Xe(e,n);if(ym(t.visibleWrites,i))return null;{const o=ni(t.visibleWrites,i);return vm(o)?r.getChild(n):Ua(o,r.getChild(n))}}function SB(t,e,n,s){const r=Xe(e,n),i=qo(t.visibleWrites,r);if(i!=null)return i;if(s.isCompleteForChild(n)){const o=ni(t.visibleWrites,r);return Ua(o,s.getNode().getImmediateChild(n))}else return null}function CB(t,e){return qo(t.visibleWrites,e)}function kB(t,e,n,s,r,i,o){let a;const c=ni(t.visibleWrites,e),l=qo(c,Se());if(l!=null)a=l;else if(n!=null)a=Ua(c,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],h=o.getCompare(),d=i?a.getReverseIteratorFrom(s,o):a.getIteratorFrom(s,o);let f=d.getNext();for(;f&&u.length<r;)h(f,s)!==0&&u.push(f),f=d.getNext();return u}else return[]}function AB(){return{visibleWrites:Ts.empty(),allWrites:[],lastWriteId:-1}}function md(t,e,n,s){return Dk(t.writeTree,t.treePath,e,n,s)}function Cy(t,e){return EB(t.writeTree,t.treePath,e)}function v0(t,e,n,s){return TB(t.writeTree,t.treePath,e,n,s)}function _d(t,e){return CB(t.writeTree,Xe(t.treePath,e))}function RB(t,e,n,s,r,i){return kB(t.writeTree,t.treePath,e,n,s,r,i)}function ky(t,e,n){return SB(t.writeTree,t.treePath,e,n)}function Ok(t,e){return Mk(Xe(t.treePath,e),t.writeTree)}function Mk(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xB{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,s=e.childName;O(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),O(s!==".priority","Only non-priority child changes can be tracked.");const r=this.changeMap.get(s);if(r){const i=r.type;if(n==="child_added"&&i==="child_removed")this.changeMap.set(s,Bl(s,e.snapshotNode,r.snapshotNode));else if(n==="child_removed"&&i==="child_added")this.changeMap.delete(s);else if(n==="child_removed"&&i==="child_changed")this.changeMap.set(s,Ul(s,r.oldSnap));else if(n==="child_changed"&&i==="child_added")this.changeMap.set(s,Fa(s,e.snapshotNode));else if(n==="child_changed"&&i==="child_changed")this.changeMap.set(s,Bl(s,e.snapshotNode,r.oldSnap));else throw sc("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(s,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{getCompleteChild(e){return null}getChildAfterChild(e,n,s){return null}}const Lk=new NB;class Ay{constructor(e,n,s=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=s}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const s=this.optCompleteServerCache_!=null?new gi(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ky(this.writes_,e,s)}}getChildAfterChild(e,n,s){const r=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:vo(this.viewCache_),i=RB(this.writes_,r,n,1,s,e);return i.length===0?null:i[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t){return{filter:t}}function DB(t,e){O(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),O(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function OB(t,e,n,s,r){const i=new xB;let o,a;if(n.type===vs.OVERWRITE){const l=n;l.source.fromUser?o=wm(t,e,l.path,l.snap,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered()&&!me(l.path),o=yd(t,e,l.path,l.snap,s,r,a,i))}else if(n.type===vs.MERGE){const l=n;l.source.fromUser?o=LB(t,e,l.path,l.children,s,r,i):(O(l.source.fromServer,"Unknown source."),a=l.source.tagged||e.serverCache.isFiltered(),o=bm(t,e,l.path,l.children,s,r,a,i))}else if(n.type===vs.ACK_USER_WRITE){const l=n;l.revert?o=UB(t,e,l.path,s,r,i):o=FB(t,e,l.path,l.affectedTree,s,r,i)}else if(n.type===vs.LISTEN_COMPLETE)o=$B(t,e,n.path,s,i);else throw sc("Unknown operation type: "+n.type);const c=i.getChanges();return MB(e,o,c),{viewCache:o,changes:c}}function MB(t,e,n){const s=e.eventCache;if(s.isFullyInitialized()){const r=s.getNode().isLeafNode()||s.getNode().isEmpty(),i=gd(t);(n.length>0||!t.eventCache.isFullyInitialized()||r&&!s.getNode().equals(i)||!s.getNode().getPriority().equals(i.getPriority()))&&n.push(Rk(gd(e)))}}function Fk(t,e,n,s,r,i){const o=e.eventCache;if(_d(s,n)!=null)return e;{let a,c;if(me(n))if(O(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const l=vo(e),u=l instanceof ne?l:ne.EMPTY_NODE,h=Cy(s,u);a=t.filter.updateFullNode(e.eventCache.getNode(),h,i)}else{const l=md(s,vo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),l,i)}else{const l=ge(n);if(l===".priority"){O(pi(n)===1,"Can't have a priority with additional path components");const u=o.getNode();c=e.serverCache.getNode();const h=v0(s,n,u,c);h!=null?a=t.filter.updatePriority(u,h):a=o.getNode()}else{const u=Ue(n);let h;if(o.isCompleteForChild(l)){c=e.serverCache.getNode();const d=v0(s,n,o.getNode(),c);d!=null?h=o.getNode().getImmediateChild(l).updateChild(u,d):h=o.getNode().getImmediateChild(l)}else h=ky(s,l,e.serverCache);h!=null?a=t.filter.updateChild(o.getNode(),l,h,u,r,i):a=o.getNode()}}return ol(e,a,o.isFullyInitialized()||me(n),t.filter.filtersNodes())}}function yd(t,e,n,s,r,i,o,a){const c=e.serverCache;let l;const u=o?t.filter:t.filter.getIndexedFilter();if(me(n))l=u.updateFullNode(c.getNode(),s,null);else if(u.filtersNodes()&&!c.isFiltered()){const f=c.getNode().updateChild(n,s);l=u.updateFullNode(c.getNode(),f,null)}else{const f=ge(n);if(!c.isCompleteForPath(n)&&pi(n)>1)return e;const p=Ue(n),v=c.getNode().getImmediateChild(f).updateChild(p,s);f===".priority"?l=u.updatePriority(c.getNode(),v):l=u.updateChild(c.getNode(),f,v,p,Lk,null)}const h=xk(e,l,c.isFullyInitialized()||me(n),u.filtersNodes()),d=new Ay(r,h,i);return Fk(t,h,n,r,d,a)}function wm(t,e,n,s,r,i,o){const a=e.eventCache;let c,l;const u=new Ay(r,e,i);if(me(n))l=t.filter.updateFullNode(e.eventCache.getNode(),s,o),c=ol(e,l,!0,t.filter.filtersNodes());else{const h=ge(n);if(h===".priority")l=t.filter.updatePriority(e.eventCache.getNode(),s),c=ol(e,l,a.isFullyInitialized(),a.isFiltered());else{const d=Ue(n),f=a.getNode().getImmediateChild(h);let p;if(me(d))p=s;else{const _=u.getCompleteChild(h);_!=null?my(d)===".priority"&&_.getChild(wk(d)).isEmpty()?p=_:p=_.updateChild(d,s):p=ne.EMPTY_NODE}if(f.equals(p))c=e;else{const _=t.filter.updateChild(a.getNode(),h,p,d,u,o);c=ol(e,_,a.isFullyInitialized(),t.filter.filtersNodes())}}}return c}function w0(t,e){return t.eventCache.isCompleteForChild(e)}function LB(t,e,n,s,r,i,o){let a=e;return s.foreach((c,l)=>{const u=Xe(n,c);w0(e,ge(u))&&(a=wm(t,a,u,l,r,i,o))}),s.foreach((c,l)=>{const u=Xe(n,c);w0(e,ge(u))||(a=wm(t,a,u,l,r,i,o))}),a}function b0(t,e,n){return n.foreach((s,r)=>{e=e.updateChild(s,r)}),e}function bm(t,e,n,s,r,i,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let c=e,l;me(n)?l=s:l=new qe(null).setTree(n,s);const u=e.serverCache.getNode();return l.children.inorderTraversal((h,d)=>{if(u.hasChild(h)){const f=e.serverCache.getNode().getImmediateChild(h),p=b0(t,f,d);c=yd(t,c,new ke(h),p,r,i,o,a)}}),l.children.inorderTraversal((h,d)=>{const f=!e.serverCache.isCompleteForChild(h)&&d.value===void 0;if(!u.hasChild(h)&&!f){const p=e.serverCache.getNode().getImmediateChild(h),_=b0(t,p,d);c=yd(t,c,new ke(h),_,r,i,o,a)}}),c}function FB(t,e,n,s,r,i,o){if(_d(r,n)!=null)return e;const a=e.serverCache.isFiltered(),c=e.serverCache;if(s.value!=null){if(me(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return yd(t,e,n,c.getNode().getChild(n),r,i,a,o);if(me(n)){let l=new qe(null);return c.getNode().forEachChild(Hs,(u,h)=>{l=l.set(new ke(u),h)}),bm(t,e,n,l,r,i,a,o)}else return e}else{let l=new qe(null);return s.foreach((u,h)=>{const d=Xe(n,u);c.isCompleteForPath(d)&&(l=l.set(u,c.getNode().getChild(d)))}),bm(t,e,n,l,r,i,a,o)}}function $B(t,e,n,s,r){const i=e.serverCache,o=xk(e,i.getNode(),i.isFullyInitialized()||me(n),i.isFiltered());return Fk(t,o,n,s,Lk,r)}function UB(t,e,n,s,r,i){let o;if(_d(s,n)!=null)return e;{const a=new Ay(s,e,r),c=e.eventCache.getNode();let l;if(me(n)||ge(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=md(s,vo(e));else{const h=e.serverCache.getNode();O(h instanceof ne,"serverChildren would be complete if leaf node"),u=Cy(s,h)}u=u,l=t.filter.updateFullNode(c,u,i)}else{const u=ge(n);let h=ky(s,u,e.serverCache);h==null&&e.serverCache.isCompleteForChild(u)&&(h=c.getImmediateChild(u)),h!=null?l=t.filter.updateChild(c,u,h,Ue(n),a,i):e.eventCache.getNode().hasChild(u)?l=t.filter.updateChild(c,u,ne.EMPTY_NODE,Ue(n),a,i):l=c,l.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=md(s,vo(e)),o.isLeafNode()&&(l=t.filter.updateFullNode(l,o,i)))}return o=e.serverCache.isFullyInitialized()||_d(s,Se())!=null,ol(e,l,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const s=this.query_._queryParams,r=new Iy(s.getIndex()),i=eB(s);this.processor_=PB(i);const o=n.serverCache,a=n.eventCache,c=r.updateFullNode(ne.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(ne.EMPTY_NODE,a.getNode(),null),u=new gi(c,o.isFullyInitialized(),r.filtersNodes()),h=new gi(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=Df(h,u),this.eventGenerator_=new hB(this.query_)}get query(){return this.query_}}function VB(t){return t.viewCache_.serverCache.getNode()}function qB(t){return gd(t.viewCache_)}function jB(t,e){const n=vo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!me(e)&&!n.getImmediateChild(ge(e)).isEmpty())?n.getChild(e):null}function I0(t){return t.eventRegistrations_.length===0}function KB(t,e){t.eventRegistrations_.push(e)}function E0(t,e,n){const s=[];if(n){O(e==null,"A cancel should cancel all event registrations.");const r=t.query._path;t.eventRegistrations_.forEach(i=>{const o=i.createCancelEvent(n,r);o&&s.push(o)})}if(e){let r=[];for(let i=0;i<t.eventRegistrations_.length;++i){const o=t.eventRegistrations_[i];if(!o.matches(e))r.push(o);else if(e.hasAnyCallback()){r=r.concat(t.eventRegistrations_.slice(i+1));break}}t.eventRegistrations_=r}else t.eventRegistrations_=[];return s}function T0(t,e,n,s){e.type===vs.MERGE&&e.source.queryId!==null&&(O(vo(t.viewCache_),"We should always have a full cache before handling merges"),O(gd(t.viewCache_),"Missing event cache, even though we have a server cache"));const r=t.viewCache_,i=OB(t.processor_,r,e,n,s);return DB(t.processor_,i.viewCache),O(i.viewCache.serverCache.isFullyInitialized()||!r.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=i.viewCache,$k(t,i.changes,i.viewCache.eventCache.getNode(),null)}function HB(t,e){const n=t.viewCache_.eventCache,s=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(He,(i,o)=>{s.push(Fa(i,o))}),n.isFullyInitialized()&&s.push(Rk(n.getNode())),$k(t,s,n.getNode(),e)}function $k(t,e,n,s){const r=s?[s]:t.eventRegistrations_;return dB(t.eventGenerator_,e,n,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vd;class Uk{constructor(){this.views=new Map}}function WB(t){O(!vd,"__referenceConstructor has already been defined"),vd=t}function zB(){return O(vd,"Reference.ts has not been loaded"),vd}function GB(t){return t.views.size===0}function Ry(t,e,n,s){const r=e.source.queryId;if(r!==null){const i=t.views.get(r);return O(i!=null,"SyncTree gave us an op for an invalid query."),T0(i,e,n,s)}else{let i=[];for(const o of t.views.values())i=i.concat(T0(o,e,n,s));return i}}function Bk(t,e,n,s,r){const i=e._queryIdentifier,o=t.views.get(i);if(!o){let a=md(n,r?s:null),c=!1;a?c=!0:s instanceof ne?(a=Cy(n,s),c=!1):(a=ne.EMPTY_NODE,c=!1);const l=Df(new gi(a,c,!1),new gi(s,r,!1));return new BB(e,l)}return o}function QB(t,e,n,s,r,i){const o=Bk(t,e,s,r,i);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),KB(o,n),HB(o,n)}function YB(t,e,n,s){const r=e._queryIdentifier,i=[];let o=[];const a=mi(t);if(r==="default")for(const[c,l]of t.views.entries())o=o.concat(E0(l,n,s)),I0(l)&&(t.views.delete(c),l.query._queryParams.loadsAllData()||i.push(l.query));else{const c=t.views.get(r);c&&(o=o.concat(E0(c,n,s)),I0(c)&&(t.views.delete(r),c.query._queryParams.loadsAllData()||i.push(c.query)))}return a&&!mi(t)&&i.push(new(zB())(e._repo,e._path)),{removed:i,events:o}}function Vk(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function si(t,e){let n=null;for(const s of t.views.values())n=n||jB(s,e);return n}function qk(t,e){if(e._queryParams.loadsAllData())return Mf(t);{const s=e._queryIdentifier;return t.views.get(s)}}function jk(t,e){return qk(t,e)!=null}function mi(t){return Mf(t)!=null}function Mf(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wd;function XB(t){O(!wd,"__referenceConstructor has already been defined"),wd=t}function JB(){return O(wd,"Reference.ts has not been loaded"),wd}let ZB=1;class S0{constructor(e){this.listenProvider_=e,this.syncPointTree_=new qe(null),this.pendingWriteTree_=AB(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function xy(t,e,n,s,r){return mB(t.pendingWriteTree_,e,n,s,r),r?hc(t,new yo(Ey(),e,n)):[]}function eV(t,e,n,s){_B(t.pendingWriteTree_,e,n,s);const r=qe.fromObject(n);return hc(t,new $a(Ey(),e,r))}function Yr(t,e,n=!1){const s=yB(t.pendingWriteTree_,e);if(vB(t.pendingWriteTree_,e)){let i=new qe(null);return s.snap!=null?i=i.set(Se(),!0):$t(s.children,o=>{i=i.set(new ke(o),!0)}),hc(t,new pd(s.path,i,n))}else return[]}function xu(t,e,n){return hc(t,new yo(Ty(),e,n))}function tV(t,e,n){const s=qe.fromObject(n);return hc(t,new $a(Ty(),e,s))}function nV(t,e){return hc(t,new ql(Ty(),e))}function sV(t,e,n){const s=Ny(t,n);if(s){const r=Py(s),i=r.path,o=r.queryId,a=_n(i,e),c=new ql(Sy(o),a);return Dy(t,i,c)}else return[]}function Im(t,e,n,s){const r=e._path,i=t.syncPointTree_.get(r);let o=[];if(i&&(e._queryIdentifier==="default"||jk(i,e))){const a=YB(i,e,n,s);GB(i)&&(t.syncPointTree_=t.syncPointTree_.remove(r));const c=a.removed;o=a.events;const l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,u=t.syncPointTree_.findOnPath(r,(h,d)=>mi(d));if(l&&!u){const h=t.syncPointTree_.subtree(r);if(!h.isEmpty()){const d=aV(h);for(let f=0;f<d.length;++f){const p=d[f],_=p.query,v=Wk(t,p);t.listenProvider_.startListening(cl(_),bd(t,_),v.hashFn,v.onComplete)}}}!u&&c.length>0&&!s&&(l?t.listenProvider_.stopListening(cl(e),null):c.forEach(h=>{const d=t.queryToTagMap.get(Ff(h));t.listenProvider_.stopListening(cl(h),d)})),cV(t,c)}return o}function rV(t,e,n,s){const r=Ny(t,s);if(r!=null){const i=Py(r),o=i.path,a=i.queryId,c=_n(o,e),l=new yo(Sy(a),c,n);return Dy(t,o,l)}else return[]}function iV(t,e,n,s){const r=Ny(t,s);if(r){const i=Py(r),o=i.path,a=i.queryId,c=_n(o,e),l=qe.fromObject(n),u=new $a(Sy(a),c,l);return Dy(t,o,u)}else return[]}function C0(t,e,n){const s=e._path;let r=null,i=!1;t.syncPointTree_.foreachOnPath(s,(h,d)=>{const f=_n(h,s);r=r||si(d,f),i=i||mi(d)});let o=t.syncPointTree_.get(s);o?(i=i||mi(o),r=r||si(o,Se())):(o=new Uk,t.syncPointTree_=t.syncPointTree_.set(s,o));let a;r!=null?a=!0:(a=!1,r=ne.EMPTY_NODE,t.syncPointTree_.subtree(s).foreachChild((d,f)=>{const p=si(f,Se());p&&(r=r.updateImmediateChild(d,p))}));const c=jk(o,e);if(!c&&!e._queryParams.loadsAllData()){const h=Ff(e);O(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const d=lV();t.queryToTagMap.set(h,d),t.tagToQueryMap.set(d,h)}const l=Of(t.pendingWriteTree_,s);let u=QB(o,e,n,l,r,a);if(!c&&!i){const h=qk(o,e);u=u.concat(uV(t,e,h))}return u}function Lf(t,e,n){const r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(o,a)=>{const c=_n(o,e),l=si(a,c);if(l)return l});return Dk(r,e,i,n,!0)}function oV(t,e){const n=e._path;let s=null;t.syncPointTree_.foreachOnPath(n,(l,u)=>{const h=_n(l,n);s=s||si(u,h)});let r=t.syncPointTree_.get(n);r?s=s||si(r,Se()):(r=new Uk,t.syncPointTree_=t.syncPointTree_.set(n,r));const i=s!=null,o=i?new gi(s,!0,!1):null,a=Of(t.pendingWriteTree_,e._path),c=Bk(r,e,a,i?o.getNode():ne.EMPTY_NODE,i);return qB(c)}function hc(t,e){return Kk(e,t.syncPointTree_,null,Of(t.pendingWriteTree_,Se()))}function Kk(t,e,n,s){if(me(t.path))return Hk(t,e,n,s);{const r=e.get(Se());n==null&&r!=null&&(n=si(r,Se()));let i=[];const o=ge(t.path),a=t.operationForChild(o),c=e.children.get(o);if(c&&a){const l=n?n.getImmediateChild(o):null,u=Ok(s,o);i=i.concat(Kk(a,c,l,u))}return r&&(i=i.concat(Ry(r,t,s,n))),i}}function Hk(t,e,n,s){const r=e.get(Se());n==null&&r!=null&&(n=si(r,Se()));let i=[];return e.children.inorderTraversal((o,a)=>{const c=n?n.getImmediateChild(o):null,l=Ok(s,o),u=t.operationForChild(o);u&&(i=i.concat(Hk(u,a,c,l)))}),r&&(i=i.concat(Ry(r,t,s,n))),i}function Wk(t,e){const n=e.query,s=bd(t,n);return{hashFn:()=>(VB(e)||ne.EMPTY_NODE).hash(),onComplete:r=>{if(r==="ok")return s?sV(t,n._path,s):nV(t,n._path);{const i=e4(r,n);return Im(t,n,null,i)}}}}function bd(t,e){const n=Ff(e);return t.queryToTagMap.get(n)}function Ff(t){return t._path.toString()+"$"+t._queryIdentifier}function Ny(t,e){return t.tagToQueryMap.get(e)}function Py(t){const e=t.indexOf("$");return O(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ke(t.substr(0,e))}}function Dy(t,e,n){const s=t.syncPointTree_.get(e);O(s,"Missing sync point for query tag that we're tracking");const r=Of(t.pendingWriteTree_,e);return Ry(s,n,r,null)}function aV(t){return t.fold((e,n,s)=>{if(n&&mi(n))return[Mf(n)];{let r=[];return n&&(r=Vk(n)),$t(s,(i,o)=>{r=r.concat(o)}),r}})}function cl(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(JB())(t._repo,t._path):t}function cV(t,e){for(let n=0;n<e.length;++n){const s=e[n];if(!s._queryParams.loadsAllData()){const r=Ff(s),i=t.queryToTagMap.get(r);t.queryToTagMap.delete(r),t.tagToQueryMap.delete(i)}}}function lV(){return ZB++}function uV(t,e,n){const s=e._path,r=bd(t,e),i=Wk(t,n),o=t.listenProvider_.startListening(cl(e),r,i.hashFn,i.onComplete),a=t.syncPointTree_.subtree(s);if(r)O(!mi(a.value),"If we're adding a query, it shouldn't be shadowed");else{const c=a.fold((l,u,h)=>{if(!me(l)&&u&&mi(u))return[Mf(u).query];{let d=[];return u&&(d=d.concat(Vk(u).map(f=>f.query))),$t(h,(f,p)=>{d=d.concat(p)}),d}});for(let l=0;l<c.length;++l){const u=c[l];t.listenProvider_.stopListening(cl(u),bd(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new Oy(n)}node(){return this.node_}}class My{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=Xe(this.path_,e);return new My(this.syncTree_,n)}node(){return Lf(this.syncTree_,this.path_)}}const hV=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},k0=function(t,e,n){if(!t||typeof t!="object")return t;if(O(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return dV(t[".sv"],e,n);if(typeof t[".sv"]=="object")return fV(t[".sv"],e);O(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},dV=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:O(!1,"Unexpected server value: "+t)}},fV=function(t,e,n){t.hasOwnProperty("increment")||O(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const s=t.increment;typeof s!="number"&&O(!1,"Unexpected increment value: "+s);const r=e.node();if(O(r!==null&&typeof r!="undefined","Expected ChildrenNode.EMPTY_NODE for nulls"),!r.isLeafNode())return s;const o=r.getValue();return typeof o!="number"?s:o+s},zk=function(t,e,n,s){return Fy(e,new My(n,t),s)},Ly=function(t,e,n){return Fy(t,new Oy(e),n)};function Fy(t,e,n){const s=t.getPriority().val(),r=k0(s,e.getImmediateChild(".priority"),n);let i;if(t.isLeafNode()){const o=t,a=k0(o.getValue(),e,n);return a!==o.getValue()||r!==o.getPriority().val()?new Ct(a,et(r)):t}else{const o=t;return i=o,r!==o.getPriority().val()&&(i=i.updatePriority(new Ct(r))),o.forEachChild(He,(a,c)=>{const l=Fy(c,e.getImmediateChild(a),n);l!==c&&(i=i.updateImmediateChild(a,l))}),i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e="",n=null,s={children:{},childCount:0}){this.name=e,this.parent=n,this.node=s}}function $f(t,e){let n=e instanceof ke?e:new ke(e),s=t,r=ge(n);for(;r!==null;){const i=po(s.node.children,r)||{children:{},childCount:0};s=new $y(r,s,i),n=Ue(n),r=ge(n)}return s}function jo(t){return t.node.value}function Uy(t,e){t.node.value=e,Em(t)}function Gk(t){return t.node.childCount>0}function pV(t){return jo(t)===void 0&&!Gk(t)}function Uf(t,e){$t(t.node.children,(n,s)=>{e(new $y(n,t,s))})}function Qk(t,e,n,s){n&&!s&&e(t),Uf(t,r=>{Qk(r,e,!0,s)}),n&&s&&e(t)}function gV(t,e,n){let s=n?t:t.parent;for(;s!==null;){if(e(s))return!0;s=s.parent}return!1}function Nu(t){return new ke(t.parent===null?t.name:Nu(t.parent)+"/"+t.name)}function Em(t){t.parent!==null&&mV(t.parent,t.name,t)}function mV(t,e,n){const s=pV(n),r=Yn(t.node.children,e);s&&r?(delete t.node.children[e],t.node.childCount--,Em(t)):!s&&!r&&(t.node.children[e]=n.node,t.node.childCount++,Em(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _V=/[\[\].#$\/\u0000-\u001F\u007F]/,yV=/[\[\].#$\u0000-\u001F\u007F]/,ng=10*1024*1024,Bf=function(t){return typeof t=="string"&&t.length!==0&&!_V.test(t)},Yk=function(t){return typeof t=="string"&&t.length!==0&&!yV.test(t)},vV=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Yk(t)},jl=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Rf(t)||t&&typeof t=="object"&&Yn(t,".sv")},er=function(t,e,n,s){s&&e===void 0||Pu(Dn(t,"value"),e,n)},Pu=function(t,e,n){const s=n instanceof ke?new P4(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Bi(s));if(typeof e=="function")throw new Error(t+"contains a function "+Bi(s)+" with contents = "+e.toString());if(Rf(e))throw new Error(t+"contains "+e.toString()+" "+Bi(s));if(typeof e=="string"&&e.length>ng/3&&pf(e)>ng)throw new Error(t+"contains a string greater than "+ng+" utf8 bytes "+Bi(s)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let r=!1,i=!1;if($t(e,(o,a)=>{if(o===".value")r=!0;else if(o!==".priority"&&o!==".sv"&&(i=!0,!Bf(o)))throw new Error(t+" contains an invalid key ("+o+") "+Bi(s)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);D4(s,o),Pu(t,a,s),O4(s)}),r&&i)throw new Error(t+' contains ".value" child '+Bi(s)+" in addition to actual children.")}},wV=function(t,e){let n,s;for(n=0;n<e.length;n++){s=e[n];const i=$l(s);for(let o=0;o<i.length;o++)if(!(i[o]===".priority"&&o===i.length-1)){if(!Bf(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+s.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(N4);let r=null;for(n=0;n<e.length;n++){if(s=e[n],r!==null&&rs(r,s))throw new Error(t+"contains a path "+r.toString()+" that is ancestor of another path "+s.toString());r=s}},Xk=function(t,e,n,s){if(s&&e===void 0)return;const r=Dn(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(r+" must be an object containing the children to replace.");const i=[];$t(e,(o,a)=>{const c=new ke(o);if(Pu(r,a,Xe(n,c)),my(c)===".priority"&&!jl(a))throw new Error(r+"contains an invalid value for '"+c.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");i.push(c)}),wV(r,i)},By=function(t,e,n){if(!(n&&e===void 0)){if(Rf(e))throw new Error(Dn(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!jl(e))throw new Error(Dn(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Du=function(t,e,n,s){if(!(s&&n===void 0)&&!Bf(n))throw new Error(Dn(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},Kl=function(t,e,n,s){if(!(s&&n===void 0)&&!Yk(n))throw new Error(Dn(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},bV=function(t,e,n,s){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Kl(t,e,n,s)},is=function(t,e){if(ge(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},Jk=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Bf(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!vV(n))throw new Error(Dn(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IV{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Vf(t,e){let n=null;for(let s=0;s<e.length;s++){const r=e[s],i=r.getPath();n!==null&&!_y(i,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:i}),n.events.push(r)}n&&t.eventLists_.push(n)}function Vy(t,e,n){Vf(t,n),Zk(t,s=>_y(s,e))}function us(t,e,n){Vf(t,n),Zk(t,s=>rs(s,e)||rs(e,s))}function Zk(t,e){t.recursionDepth_++;let n=!0;for(let s=0;s<t.eventLists_.length;s++){const r=t.eventLists_[s];if(r){const i=r.path;e(i)?(EV(t.eventLists_[s]),t.eventLists_[s]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function EV(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const s=n.getEventRunner();ho&&Nt("event: "+n.toString()),lc(s)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e1="repo_interrupt",TV=25;class SV{constructor(e,n,s,r){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=s,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new IV,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=fd(),this.transactionQueueTree_=new $y,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function CV(t,e,n){if(t.stats_=py(t.repoInfo_),t.forceRestClient_||n4())t.server_=new dd(t.repoInfo_,(s,r,i,o)=>{A0(t,s,r,i,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>R0(t,!0),0);else{if(typeof n!="undefined"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{bt(n)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}t.persistentConnection_=new wr(t.repoInfo_,e,(s,r,i,o)=>{A0(t,s,r,i,o)},s=>{R0(t,s)},s=>{kV(t,s)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(s=>{t.server_.refreshAuthToken(s)}),t.appCheckProvider_.addTokenChangeListener(s=>{t.server_.refreshAppCheckToken(s.token)}),t.statsReporter_=a4(t.repoInfo_,()=>new uB(t.stats_,t.server_)),t.infoData_=new iB,t.infoSyncTree_=new S0({startListening:(s,r,i,o)=>{let a=[];const c=t.infoData_.getNode(s._path);return c.isEmpty()||(a=xu(t.infoSyncTree_,s._path,c),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),qy(t,"connected",!1),t.serverSyncTree_=new S0({startListening:(s,r,i,o)=>(t.server_.listen(s,i,r,(a,c)=>{const l=o(a,c);us(t.eventQueue_,s._path,l)}),[]),stopListening:(s,r)=>{t.server_.unlisten(s,r)}})}function t1(t){const n=t.infoData_.getNode(new ke(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Ou(t){return hV({timestamp:t1(t)})}function A0(t,e,n,s,r){t.dataUpdateCount++;const i=new ke(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(r)if(s){const c=Zh(n,l=>et(l));o=iV(t.serverSyncTree_,i,c,r)}else{const c=et(n);o=rV(t.serverSyncTree_,i,c,r)}else if(s){const c=Zh(n,l=>et(l));o=tV(t.serverSyncTree_,i,c)}else{const c=et(n);o=xu(t.serverSyncTree_,i,c)}let a=i;o.length>0&&(a=Ba(t,i)),us(t.eventQueue_,a,o)}function R0(t,e){qy(t,"connected",e),e===!1&&xV(t)}function kV(t,e){$t(e,(n,s)=>{qy(t,n,s)})}function qy(t,e,n){const s=new ke("/.info/"+e),r=et(n);t.infoData_.updateSnapshot(s,r);const i=xu(t.infoSyncTree_,s,r);us(t.eventQueue_,s,i)}function qf(t){return t.nextWriteId_++}function AV(t,e){const n=oV(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(s=>{const r=et(s).withIndex(e._queryParams.getIndex()),i=xu(t.serverSyncTree_,e._path,r);return Vy(t.eventQueue_,e._path,i),Promise.resolve(r)},s=>(dc(t,"get for query "+bt(e)+" failed: "+s),Promise.reject(new Error(s))))}function jy(t,e,n,s,r){dc(t,"set",{path:e.toString(),value:n,priority:s});const i=Ou(t),o=et(n,s),a=Lf(t.serverSyncTree_,e),c=Ly(o,a,i),l=qf(t),u=xy(t.serverSyncTree_,e,c,l,!0);Vf(t.eventQueue_,u),t.server_.put(e.toString(),o.val(!0),(d,f)=>{const p=d==="ok";p||on("set at "+e+" failed: "+d);const _=Yr(t.serverSyncTree_,l,!p);us(t.eventQueue_,e,_),_i(t,r,d,f)});const h=Hy(t,e);Ba(t,h),us(t.eventQueue_,h,[])}function RV(t,e,n,s){dc(t,"update",{path:e.toString(),value:n});let r=!0;const i=Ou(t),o={};if($t(n,(a,c)=>{r=!1,o[a]=zk(Xe(e,a),et(c),t.serverSyncTree_,i)}),r)Nt("update() called with empty data.  Don't do anything."),_i(t,s,"ok",void 0);else{const a=qf(t),c=eV(t.serverSyncTree_,e,o,a);Vf(t.eventQueue_,c),t.server_.merge(e.toString(),n,(l,u)=>{const h=l==="ok";h||on("update at "+e+" failed: "+l);const d=Yr(t.serverSyncTree_,a,!h),f=d.length>0?Ba(t,e):e;us(t.eventQueue_,f,d),_i(t,s,l,u)}),$t(n,l=>{const u=Hy(t,Xe(e,l));Ba(t,u)}),us(t.eventQueue_,e,[])}}function xV(t){dc(t,"onDisconnectEvents");const e=Ou(t),n=fd();mm(t.onDisconnect_,Se(),(r,i)=>{const o=zk(r,i,t.serverSyncTree_,e);uc(n,r,o)});let s=[];mm(n,Se(),(r,i)=>{s=s.concat(xu(t.serverSyncTree_,r,i));const o=Hy(t,r);Ba(t,o)}),t.onDisconnect_=fd(),us(t.eventQueue_,Se(),s)}function NV(t,e,n){t.server_.onDisconnectCancel(e.toString(),(s,r)=>{s==="ok"&&gm(t.onDisconnect_,e),_i(t,n,s,r)})}function x0(t,e,n,s){const r=et(n);t.server_.onDisconnectPut(e.toString(),r.val(!0),(i,o)=>{i==="ok"&&uc(t.onDisconnect_,e,r),_i(t,s,i,o)})}function PV(t,e,n,s,r){const i=et(n,s);t.server_.onDisconnectPut(e.toString(),i.val(!0),(o,a)=>{o==="ok"&&uc(t.onDisconnect_,e,i),_i(t,r,o,a)})}function DV(t,e,n,s){if(Jh(n)){Nt("onDisconnect().update() called with empty data.  Don't do anything."),_i(t,s,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(r,i)=>{r==="ok"&&$t(n,(o,a)=>{const c=et(a);uc(t.onDisconnect_,Xe(e,o),c)}),_i(t,s,r,i)})}function OV(t,e,n){let s;ge(e._path)===".info"?s=C0(t.infoSyncTree_,e,n):s=C0(t.serverSyncTree_,e,n),Vy(t.eventQueue_,e._path,s)}function Tm(t,e,n){let s;ge(e._path)===".info"?s=Im(t.infoSyncTree_,e,n):s=Im(t.serverSyncTree_,e,n),Vy(t.eventQueue_,e._path,s)}function n1(t){t.persistentConnection_&&t.persistentConnection_.interrupt(e1)}function MV(t){t.persistentConnection_&&t.persistentConnection_.resume(e1)}function dc(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),Nt(n,...e)}function _i(t,e,n,s){e&&lc(()=>{if(n==="ok")e(null);else{const r=(n||"error").toUpperCase();let i=r;s&&(i+=": "+s);const o=new Error(i);o.code=r,e(o)}})}function LV(t,e,n,s,r,i){dc(t,"transaction on "+e);const o={path:e,update:n,onComplete:s,status:null,order:YC(),applyLocally:i,retryCount:0,unwatcher:r,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=Ky(t,e,void 0);o.currentInputSnapshot=a;const c=o.update(a.val());if(c===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{Pu("transaction failed: Data returned ",c,o.path),o.status=0;const l=$f(t.transactionQueueTree_,e),u=jo(l)||[];u.push(o),Uy(l,u);let h;typeof c=="object"&&c!==null&&Yn(c,".priority")?(h=po(c,".priority"),O(jl(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):h=(Lf(t.serverSyncTree_,e)||ne.EMPTY_NODE).getPriority().val();const d=Ou(t),f=et(c,h),p=Ly(f,a,d);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=qf(t);const _=xy(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);us(t.eventQueue_,e,_),jf(t,t.transactionQueueTree_)}}function Ky(t,e,n){return Lf(t.serverSyncTree_,e,n)||ne.EMPTY_NODE}function jf(t,e=t.transactionQueueTree_){if(e||Kf(t,e),jo(e)){const n=r1(t,e);O(n.length>0,"Sending zero length transaction queue"),n.every(r=>r.status===0)&&FV(t,Nu(e),n)}else Gk(e)&&Uf(e,n=>{jf(t,n)})}function FV(t,e,n){const s=n.map(l=>l.currentWriteId),r=Ky(t,e,s);let i=r;const o=r.hash();for(let l=0;l<n.length;l++){const u=n[l];O(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const h=_n(e,u.path);i=i.updateChild(h,u.currentOutputSnapshotRaw)}const a=i.val(!0),c=e;t.server_.put(c.toString(),a,l=>{dc(t,"transaction put response",{path:c.toString(),status:l});let u=[];if(l==="ok"){const h=[];for(let d=0;d<n.length;d++)n[d].status=2,u=u.concat(Yr(t.serverSyncTree_,n[d].currentWriteId)),n[d].onComplete&&h.push(()=>n[d].onComplete(null,!0,n[d].currentOutputSnapshotResolved)),n[d].unwatcher();Kf(t,$f(t.transactionQueueTree_,e)),jf(t,t.transactionQueueTree_),us(t.eventQueue_,e,u);for(let d=0;d<h.length;d++)lc(h[d])}else{if(l==="datastale")for(let h=0;h<n.length;h++)n[h].status===3?n[h].status=4:n[h].status=0;else{on("transaction at "+c.toString()+" failed: "+l);for(let h=0;h<n.length;h++)n[h].status=4,n[h].abortReason=l}Ba(t,e)}},o)}function Ba(t,e){const n=s1(t,e),s=Nu(n),r=r1(t,n);return $V(t,r,s),s}function $V(t,e,n){if(e.length===0)return;const s=[];let r=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const c=e[a],l=_n(n,c.path);let u=!1,h;if(O(l!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),c.status===4)u=!0,h=c.abortReason,r=r.concat(Yr(t.serverSyncTree_,c.currentWriteId,!0));else if(c.status===0)if(c.retryCount>=TV)u=!0,h="maxretry",r=r.concat(Yr(t.serverSyncTree_,c.currentWriteId,!0));else{const d=Ky(t,c.path,o);c.currentInputSnapshot=d;const f=e[a].update(d.val());if(f!==void 0){Pu("transaction failed: Data returned ",f,c.path);let p=et(f);typeof f=="object"&&f!=null&&Yn(f,".priority")||(p=p.updatePriority(d.getPriority()));const v=c.currentWriteId,b=Ou(t),N=Ly(p,d,b);c.currentOutputSnapshotRaw=p,c.currentOutputSnapshotResolved=N,c.currentWriteId=qf(t),o.splice(o.indexOf(v),1),r=r.concat(xy(t.serverSyncTree_,c.path,N,c.currentWriteId,c.applyLocally)),r=r.concat(Yr(t.serverSyncTree_,v,!0))}else u=!0,h="nodata",r=r.concat(Yr(t.serverSyncTree_,c.currentWriteId,!0))}us(t.eventQueue_,n,r),r=[],u&&(e[a].status=2,function(d){setTimeout(d,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(h==="nodata"?s.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):s.push(()=>e[a].onComplete(new Error(h),!1,null))))}Kf(t,t.transactionQueueTree_);for(let a=0;a<s.length;a++)lc(s[a]);jf(t,t.transactionQueueTree_)}function s1(t,e){let n,s=t.transactionQueueTree_;for(n=ge(e);n!==null&&jo(s)===void 0;)s=$f(s,n),e=Ue(e),n=ge(e);return s}function r1(t,e){const n=[];return i1(t,e,n),n.sort((s,r)=>s.order-r.order),n}function i1(t,e,n){const s=jo(e);if(s)for(let r=0;r<s.length;r++)n.push(s[r]);Uf(e,r=>{i1(t,r,n)})}function Kf(t,e){const n=jo(e);if(n){let s=0;for(let r=0;r<n.length;r++)n[r].status!==2&&(n[s]=n[r],s++);n.length=s,Uy(e,n.length>0?n:void 0)}Uf(e,s=>{Kf(t,s)})}function Hy(t,e){const n=Nu(s1(t,e)),s=$f(t.transactionQueueTree_,e);return gV(s,r=>{sg(t,r)}),sg(t,s),Qk(s,r=>{sg(t,r)}),n}function sg(t,e){const n=jo(e);if(n){const s=[];let r=[],i=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(O(i===o-1,"All SENT items should be at beginning of queue."),i=o,n[o].status=3,n[o].abortReason="set"):(O(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),r=r.concat(Yr(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&s.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));i===-1?Uy(e,void 0):n.length=i+1,us(t.eventQueue_,Nu(e),r);for(let o=0;o<s.length;o++)lc(s[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UV(t){let e="";const n=t.split("/");for(let s=0;s<n.length;s++)if(n[s].length>0){let r=n[s];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch{}e+="/"+r}return e}function BV(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const s=n.split("=");s.length===2?e[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):on(`Invalid query segment '${n}' in query '${t}'`)}return e}const Sm=function(t,e){const n=VV(t),s=n.namespace;n.domain==="firebase.com"&&Js(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!s||s==="undefined")&&n.domain!=="localhost"&&Js("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||QU();const r=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new hk(n.host,n.secure,s,r,e,"",s!==n.subdomain),path:new ke(n.pathString)}},VV=function(t){let e="",n="",s="",r="",i="",o=!0,a="https",c=443;if(typeof t=="string"){let l=t.indexOf("//");l>=0&&(a=t.substring(0,l-1),t=t.substring(l+2));let u=t.indexOf("/");u===-1&&(u=t.length);let h=t.indexOf("?");h===-1&&(h=t.length),e=t.substring(0,Math.min(u,h)),u<h&&(r=UV(t.substring(u,h)));const d=BV(t.substring(Math.min(t.length,h)));l=e.indexOf(":"),l>=0?(o=a==="https"||a==="wss",c=parseInt(e.substring(l+1),10)):l=e.length;const f=e.slice(0,l);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{const p=e.indexOf(".");s=e.substring(0,p).toLowerCase(),n=e.substring(p+1),i=s}"ns"in d&&(i=d.ns)}return{host:e,port:c,domain:n,subdomain:s,secure:o,scheme:a,pathString:r,namespace:i}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,n,s,r){this.eventType=e,this.eventRegistration=n,this.snapshot=s,this.prevName=r}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+bt(this.snapshot.exportVal())}}class a1{constructor(e,n,s){this.eventRegistration=e,this.error=n,this.path=s}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return O(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qV{constructor(e,n){this._repo=e,this._path=n}cancel(){const e=new wt;return NV(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){is("OnDisconnect.remove",this._path);const e=new wt;return x0(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){is("OnDisconnect.set",this._path),er("OnDisconnect.set",e,this._path,!1);const n=new wt;return x0(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){is("OnDisconnect.setWithPriority",this._path),er("OnDisconnect.setWithPriority",e,this._path,!1),By("OnDisconnect.setWithPriority",n,!1);const s=new wt;return PV(this._repo,this._path,e,n,s.wrapCallback(()=>{})),s.promise}update(e){is("OnDisconnect.update",this._path),Xk("OnDisconnect.update",e,this._path,!1);const n=new wt;return DV(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,n,s,r){this._repo=e,this._path=n,this._queryParams=s,this._orderByCalled=r}get key(){return me(this._path)?null:my(this._path)}get ref(){return new fs(this._repo,this._path)}get _queryIdentifier(){const e=g0(this._queryParams),n=hy(e);return n==="{}"?"default":n}get _queryObject(){return g0(this._queryParams)}isEqual(e){if(e=A(e),!(e instanceof Ln))return!1;const n=this._repo===e._repo,s=_y(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return n&&s&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+x4(this._path)}}function Hf(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Ci(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Hs){const s="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",r="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==Sr)throw new Error(s);if(typeof e!="string")throw new Error(r)}if(t.hasEnd()){if(t.getIndexEndName()!==Zs)throw new Error(s);if(typeof n!="string")throw new Error(r)}}else if(t.getIndex()===He){if(e!=null&&!jl(e)||n!=null&&!jl(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(O(t.getIndex()instanceof wy||t.getIndex()===by,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Wf(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class fs extends Ln{constructor(e,n){super(e,n,new Nf,!1)}get parent(){const e=wk(this._path);return e===null?null:new fs(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class wo{constructor(e,n,s){this._node=e,this.ref=n,this._index=s}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new ke(e),s=Ut(this.ref,e);return new wo(this._node.getChild(n),s,He)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(s,r)=>e(new wo(r,Ut(this.ref,s),He)))}hasChild(e){const n=new ke(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function gt(t,e){return t=A(t),t._checkNotDeleted("ref"),e!==void 0?Ut(t._root,e):t._root}function N0(t,e){t=A(t),t._checkNotDeleted("refFromURL");const n=Sm(e,t._repo.repoInfo_.nodeAdmin);Jk("refFromURL",n);const s=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&s.host!==t._repo.repoInfo_.host&&Js("refFromURL: Host name does not match the current database: (found "+s.host+" but expected "+t._repo.repoInfo_.host+")"),gt(t,n.path.toString())}function Ut(t,e){return t=A(t),ge(t._path)===null?bV("child","path",e,!1):Kl("child","path",e,!1),new fs(t._repo,Xe(t._path,e))}function Va(t,e){t=A(t),is("push",t._path),er("push",e,t._path,!0);const n=t1(t._repo),s=X4(n),r=Ut(t,s),i=Ut(t,s);let o;return e!=null?o=Cs(i,e).then(()=>i):o=Promise.resolve(i),r.then=o.then.bind(o),r.catch=o.then.bind(o,void 0),r}function jV(t){return is("remove",t._path),Cs(t,null)}function Cs(t,e){t=A(t),is("set",t._path),er("set",e,t._path,!1);const n=new wt;return jy(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function KV(t,e){t=A(t),is("setPriority",t._path),By("setPriority",e,!1);const n=new wt;return jy(t._repo,Xe(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function HV(t,e,n){if(is("setWithPriority",t._path),er("setWithPriority",e,t._path,!1),By("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";const s=new wt;return jy(t._repo,t._path,e,n,s.wrapCallback(()=>{})),s.promise}function WV(t,e){Xk("update",e,t._path,!1);const n=new wt;return RV(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function ks(t){return t=A(t),AV(t._repo,t).then(e=>new wo(e,new fs(t._repo,t._path),t._queryParams.getIndex()))}class zf{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const s=n._queryParams.getIndex();return new o1("value",this,new wo(e.snapshotNode,new fs(n._repo,n._path),s))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new a1(this,e,n):null}matches(e){return e instanceof zf?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}class Gf{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new a1(this,e,n):null}createEvent(e,n){O(e.childName!=null,"Child events should have a childName.");const s=Ut(new fs(n._repo,n._path),e.childName),r=n._queryParams.getIndex();return new o1(e.type,this,new wo(e.snapshotNode,s,r),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof Gf?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}}function Mu(t,e,n,s,r){let i;if(typeof s=="object"&&(i=void 0,r=s),typeof s=="function"&&(i=s),r&&r.onlyOnce){const c=n,l=(u,h)=>{Tm(t._repo,t,a),c(u,h)};l.userCallback=n.userCallback,l.context=n.context,n=l}const o=new c1(n,i||void 0),a=e==="value"?new zf(o):new Gf(e,o);return OV(t._repo,t,a),()=>Tm(t._repo,t,a)}function bo(t,e,n,s){return Mu(t,"value",e,n,s)}function P0(t,e,n,s){return Mu(t,"child_added",e,n,s)}function D0(t,e,n,s){return Mu(t,"child_changed",e,n,s)}function O0(t,e,n,s){return Mu(t,"child_moved",e,n,s)}function M0(t,e,n,s){return Mu(t,"child_removed",e,n,s)}function L0(t,e,n){let s=null;const r=n?new c1(n):null;e==="value"?s=new zf(r):e&&(s=new Gf(e,r)),Tm(t._repo,t,s)}class xs{}class l1 extends xs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){er("endAt",this._value,e._path,!0);const n=pm(e._queryParams,this._value,this._key);if(Wf(n),Ci(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ln(e._repo,e._path,n,e._orderByCalled)}}function zV(t,e){return Du("endAt","key",e,!0),new l1(t,e)}class GV extends xs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){er("endBefore",this._value,e._path,!1);const n=rB(e._queryParams,this._value,this._key);if(Wf(n),Ci(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ln(e._repo,e._path,n,e._orderByCalled)}}function QV(t,e){return Du("endBefore","key",e,!0),new GV(t,e)}class u1 extends xs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){er("startAt",this._value,e._path,!0);const n=fm(e._queryParams,this._value,this._key);if(Wf(n),Ci(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ln(e._repo,e._path,n,e._orderByCalled)}}function YV(t=null,e){return Du("startAt","key",e,!0),new u1(t,e)}class XV extends xs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){er("startAfter",this._value,e._path,!1);const n=sB(e._queryParams,this._value,this._key);if(Wf(n),Ci(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ln(e._repo,e._path,n,e._orderByCalled)}}function JV(t,e){return Du("startAfter","key",e,!0),new XV(t,e)}class ZV extends xs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ln(e._repo,e._path,tB(e._queryParams,this._limit),e._orderByCalled)}}function e3(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new ZV(t)}class t3 extends xs{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ln(e._repo,e._path,nB(e._queryParams,this._limit),e._orderByCalled)}}function n3(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new t3(t)}class s3 extends xs{constructor(e){super(),this._path=e}_apply(e){Hf(e,"orderByChild");const n=new ke(this._path);if(me(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const s=new wy(n),r=Pf(e._queryParams,s);return Ci(r),new Ln(e._repo,e._path,r,!0)}}function h1(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return Kl("orderByChild","path",t,!1),new s3(t)}class r3 extends xs{_apply(e){Hf(e,"orderByKey");const n=Pf(e._queryParams,Hs);return Ci(n),new Ln(e._repo,e._path,n,!0)}}function i3(){return new r3}class o3 extends xs{_apply(e){Hf(e,"orderByPriority");const n=Pf(e._queryParams,He);return Ci(n),new Ln(e._repo,e._path,n,!0)}}function a3(){return new o3}class c3 extends xs{_apply(e){Hf(e,"orderByValue");const n=Pf(e._queryParams,by);return Ci(n),new Ln(e._repo,e._path,n,!0)}}function l3(){return new c3}class u3 extends xs{constructor(e,n){super(),this._value=e,this._key=n}_apply(e){if(er("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new l1(this._value,this._key)._apply(new u1(this._value,this._key)._apply(e))}}function d1(t,e){return Du("equalTo","key",e,!0),new u3(t,e)}function ts(t,...e){let n=A(t);for(const s of e)n=s._apply(n);return n}WB(fs);XB(fs);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3="FIREBASE_DATABASE_EMULATOR_HOST",Cm={};let d3=!1;function f3(t,e,n,s){t.repoInfo_=new hk(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),s&&(t.authTokenProvider_=s)}function f1(t,e,n,s,r){let i=s||t.options.databaseURL;i===void 0&&(t.options.projectId||Js("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Nt("Using default host for project ",t.options.projectId),i=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=Sm(i,r),a=o.repoInfo,c,l;typeof process!="undefined"&&process.env&&(l=process.env[h3]),l?(c=!0,i=`http://${l}?ns=${a.namespace}`,o=Sm(i,r),a=o.repoInfo):c=!o.repoInfo.secure;const u=r&&c?new ba(ba.OWNER):new r4(t.name,t.options,e);Jk("Invalid Firebase Database URL",o),me(o.path)||Js("Database URL must point to the root of a Firebase Database (not including a child path).");const h=g3(a,t,u,new s4(t.name,n));return new m3(h,t)}function p3(t,e){const n=Cm[e];(!n||n[t.key]!==t)&&Js(`Database ${e}(${t.repoInfo_}) has already been deleted.`),n1(t),delete n[t.key]}function g3(t,e,n,s){let r=Cm[e.name];r||(r={},Cm[e.name]=r);let i=r[t.toURLString()];return i&&Js("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new SV(t,d3,n,s),r[t.toURLString()]=i,i}class m3{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(CV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new fs(this._repo,Se())),this._rootInternal}_delete(){return this._rootInternal!==null&&(p3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Js("Cannot call "+e+" on a deleted database.")}}function p1(){Ma.IS_TRANSPORT_INITIALIZED&&on("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function _3(){p1(),Qr.forceDisallow()}function y3(){p1(),ns.forceDisallow(),Qr.forceAllow()}function On(t=bu(),e){return ds(t,"database").getImmediate({identifier:e})}function v3(t,e,n,s={}){t=A(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Js("Cannot call useEmulator() after instance has already been initialized.");const r=t._repoInternal;let i;if(r.repoInfo_.nodeAdmin)s.mockUserToken&&Js('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),i=new ba(ba.OWNER);else if(s.mockUserToken){const o=typeof s.mockUserToken=="string"?s.mockUserToken:$_(s.mockUserToken,t.app.options.projectId);i=new ba(o)}f3(r,e,n,i)}function w3(t){t=A(t),t._checkNotDeleted("goOffline"),n1(t._repo)}function b3(t){t=A(t),t._checkNotDeleted("goOnline"),MV(t._repo)}function I3(t,e){JC(t,e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(t){GC(ir),st(new Te("database",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return f1(s,r,i,n)},"PUBLIC").setMultipleInstances(!0)),Ae(Xb,Jb,t),Ae(Xb,Jb,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3={".sv":"timestamp"};function S3(){return T3}function C3(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k3{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}function A3(t,e,n){var s;if(t=A(t),is("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";const r=(s=n==null?void 0:n.applyLocally)!==null&&s!==void 0?s:!0,i=new wt,o=(c,l,u)=>{let h=null;c?i.reject(c):(h=new wo(u,new fs(t._repo,t._path),He),i.resolve(new k3(l,h)))},a=bo(t,()=>{});return LV(t._repo,t._path,e,o,a,r),i.promise}wr.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};wr.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};E3();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R3{constructor(e,n){this._delegate=e,this.firebase=n,td(e,new Te("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),ES(this._delegate)))}_getService(e,n=go){var s;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return!r.isInitialized()&&((s=r.getComponent())===null||s===void 0?void 0:s.instantiationMode)==="EXPLICIT"&&r.initialize(),r.getImmediate({identifier:n})}_removeServiceInstance(e,n=go){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){td(this._delegate,e)}_addOrOverwriteComponent(e){IS(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3={["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance."},F0=new En("app-compat","Firebase",x3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N3(t){const e={},n={__esModule:!0,initializeApp:i,app:r,registerVersion:Ae,setLogLevel:SS,onLog:TS,apps:null,SDK_VERSION:ir,INTERNAL:{registerComponent:a,removeApp:s,useAsService:c,modularAPIs:wL}};n.default=n,Object.defineProperty(n,"apps",{get:o});function s(l){delete e[l]}function r(l){if(l=l||go,!Yn(e,l))throw F0.create("no-app",{appName:l});return e[l]}r.App=t;function i(l,u={}){const h=H_(l,u);if(Yn(e,h.name))return e[h.name];const d=new t(h,n);return e[h.name]=d,d}function o(){return Object.keys(e).map(l=>e[l])}function a(l){const u=l.name,h=u.replace("-compat","");if(st(l)&&l.type==="PUBLIC"){const d=(f=r())=>{if(typeof f[h]!="function")throw F0.create("invalid-app-argument",{appName:u});return f[h]()};l.serviceProps!==void 0&&Rl(d,l.serviceProps),n[h]=d,t.prototype[h]=function(...f){return this._getService.bind(this,u).apply(this,l.multipleInstances?f:[])}}return l.type==="PUBLIC"?n[h]:null}function c(l,u){return u==="serverAuth"?null:u}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g1(){const t=N3(R3);t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:g1,extendNamespace:e,createSubscribe:mS,ErrorFactory:En,deepExtend:Rl});function e(n){Rl(t,n)}return t}const P3=g1();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $0=new rr("@firebase/app-compat"),D3="@firebase/app-compat",O3="0.1.27";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M3(t){Ae(D3,O3,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(YO()&&self.firebase!==void 0){$0.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);const t=self.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&$0.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}const jt=P3;M3();const L3="@firebase/analytics-compat",F3="0.1.11";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e,n){this.app=e,this._delegate=n}logEvent(e,n,s){WC(this._delegate,e,n,s)}setCurrentScreen(e,n){qU(this._delegate,e,n)}setUserId(e,n){jU(this._delegate,e,n)}setUserProperties(e,n){KU(this._delegate,e,n)}setAnalyticsCollectionEnabled(e){HU(this._delegate,e)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var km;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(km||(km={}));/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=t=>{const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("analytics").getImmediate();return new m1(e,n)};function U3(){const t={Analytics:m1,settings:NU,isSupported:VU,EventName:km};jt.INTERNAL.registerComponent(new Te("analytics-compat",$3,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}U3();jt.registerVersion(L3,F3);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _1=new Map,B3={activated:!1,tokenObservers:[]},V3={initialized:!1,enabled:!1};function Bt(t){return _1.get(t)||B3}function As(t,e){_1.set(t,e)}function Qf(){return V3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wy="https://content-firebaseappcheck.googleapis.com/v1",q3="exchangeRecaptchaV3Token",j3="exchangeRecaptchaEnterpriseToken",K3="exchangeDebugToken",U0={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},H3=24*60*60*1e3;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,n,s,r,i){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=s,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}async process(e){this.stop();try{this.pending=new wt,await z3(this.getNextRun(e)),this.pending.resolve(),await this.pending.promise,this.pending=new wt,await this.operation(),this.pending.resolve(),await this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}}function z3(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3={["already-initialized"]:"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.",["use-before-activation"]:"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.",["fetch-network-error"]:"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-parse-error"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status-error"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["recaptcha-error"]:"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},yn=new En("appCheck","AppCheck",G3);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Id(t=!1){var e;return t?(e=self.grecaptcha)===null||e===void 0?void 0:e.enterprise:self.grecaptcha}function y1(t){if(!Bt(t).activated)throw yn.create("use-before-activation",{appName:t.name})}function Q3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function zy(t){const e=Math.round(t/1e3),n=Math.floor(e/(3600*24)),s=Math.floor((e-n*3600*24)/3600),r=Math.floor((e-n*3600*24-s*3600)/60),i=e-n*3600*24-s*3600-r*60;let o="";return n&&(o+=ph(n)+"d:"),s&&(o+=ph(s)+"h:"),o+=ph(r)+"m:"+ph(i)+"s",o}function ph(t){return t===0?"00":t>=10?t.toString():"0"+t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gy({url:t,body:e},n){var s,r;const i={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){const f=await o.getHeartbeatsHeader();f&&(i["X-Firebase-Client"]=f)}const a={method:"POST",body:JSON.stringify(e),headers:i};let c;try{c=await fetch(t,a)}catch(f){throw yn.create("fetch-network-error",{originalErrorMessage:(s=f)===null||s===void 0?void 0:s.message})}if(c.status!==200)throw yn.create("fetch-status-error",{httpStatus:c.status});let l;try{l=await c.json()}catch(f){throw yn.create("fetch-parse-error",{originalErrorMessage:(r=f)===null||r===void 0?void 0:r.message})}const u=l.ttl.match(/^([\d.]+)(s)$/);if(!u||!u[2]||isNaN(Number(u[1])))throw yn.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});const h=Number(u[1])*1e3,d=Date.now();return{token:l.token,expireTimeMillis:d+h,issuedAtTimeMillis:d}}function Y3(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Wy}/projects/${n}/apps/${s}:${q3}?key=${r}`,body:{recaptcha_v3_token:e}}}function X3(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Wy}/projects/${n}/apps/${s}:${j3}?key=${r}`,body:{recaptcha_enterprise_token:e}}}function J3(t,e){const{projectId:n,appId:s,apiKey:r}=t.options;return{url:`${Wy}/projects/${n}/apps/${s}:${K3}?key=${r}`,body:{debug_token:e}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3="firebase-app-check-database",eq=1,Hl="firebase-app-check-store",v1="debug-token";let gh=null;function w1(){return gh||(gh=new Promise((t,e)=>{var n;try{const s=indexedDB.open(Z3,eq);s.onsuccess=r=>{t(r.target.result)},s.onerror=r=>{var i;e(yn.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Hl,{keyPath:"compositeKey"})}}}catch(s){e(yn.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}}),gh)}function tq(t){return I1(E1(t))}function nq(t,e){return b1(E1(t),e)}function sq(t){return b1(v1,t)}function rq(){return I1(v1)}async function b1(t,e){const s=(await w1()).transaction(Hl,"readwrite"),i=s.objectStore(Hl).put({compositeKey:t,value:e});return new Promise((o,a)=>{i.onsuccess=c=>{o()},s.onerror=c=>{var l;a(yn.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})}async function I1(t){const n=(await w1()).transaction(Hl,"readonly"),r=n.objectStore(Hl).get(t);return new Promise((i,o)=>{r.onsuccess=a=>{const c=a.target.result;i(c?c.value:void 0)},n.onerror=a=>{var c;o(yn.create("storage-get",{originalErrorMessage:(c=a.target.error)===null||c===void 0?void 0:c.message}))}})}function E1(t){return`${t.options.appId}-${t.name}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wl=new rr("@firebase/app-check");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iq(t){if(Mn()){let e;try{e=await tq(t)}catch(n){Wl.warn(`Failed to read token from IndexedDB. Error: ${n}`)}return e}}function B0(t,e){return Mn()?nq(t,e).catch(n=>{Wl.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}async function oq(){let t;try{t=await rq()}catch{}if(t)return t;{const e=Q3();return sq(e).catch(n=>Wl.warn(`Failed to persist debug token to IndexedDB. Error: ${n}`)),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(){return Qf().enabled}async function S1(){const t=Qf();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)}function aq(){const t=eM(),e=Qf();if(e.initialized=!0,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN!="string"&&t.FIREBASE_APPCHECK_DEBUG_TOKEN!==!0)return;e.enabled=!0;const n=new wt;e.token=n,typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN=="string"?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(oq())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cq={error:"UNKNOWN_ERROR"};function lq(t){return hf.encodeString(JSON.stringify(t),!1)}async function Ed(t,e=!1){const n=t.app;y1(n);const s=Bt(n);let r=s.token,i;if(!r){const c=await s.cachedTokenPromise;c&&Td(c)&&(r=c)}if(!e&&r&&Td(r))return{token:r.token};let o=!1;if(T1()){s.exchangeTokenPromise||(s.exchangeTokenPromise=Gy(J3(n,await S1()),t.heartbeatServiceProvider).then(l=>(s.exchangeTokenPromise=void 0,l)),o=!0);const c=await s.exchangeTokenPromise;return await B0(n,c),As(n,Object.assign(Object.assign({},s),{token:c})),{token:c.token}}try{s.exchangeTokenPromise||(s.exchangeTokenPromise=s.provider.getToken().then(c=>(s.exchangeTokenPromise=void 0,c)),o=!0),r=await s.exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Wl.warn(c.message):Wl.error(c),i=c}let a;return r?(a={token:r.token},As(n,Object.assign(Object.assign({},s),{token:r})),await B0(n,r)):a=hq(i),o&&C1(n,a),a}function Qy(t,e,n,s){const{app:r}=t,i=Bt(r),o={next:n,error:s,type:e};if(As(r,Object.assign(Object.assign({},i),{tokenObservers:[...i.tokenObservers,o]})),i.token&&Td(i.token)){const a=i.token;Promise.resolve().then(()=>{n({token:a.token}),V0(t)}).catch(()=>{})}i.cachedTokenPromise.then(()=>V0(t))}function Yy(t,e){const n=Bt(t),s=n.tokenObservers.filter(r=>r.next!==e);s.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),As(t,Object.assign(Object.assign({},n),{tokenObservers:s}))}function V0(t){const{app:e}=t,n=Bt(e);let s=n.tokenRefresher;s||(s=uq(t),As(e,Object.assign(Object.assign({},n),{tokenRefresher:s}))),!s.isRunning()&&n.isTokenAutoRefreshEnabled&&s.start()}function uq(t){const{app:e}=t;return new W3(async()=>{const n=Bt(e);let s;if(n.token?s=await Ed(t,!0):s=await Ed(t),s.error)throw s.error},()=>!0,()=>{const n=Bt(e);if(n.token){let s=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5;const r=n.token.expireTimeMillis-5*60*1e3;return s=Math.min(s,r),Math.max(0,s-Date.now())}else return 0},U0.RETRIAL_MIN_WAIT,U0.RETRIAL_MAX_WAIT)}function C1(t,e){const n=Bt(t).tokenObservers;for(const s of n)try{s.type==="EXTERNAL"&&e.error!=null?s.error(e.error):s.next(e)}catch{}}function Td(t){return t.expireTimeMillis-Date.now()>0}function hq(t){return{token:lq(cq),error:t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dq{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){const{tokenObservers:e}=Bt(this.app);for(const n of e)Yy(this.app,n.next);return Promise.resolve()}}function fq(t,e){return new dq(t,e)}function pq(t){return{getToken:e=>Ed(t,e),addTokenListener:e=>Qy(t,"INTERNAL",e),removeTokenListener:e=>Yy(t.app,e)}}const gq="@firebase/app-check",mq="0.5.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _q="https://www.google.com/recaptcha/api.js",yq="https://www.google.com/recaptcha/enterprise.js";function vq(t,e){const n=Bt(t),s=new wt;As(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=k1(t),i=Id(!1);return i?Sd(t,e,i,r,s):Iq(()=>{const o=Id(!1);if(!o)throw new Error("no recaptcha");Sd(t,e,o,r,s)}),s.promise}function wq(t,e){const n=Bt(t),s=new wt;As(t,Object.assign(Object.assign({},n),{reCAPTCHAState:{initialized:s}}));const r=k1(t),i=Id(!0);return i?Sd(t,e,i,r,s):Eq(()=>{const o=Id(!0);if(!o)throw new Error("no recaptcha");Sd(t,e,o,r,s)}),s.promise}function Sd(t,e,n,s,r){n.ready(()=>{bq(t,e,n,s),r.resolve(n)})}function k1(t){const e=`fire_app_check_${t.name}`,n=document.createElement("div");return n.id=e,n.style.display="none",document.body.appendChild(n),e}async function A1(t){y1(t);const n=await Bt(t).reCAPTCHAState.initialized.promise;return new Promise((s,r)=>{const i=Bt(t).reCAPTCHAState;n.ready(()=>{s(n.execute(i.widgetId,{action:"fire_app_check"}))})})}function bq(t,e,n,s){const r=n.render(s,{sitekey:e,size:"invisible"}),i=Bt(t);As(t,Object.assign(Object.assign({},i),{reCAPTCHAState:Object.assign(Object.assign({},i.reCAPTCHAState),{widgetId:r})}))}function Iq(t){const e=document.createElement("script");e.src=_q,e.onload=t,document.head.appendChild(e)}function Eq(t){const e=document.createElement("script");e.src=yq,e.onload=t,document.head.appendChild(e)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;x1(this._throttleData);const n=await A1(this._app).catch(r=>{throw yn.create("recaptcha-error")});let s;try{s=await Gy(Y3(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=R1(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),yn.create("throttled",{time:zy(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=ds(e,"heartbeat"),vq(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof zl?this._siteKey===e._siteKey:!1}}class Yf{constructor(e){this._siteKey=e,this._throttleData=null}async getToken(){var e;x1(this._throttleData);const n=await A1(this._app).catch(r=>{throw yn.create("recaptcha-error")});let s;try{s=await Gy(X3(this._app,n),this._heartbeatServiceProvider)}catch(r){throw r.code==="fetch-status-error"?(this._throttleData=R1(Number((e=r.customData)===null||e===void 0?void 0:e.httpStatus),this._throttleData),yn.create("throttled",{time:zy(this._throttleData.allowRequestsAfter-Date.now()),httpStatus:this._throttleData.httpStatus})):r}return this._throttleData=null,s}initialize(e){this._app=e,this._heartbeatServiceProvider=ds(e,"heartbeat"),wq(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof Yf?this._siteKey===e._siteKey:!1}}class Gl{constructor(e){this._customProviderOptions=e}async getToken(){const e=await this._customProviderOptions.getToken(),n=rM(e.token),s=n!==null&&n<Date.now()&&n>0?n*1e3:Date.now();return Object.assign(Object.assign({},e),{issuedAtTimeMillis:s})}initialize(e){this._app=e}isEqual(e){return e instanceof Gl?this._customProviderOptions.getToken.toString()===e._customProviderOptions.getToken.toString():!1}}function R1(t,e){if(t===404||t===403)return{backoffCount:1,allowRequestsAfter:Date.now()+H3,httpStatus:t};{const n=e?e.backoffCount:0,s=ed(n,1e3,2);return{backoffCount:n+1,allowRequestsAfter:Date.now()+s,httpStatus:t}}}function x1(t){if(t&&Date.now()-t.allowRequestsAfter<=0)throw yn.create("throttled",{time:zy(t.allowRequestsAfter-Date.now()),httpStatus:t.httpStatus})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tq(t=bu(),e){t=A(t);const n=ds(t,"app-check");if(Qf().initialized||aq(),T1()&&S1().then(r=>console.log(`App Check debug token: ${r}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(i.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&i.provider.isEqual(e.provider))return r;throw yn.create("already-initialized",{appName:t.name})}const s=n.initialize({options:e});return Sq(t,e.provider,e.isTokenAutoRefreshEnabled),Bt(t).isTokenAutoRefreshEnabled&&Qy(s,"INTERNAL",()=>{}),s}function Sq(t,e,n){const s=Bt(t),r=Object.assign(Object.assign({},s),{activated:!0});r.provider=e,r.cachedTokenPromise=iq(t).then(i=>(i&&Td(i)&&(As(t,Object.assign(Object.assign({},Bt(t)),{token:i})),C1(t,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=n===void 0?t.automaticDataCollectionEnabled:n,As(t,r),r.provider.initialize(t)}function Cq(t,e){const n=t.app,s=Bt(n);s.tokenRefresher&&(e===!0?s.tokenRefresher.start():s.tokenRefresher.stop()),As(n,Object.assign(Object.assign({},s),{isTokenAutoRefreshEnabled:e}))}async function kq(t,e){const n=await Ed(t,e);if(n.error)throw n.error;return{token:n.token}}function Aq(t,e,n,s){let r=()=>{},i=()=>{};return e.next!=null?r=e.next.bind(e):r=e,e.error!=null?i=e.error.bind(e):n&&(i=n),Qy(t,"EXTERNAL",r,i),()=>Yy(t.app,r)}const Rq="app-check",q0="app-check-internal";function xq(){st(new Te(Rq,t=>{const e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return fq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(q0).initialize()})),st(new Te(q0,t=>{const e=t.getProvider("app-check").getImmediate();return pq(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ae(gq,mq)}xq();const Nq="@firebase/app-check-compat",Pq="0.2.9";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dq={["use-before-activation"]:"App Check is being used before activate() is called for FirebaseApp {$appName}. Call activate() before instantiating other Firebase services."},rg=new En("appCheck","AppCheck",Dq);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oq{constructor(e){this.app=e}activate(e,n){let s;typeof e=="string"?s=new zl(e):e instanceof Yf||e instanceof zl||e instanceof Gl?s=e:s=new Gl({getToken:e.getToken}),this._delegate=Tq(this.app,{provider:s,isTokenAutoRefreshEnabled:n})}setTokenAutoRefreshEnabled(e){if(!this._delegate)throw rg.create("use-before-activation",{appName:this.app.name});Cq(this._delegate,e)}getToken(e){if(!this._delegate)throw rg.create("use-before-activation",{appName:this.app.name});return kq(this._delegate,e)}onTokenChanged(e,n,s){if(!this._delegate)throw rg.create("use-before-activation",{appName:this.app.name});return Aq(this._delegate,e,n)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mq=t=>{const e=t.getProvider("app-compat").getImmediate();return new Oq(e)};function Lq(){jt.INTERNAL.registerComponent(new Te("appCheck-compat",Mq,"PUBLIC").setServiceProps({ReCaptchaEnterpriseProvider:Yf,ReCaptchaV3Provider:zl,CustomProvider:Gl}))}Lq();jt.registerVersion(Nq,Pq);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Io(){return window}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fq=2e3;async function $q(t,e,n){var s;const{BuildInfo:r}=Io();Ss(e.sessionId,"AuthEvent did not contain a session ID");const i=await jq(e.sessionId),o={};return oc()?o.ibi=r.packageName:Eu()?o.apn=r.packageName:Lt(t,"operation-not-supported-in-this-environment"),r.displayName&&(o.appDisplayName=r.displayName),o.sessionId=i,im(t,n,e.type,void 0,(s=e.eventId)!==null&&s!==void 0?s:void 0,o)}async function Uq(t){const{BuildInfo:e}=Io(),n={};oc()?n.iosBundleId=e.packageName:Eu()?n.androidPackageName=e.packageName:Lt(t,"operation-not-supported-in-this-environment"),await wC(t,n)}function Bq(t){const{cordova:e}=Io();return new Promise(n=>{e.plugins.browsertab.isAvailable(s=>{let r=null;s?e.plugins.browsertab.openUrl(t):r=e.InAppBrowser.open(t,qL()?"_blank":"_system","location=yes"),n(r)})})}async function Vq(t,e,n){const{cordova:s}=Io();let r=()=>{};try{await new Promise((i,o)=>{let a=null;function c(){var h;i();const d=(h=s.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof(n==null?void 0:n.close)=="function"&&n.close()}function l(){a||(a=window.setTimeout(()=>{o(Yt(t,"redirect-cancelled-by-user"))},Fq))}function u(){(document==null?void 0:document.visibilityState)==="visible"&&l()}e.addPassiveListener(c),document.addEventListener("resume",l,!1),Eu()&&document.addEventListener("visibilitychange",u,!1),r=()=>{e.removePassiveListener(c),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",u,!1),a&&window.clearTimeout(a)}})}finally{r()}}function qq(t){var e,n,s,r,i,o,a,c,l,u;const h=Io();D(typeof((e=h==null?void 0:h.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),D(typeof((n=h==null?void 0:h.BuildInfo)===null||n===void 0?void 0:n.packageName)!="undefined",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),D(typeof((i=(r=(s=h==null?void 0:h.cordova)===null||s===void 0?void 0:s.plugins)===null||r===void 0?void 0:r.browsertab)===null||i===void 0?void 0:i.openUrl)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((c=(a=(o=h==null?void 0:h.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),D(typeof((u=(l=h==null?void 0:h.cordova)===null||l===void 0?void 0:l.InAppBrowser)===null||u===void 0?void 0:u.open)=="function",t,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function jq(t){const e=Kq(t),n=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(n)).map(r=>r.toString(16).padStart(2,"0")).join("")}function Kq(t){if(Ss(/[0-9a-zA-Z]+/.test(t),"Can only convert alpha-numeric strings"),typeof TextEncoder!="undefined")return new TextEncoder().encode(t);const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let s=0;s<t.length;s++)n[s]=t.charCodeAt(s);return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hq=20;class Wq extends yC{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(n=>n(e)),super.onEvent(e)}async initialized(){await this.initPromise}}function zq(t,e,n=null){return{type:e,eventId:n,urlResponse:null,sessionId:Yq(),postBody:null,tenantId:t.tenantId,error:Yt(t,"no-auth-event")}}function Gq(t,e){return Am()._set(Rm(t),e)}async function j0(t){const e=await Am()._get(Rm(t));return e&&await Am()._remove(Rm(t)),e}function Qq(t,e){var n,s;const r=Jq(e);if(r.includes("/__/auth/callback")){const i=Fh(r),o=i.firebaseError?Xq(decodeURIComponent(i.firebaseError)):null,a=(s=(n=o==null?void 0:o.code)===null||n===void 0?void 0:n.split("auth/"))===null||s===void 0?void 0:s[1],c=a?Yt(a):null;return c?{type:t.type,eventId:t.eventId,tenantId:t.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:t.type,eventId:t.eventId,tenantId:t.tenantId,sessionId:t.sessionId,urlResponse:r,postBody:null}}return null}function Yq(){const t=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<Hq;n++){const s=Math.floor(Math.random()*e.length);t.push(e.charAt(s))}return t.join("")}function Am(){return Hn(If)}function Rm(t){return lo("authEvent",t.config.apiKey,t.name)}function Xq(t){try{return JSON.parse(t)}catch{return null}}function Jq(t){const e=Fh(t),n=e.link?decodeURIComponent(e.link):void 0,s=Fh(n).link,r=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Fh(r).link||r||s||n||t}function Fh(t){if(!(t!=null&&t.includes("?")))return{};const[e,...n]=t.split("?");return ha(n.join("?"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zq=500;class e5{constructor(){this._redirectPersistence=fi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Cf,this._overrideRedirectResult=iy}async _initialize(e){const n=e._key();let s=this.eventManagers.get(n);return s||(s=new Wq(e),this.eventManagers.set(n,s),this.attachCallbackListeners(e,s)),s}_openPopup(e){Lt(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,n,s,r){qq(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),MF(),await this._originValidation(e);const o=zq(e,s,r);await Gq(e,o);const a=await $q(e,o,n),c=await Bq(a);return Vq(e,i,c)}_isIframeWebStorageSupported(e,n){throw new Error("Method not implemented.")}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=Uq(e)),this.originValidationPromises[n]}attachCallbackListeners(e,n){const{universalLinks:s,handleOpenURL:r,BuildInfo:i}=Io(),o=setTimeout(async()=>{await j0(e),n.onEvent(K0())},Zq),a=async u=>{clearTimeout(o);const h=await j0(e);let d=null;h&&(u==null?void 0:u.url)&&(d=Qq(h,u.url)),n.onEvent(d||K0())};typeof s!="undefined"&&typeof s.subscribe=="function"&&s.subscribe(null,a);const c=r,l=`${i.packageName.toLowerCase()}://`;Io().handleOpenURL=async u=>{if(u.toLowerCase().startsWith(l)&&a({url:u}),typeof c=="function")try{c(u)}catch(h){console.error(h)}}}}const t5=e5;function K0(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:Yt("no-auth-event")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n5(t,e){Ft(t)._logFramework(e)}var s5="@firebase/auth-compat",r5="0.2.16";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5=1e3;function ll(){var t;return((t=self==null?void 0:self.location)===null||t===void 0?void 0:t.protocol)||null}function o5(){return ll()==="http:"||ll()==="https:"}function N1(t=Ge()){return!!((ll()==="file:"||ll()==="ionic:"||ll()==="capacitor:")&&t.toLowerCase().match(/iphone|ipad|ipod|android/))}function a5(){return vu()||U_()}function c5(){return B_()&&(document==null?void 0:document.documentMode)===11}function l5(t=Ge()){return/Edge\/\d+/.test(t)}function u5(t=Ge()){return c5()||l5(t)}function P1(){try{const t=self.localStorage,e=Tu();if(t)return t.setItem(e,"1"),t.removeItem(e),u5()?Mn():!0}catch{return Xy()&&Mn()}return!1}function Xy(){return typeof global!="undefined"&&"WorkerGlobalScope"in global&&"importScripts"in global}function ig(){return(o5()||yu()||N1())&&!a5()&&P1()&&!Xy()}function D1(){return N1()&&typeof document!="undefined"}async function h5(){return D1()?new Promise(t=>{const e=setTimeout(()=>{t(!1)},i5);document.addEventListener("deviceready",()=>{clearTimeout(e),t(!0)})}):!1}function d5(){return typeof window!="undefined"?window:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bn={LOCAL:"local",NONE:"none",SESSION:"session"},Dc=D,O1="persistence";function f5(t,e){if(Dc(Object.values(Bn).includes(e),t,"invalid-persistence-type"),vu()){Dc(e!==Bn.SESSION,t,"unsupported-persistence-type");return}if(U_()){Dc(e===Bn.NONE,t,"unsupported-persistence-type");return}if(Xy()){Dc(e===Bn.NONE||e===Bn.LOCAL&&Mn(),t,"unsupported-persistence-type");return}Dc(e===Bn.NONE||P1(),t,"unsupported-persistence-type")}async function xm(t){await t._initializationPromise;const e=M1(),n=lo(O1,t.config.apiKey,t.name);e&&e.setItem(n,t._getPersistence())}function p5(t,e){const n=M1();if(!n)return[];const s=lo(O1,t,e);switch(n.getItem(s)){case Bn.NONE:return[Pa];case Bn.LOCAL:return[Oa,fi];case Bn.SESSION:return[fi];default:return[]}}function M1(){var t;try{return((t=d5())===null||t===void 0?void 0:t.sessionStorage)||null}catch{return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g5=D;class Xr{constructor(){this.browserResolver=Hn(bC),this.cordovaResolver=Hn(t5),this.underlyingResolver=null,this._redirectPersistence=fi,this._completeRedirectFn=Cf,this._overrideRedirectResult=iy}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,n,s,r)}async _openRedirect(e,n,s,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,n,s,r)}_isIframeWebStorageSupported(e,n){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,n)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return D1()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return g5(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await h5();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L1(t){return t.unwrap()}function m5(t){return t.wrapped()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _5(t){return F1(t)}function y5(t,e){var n;const s=(n=e.customData)===null||n===void 0?void 0:n._tokenResponse;if(e.code==="auth/multi-factor-auth-required"){const r=e;r.resolver=new v5(t,B2(t,e))}else if(s){const r=F1(e),i=e;r&&(i.credential=r,i.tenantId=s.tenantId||void 0,i.email=s.email||void 0,i.phoneNumber=s.phoneNumber||void 0)}}function F1(t){const{_tokenResponse:e}=t instanceof lt?t.customData:t;if(!e)return null;if(!(t instanceof lt)&&"temporaryProof"in e&&"phoneNumber"in e)return Es.credentialFromResult(t);const n=e.providerId;if(!n||n===Ac.PASSWORD)return null;let s;switch(n){case Ac.GOOGLE:s=jn;break;case Ac.FACEBOOK:s=qn;break;case Ac.GITHUB:s=Fs;break;case Ac.TWITTER:s=$s;break;default:const{oauthIdToken:r,oauthAccessToken:i,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!i&&!o&&!r&&!a?null:a?n.startsWith("saml.")?Da._create(n,a):Xs._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:r,accessToken:i}):new ya(n).credential({idToken:r,accessToken:i,rawNonce:c})}return t instanceof lt?s.credentialFromError(t):s.credentialFromResult(t)}function Sn(t,e){return e.catch(n=>{throw n instanceof lt&&y5(t,n),n}).then(n=>{const s=n.operationType,r=n.user;return{operationType:s,credential:_5(n),additionalUserInfo:U2(n),user:pr.getOrCreate(r)}})}async function Nm(t,e){const n=await e;return{verificationId:n.verificationId,confirm:s=>Sn(t,n.confirm(s))}}class v5{constructor(e,n){this.resolver=n,this.auth=m5(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Sn(L1(this.auth),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this._delegate=e,this.multiFactor=K2(e)}static getOrCreate(e){return pr.USER_MAP.has(e)||pr.USER_MAP.set(e,new pr(e)),pr.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Sn(this.auth,XS(this._delegate,e))}async linkWithPhoneNumber(e,n){return Nm(this.auth,EF(this._delegate,e,n))}async linkWithPopup(e){return Sn(this.auth,NF(this._delegate,e,Xr))}async linkWithRedirect(e){return await xm(Ft(this.auth)),BF(this._delegate,e,Xr)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Sn(this.auth,JS(this._delegate,e))}reauthenticateWithPhoneNumber(e,n){return Nm(this.auth,TF(this._delegate,e,n))}reauthenticateWithPopup(e){return Sn(this.auth,xF(this._delegate,e,Xr))}async reauthenticateWithRedirect(e){return await xm(Ft(this.auth)),$F(this._delegate,e,Xr)}sendEmailVerification(e){return A2(this._delegate,e)}async unlink(e){return await m2(this._delegate,e),this}updateEmail(e){return P2(this._delegate,e)}updatePassword(e){return D2(this._delegate,e)}updatePhoneNumber(e){return SF(this._delegate,e)}updateProfile(e){return N2(this._delegate,e)}verifyBeforeUpdateEmail(e,n){return R2(this._delegate,e,n)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}pr.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oc=D;class Pm{constructor(e,n){if(this.app=e,n.isInitialized()){this._delegate=n.getImmediate(),this.linkUnderlyingAuth();return}const{apiKey:s}=e.options;Oc(s,"invalid-api-key",{appName:e.name}),Oc(s,"invalid-api-key",{appName:e.name});const r=typeof window!="undefined"?Xr:void 0;this._delegate=n.initialize({options:{persistence:w5(s,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(IL),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?pr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,n){GL(this._delegate,e,n)}applyActionCode(e){return b2(this._delegate,e)}checkActionCode(e){return ZS(this._delegate,e)}confirmPasswordReset(e,n){return w2(this._delegate,e,n)}async createUserWithEmailAndPassword(e,n){return Sn(this._delegate,eC(this._delegate,e,n))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return k2(this._delegate,e)}isSignInWithEmailLink(e){return T2(this._delegate,e)}async getRedirectResult(){Oc(ig(),this._delegate,"operation-not-supported-in-this-environment");const e=await qF(this._delegate,Xr);return e?Sn(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){n5(this._delegate,e)}onAuthStateChanged(e,n,s){const{next:r,error:i,complete:o}=H0(e,n,s);return this._delegate.onAuthStateChanged(r,i,o)}onIdTokenChanged(e,n,s){const{next:r,error:i,complete:o}=H0(e,n,s);return this._delegate.onIdTokenChanged(r,i,o)}sendSignInLinkToEmail(e,n){return E2(this._delegate,e,n)}sendPasswordResetEmail(e,n){return v2(this._delegate,e,n||void 0)}async setPersistence(e){f5(this._delegate,e);let n;switch(e){case Bn.SESSION:n=fi;break;case Bn.LOCAL:n=await Hn(Oa)._isAvailable()?Oa:If;break;case Bn.NONE:n=Pa;break;default:return Lt("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(n)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Sn(this._delegate,g2(this._delegate))}signInWithCredential(e){return Sn(this._delegate,vf(this._delegate,e))}signInWithCustomToken(e){return Sn(this._delegate,y2(this._delegate,e))}signInWithEmailAndPassword(e,n){return Sn(this._delegate,tC(this._delegate,e,n))}signInWithEmailLink(e,n){return Sn(this._delegate,S2(this._delegate,e,n))}signInWithPhoneNumber(e,n){return Nm(this._delegate,IF(this._delegate,e,n))}async signInWithPopup(e){return Oc(ig(),this._delegate,"operation-not-supported-in-this-environment"),Sn(this._delegate,rm(this._delegate,e,Xr))}async signInWithRedirect(e){return Oc(ig(),this._delegate,"operation-not-supported-in-this-environment"),await xm(this._delegate),LF(this._delegate,e,Xr)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return I2(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}Pm.Persistence=Bn;function H0(t,e,n){let s=t;typeof t!="function"&&({next:s,error:e,complete:n}=t);const r=s;return{next:o=>r(o&&pr.getOrCreate(o)),error:e,complete:n}}function w5(t,e){const n=p5(t,e);if(typeof self!="undefined"&&!n.includes(Oa)&&n.push(Oa),typeof window!="undefined")for(const s of[If,fi])n.includes(s)||n.push(s);return n.includes(Pa)||n.push(Pa),n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(){this.providerId="phone",this._delegate=new Es(L1(jt.auth()))}static credential(e,n){return Es.credential(e,n)}verifyPhoneNumber(e,n){return this._delegate.verifyPhoneNumber(e,n)}unwrap(){return this._delegate}}Jy.PHONE_SIGN_IN_METHOD=Es.PHONE_SIGN_IN_METHOD;Jy.PROVIDER_ID=Es.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b5=D;class I5{constructor(e,n,s=jt.app()){var r;b5((r=s.options)===null||r===void 0?void 0:r.apiKey,"invalid-api-key",{appName:s.name}),this._delegate=new wF(e,n,s.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E5="auth-compat";function T5(t){t.INTERNAL.registerComponent(new Te(E5,e=>{const n=e.getProvider("app-compat").getImmediate(),s=e.getProvider("auth");return new Pm(n,s)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Jo.EMAIL_SIGNIN,PASSWORD_RESET:Jo.PASSWORD_RESET,RECOVER_EMAIL:Jo.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:Jo.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:Jo.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:Jo.VERIFY_EMAIL}},EmailAuthProvider:Si,FacebookAuthProvider:qn,GithubAuthProvider:Fs,GoogleAuthProvider:jn,OAuthProvider:ya,SAMLAuthProvider:nd,PhoneAuthProvider:Jy,PhoneMultiFactorGenerator:IC,RecaptchaVerifier:I5,TwitterAuthProvider:$s,Auth:Pm,AuthCredential:ac,Error:lt}).setInstantiationMode("LAZY").setMultipleInstances(!1)),t.registerVersion(s5,r5)}T5(jt);const S5="@firebase/database-compat",C5="0.2.1";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k5=new rr("@firebase/database-compat"),$1=function(t){const e="FIREBASE WARNING: "+t;k5.warn(e)};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A5=function(t,e,n,s){if(!(s&&n===void 0)&&typeof n!="boolean")throw new Error(Dn(t,e)+"must be a boolean.")},R5=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Dn(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e){this._delegate=e}cancel(e){se("OnDisconnect.cancel",0,1,arguments.length),At("OnDisconnect.cancel","onComplete",e,!0);const n=this._delegate.cancel();return e&&n.then(()=>e(null),s=>e(s)),n}remove(e){se("OnDisconnect.remove",0,1,arguments.length),At("OnDisconnect.remove","onComplete",e,!0);const n=this._delegate.remove();return e&&n.then(()=>e(null),s=>e(s)),n}set(e,n){se("OnDisconnect.set",1,2,arguments.length),At("OnDisconnect.set","onComplete",n,!0);const s=this._delegate.set(e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){se("OnDisconnect.setWithPriority",2,3,arguments.length),At("OnDisconnect.setWithPriority","onComplete",s,!0);const r=this._delegate.setWithPriority(e,n);return s&&r.then(()=>s(null),i=>s(i)),r}update(e,n){if(se("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,$1("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}At("OnDisconnect.update","onComplete",n,!0);const s=this._delegate.update(e);return n&&s.then(()=>n(null),r=>n(r)),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N5{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return se("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n){this._database=e,this._delegate=n}val(){return se("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return se("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return se("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return se("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return se("DataSnapshot.child",0,1,arguments.length),e=String(e),Kl("DataSnapshot.child","path",e,!1),new ri(this._database,this._delegate.child(e))}hasChild(e){return se("DataSnapshot.hasChild",1,1,arguments.length),Kl("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return se("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return se("DataSnapshot.forEach",1,1,arguments.length),At("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new ri(this._database,n)))}hasChildren(){return se("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return se("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return se("DataSnapshot.ref",0,0,arguments.length),new Kn(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Wt{constructor(e,n){this.database=e,this._delegate=n}on(e,n,s,r){var i;se("Query.on",2,4,arguments.length),At("Query.on","callback",n,!1);const o=Wt.getCancelAndContextArgs_("Query.on",s,r),a=(l,u)=>{n.call(o.context,new ri(this.database,l),u)};a.userCallback=n,a.context=o.context;const c=(i=o.cancel)===null||i===void 0?void 0:i.bind(o.context);switch(e){case"value":return bo(this._delegate,a,c),n;case"child_added":return P0(this._delegate,a,c),n;case"child_removed":return M0(this._delegate,a,c),n;case"child_changed":return D0(this._delegate,a,c),n;case"child_moved":return O0(this._delegate,a,c),n;default:throw new Error(Dn("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,s){if(se("Query.off",0,3,arguments.length),R5("Query.off",e,!0),At("Query.off","callback",n,!0),Ib("Query.off","context",s,!0),n){const r=()=>{};r.userCallback=n,r.context=s,L0(this._delegate,e,r)}else L0(this._delegate,e)}get(){return ks(this._delegate).then(e=>new ri(this.database,e))}once(e,n,s,r){se("Query.once",1,4,arguments.length),At("Query.once","callback",n,!0);const i=Wt.getCancelAndContextArgs_("Query.once",s,r),o=new wt,a=(l,u)=>{const h=new ri(this.database,l);n&&n.call(i.context,h,u),o.resolve(h)};a.userCallback=n,a.context=i.context;const c=l=>{i.cancel&&i.cancel.call(i.context,l),o.reject(l)};switch(e){case"value":bo(this._delegate,a,c,{onlyOnce:!0});break;case"child_added":P0(this._delegate,a,c,{onlyOnce:!0});break;case"child_removed":M0(this._delegate,a,c,{onlyOnce:!0});break;case"child_changed":D0(this._delegate,a,c,{onlyOnce:!0});break;case"child_moved":O0(this._delegate,a,c,{onlyOnce:!0});break;default:throw new Error(Dn("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return se("Query.limitToFirst",1,1,arguments.length),new Wt(this.database,ts(this._delegate,e3(e)))}limitToLast(e){return se("Query.limitToLast",1,1,arguments.length),new Wt(this.database,ts(this._delegate,n3(e)))}orderByChild(e){return se("Query.orderByChild",1,1,arguments.length),new Wt(this.database,ts(this._delegate,h1(e)))}orderByKey(){return se("Query.orderByKey",0,0,arguments.length),new Wt(this.database,ts(this._delegate,i3()))}orderByPriority(){return se("Query.orderByPriority",0,0,arguments.length),new Wt(this.database,ts(this._delegate,a3()))}orderByValue(){return se("Query.orderByValue",0,0,arguments.length),new Wt(this.database,ts(this._delegate,l3()))}startAt(e=null,n){return se("Query.startAt",0,2,arguments.length),new Wt(this.database,ts(this._delegate,YV(e,n)))}startAfter(e=null,n){return se("Query.startAfter",0,2,arguments.length),new Wt(this.database,ts(this._delegate,JV(e,n)))}endAt(e=null,n){return se("Query.endAt",0,2,arguments.length),new Wt(this.database,ts(this._delegate,zV(e,n)))}endBefore(e=null,n){return se("Query.endBefore",0,2,arguments.length),new Wt(this.database,ts(this._delegate,QV(e,n)))}equalTo(e,n){return se("Query.equalTo",1,2,arguments.length),new Wt(this.database,ts(this._delegate,d1(e,n)))}toString(){return se("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return se("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(se("Query.isEqual",1,1,arguments.length),!(e instanceof Wt)){const n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,s){const r={cancel:void 0,context:void 0};if(n&&s)r.cancel=n,At(e,"cancel",r.cancel,!0),r.context=s,Ib(e,"context",r.context,!0);else if(n)if(typeof n=="object"&&n!==null)r.context=n;else if(typeof n=="function")r.cancel=n;else throw new Error(Dn(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return r}get ref(){return new Kn(this.database,new fs(this._delegate._repo,this._delegate._path))}}class Kn extends Wt{constructor(e,n){super(e,new Ln(n._repo,n._path,new Nf,!1)),this.database=e,this._delegate=n}getKey(){return se("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return se("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new Kn(this.database,Ut(this._delegate,e))}getParent(){se("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Kn(this.database,e):null}getRoot(){return se("Reference.root",0,0,arguments.length),new Kn(this.database,this._delegate.root)}set(e,n){se("Reference.set",1,2,arguments.length),At("Reference.set","onComplete",n,!0);const s=Cs(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}update(e,n){if(se("Reference.update",1,2,arguments.length),Array.isArray(e)){const r={};for(let i=0;i<e.length;++i)r[""+i]=e[i];e=r,$1("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}is("Reference.update",this._delegate._path),At("Reference.update","onComplete",n,!0);const s=WV(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}setWithPriority(e,n,s){se("Reference.setWithPriority",2,3,arguments.length),At("Reference.setWithPriority","onComplete",s,!0);const r=HV(this._delegate,e,n);return s&&r.then(()=>s(null),i=>s(i)),r}remove(e){se("Reference.remove",0,1,arguments.length),At("Reference.remove","onComplete",e,!0);const n=jV(this._delegate);return e&&n.then(()=>e(null),s=>e(s)),n}transaction(e,n,s){se("Reference.transaction",1,3,arguments.length),At("Reference.transaction","transactionUpdate",e,!1),At("Reference.transaction","onComplete",n,!0),A5("Reference.transaction","applyLocally",s,!0);const r=A3(this._delegate,e,{applyLocally:s}).then(i=>new N5(i.committed,new ri(this.database,i.snapshot)));return n&&r.then(i=>n(null,i.committed,i.snapshot),i=>n(i,!1,null)),r}setPriority(e,n){se("Reference.setPriority",1,2,arguments.length),At("Reference.setPriority","onComplete",n,!0);const s=KV(this._delegate,e);return n&&s.then(()=>n(null),r=>n(r)),s}push(e,n){se("Reference.push",0,2,arguments.length),At("Reference.push","onComplete",n,!0);const s=Va(this._delegate,e),r=s.then(o=>new Kn(this.database,o));n&&r.then(()=>n(null),o=>n(o));const i=new Kn(this.database,s);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return is("Reference.onDisconnect",this._delegate._path),new x5(new qV(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:_3,forceLongPolling:y3}}useEmulator(e,n,s={}){v3(this._delegate,e,n,s)}ref(e){if(se("database.ref",0,1,arguments.length),e instanceof Kn){const n=N0(this._delegate,e.toString());return new Kn(this,n)}else{const n=gt(this._delegate,e);return new Kn(this,n)}}refFromURL(e){se("database.refFromURL",1,1,arguments.length);const s=N0(this._delegate,e);return new Kn(this,s)}goOffline(){return se("database.goOffline",0,0,arguments.length),w3(this._delegate)}goOnline(){return se("database.goOnline",0,0,arguments.length),b3(this._delegate)}}Ql.ServerValue={TIMESTAMP:S3(),increment:t=>C3(t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P5({app:t,url:e,version:n,customAuthImpl:s,namespace:r,nodeAdmin:i=!1}){GC(n);const o=new _S("auth-internal",new yS("database-standalone"));return o.setComponent(new Te("auth-internal",()=>s,"PRIVATE")),{instance:new Ql(f1(t,o,void 0,e,i),t),namespace:r}}var D5=Object.freeze({__proto__:null,initStandalone:P5});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O5=Ql.ServerValue;function M5(t){t.INTERNAL.registerComponent(new Te("database-compat",(e,{instanceIdentifier:n})=>{const s=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:n});return new Ql(r,s)},"PUBLIC").setServiceProps({Reference:Kn,Query:Wt,Database:Ql,DataSnapshot:ri,enableLogging:I3,INTERNAL:D5,ServerValue:O5}).setMultipleInstances(!0)),t.registerVersion(S5,C5)}M5(jt);var L5=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},K,Zy=Zy||{},oe=L5||self;function Cd(){}function Dm(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Lu(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function F5(t){return Object.prototype.hasOwnProperty.call(t,og)&&t[og]||(t[og]=++$5)}var og="closure_uid_"+(1e9*Math.random()>>>0),$5=0;function U5(t,e,n){return t.call.apply(t.bind,arguments)}function B5(t,e,n){if(!t)throw Error();if(2<arguments.length){var s=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,s),t.apply(e,r)}}return function(){return t.apply(e,arguments)}}function Jt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Jt=U5:Jt=B5,Jt.apply(null,arguments)}function mh(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var s=n.slice();return s.push.apply(s,arguments),t.apply(this,s)}}function en(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(s,r,i){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[r].apply(s,o)}}function ki(){this.s=this.s,this.o=this.o}var V5=0;ki.prototype.s=!1;ki.prototype.na=function(){!this.s&&(this.s=!0,this.M(),V5!=0)&&F5(this)};ki.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const U1=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},B1=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){const s=t.length,r=typeof t=="string"?t.split(""):t;for(let i=0;i<s;i++)i in r&&e.call(n,r[i],i,t)};function q5(t){e:{var e=Dj;const n=t.length,s=typeof t=="string"?t.split(""):t;for(let r=0;r<n;r++)if(r in s&&e.call(void 0,s[r],r,t)){e=r;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function W0(t){return Array.prototype.concat.apply([],arguments)}function ev(t){const e=t.length;if(0<e){const n=Array(e);for(let s=0;s<e;s++)n[s]=t[s];return n}return[]}function kd(t){return/^[\s\xa0]*$/.test(t)}var z0=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function gn(t,e){return t.indexOf(e)!=-1}function ag(t,e){return t<e?-1:t>e?1:0}var mn;e:{var G0=oe.navigator;if(G0){var Q0=G0.userAgent;if(Q0){mn=Q0;break e}}mn=""}function tv(t,e,n){for(const s in t)e.call(n,t[s],s,t)}function V1(t){const e={};for(const n in t)e[n]=t[n];return e}var Y0="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function q1(t,e){let n,s;for(let r=1;r<arguments.length;r++){s=arguments[r];for(n in s)t[n]=s[n];for(let i=0;i<Y0.length;i++)n=Y0[i],Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}}function nv(t){return nv[" "](t),t}nv[" "]=Cd;function j5(t){var e=W5;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var K5=gn(mn,"Opera"),qa=gn(mn,"Trident")||gn(mn,"MSIE"),j1=gn(mn,"Edge"),Om=j1||qa,K1=gn(mn,"Gecko")&&!(gn(mn.toLowerCase(),"webkit")&&!gn(mn,"Edge"))&&!(gn(mn,"Trident")||gn(mn,"MSIE"))&&!gn(mn,"Edge"),H5=gn(mn.toLowerCase(),"webkit")&&!gn(mn,"Edge");function H1(){var t=oe.document;return t?t.documentMode:void 0}var Ad;e:{var cg="",lg=function(){var t=mn;if(K1)return/rv:([^\);]+)(\)|;)/.exec(t);if(j1)return/Edge\/([\d\.]+)/.exec(t);if(qa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(H5)return/WebKit\/(\S+)/.exec(t);if(K5)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(lg&&(cg=lg?lg[1]:""),qa){var ug=H1();if(ug!=null&&ug>parseFloat(cg)){Ad=String(ug);break e}}Ad=cg}var W5={};function z5(){return j5(function(){let t=0;const e=z0(String(Ad)).split("."),n=z0("9").split("."),s=Math.max(e.length,n.length);for(let o=0;t==0&&o<s;o++){var r=e[o]||"",i=n[o]||"";do{if(r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],r[0].length==0&&i[0].length==0)break;t=ag(r[1].length==0?0:parseInt(r[1],10),i[1].length==0?0:parseInt(i[1],10))||ag(r[2].length==0,i[2].length==0)||ag(r[2],i[2]),r=r[3],i=i[3]}while(t==0)}return 0<=t})}var Mm;if(oe.document&&qa){var X0=H1();Mm=X0||parseInt(Ad,10)||void 0}else Mm=void 0;var G5=Mm,Q5=function(){if(!oe.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{oe.addEventListener("test",Cd,e),oe.removeEventListener("test",Cd,e)}catch{}return t}();function an(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}an.prototype.h=function(){this.defaultPrevented=!0};function Yl(t,e){if(an.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,s=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(K1){e:{try{nv(e.nodeName);var r=!0;break e}catch{}r=!1}r||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,s?(this.clientX=s.clientX!==void 0?s.clientX:s.pageX,this.clientY=s.clientY!==void 0?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:Y5[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Yl.Z.h.call(this)}}en(Yl,an);var Y5={2:"touch",3:"pen",4:"mouse"};Yl.prototype.h=function(){Yl.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Fu="closure_listenable_"+(1e6*Math.random()|0),X5=0;function J5(t,e,n,s,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!s,this.ia=r,this.key=++X5,this.ca=this.fa=!1}function Xf(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function Jf(t){this.src=t,this.g={},this.h=0}Jf.prototype.add=function(t,e,n,s,r){var i=t.toString();t=this.g[i],t||(t=this.g[i]=[],this.h++);var o=Fm(t,e,s,r);return-1<o?(e=t[o],n||(e.fa=!1)):(e=new J5(e,this.src,i,!!s,r),e.fa=n,t.push(e)),e};function Lm(t,e){var n=e.type;if(n in t.g){var s=t.g[n],r=U1(s,e),i;(i=0<=r)&&Array.prototype.splice.call(s,r,1),i&&(Xf(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function Fm(t,e,n,s){for(var r=0;r<t.length;++r){var i=t[r];if(!i.ca&&i.listener==e&&i.capture==!!n&&i.ia==s)return r}return-1}var sv="closure_lm_"+(1e6*Math.random()|0),hg={};function W1(t,e,n,s,r){if(s&&s.once)return G1(t,e,n,s,r);if(Array.isArray(e)){for(var i=0;i<e.length;i++)W1(t,e[i],n,s,r);return null}return n=ov(n),t&&t[Fu]?t.N(e,n,Lu(s)?!!s.capture:!!s,r):z1(t,e,n,!1,s,r)}function z1(t,e,n,s,r,i){if(!e)throw Error("Invalid event type");var o=Lu(r)?!!r.capture:!!r,a=iv(t);if(a||(t[sv]=a=new Jf(t)),n=a.add(e,n,s,o,i),n.proxy)return n;if(s=Z5(),n.proxy=s,s.src=t,s.listener=n,t.addEventListener)Q5||(r=o),r===void 0&&(r=!1),t.addEventListener(e.toString(),s,r);else if(t.attachEvent)t.attachEvent(Y1(e.toString()),s);else if(t.addListener&&t.removeListener)t.addListener(s);else throw Error("addEventListener and attachEvent are unavailable.");return n}function Z5(){function t(n){return e.call(t.src,t.listener,n)}var e=ej;return t}function G1(t,e,n,s,r){if(Array.isArray(e)){for(var i=0;i<e.length;i++)G1(t,e[i],n,s,r);return null}return n=ov(n),t&&t[Fu]?t.O(e,n,Lu(s)?!!s.capture:!!s,r):z1(t,e,n,!0,s,r)}function Q1(t,e,n,s,r){if(Array.isArray(e))for(var i=0;i<e.length;i++)Q1(t,e[i],n,s,r);else s=Lu(s)?!!s.capture:!!s,n=ov(n),t&&t[Fu]?(t=t.i,e=String(e).toString(),e in t.g&&(i=t.g[e],n=Fm(i,n,s,r),-1<n&&(Xf(i[n]),Array.prototype.splice.call(i,n,1),i.length==0&&(delete t.g[e],t.h--)))):t&&(t=iv(t))&&(e=t.g[e.toString()],t=-1,e&&(t=Fm(e,n,s,r)),(n=-1<t?e[t]:null)&&rv(n))}function rv(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Fu])Lm(e.i,t);else{var n=t.type,s=t.proxy;e.removeEventListener?e.removeEventListener(n,s,t.capture):e.detachEvent?e.detachEvent(Y1(n),s):e.addListener&&e.removeListener&&e.removeListener(s),(n=iv(e))?(Lm(n,t),n.h==0&&(n.src=null,e[sv]=null)):Xf(t)}}}function Y1(t){return t in hg?hg[t]:hg[t]="on"+t}function ej(t,e){if(t.ca)t=!0;else{e=new Yl(e,this);var n=t.listener,s=t.ia||t.src;t.fa&&rv(t),t=n.call(s,e)}return t}function iv(t){return t=t[sv],t instanceof Jf?t:null}var dg="__closure_events_fn_"+(1e9*Math.random()>>>0);function ov(t){return typeof t=="function"?t:(t[dg]||(t[dg]=function(e){return t.handleEvent(e)}),t[dg])}function Vt(){ki.call(this),this.i=new Jf(this),this.P=this,this.I=null}en(Vt,ki);Vt.prototype[Fu]=!0;Vt.prototype.removeEventListener=function(t,e,n,s){Q1(this,t,e,n,s)};function Zt(t,e){var n,s=t.I;if(s)for(n=[];s;s=s.I)n.push(s);if(t=t.P,s=e.type||e,typeof e=="string")e=new an(e,t);else if(e instanceof an)e.target=e.target||t;else{var r=e;e=new an(s,t),q1(e,r)}if(r=!0,n)for(var i=n.length-1;0<=i;i--){var o=e.g=n[i];r=_h(o,s,!0,e)&&r}if(o=e.g=t,r=_h(o,s,!0,e)&&r,r=_h(o,s,!1,e)&&r,n)for(i=0;i<n.length;i++)o=e.g=n[i],r=_h(o,s,!1,e)&&r}Vt.prototype.M=function(){if(Vt.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],s=0;s<n.length;s++)Xf(n[s]);delete t.g[e],t.h--}}this.I=null};Vt.prototype.N=function(t,e,n,s){return this.i.add(String(t),e,!1,n,s)};Vt.prototype.O=function(t,e,n,s){return this.i.add(String(t),e,!0,n,s)};function _h(t,e,n,s){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var o=e[i];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&Lm(t.i,o),r=a.call(c,s)!==!1&&r}}return r&&!s.defaultPrevented}var av=oe.JSON.stringify;function tj(){var t=J1;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class nj{constructor(){this.h=this.g=null}add(e,n){const s=X1.get();s.set(e,n),this.h?this.h.next=s:this.g=s,this.h=s}}var X1=new class{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}(()=>new sj,t=>t.reset());class sj{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}}function rj(t){oe.setTimeout(()=>{throw t},0)}function cv(t,e){$m||ij(),Um||($m(),Um=!0),J1.add(t,e)}var $m;function ij(){var t=oe.Promise.resolve(void 0);$m=function(){t.then(oj)}}var Um=!1,J1=new nj;function oj(){for(var t;t=tj();){try{t.h.call(t.g)}catch(n){rj(n)}var e=X1;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Um=!1}function Zf(t,e){Vt.call(this),this.h=t||1,this.g=e||oe,this.j=Jt(this.kb,this),this.l=Date.now()}en(Zf,Vt);K=Zf.prototype;K.da=!1;K.S=null;K.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Zt(this,"tick"),this.da&&(lv(this),this.start()))}};K.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function lv(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}K.M=function(){Zf.Z.M.call(this),lv(this),delete this.g};function uv(t,e,n){if(typeof t=="function")n&&(t=Jt(t,n));else if(t&&typeof t.handleEvent=="function")t=Jt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:oe.setTimeout(t,e||0)}function Z1(t){t.g=uv(()=>{t.g=null,t.i&&(t.i=!1,Z1(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}class aj extends ki{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Z1(this)}M(){super.M(),this.g&&(oe.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Xl(t){ki.call(this),this.h=t,this.g={}}en(Xl,ki);var J0=[];function eA(t,e,n,s){Array.isArray(n)||(n&&(J0[0]=n.toString()),n=J0);for(var r=0;r<n.length;r++){var i=W1(e,n[r],s||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}}function tA(t){tv(t.g,function(e,n){this.g.hasOwnProperty(n)&&rv(e)},t),t.g={}}Xl.prototype.M=function(){Xl.Z.M.call(this),tA(this)};Xl.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ep(){this.g=!0}ep.prototype.Aa=function(){this.g=!1};function cj(t,e,n,s,r,i){t.info(function(){if(t.g)if(i)for(var o="",a=i.split("&"),c=0;c<a.length;c++){var l=a[c].split("=");if(1<l.length){var u=l[0];l=l[1];var h=u.split("_");o=2<=h.length&&h[1]=="type"?o+(u+"="+l+"&"):o+(u+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+s+") [attempt "+r+"]: "+e+`
`+n+`
`+o})}function lj(t,e,n,s,r,i,o){t.info(function(){return"XMLHTTP RESP ("+s+") [ attempt "+r+"]: "+e+`
`+n+`
`+i+" "+o})}function da(t,e,n,s){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+hj(t,n)+(s?" "+s:"")})}function uj(t,e){t.info(function(){return"TIMEOUT: "+e})}ep.prototype.info=function(){};function hj(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var s=n[t];if(!(2>s.length)){var r=s[1];if(Array.isArray(r)&&!(1>r.length)){var i=r[0];if(i!="noop"&&i!="stop"&&i!="close")for(var o=1;o<r.length;o++)r[o]=""}}}}return av(n)}catch{return e}}var Ko={},Z0=null;function tp(){return Z0=Z0||new Vt}Ko.Ma="serverreachability";function nA(t){an.call(this,Ko.Ma,t)}en(nA,an);function Jl(t){const e=tp();Zt(e,new nA(e,t))}Ko.STAT_EVENT="statevent";function sA(t,e){an.call(this,Ko.STAT_EVENT,t),this.stat=e}en(sA,an);function vn(t){const e=tp();Zt(e,new sA(e,t))}Ko.Na="timingevent";function rA(t,e){an.call(this,Ko.Na,t),this.size=e}en(rA,an);function $u(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return oe.setTimeout(function(){t()},e)}var np={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},iA={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function hv(){}hv.prototype.h=null;function eI(t){return t.h||(t.h=t.i())}function oA(){}var Uu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function dv(){an.call(this,"d")}en(dv,an);function fv(){an.call(this,"c")}en(fv,an);var Bm;function sp(){}en(sp,hv);sp.prototype.g=function(){return new XMLHttpRequest};sp.prototype.i=function(){return{}};Bm=new sp;function Bu(t,e,n,s){this.l=t,this.j=e,this.m=n,this.X=s||1,this.V=new Xl(this),this.P=dj,t=Om?125:void 0,this.W=new Zf(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new aA}function aA(){this.i=null,this.g="",this.h=!1}var dj=45e3,Vm={},Rd={};K=Bu.prototype;K.setTimeout=function(t){this.P=t};function qm(t,e,n){t.K=1,t.v=ip(Cr(e)),t.s=n,t.U=!0,cA(t,null)}function cA(t,e){t.F=Date.now(),Vu(t),t.A=Cr(t.v);var n=t.A,s=t.X;Array.isArray(s)||(s=[String(s)]),gA(n.h,"t",s),t.C=0,n=t.l.H,t.h=new aA,t.g=MA(t.l,n?e:null,!t.s),0<t.O&&(t.L=new aj(Jt(t.Ia,t,t.g),t.O)),eA(t.V,t.g,"readystatechange",t.gb),e=t.H?V1(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Jl(1),cj(t.j,t.u,t.A,t.m,t.X,t.s)}K.gb=function(t){t=t.target;const e=this.L;e&&gr(t)==3?e.l():this.Ia(t)};K.Ia=function(t){try{if(t==this.g)e:{const u=gr(this.g);var e=this.g.Da();const h=this.g.ba();if(!(3>u)&&(u!=3||Om||this.g&&(this.h.h||this.g.ga()||rI(this.g)))){this.I||u!=4||e==7||(e==8||0>=h?Jl(3):Jl(2)),rp(this);var n=this.g.ba();this.N=n;t:if(lA(this)){var s=rI(this.g);t="";var r=s.length,i=gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder=="undefined"){no(this),ul(this);var o="";break t}this.h.i=new oe.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(s[e],{stream:i&&e==r-1});s.splice(0,r),this.h.g+=t,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=n==200,lj(this.j,this.u,this.A,this.m,this.X,u,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!kd(a)){var l=a;break t}}l=null}if(n=l)da(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,jm(this,n);else{this.i=!1,this.o=3,vn(12),no(this),ul(this);break e}}this.U?(uA(this,u,o),Om&&this.i&&u==3&&(eA(this.V,this.W,"tick",this.fb),this.W.start())):(da(this.j,this.m,o,null),jm(this,o)),u==4&&no(this),this.i&&!this.I&&(u==4?NA(this.l,this):(this.i=!1,Vu(this)))}else n==400&&0<o.indexOf("Unknown SID")?(this.o=3,vn(12)):(this.o=0,vn(13)),no(this),ul(this)}}}catch{}finally{}};function lA(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function uA(t,e,n){let s=!0,r;for(;!t.I&&t.C<n.length;)if(r=fj(t,n),r==Rd){e==4&&(t.o=4,vn(14),s=!1),da(t.j,t.m,null,"[Incomplete Response]");break}else if(r==Vm){t.o=4,vn(15),da(t.j,t.m,n,"[Invalid Chunk]"),s=!1;break}else da(t.j,t.m,r,null),jm(t,r);lA(t)&&r!=Rd&&r!=Vm&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,vn(16),s=!1),t.i=t.i&&s,s?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Iv(e),e.L=!0,vn(11))):(da(t.j,t.m,n,"[Invalid Chunked Response]"),no(t),ul(t))}K.fb=function(){if(this.g){var t=gr(this.g),e=this.g.ga();this.C<e.length&&(rp(this),uA(this,t,e),this.i&&t!=4&&Vu(this))}};function fj(t,e){var n=t.C,s=e.indexOf(`
`,n);return s==-1?Rd:(n=Number(e.substring(n,s)),isNaN(n)?Vm:(s+=1,s+n>e.length?Rd:(e=e.substr(s,n),t.C=s+n,e)))}K.cancel=function(){this.I=!0,no(this)};function Vu(t){t.Y=Date.now()+t.P,hA(t,t.P)}function hA(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=$u(Jt(t.eb,t),e)}function rp(t){t.B&&(oe.clearTimeout(t.B),t.B=null)}K.eb=function(){this.B=null;const t=Date.now();0<=t-this.Y?(uj(this.j,this.A),this.K!=2&&(Jl(3),vn(17)),no(this),this.o=2,ul(this)):hA(this,this.Y-t)};function ul(t){t.l.G==0||t.I||NA(t.l,t)}function no(t){rp(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,lv(t.W),tA(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function jm(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||Km(n.i,t))){if(n.I=t.N,!t.J&&Km(n.i,t)&&n.G==3){try{var s=n.Ca.g.parse(e)}catch{s=null}if(Array.isArray(s)&&s.length==3){var r=s;if(r[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)Dd(n),cp(n);else break e;bv(n),vn(18)}}else n.ta=r[1],0<n.ta-n.U&&37500>r[2]&&n.N&&n.A==0&&!n.v&&(n.v=$u(Jt(n.ab,n),6e3));if(1>=yA(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else so(n,11)}else if((t.J||n.g==t)&&Dd(n),!kd(e))for(r=n.Ca.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(n.U=l[0],l=l[1],n.G==2)if(l[0]=="c"){n.J=l[1],n.la=l[2];const u=l[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));const h=l[4];h!=null&&(n.za=h,n.h.info("SVER="+n.za));const d=l[5];d!=null&&typeof d=="number"&&0<d&&(s=1.5*d,n.K=s,n.h.info("backChannelRequestTimeoutMs_="+s)),s=n;const f=t.g;if(f){const p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var i=s.i;!i.g&&(gn(p,"spdy")||gn(p,"quic")||gn(p,"h2"))&&(i.j=i.l,i.g=new Set,i.h&&(mv(i,i.h),i.h=null))}if(s.D){const _=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;_&&(s.sa=_,Ye(s.F,s.D,_))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),s=n;var o=t;if(s.oa=OA(s,s.H?s.la:null,s.W),o.J){vA(s.i,o);var a=o,c=s.K;c&&a.setTimeout(c),a.B&&(rp(a),Vu(a)),s.g=o}else RA(s);0<n.l.length&&lp(n)}else l[0]!="stop"&&l[0]!="close"||so(n,7);else n.G==3&&(l[0]=="stop"||l[0]=="close"?l[0]=="stop"?so(n,7):wv(n):l[0]!="noop"&&n.j&&n.j.wa(l),n.A=0)}}Jl(4)}catch{}}function pj(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(Dm(t)){for(var e=[],n=t.length,s=0;s<n;s++)e.push(t[s]);return e}e=[],n=0;for(s in t)e[n++]=t[s];return e}function pv(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Dm(t)||typeof t=="string")B1(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(Dm(t)||typeof t=="string"){n=[];for(var s=t.length,r=0;r<s;r++)n.push(r)}else for(r in n=[],s=0,t)n[s++]=r;s=pj(t),r=s.length;for(var i=0;i<r;i++)e.call(void 0,s[i],n&&n[i],t)}}function fc(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var s=0;s<n;s+=2)this.set(arguments[s],arguments[s+1])}else if(t)if(t instanceof fc)for(n=t.T(),s=0;s<n.length;s++)this.set(n[s],t.get(n[s]));else for(s in t)this.set(s,t[s])}K=fc.prototype;K.R=function(){gv(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};K.T=function(){return gv(this),this.g.concat()};function gv(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var s=t.g[e];Eo(t.h,s)&&(t.g[n++]=s),e++}t.g.length=n}if(t.i!=t.g.length){var r={};for(n=e=0;e<t.g.length;)s=t.g[e],Eo(r,s)||(t.g[n++]=s,r[s]=1),e++;t.g.length=n}}K.get=function(t,e){return Eo(this.h,t)?this.h[t]:e};K.set=function(t,e){Eo(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};K.forEach=function(t,e){for(var n=this.T(),s=0;s<n.length;s++){var r=n[s],i=this.get(r);t.call(e,i,r,this)}};function Eo(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var dA=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gj(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var s=t[n].indexOf("="),r=null;if(0<=s){var i=t[n].substring(0,s);r=t[n].substring(s+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function To(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof To){this.g=e!==void 0?e:t.g,xd(this,t.j),this.s=t.s,Nd(this,t.i),Pd(this,t.m),this.l=t.l,e=t.h;var n=new Zl;n.i=e.i,e.g&&(n.g=new fc(e.g),n.h=e.h),tI(this,n),this.o=t.o}else t&&(n=String(t).match(dA))?(this.g=!!e,xd(this,n[1]||"",!0),this.s=hl(n[2]||""),Nd(this,n[3]||"",!0),Pd(this,n[4]),this.l=hl(n[5]||"",!0),tI(this,n[6]||"",!0),this.o=hl(n[7]||"")):(this.g=!!e,this.h=new Zl(null,this.g))}To.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Gc(e,nI,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Gc(e,nI,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Gc(n,n.charAt(0)=="/"?wj:vj,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Gc(n,Ij)),t.join("")};function Cr(t){return new To(t)}function xd(t,e,n){t.j=n?hl(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Nd(t,e,n){t.i=n?hl(e,!0):e}function Pd(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function tI(t,e,n){e instanceof Zl?(t.h=e,Ej(t.h,t.g)):(n||(e=Gc(e,bj)),t.h=new Zl(e,t.g))}function Ye(t,e,n){t.h.set(e,n)}function ip(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function mj(t){return t instanceof To?Cr(t):new To(t,void 0)}function _j(t,e,n,s){var r=new To(null,void 0);return t&&xd(r,t),e&&Nd(r,e),n&&Pd(r,n),s&&(r.l=s),r}function hl(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Gc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,yj),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function yj(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var nI=/[#\/\?@]/g,vj=/[#\?:]/g,wj=/[#\?]/g,bj=/[#\?@]/g,Ij=/#/g;function Zl(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function Ai(t){t.g||(t.g=new fc,t.h=0,t.i&&gj(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}K=Zl.prototype;K.add=function(t,e){Ai(this),this.i=null,t=pc(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function fA(t,e){Ai(t),e=pc(t,e),Eo(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,Eo(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&gv(t)))}function pA(t,e){return Ai(t),e=pc(t,e),Eo(t.g.h,e)}K.forEach=function(t,e){Ai(this),this.g.forEach(function(n,s){B1(n,function(r){t.call(e,r,s,this)},this)},this)};K.T=function(){Ai(this);for(var t=this.g.R(),e=this.g.T(),n=[],s=0;s<e.length;s++)for(var r=t[s],i=0;i<r.length;i++)n.push(e[s]);return n};K.R=function(t){Ai(this);var e=[];if(typeof t=="string")pA(this,t)&&(e=W0(e,this.g.get(pc(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=W0(e,t[n])}return e};K.set=function(t,e){return Ai(this),this.i=null,t=pc(this,t),pA(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};K.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function gA(t,e,n){fA(t,e),0<n.length&&(t.i=null,t.g.set(pc(t,e),ev(n)),t.h+=n.length)}K.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var s=e[n],r=encodeURIComponent(String(s));s=this.R(s);for(var i=0;i<s.length;i++){var o=r;s[i]!==""&&(o+="="+encodeURIComponent(String(s[i]))),t.push(o)}}return this.i=t.join("&")};function pc(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Ej(t,e){e&&!t.j&&(Ai(t),t.i=null,t.g.forEach(function(n,s){var r=s.toLowerCase();s!=r&&(fA(this,s),gA(this,r,n))},t)),t.j=e}var Tj=class{constructor(t,e){this.h=t,this.g=e}};function mA(t){this.l=t||Sj,oe.PerformanceNavigationTiming?(t=oe.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(oe.g&&oe.g.Ea&&oe.g.Ea()&&oe.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var Sj=10;function _A(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function yA(t){return t.h?1:t.g?t.g.size:0}function Km(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function mv(t,e){t.g?t.g.add(e):t.h=e}function vA(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}mA.prototype.cancel=function(){if(this.i=wA(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const t of this.g.values())t.cancel();this.g.clear()}};function wA(t){if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){let e=t.i;for(const n of t.g.values())e=e.concat(n.D);return e}return ev(t.i)}function _v(){}_v.prototype.stringify=function(t){return oe.JSON.stringify(t,void 0)};_v.prototype.parse=function(t){return oe.JSON.parse(t,void 0)};function Cj(){this.g=new _v}function kj(t,e,n){const s=n||"";try{pv(t,function(r,i){let o=r;Lu(r)&&(o=av(r)),e.push(s+i+"="+encodeURIComponent(o))})}catch(r){throw e.push(s+"type="+encodeURIComponent("_badmap")),r}}function Aj(t,e){const n=new ep;if(oe.Image){const s=new Image;s.onload=mh(yh,n,s,"TestLoadImage: loaded",!0,e),s.onerror=mh(yh,n,s,"TestLoadImage: error",!1,e),s.onabort=mh(yh,n,s,"TestLoadImage: abort",!1,e),s.ontimeout=mh(yh,n,s,"TestLoadImage: timeout",!1,e),oe.setTimeout(function(){s.ontimeout&&s.ontimeout()},1e4),s.src=t}else e(!1)}function yh(t,e,n,s,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(s)}catch{}}function qu(t){this.l=t.$b||null,this.j=t.ib||!1}en(qu,hv);qu.prototype.g=function(){return new op(this.l,this.j)};qu.prototype.i=function(t){return function(){return t}}({});function op(t,e){Vt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=yv,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}en(op,Vt);var yv=0;K=op.prototype;K.open=function(t,e){if(this.readyState!=yv)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,eu(this)};K.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||oe).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};K.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ju(this)),this.readyState=yv};K.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,eu(this)),this.g&&(this.readyState=3,eu(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof oe.ReadableStream!="undefined"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bA(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function bA(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}K.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?ju(this):eu(this),this.readyState==3&&bA(this)}};K.Ua=function(t){this.g&&(this.response=this.responseText=t,ju(this))};K.Ta=function(t){this.g&&(this.response=t,ju(this))};K.ha=function(){this.g&&ju(this)};function ju(t){t.readyState=4,t.l=null,t.j=null,t.A=null,eu(t)}K.setRequestHeader=function(t,e){this.v.append(t,e)};K.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};K.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function eu(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(op.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var Rj=oe.JSON.parse;function mt(t){Vt.call(this),this.headers=new fc,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=IA,this.K=this.L=!1}en(mt,Vt);var IA="",xj=/^https?$/i,Nj=["POST","PUT"];K=mt.prototype;K.ea=function(t,e,n,s){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Bm.g(),this.C=this.u?eI(this.u):eI(Bm),this.g.onreadystatechange=Jt(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(i){sI(this,i);return}t=n||"";const r=new fc(this.headers);s&&pv(s,function(i,o){r.set(o,i)}),s=q5(r.T()),n=oe.FormData&&t instanceof oe.FormData,!(0<=U1(Nj,e))||s||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),r.forEach(function(i,o){this.g.setRequestHeader(o,i)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{SA(this),0<this.B&&((this.K=Pj(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Jt(this.pa,this)):this.A=uv(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(i){sI(this,i)}};function Pj(t){return qa&&z5()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function Dj(t){return t.toLowerCase()=="content-type"}K.pa=function(){typeof Zy!="undefined"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Zt(this,"timeout"),this.abort(8))};function sI(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,EA(t),ap(t)}function EA(t){t.D||(t.D=!0,Zt(t,"complete"),Zt(t,"error"))}K.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Zt(this,"complete"),Zt(this,"abort"),ap(this))};K.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),ap(this,!0)),mt.Z.M.call(this)};K.Fa=function(){this.s||(this.F||this.v||this.l?TA(this):this.cb())};K.cb=function(){TA(this)};function TA(t){if(t.h&&typeof Zy!="undefined"&&(!t.C[1]||gr(t)!=4||t.ba()!=2)){if(t.v&&gr(t)==4)uv(t.Fa,0,t);else if(Zt(t,"readystatechange"),gr(t)==4){t.h=!1;try{const a=t.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var s;if(s=a===0){var r=String(t.H).match(dA)[1]||null;if(!r&&oe.self&&oe.self.location){var i=oe.self.location.protocol;r=i.substr(0,i.length-1)}s=!xj.test(r?r.toLowerCase():"")}n=s}if(n)Zt(t,"complete"),Zt(t,"success");else{t.m=6;try{var o=2<gr(t)?t.g.statusText:""}catch{o=""}t.j=o+" ["+t.ba()+"]",EA(t)}}finally{ap(t)}}}}function ap(t,e){if(t.g){SA(t);const n=t.g,s=t.C[0]?Cd:null;t.g=null,t.C=null,e||Zt(t,"ready");try{n.onreadystatechange=s}catch{}}}function SA(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(oe.clearTimeout(t.A),t.A=null)}function gr(t){return t.g?t.g.readyState:0}K.ba=function(){try{return 2<gr(this)?this.g.status:-1}catch{return-1}};K.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};K.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),Rj(e)}};function rI(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case IA:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}K.Da=function(){return this.m};K.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function Oj(t){let e="";return tv(t,function(n,s){e+=s,e+=":",e+=n,e+=`\r
`}),e}function vv(t,e,n){e:{for(s in n){var s=!1;break e}s=!0}s||(n=Oj(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ye(t,e,n))}function Mc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function CA(t){this.za=0,this.l=[],this.h=new ep,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Mc("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Mc("baseRetryDelayMs",5e3,t),this.$a=Mc("retryDelaySeedMs",1e4,t),this.Ya=Mc("forwardChannelMaxRetries",2,t),this.ra=Mc("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new mA(t&&t.concurrentRequestLimit),this.Ca=new Cj,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}K=CA.prototype;K.ma=8;K.G=1;function wv(t){if(kA(t),t.G==3){var e=t.V++,n=Cr(t.F);Ye(n,"SID",t.J),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),Ku(t,n),e=new Bu(t,t.h,e,void 0),e.K=2,e.v=ip(Cr(n)),n=!1,oe.navigator&&oe.navigator.sendBeacon&&(n=oe.navigator.sendBeacon(e.v.toString(),"")),!n&&oe.Image&&(new Image().src=e.v,n=!0),n||(e.g=MA(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Vu(e)}DA(t)}K.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function cp(t){t.g&&(Iv(t),t.g.cancel(),t.g=null)}function kA(t){cp(t),t.u&&(oe.clearTimeout(t.u),t.u=null),Dd(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&oe.clearTimeout(t.m),t.m=null)}function fg(t,e){t.l.push(new Tj(t.Za++,e)),t.G==3&&lp(t)}function lp(t){_A(t.i)||t.m||(t.m=!0,cv(t.Ha,t),t.C=0)}function Mj(t,e){return yA(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=$u(Jt(t.Ha,t,e),PA(t,t.C)),t.C++,!0)}K.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;const r=new Bu(this,this.h,t,void 0);let i=this.s;if(this.P&&(i?(i=V1(i),q1(i,this.P)):i=this.P),this.o===null&&(r.H=i),this.ja)e:{for(var e=0,n=0;n<this.l.length;n++){t:{var s=this.l[n];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(e+=s,4096<e){e=n;break e}if(e===4096||n===this.l.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=AA(this,r,e),n=Cr(this.F),Ye(n,"RID",t),Ye(n,"CVER",22),this.D&&Ye(n,"X-HTTP-Session-Id",this.D),Ku(this,n),this.o&&i&&vv(n,this.o,i),mv(this.i,r),this.Ra&&Ye(n,"TYPE","init"),this.ja?(Ye(n,"$req",e),Ye(n,"SID","null"),r.$=!0,qm(r,n,null)):qm(r,n,e),this.G=2}}else this.G==3&&(t?iI(this,t):this.l.length==0||_A(this.i)||iI(this))};function iI(t,e){var n;e?n=e.m:n=t.V++;const s=Cr(t.F);Ye(s,"SID",t.J),Ye(s,"RID",n),Ye(s,"AID",t.U),Ku(t,s),t.o&&t.s&&vv(s,t.o,t.s),n=new Bu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=AA(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),mv(t.i,n),qm(n,s,e)}function Ku(t,e){t.j&&pv({},function(n,s){Ye(e,s,n)})}function AA(t,e,n){n=Math.min(t.l.length,n);var s=t.j?Jt(t.j.Oa,t.j,t):null;e:{var r=t.l;let i=-1;for(;;){const o=["count="+n];i==-1?0<n?(i=r[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);let a=!0;for(let c=0;c<n;c++){let l=r[c].h;const u=r[c].g;if(l-=i,0>l)i=Math.max(0,r[c].h-100),a=!1;else try{kj(u,o,"req"+l+"_")}catch{s&&s(u)}}if(a){s=o.join("&");break e}}}return t=t.l.splice(0,n),e.D=t,s}function RA(t){t.g||t.u||(t.Y=1,cv(t.Ga,t),t.A=0)}function bv(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=$u(Jt(t.Ga,t),PA(t,t.A)),t.A++,!0)}K.Ga=function(){if(this.u=null,xA(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=$u(Jt(this.bb,this),t)}};K.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,vn(10),cp(this),xA(this))};function Iv(t){t.B!=null&&(oe.clearTimeout(t.B),t.B=null)}function xA(t){t.g=new Bu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=Cr(t.oa);Ye(e,"RID","rpc"),Ye(e,"SID",t.J),Ye(e,"CI",t.N?"0":"1"),Ye(e,"AID",t.U),Ku(t,e),Ye(e,"TYPE","xmlhttp"),t.o&&t.s&&vv(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=ip(Cr(e)),n.s=null,n.U=!0,cA(n,t)}K.ab=function(){this.v!=null&&(this.v=null,cp(this),bv(this),vn(19))};function Dd(t){t.v!=null&&(oe.clearTimeout(t.v),t.v=null)}function NA(t,e){var n=null;if(t.g==e){Dd(t),Iv(t),t.g=null;var s=2}else if(Km(t.i,e))n=e.D,vA(t.i,e),s=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(s==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var r=t.C;s=tp(),Zt(s,new rA(s,n,e,r)),lp(t)}else RA(t);else if(r=e.o,r==3||r==0&&0<t.I||!(s==1&&Mj(t,e)||s==2&&bv(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),r){case 1:so(t,5);break;case 4:so(t,10);break;case 3:so(t,6);break;default:so(t,2)}}}function PA(t,e){let n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function so(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var s=Jt(t.jb,t);n||(n=new To("//www.google.com/images/cleardot.gif"),oe.location&&oe.location.protocol=="http"||xd(n,"https"),ip(n)),Aj(n.toString(),s)}else vn(2);t.G=0,t.j&&t.j.va(e),DA(t),kA(t)}K.jb=function(t){t?(this.h.info("Successfully pinged google.com"),vn(2)):(this.h.info("Failed to ping google.com"),vn(1))};function DA(t){t.G=0,t.I=-1,t.j&&((wA(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,ev(t.l),t.l.length=0),t.j.ua())}function OA(t,e,n){let s=mj(n);if(s.i!="")e&&Nd(s,e+"."+s.i),Pd(s,s.m);else{const r=oe.location;s=_j(r.protocol,e?e+"."+r.hostname:r.hostname,+r.port,n)}return t.aa&&tv(t.aa,function(r,i){Ye(s,i,r)}),e=t.D,n=t.sa,e&&n&&Ye(s,e,n),Ye(s,"VER",t.ma),Ku(t,s),s}function MA(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new mt(new qu({ib:!0})):new mt(t.qa),e.L=t.H,e}function LA(){}K=LA.prototype;K.xa=function(){};K.wa=function(){};K.va=function(){};K.ua=function(){};K.Oa=function(){};function Od(){if(qa&&!(10<=Number(G5)))throw Error("Environmental error: no available transport.")}Od.prototype.g=function(t,e){return new Xn(t,e)};function Xn(t,e){Vt.call(this),this.g=new CA(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!kd(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!kd(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new gc(this)}en(Xn,Vt);Xn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),cv(Jt(t.hb,t,e))),vn(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=OA(t,null,t.W),lp(t)};Xn.prototype.close=function(){wv(this.g)};Xn.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,fg(this.g,e)}else this.v?(e={},e.__data__=av(t),fg(this.g,e)):fg(this.g,t)};Xn.prototype.M=function(){this.g.j=null,delete this.j,wv(this.g),delete this.g,Xn.Z.M.call(this)};function FA(t){dv.call(this);var e=t.__sm__;if(e){e:{for(const n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}en(FA,dv);function $A(){fv.call(this),this.status=1}en($A,fv);function gc(t){this.g=t}en(gc,LA);gc.prototype.xa=function(){Zt(this.g,"a")};gc.prototype.wa=function(t){Zt(this.g,new FA(t))};gc.prototype.va=function(t){Zt(this.g,new $A(t))};gc.prototype.ua=function(){Zt(this.g,"b")};Od.prototype.createWebChannel=Od.prototype.g;Xn.prototype.send=Xn.prototype.u;Xn.prototype.open=Xn.prototype.m;Xn.prototype.close=Xn.prototype.close;np.NO_ERROR=0;np.TIMEOUT=8;np.HTTP_ERROR=6;iA.COMPLETE="complete";oA.EventType=Uu;Uu.OPEN="a";Uu.CLOSE="b";Uu.ERROR="c";Uu.MESSAGE="d";Vt.prototype.listen=Vt.prototype.N;mt.prototype.listenOnce=mt.prototype.O;mt.prototype.getLastError=mt.prototype.La;mt.prototype.getLastErrorCode=mt.prototype.Da;mt.prototype.getStatus=mt.prototype.ba;mt.prototype.getResponseJson=mt.prototype.Qa;mt.prototype.getResponseText=mt.prototype.ga;mt.prototype.send=mt.prototype.ea;var Lj=function(){return new Od},Fj=function(){return tp()},pg=np,$j=iA,Uj=Ko,oI={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Bj=qu,vh=oA,Vj=mt;const aI="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mc="9.8.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi=new rr("@firebase/firestore");function Hm(){return yi.logLevel}function qj(t){yi.setLogLevel(t)}function x(t,...e){if(yi.logLevel<=pe.DEBUG){const n=e.map(Ev);yi.debug(`Firestore (${mc}): ${t}`,...n)}}function ft(t,...e){if(yi.logLevel<=pe.ERROR){const n=e.map(Ev);yi.error(`Firestore (${mc}): ${t}`,...n)}}function tu(t,...e){if(yi.logLevel<=pe.WARN){const n=e.map(Ev);yi.warn(`Firestore (${mc}): ${t}`,...n)}}function Ev(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(t="Unexpected state"){const e=`FIRESTORE (${mc}) INTERNAL ASSERTION FAILED: `+t;throw ft(e),new Error(e)}function ie(t,e){t||H()}function jj(t,e){t||H()}function q(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends lt{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Kj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(xt.UNAUTHENTICATED))}shutdown(){}}class Hj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Wj{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new Dt;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Dt,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},a=c=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Dt)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ie(typeof s.accessToken=="string"),new UA(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return ie(e===null||typeof e=="string"),new xt(e)}}class zj{constructor(e,n,s){this.type="FirstParty",this.user=xt.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);const r=e.auth.getAuthHeaderValueForFirstParty([]);r&&this.headers.set("Authorization",r),s&&this.headers.set("X-Goog-Iam-Authorization-Token",s)}}class Gj{constructor(e,n,s){this.h=e,this.l=n,this.m=s}getToken(){return Promise.resolve(new zj(this.h,this.l,this.m))}start(e,n){e.enqueueRetryable(()=>n(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Qj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Yj{constructor(e){this.g=e,this.forceRefresh=!1,this.appCheck=null,this.p=null}start(e,n){const s=i=>{i.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.p;return this.p=i.token,x("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.g.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.g.getImmediate({optional:!0});i?r(i):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ie(typeof n.token=="string"),this.p=n.token,new Qj(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xj(t){const e=typeof self!="undefined"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=Xj(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function ue(t,e){return t<e?-1:t>e?1:0}function ja(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function VA(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new k(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new k(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new k(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new k(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ze.fromMillis(Date.now())}static fromDate(e){return Ze.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new Ze(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ue(this.nanoseconds,e.nanoseconds):ue(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new re(e)}static min(){return new re(new Ze(0,0))}static max(){return new re(new Ze(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nu{constructor(e,n,s){n===void 0?n=0:n>e.length&&H(),s===void 0?s=e.length-n:s>e.length-n&&H(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return nu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof nu?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class be extends nu{construct(e,n,s){return new be(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new k(I.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new be(n)}static emptyPath(){return new be([])}}const Jj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends nu{construct(e,n,s){return new at(e,n,s)}static isValidIdentifier(e){return Jj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new at(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new k(I.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const a=e[r];if(a==="\\"){if(r+1===e.length)throw new k(I.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new k(I.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(s+=a,r++):(i(),r++)}if(i(),o)throw new k(I.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(n)}static emptyPath(){return new at([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U{constructor(e){this.path=e}static fromPath(e){return new U(be.fromString(e))}static fromName(e){return new U(be.fromString(e).popFirst(5))}static empty(){return new U(be.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&be.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return be.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new U(new be(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function Wm(t){return t.fields.find(e=>e.kind===2)}function Vi(t){return t.fields.filter(e=>e.kind!==2)}qA.UNKNOWN_ID=-1;class Zj{constructor(e,n){this.fieldPath=e,this.kind=n}}class Md{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Md(0,Jn.min())}}function jA(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=re.fromTimestamp(s===1e9?new Ze(n+1,0):new Ze(n,s));return new Jn(r,U.empty(),e)}function KA(t){return new Jn(t.readTime,t.key,-1)}class Jn{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new Jn(re.min(),U.empty(),-1)}static max(){return new Jn(re.max(),U.empty(),-1)}}function Tv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=U.comparator(t.documentKey,e.documentKey),n!==0?n:ue(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class WA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ri(t){if(t.code!==I.FAILED_PRECONDITION||t.message!==HA)throw t;x("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&H(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new w((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof w?n:w.resolve(n)}catch(n){return w.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):w.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):w.reject(n)}static resolve(e){return new w((n,s)=>{n(e)})}static reject(e){return new w((n,s)=>{s(e)})}static waitFor(e){return new w((n,s)=>{let r=0,i=0,o=!1;e.forEach(a=>{++r,a.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=w.resolve(!1);for(const s of e)n=n.next(r=>r?w.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new w((s,r)=>{const i=e.length,o=new Array(i);let a=0;for(let c=0;c<i;c++){const l=c;n(e[l]).next(u=>{o[l]=u,++a,a===i&&s(o)},u=>r(u))}})}static doWhile(e,n){return new w((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.T=new Dt,this.transaction.oncomplete=()=>{this.T.resolve()},this.transaction.onabort=()=>{n.error?this.T.reject(new dl(e,n.error)):this.T.resolve()},this.transaction.onerror=s=>{const r=Sv(s.target.error);this.T.reject(new dl(e,r))}}static open(e,n,s,r){try{return new up(n,e.transaction(r,s))}catch(i){throw new dl(n,i)}}get A(){return this.T.promise}abort(e){e&&this.T.reject(e),this.aborted||(x("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}R(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new t6(n)}}class ws{constructor(e,n,s){this.name=e,this.version=n,this.P=s,ws.v(Ge())===12.2&&ft("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return x("SimpleDb","Removing database:",e),Ki(window.indexedDB.deleteDatabase(e)).toPromise()}static V(){if(!Mn())return!1;if(ws.S())return!0;const e=Ge(),n=ws.v(e),s=0<n&&n<10,r=ws.D(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static S(){var e;return typeof process!="undefined"&&((e=process.env)===null||e===void 0?void 0:e.C)==="YES"}static N(e,n){return e.store(n)}static v(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}static D(e){const n=e.match(/Android ([\d.]+)/i),s=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(s)}async k(e){return this.db||(x("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new dl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new k(I.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new k(I.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new dl(e,o))},r.onupgradeneeded=i=>{x("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.P.O(o,r.transaction,i.oldVersion,this.version).next(()=>{x("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.M&&(this.db.onversionchange=n=>this.M(n)),this.db}F(e){this.M=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const a=up.open(this.db,e,i?"readonly":"readwrite",s),c=r(a).next(l=>(a.R(),l)).catch(l=>(a.abort(l),w.reject(l))).toPromise();return c.catch(()=>{}),await a.A,c}catch(a){const c=a.name!=="FirebaseError"&&o<3;if(x("SimpleDb","Transaction failed with error:",a.message,"Retrying:",c),this.close(),!c)return Promise.reject(a)}}}close(){this.db&&this.db.close(),this.db=void 0}}class e6{constructor(e){this.$=e,this.B=!1,this.L=null}get isDone(){return this.B}get U(){return this.L}set cursor(e){this.$=e}done(){this.B=!0}q(e){this.L=e}delete(){return Ki(this.$.delete())}}class dl extends k{constructor(e,n){super(I.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function xi(t){return t.name==="IndexedDbTransactionError"}class t6{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(x("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(x("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),Ki(s)}add(e){return x("SimpleDb","ADD",this.store.name,e,e),Ki(this.store.add(e))}get(e){return Ki(this.store.get(e)).next(n=>(n===void 0&&(n=null),x("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return x("SimpleDb","DELETE",this.store.name,e),Ki(this.store.delete(e))}count(){return x("SimpleDb","COUNT",this.store.name),Ki(this.store.count())}K(e,n){const s=this.options(e,n);if(s.index||typeof this.store.getAll!="function"){const r=this.cursor(s),i=[];return this.G(r,(o,a)=>{i.push(a)}).next(()=>i)}{const r=this.store.getAll(s.range);return new w((i,o)=>{r.onerror=a=>{o(a.target.error)},r.onsuccess=a=>{i(a.target.result)}})}}j(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new w((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}W(e,n){x("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const r=this.cursor(s);return this.G(r,(i,o,a)=>a.delete())}J(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.G(r,n)}Y(e){const n=this.cursor({});return new w((s,r)=>{n.onerror=i=>{const o=Sv(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():s()}):s()}})}G(e,n){const s=[];return new w((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void r();const c=new e6(a),l=n(a.primaryKey,a.value,c);if(l instanceof w){const u=l.catch(h=>(c.done(),w.reject(h)));s.push(u)}c.isDone?r():c.U===null?a.continue():a.continue(c.U)}}).next(()=>w.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ki(t){return new w((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=Sv(s.target.error);n(r)}})}let cI=!1;function Sv(t){const e=ws.v(Ge());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return cI||(cI=!0,setTimeout(()=>{throw s},0)),s}}return t}class n6{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}Z(e){x("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{x("IndexBackiller",`Documents written: ${await this.X.tt()}`)}catch(n){xi(n)?x("IndexBackiller","Ignoring IndexedDB error during index backfill: ",n):await Ri(n)}await this.Z(1)})}}class s6{constructor(e,n){this.localStore=e,this.persistence=n}async tt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.et(n,e))}et(e,n){const s=new Set;let r=n,i=!0;return w.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return x("IndexBackiller",`Processing collection: ${o}`),this.nt(e,o,r).next(a=>{r-=a,s.add(o)});i=!1})).next(()=>n-r)}nt(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.st(r,i)).next(a=>(x("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}st(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=KA(i);Tv(o,s)>0&&(s=o)}),new Jn(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.it(s),this.rt=s=>n.writeSequenceNumber(s))}it(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.rt&&this.rt(e),e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lI(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ho(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function zA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */xn.ot=-1;class rt{constructor(e,n){this.comparator=e,this.root=n||zt.EMPTY}insert(e,n){return new rt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zt.BLACK,null,null))}remove(e){return new rt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wh(this.root,e,this.comparator,!1)}getReverseIterator(){return new wh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wh(this.root,e,this.comparator,!0)}}class wh{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zt{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s!=null?s:zt.RED,this.left=r!=null?r:zt.EMPTY,this.right=i!=null?i:zt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new zt(e!=null?e:this.key,n!=null?n:this.value,s!=null?s:this.color,r!=null?r:this.left,i!=null?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return zt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return zt.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw H();const e=this.left.check();if(e!==this.right.check())throw H();return e+(this.isRed()?0:1)}}zt.EMPTY=null,zt.RED=!0,zt.BLACK=!1;zt.EMPTY=new class{constructor(){this.size=0}get key(){throw H()}get value(){throw H()}get color(){throw H()}get left(){throw H()}get right(){throw H()}copy(t,e,n,s,r){return this}insert(t,e,n){return new zt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.comparator=e,this.data=new rt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new uI(this.data.getIterator())}getIteratorFrom(e){return new uI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof Re)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Re(this.comparator);return n.data=e,n}}class uI{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ea(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new Gn([])}unionWith(e){let n=new Re(at.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return ja(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(){return typeof atob!="undefined"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=atob(e);return new Tt(n)}static fromUint8Array(e){const n=function(s){let r="";for(let i=0;i<s.length;++i)r+=String.fromCharCode(s[i]);return r}(e);return new Tt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const n=new Uint8Array(e.length);for(let s=0;s<e.length;s++)n[s]=e.charCodeAt(s);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ue(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tt.EMPTY_BYTE_STRING=new Tt("");const i6=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(t){if(ie(!!t),typeof t=="string"){let e=0;const n=i6.exec(t);if(ie(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function So(t){return typeof t=="string"?Tt.fromBase64String(t):Tt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function GA(t){const e=t.mapValue.fields.__previous_value__;return Cv(e)?GA(e):e}function su(t){const e=vi(t.mapValue.fields.__local_write_time__.timestampValue);return new Ze(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o6{constructor(e,n,s,r,i,o,a,c){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=c}}class kr{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new kr("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof kr&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hu(t){return t==null}function ru(t){return t===0&&1/t==-1/0}function QA(t){return typeof t=="number"&&Number.isInteger(t)&&!ru(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jr={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},$h={nullValue:"NULL_VALUE"};function Co(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Cv(t)?4:YA(t)?9007199254740991:10:H()}function tr(t,e){if(t===e)return!0;const n=Co(t);if(n!==Co(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return su(t).isEqual(su(e));case 3:return function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const i=vi(s.timestampValue),o=vi(r.timestampValue);return i.seconds===o.seconds&&i.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,r){return So(s.bytesValue).isEqual(So(r.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,r){return nt(s.geoPointValue.latitude)===nt(r.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(r.geoPointValue.longitude)}(t,e);case 2:return function(s,r){if("integerValue"in s&&"integerValue"in r)return nt(s.integerValue)===nt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const i=nt(s.doubleValue),o=nt(r.doubleValue);return i===o?ru(i)===ru(o):isNaN(i)&&isNaN(o)}return!1}(t,e);case 9:return ja(t.arrayValue.values||[],e.arrayValue.values||[],tr);case 10:return function(s,r){const i=s.mapValue.fields||{},o=r.mapValue.fields||{};if(lI(i)!==lI(o))return!1;for(const a in i)if(i.hasOwnProperty(a)&&(o[a]===void 0||!tr(i[a],o[a])))return!1;return!0}(t,e);default:return H()}}function iu(t,e){return(t.values||[]).find(n=>tr(n,e))!==void 0}function wi(t,e){if(t===e)return 0;const n=Co(t),s=Co(e);if(n!==s)return ue(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return ue(t.booleanValue,e.booleanValue);case 2:return function(r,i){const o=nt(r.integerValue||r.doubleValue),a=nt(i.integerValue||i.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(t,e);case 3:return hI(t.timestampValue,e.timestampValue);case 4:return hI(su(t),su(e));case 5:return ue(t.stringValue,e.stringValue);case 6:return function(r,i){const o=So(r),a=So(i);return o.compareTo(a)}(t.bytesValue,e.bytesValue);case 7:return function(r,i){const o=r.split("/"),a=i.split("/");for(let c=0;c<o.length&&c<a.length;c++){const l=ue(o[c],a[c]);if(l!==0)return l}return ue(o.length,a.length)}(t.referenceValue,e.referenceValue);case 8:return function(r,i){const o=ue(nt(r.latitude),nt(i.latitude));return o!==0?o:ue(nt(r.longitude),nt(i.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(r,i){const o=r.values||[],a=i.values||[];for(let c=0;c<o.length&&c<a.length;++c){const l=wi(o[c],a[c]);if(l)return l}return ue(o.length,a.length)}(t.arrayValue,e.arrayValue);case 10:return function(r,i){if(r===Jr.mapValue&&i===Jr.mapValue)return 0;if(r===Jr.mapValue)return 1;if(i===Jr.mapValue)return-1;const o=r.fields||{},a=Object.keys(o),c=i.fields||{},l=Object.keys(c);a.sort(),l.sort();for(let u=0;u<a.length&&u<l.length;++u){const h=ue(a[u],l[u]);if(h!==0)return h;const d=wi(o[a[u]],c[l[u]]);if(d!==0)return d}return ue(a.length,l.length)}(t.mapValue,e.mapValue);default:throw H()}}function hI(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ue(t,e);const n=vi(t),s=vi(e),r=ue(n.seconds,s.seconds);return r!==0?r:ue(n.nanos,s.nanos)}function Ia(t){return zm(t)}function zm(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(s){const r=vi(s);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?So(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,U.fromName(n).toString()):"geoPointValue"in t?`geo(${(e=t.geoPointValue).latitude},${e.longitude})`:"arrayValue"in t?function(s){let r="[",i=!0;for(const o of s.values||[])i?i=!1:r+=",",r+=zm(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(s){const r=Object.keys(s.fields||{}).sort();let i="{",o=!0;for(const a of r)o?o=!1:i+=",",i+=`${a}:${zm(s.fields[a])}`;return i+"}"}(t.mapValue):H();var e,n}function ko(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Gm(t){return!!t&&"integerValue"in t}function ou(t){return!!t&&"arrayValue"in t}function dI(t){return!!t&&"nullValue"in t}function fI(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Uh(t){return!!t&&"mapValue"in t}function fl(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ho(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=fl(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=fl(t.arrayValue.values[n]);return e}return Object.assign({},t)}function YA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function a6(t){return"nullValue"in t?$h:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ko(kr.empty(),U.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:H()}function c6(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ko(kr.empty(),U.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Jr:H()}function pI(t,e){const n=wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function gI(t,e){const n=wi(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.value=e}static empty(){return new Gt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!Uh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=fl(n)}setAll(e){let n=at.emptyPath(),s={},r=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=a.popLast()}o?s[a.lastSegment()]=fl(o):r.push(a.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());Uh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return tr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];Uh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Ho(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new Gt(fl(this.value))}}function XA(t){const e=[];return Ho(t.fields,(n,s)=>{const r=new at([n]);if(Uh(s)){const i=XA(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,n,s,r,i,o){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Ke(e,0,re.min(),re.min(),Gt.empty(),0)}static newFoundDocument(e,n,s){return new Ke(e,1,n,re.min(),s,0)}static newNoDocument(e,n){return new Ke(e,2,n,re.min(),Gt.empty(),0)}static newUnknownDocument(e,n){return new Ke(e,3,n,re.min(),Gt.empty(),2)}convertToFoundDocument(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Gt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Gt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ke&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ke(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,n=null,s=[],r=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.ut=null}}function mI(t,e=null,n=[],s=[],r=null,i=null,o=null){return new l6(t,e,n,s,r,i,o)}function Ao(t){const e=q(t);if(e.ut===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>{return(r=s).field.canonicalString()+r.op.toString()+Ia(r.value);var r}).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(r){return r.field.canonicalString()+r.dir}(s)).join(","),Hu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>Ia(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>Ia(s)).join(",")),e.ut=n}return e.ut}function u6(t){let e=t.path.canonicalString();return t.collectionGroup!==null&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=`, filters: [${t.filters.map(n=>{return`${(s=n).field.canonicalString()} ${s.op} ${Ia(s.value)}`;var s}).join(", ")}]`),Hu(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=`, orderBy: [${t.orderBy.map(n=>function(s){return`${s.field.canonicalString()} (${s.dir})`}(n)).join(", ")}]`),t.startAt&&(e+=", startAt: ",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(n=>Ia(n)).join(",")),t.endAt&&(e+=", endAt: ",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(n=>Ia(n)).join(",")),`Target(${e})`}function Wu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!y6(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(n=t.filters[r],s=e.filters[r],n.op!==s.op||!n.field.isEqual(s.field)||!tr(n.value,s.value))return!1;var n,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!wI(t.startAt,e.startAt)&&wI(t.endAt,e.endAt)}function Ld(t){return U.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Fd(t,e){return t.filters.filter(n=>n instanceof Qt&&n.field.isEqual(e))}function _I(t,e,n){let s=$h,r=!0;for(const i of Fd(t,e)){let o=$h,a=!0;switch(i.op){case"<":case"<=":o=a6(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,a=!1;break;case"!=":case"not-in":o=$h}pI({value:s,inclusive:r},{value:o,inclusive:a})<0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];pI({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function yI(t,e,n){let s=Jr,r=!0;for(const i of Fd(t,e)){let o=Jr,a=!0;switch(i.op){case">=":case">":o=c6(i.value),a=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,a=!1;break;case"!=":case"not-in":o=Jr}gI({value:s,inclusive:r},{value:o,inclusive:a})>0&&(s=o,r=a)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];gI({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}class Qt extends class{}{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.ct(e,n,s):new h6(e,n,s):n==="array-contains"?new p6(e,s):n==="in"?new g6(e,s):n==="not-in"?new m6(e,s):n==="array-contains-any"?new _6(e,s):new Qt(e,n,s)}static ct(e,n,s){return n==="in"?new d6(e,s):new f6(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.at(wi(n,this.value)):n!==null&&Co(this.value)===Co(n)&&this.at(wi(n,this.value))}at(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return H()}}ht(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class h6 extends Qt{constructor(e,n,s){super(e,n,s),this.key=U.fromName(s.referenceValue)}matches(e){const n=U.comparator(e.key,this.key);return this.at(n)}}class d6 extends Qt{constructor(e,n){super(e,"in",n),this.keys=JA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class f6 extends Qt{constructor(e,n){super(e,"not-in",n),this.keys=JA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function JA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>U.fromName(s.referenceValue))}class p6 extends Qt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return ou(n)&&iu(n.arrayValue,this.value)}}class g6 extends Qt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&iu(this.value.arrayValue,n)}}class m6 extends Qt{constructor(e,n){super(e,"not-in",n)}matches(e){if(iu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!iu(this.value.arrayValue,n)}}class _6 extends Qt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!ou(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>iu(this.value.arrayValue,s))}}class bi{constructor(e,n){this.position=e,this.inclusive=n}}class Ea{constructor(e,n="asc"){this.field=e,this.dir=n}}function y6(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function vI(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=U.comparator(U.fromName(o.referenceValue),n.key):s=wi(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function wI(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!tr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,n=null,s=[],r=[],i=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=c,this.lt=null,this.ft=null,this.startAt,this.endAt}}function ZA(t,e,n,s,r,i,o,a){return new Pr(t,e,n,s,r,i,o,a)}function _c(t){return new Pr(t)}function v6(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function kv(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Av(t){for(const e of t.filters)if(e.ht())return e.field;return null}function Rv(t){return t.collectionGroup!==null}function Ka(t){const e=q(t);if(e.lt===null){e.lt=[];const n=Av(e),s=kv(e);if(n!==null&&s===null)n.isKeyField()||e.lt.push(new Ea(n)),e.lt.push(new Ea(at.keyField(),"asc"));else{let r=!1;for(const i of e.explicitOrderBy)e.lt.push(i),i.field.isKeyField()&&(r=!0);if(!r){const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.lt.push(new Ea(at.keyField(),i))}}}return e.lt}function hs(t){const e=q(t);if(!e.ft)if(e.limitType==="F")e.ft=mI(e.path,e.collectionGroup,Ka(e),e.filters,e.limit,e.startAt,e.endAt);else{const n=[];for(const i of Ka(e)){const o=i.dir==="desc"?"asc":"desc";n.push(new Ea(i.field,o))}const s=e.endAt?new bi(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new bi(e.startAt.position,e.startAt.inclusive):null;e.ft=mI(e.path,e.collectionGroup,n,e.filters,e.limit,s,r)}return e.ft}function eR(t,e,n){return new Pr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function zu(t,e){return Wu(hs(t),hs(e))&&t.limitType===e.limitType}function tR(t){return`${Ao(hs(t))}|lt:${t.limitType}`}function Qm(t){return`Query(target=${u6(hs(t))}; limitType=${t.limitType})`}function xv(t,e){return e.isFoundDocument()&&function(n,s){const r=s.key.path;return n.collectionGroup!==null?s.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(r):U.isDocumentKey(n.path)?n.path.isEqual(r):n.path.isImmediateParentOf(r)}(t,e)&&function(n,s){for(const r of n.explicitOrderBy)if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0}(t,e)&&function(n,s){for(const r of n.filters)if(!r.matches(s))return!1;return!0}(t,e)&&function(n,s){return!(n.startAt&&!function(r,i,o){const a=vI(r,i,o);return r.inclusive?a<=0:a<0}(n.startAt,Ka(n),s)||n.endAt&&!function(r,i,o){const a=vI(r,i,o);return r.inclusive?a>=0:a>0}(n.endAt,Ka(n),s))}(t,e)}function nR(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function sR(t){return(e,n)=>{let s=!1;for(const r of Ka(t)){const i=w6(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function w6(t,e,n){const s=t.field.isKeyField()?U.comparator(e.key,n.key):function(r,i,o){const a=i.data.field(r),c=o.data.field(r);return a!==null&&c!==null?wi(a,c):H()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return H()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rR(t,e){if(t.dt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ru(e)?"-0":e}}function iR(t){return{integerValue:""+t}}function oR(t,e){return QA(e)?iR(e):rR(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(){this._=void 0}}function b6(t,e,n){return t instanceof Ha?function(s,r){const i={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&(i.fields.__previous_value__=r),{mapValue:i}}(n,e):t instanceof Ro?cR(t,e):t instanceof xo?lR(t,e):function(s,r){const i=aR(s,r),o=bI(i)+bI(s._t);return Gm(i)&&Gm(s._t)?iR(o):rR(s.wt,o)}(t,e)}function I6(t,e,n){return t instanceof Ro?cR(t,e):t instanceof xo?lR(t,e):n}function aR(t,e){return t instanceof Wa?Gm(n=e)||function(s){return!!s&&"doubleValue"in s}(n)?e:{integerValue:0}:null;var n}class Ha extends hp{}class Ro extends hp{constructor(e){super(),this.elements=e}}function cR(t,e){const n=uR(e);for(const s of t.elements)n.some(r=>tr(r,s))||n.push(s);return{arrayValue:{values:n}}}class xo extends hp{constructor(e){super(),this.elements=e}}function lR(t,e){let n=uR(e);for(const s of t.elements)n=n.filter(r=>!tr(r,s));return{arrayValue:{values:n}}}class Wa extends hp{constructor(e,n){super(),this.wt=e,this._t=n}}function bI(t){return nt(t.integerValue||t.doubleValue)}function uR(t){return ou(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,n){this.field=e,this.transform=n}}function E6(t,e){return t.field.isEqual(e.field)&&function(n,s){return n instanceof Ro&&s instanceof Ro||n instanceof xo&&s instanceof xo?ja(n.elements,s.elements,tr):n instanceof Wa&&s instanceof Wa?tr(n._t,s._t):n instanceof Ha&&s instanceof Ha}(t.transform,e.transform)}class T6{constructor(e,n){this.version=e,this.transformResults=n}}class tt{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new tt}static exists(e){return new tt(void 0,e)}static updateTime(e){return new tt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class dp{}function hR(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new vc(t.key,tt.none()):new yc(t.key,t.data,tt.none());{const n=t.data,s=Gt.empty();let r=new Re(at.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Dr(t.key,s,new Gn(r.toArray()),tt.none())}}function S6(t,e,n){t instanceof yc?function(s,r,i){const o=s.value.clone(),a=EI(s.fieldTransforms,r,i.transformResults);o.setAll(a),r.convertToFoundDocument(i.version,o).setHasCommittedMutations()}(t,e,n):t instanceof Dr?function(s,r,i){if(!Bh(s.precondition,r))return void r.convertToUnknownDocument(i.version);const o=EI(s.fieldTransforms,r,i.transformResults),a=r.data;a.setAll(dR(s)),a.setAll(o),r.convertToFoundDocument(i.version,a).setHasCommittedMutations()}(t,e,n):function(s,r,i){r.convertToNoDocument(i.version).setHasCommittedMutations()}(0,e,n)}function pl(t,e,n,s){return t instanceof yc?function(r,i,o,a){if(!Bh(r.precondition,i))return o;const c=r.value.clone(),l=TI(r.fieldTransforms,a,i);return c.setAll(l),i.convertToFoundDocument(i.version,c).setHasLocalMutations(),null}(t,e,n,s):t instanceof Dr?function(r,i,o,a){if(!Bh(r.precondition,i))return o;const c=TI(r.fieldTransforms,a,i),l=i.data;return l.setAll(dR(r)),l.setAll(c),i.convertToFoundDocument(i.version,l).setHasLocalMutations(),o===null?null:o.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map(u=>u.field))}(t,e,n,s):function(r,i,o){return Bh(r.precondition,i)?(i.convertToNoDocument(i.version).setHasLocalMutations(),null):o}(t,e,n)}function C6(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=aR(s.transform,r||null);i!=null&&(n===null&&(n=Gt.empty()),n.set(s.field,i))}return n||null}function II(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,s){return n===void 0&&s===void 0||!(!n||!s)&&ja(n,s,(r,i)=>E6(r,i))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class yc extends dp{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Dr extends dp{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function dR(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function EI(t,e,n){const s=new Map;ie(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,a=e.data.field(i.field);s.set(i.field,I6(o,a,n[r]))}return s}function TI(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,b6(i,o,e))}return s}class vc extends dp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Nv extends dp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.count=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ut,ve;function fR(t){switch(t){default:return H();case I.CANCELLED:case I.UNKNOWN:case I.DEADLINE_EXCEEDED:case I.RESOURCE_EXHAUSTED:case I.INTERNAL:case I.UNAVAILABLE:case I.UNAUTHENTICATED:return!1;case I.INVALID_ARGUMENT:case I.NOT_FOUND:case I.ALREADY_EXISTS:case I.PERMISSION_DENIED:case I.FAILED_PRECONDITION:case I.ABORTED:case I.OUT_OF_RANGE:case I.UNIMPLEMENTED:case I.DATA_LOSS:return!0}}function pR(t){if(t===void 0)return ft("GRPC error has no .code"),I.UNKNOWN;switch(t){case ut.OK:return I.OK;case ut.CANCELLED:return I.CANCELLED;case ut.UNKNOWN:return I.UNKNOWN;case ut.DEADLINE_EXCEEDED:return I.DEADLINE_EXCEEDED;case ut.RESOURCE_EXHAUSTED:return I.RESOURCE_EXHAUSTED;case ut.INTERNAL:return I.INTERNAL;case ut.UNAVAILABLE:return I.UNAVAILABLE;case ut.UNAUTHENTICATED:return I.UNAUTHENTICATED;case ut.INVALID_ARGUMENT:return I.INVALID_ARGUMENT;case ut.NOT_FOUND:return I.NOT_FOUND;case ut.ALREADY_EXISTS:return I.ALREADY_EXISTS;case ut.PERMISSION_DENIED:return I.PERMISSION_DENIED;case ut.FAILED_PRECONDITION:return I.FAILED_PRECONDITION;case ut.ABORTED:return I.ABORTED;case ut.OUT_OF_RANGE:return I.OUT_OF_RANGE;case ut.UNIMPLEMENTED:return I.UNIMPLEMENTED;case ut.DATA_LOSS:return I.DATA_LOSS;default:return H()}}(ve=ut||(ut={}))[ve.OK=0]="OK",ve[ve.CANCELLED=1]="CANCELLED",ve[ve.UNKNOWN=2]="UNKNOWN",ve[ve.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ve[ve.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ve[ve.NOT_FOUND=5]="NOT_FOUND",ve[ve.ALREADY_EXISTS=6]="ALREADY_EXISTS",ve[ve.PERMISSION_DENIED=7]="PERMISSION_DENIED",ve[ve.UNAUTHENTICATED=16]="UNAUTHENTICATED",ve[ve.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ve[ve.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ve[ve.ABORTED=10]="ABORTED",ve[ve.OUT_OF_RANGE=11]="OUT_OF_RANGE",ve[ve.UNIMPLEMENTED=12]="UNIMPLEMENTED",ve[ve.INTERNAL=13]="INTERNAL",ve[ve.UNAVAILABLE=14]="UNAVAILABLE",ve[ve.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ho(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return zA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6=new rt(U.comparator);function Nn(){return A6}const gR=new rt(U.comparator);function Qc(...t){let e=gR;for(const n of t)e=e.insert(n.key,n);return e}function mR(t){let e=gR;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function Vs(){return gl()}function _R(){return gl()}function gl(){return new Ni(t=>t.toString(),(t,e)=>t.isEqual(e))}const R6=new rt(U.comparator),x6=new Re(U.comparator);function de(...t){let e=x6;for(const n of t)e=e.add(n);return e}const N6=new Re(ue);function fp(){return N6}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n){const s=new Map;return s.set(e,Yu.createSynthesizedTargetChangeForCurrentChange(e,n)),new Qu(re.min(),s,fp(),Nn(),de())}}class Yu{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n){return new Yu(Tt.EMPTY_BYTE_STRING,n,de(),de(),de())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vh{constructor(e,n,s,r){this.gt=e,this.removedTargetIds=n,this.key=s,this.yt=r}}class yR{constructor(e,n){this.targetId=e,this.It=n}}class vR{constructor(e,n,s=Tt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class SI{constructor(){this.Tt=0,this.Et=kI(),this.At=Tt.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}get current(){return this.Rt}get resumeToken(){return this.At}get Pt(){return this.Tt!==0}get vt(){return this.bt}Vt(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}St(){let e=de(),n=de(),s=de();return this.Et.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:H()}}),new Yu(this.At,this.Rt,e,n,s)}Dt(){this.bt=!1,this.Et=kI()}Ct(e,n){this.bt=!0,this.Et=this.Et.insert(e,n)}xt(e){this.bt=!0,this.Et=this.Et.remove(e)}Nt(){this.Tt+=1}kt(){this.Tt-=1}Ot(){this.bt=!0,this.Rt=!0}}class P6{constructor(e){this.Mt=e,this.Ft=new Map,this.$t=Nn(),this.Bt=CI(),this.Lt=new Re(ue)}Ut(e){for(const n of e.gt)e.yt&&e.yt.isFoundDocument()?this.qt(n,e.yt):this.Kt(n,e.key,e.yt);for(const n of e.removedTargetIds)this.Kt(n,e.key,e.yt)}Gt(e){this.forEachTarget(e,n=>{const s=this.Qt(n);switch(e.state){case 0:this.jt(n)&&s.Vt(e.resumeToken);break;case 1:s.kt(),s.Pt||s.Dt(),s.Vt(e.resumeToken);break;case 2:s.kt(),s.Pt||this.removeTarget(n);break;case 3:this.jt(n)&&(s.Ot(),s.Vt(e.resumeToken));break;case 4:this.jt(n)&&(this.Wt(n),s.Vt(e.resumeToken));break;default:H()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ft.forEach((s,r)=>{this.jt(r)&&n(r)})}zt(e){const n=e.targetId,s=e.It.count,r=this.Ht(n);if(r){const i=r.target;if(Ld(i))if(s===0){const o=new U(i.path);this.Kt(n,o,Ke.newNoDocument(o,re.min()))}else ie(s===1);else this.Jt(n)!==s&&(this.Wt(n),this.Lt=this.Lt.add(n))}}Yt(e){const n=new Map;this.Ft.forEach((i,o)=>{const a=this.Ht(o);if(a){if(i.current&&Ld(a.target)){const c=new U(a.target.path);this.$t.get(c)!==null||this.Xt(o,c)||this.Kt(o,c,Ke.newNoDocument(c,e))}i.vt&&(n.set(o,i.St()),i.Dt())}});let s=de();this.Bt.forEach((i,o)=>{let a=!0;o.forEachWhile(c=>{const l=this.Ht(c);return!l||l.purpose===2||(a=!1,!1)}),a&&(s=s.add(i))}),this.$t.forEach((i,o)=>o.setReadTime(e));const r=new Qu(e,n,this.Lt,this.$t,s);return this.$t=Nn(),this.Bt=CI(),this.Lt=new Re(ue),r}qt(e,n){if(!this.jt(e))return;const s=this.Xt(e,n.key)?2:0;this.Qt(e).Ct(n.key,s),this.$t=this.$t.insert(n.key,n),this.Bt=this.Bt.insert(n.key,this.Zt(n.key).add(e))}Kt(e,n,s){if(!this.jt(e))return;const r=this.Qt(e);this.Xt(e,n)?r.Ct(n,1):r.xt(n),this.Bt=this.Bt.insert(n,this.Zt(n).delete(e)),s&&(this.$t=this.$t.insert(n,s))}removeTarget(e){this.Ft.delete(e)}Jt(e){const n=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Nt(e){this.Qt(e).Nt()}Qt(e){let n=this.Ft.get(e);return n||(n=new SI,this.Ft.set(e,n)),n}Zt(e){let n=this.Bt.get(e);return n||(n=new Re(ue),this.Bt=this.Bt.insert(e,n)),n}jt(e){const n=this.Ht(e)!==null;return n||x("WatchChangeAggregator","Detected inactive target",e),n}Ht(e){const n=this.Ft.get(e);return n&&n.Pt?null:this.Mt.te(e)}Wt(e){this.Ft.set(e,new SI),this.Mt.getRemoteKeysForTarget(e).forEach(n=>{this.Kt(e,n,null)})}Xt(e,n){return this.Mt.getRemoteKeysForTarget(e).has(n)}}function CI(){return new rt(U.comparator)}function kI(){return new rt(U.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),O6=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))();class M6{constructor(e,n){this.databaseId=e,this.dt=n}}function au(t,e){return t.dt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function wR(t,e){return t.dt?e.toBase64():e.toUint8Array()}function L6(t,e){return au(t,e.toTimestamp())}function Ot(t){return ie(!!t),re.fromTimestamp(function(e){const n=vi(e);return new Ze(n.seconds,n.nanos)}(t))}function Pv(t,e){return function(n){return new be(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function bR(t){const e=be.fromString(t);return ie(RR(e)),e}function cu(t,e){return Pv(t.databaseId,e.path)}function Ws(t,e){const n=bR(e);if(n.get(1)!==t.databaseId.projectId)throw new k(I.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new k(I.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new U(ER(n))}function Ym(t,e){return Pv(t.databaseId,e)}function IR(t){const e=bR(t);return e.length===4?be.emptyPath():ER(e)}function lu(t){return new be(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function ER(t){return ie(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function AI(t,e,n){return{name:cu(t,e),fields:n.value.mapValue.fields}}function TR(t,e,n){const s=Ws(t,e.name),r=Ot(e.updateTime),i=new Gt({mapValue:{fields:e.fields}}),o=Ke.newFoundDocument(s,r,i);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function F6(t,e){return"found"in e?function(n,s){ie(!!s.found),s.found.name,s.found.updateTime;const r=Ws(n,s.found.name),i=Ot(s.found.updateTime),o=new Gt({mapValue:{fields:s.found.fields}});return Ke.newFoundDocument(r,i,o)}(t,e):"missing"in e?function(n,s){ie(!!s.missing),ie(!!s.readTime);const r=Ws(n,s.missing),i=Ot(s.readTime);return Ke.newNoDocument(r,i)}(t,e):H()}function $6(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:H()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(c,l){return c.dt?(ie(l===void 0||typeof l=="string"),Tt.fromBase64String(l||"")):(ie(l===void 0||l instanceof Uint8Array),Tt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const l=c.code===void 0?I.UNKNOWN:pR(c.code);return new k(l,c.message||"")}(o);n=new vR(s,r,i,a||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Ws(t,s.document.name),i=Ot(s.document.updateTime),o=new Gt({mapValue:{fields:s.document.fields}}),a=Ke.newFoundDocument(r,i,o),c=s.targetIds||[],l=s.removedTargetIds||[];n=new Vh(c,l,a.key,a)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Ws(t,s.document),i=s.readTime?Ot(s.readTime):re.min(),o=Ke.newNoDocument(r,i),a=s.removedTargetIds||[];n=new Vh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Ws(t,s.document),i=s.removedTargetIds||[];n=new Vh([],i,r,null)}else{if(!("filter"in e))return H();{e.filter;const s=e.filter;s.targetId;const r=s.count||0,i=new k6(r),o=s.targetId;n=new yR(o,i)}}return n}function uu(t,e){let n;if(e instanceof yc)n={update:AI(t,e.key,e.value)};else if(e instanceof vc)n={delete:cu(t,e.key)};else if(e instanceof Dr)n={update:AI(t,e.key,e.data),updateMask:H6(e.fieldMask)};else{if(!(e instanceof Nv))return H();n={verify:cu(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(r,i){const o=i.transform;if(o instanceof Ha)return{fieldPath:i.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Ro)return{fieldPath:i.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof xo)return{fieldPath:i.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Wa)return{fieldPath:i.field.canonicalString(),increment:o._t};throw H()}(0,s))),e.precondition.isNone||(n.currentDocument=function(s,r){return r.updateTime!==void 0?{updateTime:L6(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:H()}(t,e.precondition)),n}function Xm(t,e){const n=e.currentDocument?function(r){return r.updateTime!==void 0?tt.updateTime(Ot(r.updateTime)):r.exists!==void 0?tt.exists(r.exists):tt.none()}(e.currentDocument):tt.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(i,o){let a=null;if("setToServerValue"in o)ie(o.setToServerValue==="REQUEST_TIME"),a=new Ha;else if("appendMissingElements"in o){const l=o.appendMissingElements.values||[];a=new Ro(l)}else if("removeAllFromArray"in o){const l=o.removeAllFromArray.values||[];a=new xo(l)}else"increment"in o?a=new Wa(i,o.increment):H();const c=at.fromServerFormat(o.fieldPath);return new Gu(c,a)}(t,r)):[];if(e.update){e.update.name;const r=Ws(t,e.update.name),i=new Gt({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(a){const c=a.fieldPaths||[];return new Gn(c.map(l=>at.fromServerFormat(l)))}(e.updateMask);return new Dr(r,i,o,n,s)}return new yc(r,i,n,s)}if(e.delete){const r=Ws(t,e.delete);return new vc(r,n)}if(e.verify){const r=Ws(t,e.verify);return new Nv(r,n)}return H()}function U6(t,e){return t&&t.length>0?(ie(e!==void 0),t.map(n=>function(s,r){let i=s.updateTime?Ot(s.updateTime):Ot(r);return i.isEqual(re.min())&&(i=Ot(r)),new T6(i,s.transformResults||[])}(n,e))):[]}function SR(t,e){return{documents:[Ym(t,e.path)]}}function CR(t,e){const n={structuredQuery:{}},s=e.path;e.collectionGroup!==null?(n.parent=Ym(t,s),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Ym(t,s.popLast()),n.structuredQuery.from=[{collectionId:s.lastSegment()}]);const r=function(c){if(c.length===0)return;const l=c.map(u=>function(h){if(h.op==="=="){if(fI(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NAN"}};if(dI(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NULL"}}}else if(h.op==="!="){if(fI(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NOT_NAN"}};if(dI(h.value))return{unaryFilter:{field:ta(h.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ta(h.field),op:q6(h.op),value:h.value}}}(u));return l.length===1?l[0]:{compositeFilter:{op:"AND",filters:l}}}(e.filters);r&&(n.structuredQuery.where=r);const i=function(c){if(c.length!==0)return c.map(l=>function(u){return{field:ta(u.field),direction:V6(u.dir)}}(l))}(e.orderBy);i&&(n.structuredQuery.orderBy=i);const o=function(c,l){return c.dt||Hu(l)?l:{value:l}}(t,e.limit);var a;return o!==null&&(n.structuredQuery.limit=o),e.startAt&&(n.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),n}function kR(t){let e=IR(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ie(s===1);const u=n.from[0];u.allDescendants?r=u.collectionId:e=e.child(u.collectionId)}let i=[];n.where&&(i=AR(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(u=>function(h){return new Ea(fa(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(u)));let a=null;n.limit&&(a=function(u){let h;return h=typeof u=="object"?u.value:u,Hu(h)?null:h}(n.limit));let c=null;n.startAt&&(c=function(u){const h=!!u.before,d=u.values||[];return new bi(d,h)}(n.startAt));let l=null;return n.endAt&&(l=function(u){const h=!u.before,d=u.values||[];return new bi(d,h)}(n.endAt)),ZA(e,r,o,i,a,"F",c,l)}function B6(t,e){const n=function(s,r){switch(r){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return H()}}(0,e.purpose);return n==null?null:{"goog-listen-tags":n}}function AR(t){return t?t.unaryFilter!==void 0?[K6(t)]:t.fieldFilter!==void 0?[j6(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(e=>AR(e)).reduce((e,n)=>e.concat(n)):H():[]}function V6(t){return D6[t]}function q6(t){return O6[t]}function ta(t){return{fieldPath:t.canonicalString()}}function fa(t){return at.fromServerFormat(t.fieldPath)}function j6(t){return Qt.create(fa(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return H()}}(t.fieldFilter.op),t.fieldFilter.value)}function K6(t){switch(t.unaryFilter.op){case"IS_NAN":const e=fa(t.unaryFilter.field);return Qt.create(e,"==",{doubleValue:NaN});case"IS_NULL":const n=fa(t.unaryFilter.field);return Qt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=fa(t.unaryFilter.field);return Qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const r=fa(t.unaryFilter.field);return Qt.create(r,"!=",{nullValue:"NULL_VALUE"});default:return H()}}function H6(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function RR(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=RI(e)),e=W6(t.get(n),e);return RI(e)}function W6(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function RI(t){return t+""}function qs(t){const e=t.length;if(ie(e>=2),e===2)return ie(t.charAt(0)===""&&t.charAt(1)===""),be.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&H(),t.charAt(o+1)){case"":const a=t.substring(i,o);let c;r.length===0?c=a:(r+=a,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:H()}i=o+2}return new be(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(t,e){return[t,wn(e)]}function xR(t,e,n){return[t,wn(e),n]}const z6={},G6=["prefixPath","collectionGroup","readTime","documentId"],Q6=["prefixPath","collectionGroup","documentId"],Y6=["collectionGroup","readTime","prefixPath","documentId"],X6=["canonicalId","targetId"],J6=["targetId","path"],Z6=["path","targetId"],eK=["collectionId","parent"],tK=["indexId","uid"],nK=["uid","sequenceNumber"],sK=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],rK=["indexId","uid","orderedDocumentKey"],iK=["userId","collectionPath","documentId"],oK=["userId","collectionPath","largestBatchId"],aK=["userId","collectionGroup","largestBatchId"],NR=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],cK=[...NR,"documentOverlays"],PR=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],DR=PR,lK=[...DR,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm extends WA{constructor(e,n){super(),this.ee=e,this.currentSequenceNumber=n}}function Kt(t,e){const n=q(t);return ws.N(n.ee,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dv{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&S6(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=pl(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=pl(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=_R();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=n.has(r.key)?null:a;const c=hR(o,a);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(re.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),de())}isEqual(e){return this.batchId===e.batchId&&ja(this.mutations,e.mutations,(n,s)=>II(n,s))&&ja(this.baseMutations,e.baseMutations,(n,s)=>II(n,s))}}class Ov{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ie(e.mutations.length===s.length);let r=R6;const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Ov(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e,n,s,r,i=re.min(),o=re.min(),a=Tt.EMPTY_BYTE_STRING){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}withSequenceNumber(e){return new ii(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,n){return new ii(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new ii(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OR{constructor(e){this.ne=e}}function uK(t,e){let n;if(e.document)n=TR(t.ne,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=U.fromSegments(e.noDocument.path),r=Po(e.noDocument.readTime);n=Ke.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return H();{const s=U.fromSegments(e.unknownDocument.path),r=Po(e.unknownDocument.version);n=Ke.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(s){const r=new Ze(s[0],s[1]);return re.fromTimestamp(r)}(e.readTime)),n}function NI(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:$d(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(r,i){return{name:cu(r,i.key),fields:i.data.value.mapValue.fields,updateTime:au(r,i.version.toTimestamp())}}(t.ne,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:No(e.version)};else{if(!e.isUnknownDocument())return H();s.unknownDocument={path:n.path.toArray(),version:No(e.version)}}return s}function $d(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function No(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Po(t){const e=new Ze(t.seconds,t.nanoseconds);return re.fromTimestamp(e)}function Hi(t,e){const n=(e.baseMutations||[]).map(i=>Xm(t.ne,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const a=e.mutations[i+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>Xm(t.ne,i)),r=Ze.fromMillis(e.localWriteTimeMs);return new Dv(e.batchId,r,n,s)}function Yc(t){const e=Po(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?Po(t.lastLimboFreeSnapshotVersion):re.min();let s;var r;return t.query.documents!==void 0?(ie((r=t.query).documents.length===1),s=hs(_c(IR(r.documents[0])))):s=function(i){return hs(kR(i))}(t.query),new ii(s,t.targetId,0,t.lastListenSequenceNumber,e,n,Tt.fromBase64String(t.resumeToken))}function MR(t,e){const n=No(e.snapshotVersion),s=No(e.lastLimboFreeSnapshotVersion);let r;r=Ld(e.target)?SR(t.ne,e.target):CR(t.ne,e.target);const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Ao(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Lv(t){const e=kR({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?eR(e,e.limit,"L"):e}function gg(t,e){return new Mv(e.largestBatchId,Xm(t.ne,e.overlayMutation))}function PI(t,e){const n=e.path.lastSegment();return[t,wn(e.path.popLast()),n]}function DI(t,e,n,s){return{indexId:t,uid:e.uid||"",sequenceNumber:n,readTime:No(s.readTime),documentKey:wn(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hK{getBundleMetadata(e,n){return OI(e).get(n).next(s=>{if(s)return{id:(r=s).bundleId,createTime:Po(r.createTime),version:r.version};var r})}saveBundleMetadata(e,n){return OI(e).put({bundleId:(s=n).id,createTime:No(Ot(s.createTime)),version:s.version});var s}getNamedQuery(e,n){return MI(e).get(n).next(s=>{if(s)return{name:(r=s).name,query:Lv(r.bundledQuery),readTime:Po(r.readTime)};var r})}saveNamedQuery(e,n){return MI(e).put(function(s){return{name:s.name,readTime:No(Ot(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function OI(t){return Kt(t,"bundles")}function MI(t){return Kt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp{constructor(e,n){this.wt=e,this.userId=n}static se(e,n){const s=n.uid||"";return new pp(e,s)}getOverlay(e,n){return Lc(e).get(PI(this.userId,n)).next(s=>s?gg(this.wt,s):null)}getOverlays(e,n){const s=Vs();return w.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const a=new Mv(n,o);r.push(this.ie(e,a))}),w.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(wn(o.getCollectionPath())));const i=[];return r.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(Lc(e).W("collectionPathOverlayIndex",a))}),w.waitFor(i)}getOverlaysForCollection(e,n,s){const r=Vs(),i=wn(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return Lc(e).K("collectionPathOverlayIndex",o).next(a=>{for(const c of a){const l=gg(this.wt,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=Vs();let o;const a=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Lc(e).J({index:"collectionGroupOverlayIndex",range:a},(c,l,u)=>{const h=gg(this.wt,l);i.size()<r||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):u.done()}).next(()=>i)}ie(e,n){return Lc(e).put(function(s,r,i){const[o,a,c]=PI(r,i.mutation.key);return{userId:r,collectionPath:a,documentId:c,collectionGroup:i.mutation.key.getCollectionGroup(),largestBatchId:i.largestBatchId,overlayMutation:uu(s.ne,i.mutation)}}(this.wt,this.userId,n))}}function Lc(t){return Kt(t,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(){}re(e,n){this.oe(e,n),n.ue()}oe(e,n){if("nullValue"in e)this.ce(n,5);else if("booleanValue"in e)this.ce(n,10),n.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(n,15),n.ae(nt(e.integerValue));else if("doubleValue"in e){const s=nt(e.doubleValue);isNaN(s)?this.ce(n,13):(this.ce(n,15),ru(s)?n.ae(0):n.ae(s))}else if("timestampValue"in e){const s=e.timestampValue;this.ce(n,20),typeof s=="string"?n.he(s):(n.he(`${s.seconds||""}`),n.ae(s.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,n),this.fe(n);else if("bytesValue"in e)this.ce(n,30),n.de(So(e.bytesValue)),this.fe(n);else if("referenceValue"in e)this._e(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.ce(n,45),n.ae(s.latitude||0),n.ae(s.longitude||0)}else"mapValue"in e?YA(e)?this.ce(n,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,n),this.fe(n)):"arrayValue"in e?(this.me(e.arrayValue,n),this.fe(n)):H()}le(e,n){this.ce(n,25),this.ge(e,n)}ge(e,n){n.he(e)}we(e,n){const s=e.fields||{};this.ce(n,55);for(const r of Object.keys(s))this.le(r,n),this.oe(s[r],n)}me(e,n){const s=e.values||[];this.ce(n,50);for(const r of s)this.oe(r,n)}_e(e,n){this.ce(n,37),U.fromName(e).path.forEach(s=>{this.ce(n,60),this.ge(s,n)})}ce(e,n){e.ae(n)}fe(e){e.ae(2)}}Wi.ye=new Wi;function dK(t){if(t===0)return 8;let e=0;return t>>4==0&&(e+=4,t<<=4),t>>6==0&&(e+=2,t<<=2),t>>7==0&&(e+=1),e}function LI(t){const e=64-function(n){let s=0;for(let r=0;r<8;++r){const i=dK(255&n[r]);if(s+=i,i!==8)break}return s}(t);return Math.ceil(e/8)}class fK{constructor(){this.buffer=new Uint8Array(1024),this.position=0}pe(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ie(s.value),s=n.next();this.Te()}Ee(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ae(s.value),s=n.next();this.Re()}be(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ie(s);else if(s<2048)this.Ie(960|s>>>6),this.Ie(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ie(480|s>>>12),this.Ie(128|63&s>>>6),this.Ie(128|63&s);else{const r=n.codePointAt(0);this.Ie(240|r>>>18),this.Ie(128|63&r>>>12),this.Ie(128|63&r>>>6),this.Ie(128|63&r)}}this.Te()}Pe(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ae(s);else if(s<2048)this.Ae(960|s>>>6),this.Ae(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ae(480|s>>>12),this.Ae(128|63&s>>>6),this.Ae(128|63&s);else{const r=n.codePointAt(0);this.Ae(240|r>>>18),this.Ae(128|63&r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r)}}this.Re()}ve(e){const n=this.Ve(e),s=LI(n);this.Se(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}De(e){const n=this.Ve(e),s=LI(n);this.Se(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}Ce(){this.xe(255),this.xe(255)}Ne(){this.ke(255),this.ke(255)}reset(){this.position=0}seed(e){this.Se(e.length),this.buffer.set(e,this.position),this.position+=e.length}Oe(){return this.buffer.slice(0,this.position)}Ve(e){const n=function(r){const i=new DataView(new ArrayBuffer(8));return i.setFloat64(0,r,!1),new Uint8Array(i.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ie(e){const n=255&e;n===0?(this.xe(0),this.xe(255)):n===255?(this.xe(255),this.xe(0)):this.xe(n)}Ae(e){const n=255&e;n===0?(this.ke(0),this.ke(255)):n===255?(this.ke(255),this.ke(0)):this.ke(e)}Te(){this.xe(0),this.xe(1)}Re(){this.ke(0),this.ke(1)}xe(e){this.Se(1),this.buffer[this.position++]=e}ke(e){this.Se(1),this.buffer[this.position++]=~e}Se(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class pK{constructor(e){this.Me=e}de(e){this.Me.pe(e)}he(e){this.Me.be(e)}ae(e){this.Me.ve(e)}ue(){this.Me.Ce()}}class gK{constructor(e){this.Me=e}de(e){this.Me.Ee(e)}he(e){this.Me.Pe(e)}ae(e){this.Me.De(e)}ue(){this.Me.Ne()}}class Fc{constructor(){this.Me=new fK,this.Fe=new pK(this.Me),this.$e=new gK(this.Me)}seed(e){this.Me.seed(e)}Be(e){return e===0?this.Fe:this.$e}Oe(){return this.Me.Oe()}reset(){this.Me.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Le(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new zi(this.indexId,this.documentKey,this.arrayValue,s)}}function Li(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=FI(t.arrayValue,e.arrayValue),n!==0?n:(n=FI(t.directionalValue,e.directionalValue),n!==0?n:U.comparator(t.documentKey,e.documentKey)))}function FI(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mK{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ue=e.orderBy,this.qe=[];for(const n of e.filters){const s=n;s.ht()?this.Ke=s:this.qe.push(s)}}Ge(e){const n=Wm(e);if(n!==void 0&&!this.Qe(n))return!1;const s=Vi(e);let r=0,i=0;for(;r<s.length&&this.Qe(s[r]);++r);if(r===s.length)return!0;if(this.Ke!==void 0){const o=s[r];if(!this.je(this.Ke,o)||!this.We(this.Ue[i++],o))return!1;++r}for(;r<s.length;++r){const o=s[r];if(i>=this.Ue.length||!this.We(this.Ue[i++],o))return!1}return!0}Qe(e){for(const n of this.qe)if(this.je(n,e))return!0;return!1}je(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}We(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _K{constructor(){this.ze=new Fv}addToCollectionParentIndex(e,n){return this.ze.add(n),w.resolve()}getCollectionParents(e,n){return w.resolve(this.ze.getEntries(n))}addFieldIndex(e,n){return w.resolve()}deleteFieldIndex(e,n){return w.resolve()}getDocumentsMatchingTarget(e,n){return w.resolve(null)}getIndexType(e,n){return w.resolve(0)}getFieldIndexes(e,n){return w.resolve([])}getNextCollectionGroupToUpdate(e){return w.resolve(null)}getMinOffset(e,n){return w.resolve(Jn.min())}getMinOffsetFromCollectionGroup(e,n){return w.resolve(Jn.min())}updateCollectionGroup(e,n,s){return w.resolve()}updateIndexEntries(e,n){return w.resolve()}}class Fv{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new Re(be.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new Re(be.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh=new Uint8Array(0);class yK{constructor(e,n){this.user=e,this.databaseId=n,this.He=new Fv,this.Je=new Ni(s=>Ao(s),(s,r)=>Wu(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.He.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.He.add(n)});const i={collectionId:s,parent:wn(r)};return $I(e).put(i)}return w.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[VA(n),""],!1,!0);return $I(e).K(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(qs(o.parent))}return s})}addFieldIndex(e,n){const s=Ih(e),r=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=Uc(e);return i.next(a=>{o.put(DI(a,this.user,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=Ih(e),r=Uc(e),i=$c(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,n){const s=$c(e);let r=!0;const i=new Map;return w.forEach(this.Ye(n),o=>this.Xe(e,o).next(a=>{r&&(r=!!a),i.set(o,a)})).next(()=>{if(r){let o=de();const a=[];return w.forEach(i,(c,l)=>{var u;x("IndexedDbIndexManager",`Using index ${u=c,`id=${u.indexId}|cg=${u.collectionGroup}|f=${u.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`} to execute ${Ao(n)}`);const h=function(T,$){const z=Wm($);if(z===void 0)return null;for(const te of Fd(T,z.fieldPath))switch(te.op){case"array-contains-any":return te.value.arrayValue.values||[];case"array-contains":return[te.value]}return null}(l,c),d=function(T,$){const z=new Map;for(const te of Vi($))for(const J of Fd(T,te.fieldPath))switch(J.op){case"==":case"in":z.set(te.fieldPath.canonicalString(),J.value);break;case"not-in":case"!=":return z.set(te.fieldPath.canonicalString(),J.value),Array.from(z.values())}return null}(l,c),f=function(T,$){const z=[];let te=!0;for(const J of Vi($)){const ae=J.kind===0?_I(T,J.fieldPath,T.startAt):yI(T,J.fieldPath,T.startAt);z.push(ae.value),te&&(te=ae.inclusive)}return new bi(z,te)}(l,c),p=function(T,$){const z=[];let te=!0;for(const J of Vi($)){const ae=J.kind===0?yI(T,J.fieldPath,T.endAt):_I(T,J.fieldPath,T.endAt);z.push(ae.value),te&&(te=ae.inclusive)}return new bi(z,te)}(l,c),_=this.Ze(c,l,f),v=this.Ze(c,l,p),b=this.tn(c,l,d),N=this.en(c.indexId,h,_,f.inclusive,v,p.inclusive,b);return w.forEach(N,T=>s.j(T,n.limit).next($=>{$.forEach(z=>{const te=U.fromSegments(z.documentKey);o.has(te)||(o=o.add(te),a.push(te))})}))}).next(()=>a)}return w.resolve(null)})}Ye(e){let n=this.Je.get(e);return n||(n=[e],this.Je.set(e,n),n)}en(e,n,s,r,i,o,a){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),l=c/(n!=null?n.length:1),u=[];for(let h=0;h<c;++h){const d=n?this.nn(n[h/l]):bh,f=this.sn(e,d,s[h%l],r),p=this.rn(e,d,i[h%l],o),_=a.map(v=>this.sn(e,d,v,!0));u.push(...this.createRange(f,p,_))}return u}sn(e,n,s,r){const i=new zi(e,U.empty(),n,s);return r?i:i.Le()}rn(e,n,s,r){const i=new zi(e,U.empty(),n,s);return r?i.Le():i}Xe(e,n){const s=new mK(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const a of i)s.Ge(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let s=2;return w.forEach(this.Ye(n),r=>this.Xe(e,r).next(i=>{i?s!==0&&i.fields.length<function(o){let a=new Re(at.comparator),c=!1;for(const l of o.filters){const u=l;u.field.isKeyField()||(u.op==="array-contains"||u.op==="array-contains-any"?c=!0:a=a.add(u.field))}for(const l of o.orderBy)l.field.isKeyField()||(a=a.add(l.field));return a.size+(c?1:0)}(r)&&(s=1):s=0})).next(()=>s)}on(e,n){const s=new Fc;for(const r of Vi(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.Be(r.kind);Wi.ye.re(i,o)}return s.Oe()}nn(e){const n=new Fc;return Wi.ye.re(e,n.Be(0)),n.Oe()}un(e,n){const s=new Fc;return Wi.ye.re(ko(this.databaseId,n),s.Be(function(r){const i=Vi(r);return i.length===0?0:i[i.length-1].kind}(e))),s.Oe()}tn(e,n,s){if(s===null)return[];let r=[];r.push(new Fc);let i=0;for(const o of Vi(e)){const a=s[i++];for(const c of r)if(this.cn(n,o.fieldPath)&&ou(a))r=this.an(r,o,a);else{const l=c.Be(o.kind);Wi.ye.re(a,l)}}return this.hn(r)}Ze(e,n,s){return this.tn(e,n,s.position)}hn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].Oe();return n}an(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const a of r){const c=new Fc;c.seed(a.Oe()),Wi.ye.re(o,c.Be(n.kind)),i.push(c)}return i}cn(e,n){return!!e.filters.find(s=>s instanceof Qt&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=Ih(e),r=Uc(e);return(n?s.K("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.K()).next(i=>{const o=[];return w.forEach(i,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(l,u){const h=u?new Md(u.sequenceNumber,new Jn(Po(u.readTime),new U(qs(u.documentKey)),u.largestBatchId)):Md.empty(),d=l.fields.map(([f,p])=>new Zj(at.fromServerFormat(f),p));return new qA(l.indexId,l.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:ue(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=Ih(e),i=Uc(e);return this.ln(e).next(o=>r.K("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>w.forEach(a,c=>i.put(DI(c.indexId,this.user,o,s)))))}updateIndexEntries(e,n){const s=new Map;return w.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?w.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(a=>(s.set(r.collectionGroup,a),w.forEach(a,c=>this.fn(e,r,c).next(l=>{const u=this.dn(i,c);return l.isEqual(u)?w.resolve():this._n(e,i,c,l,u)}))))})}wn(e,n,s,r){return $c(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.un(s,n.key),documentKey:n.key.path.toArray()})}mn(e,n,s,r){return $c(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.un(s,n.key),n.key.path.toArray()])}fn(e,n,s){const r=$c(e);let i=new Re(Li);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.un(s,n)])},(o,a)=>{i=i.add(new zi(s.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>i)}dn(e,n){let s=new Re(Li);const r=this.on(n,e);if(r==null)return s;const i=Wm(n);if(i!=null){const o=e.data.field(i.fieldPath);if(ou(o))for(const a of o.arrayValue.values||[])s=s.add(new zi(n.indexId,e.key,this.nn(a),r))}else s=s.add(new zi(n.indexId,e.key,bh,r));return s}_n(e,n,s,r,i){x("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(a,c,l,u,h){const d=a.getIterator(),f=c.getIterator();let p=ea(d),_=ea(f);for(;p||_;){let v=!1,b=!1;if(p&&_){const N=l(p,_);N<0?b=!0:N>0&&(v=!0)}else p!=null?b=!0:v=!0;v?(u(_),_=ea(f)):b?(h(p),p=ea(d)):(p=ea(d),_=ea(f))}}(r,i,Li,a=>{o.push(this.wn(e,n,s,a))},a=>{o.push(this.mn(e,n,s,a))}),w.waitFor(o)}ln(e){let n=1;return Uc(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,a)=>Li(o,a)).filter((o,a,c)=>!a||Li(o,c[a-1])!==0);const r=[];r.push(e);for(const o of s){const a=Li(o,e),c=Li(o,n);if(a===0)r[0]=e.Le();else if(a>0&&c<0)r.push(o),r.push(o.Le());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2)i.push(IDBKeyRange.bound([r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,bh,[]],[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,bh,[]]));return i}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(UI)}getMinOffset(e,n){return w.mapArray(this.Ye(n),s=>this.Xe(e,s).next(r=>r||H())).next(UI)}}function $I(t){return Kt(t,"collectionParents")}function $c(t){return Kt(t,"indexEntries")}function Ih(t){return Kt(t,"indexConfiguration")}function Uc(t){return Kt(t,"indexState")}function UI(t){ie(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;Tv(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new Jn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Cn{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new Cn(e,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LR(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=s.J({range:o},(u,h,d)=>(a++,d.delete()));i.push(c.next(()=>{ie(a===1)}));const l=[];for(const u of n.mutations){const h=xR(e,u.key.path,n.batchId);i.push(r.delete(h)),l.push(u.key)}return w.waitFor(i).next(()=>l)}function Ud(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw H();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Cn.DEFAULT_COLLECTION_PERCENTILE=10,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Cn.DEFAULT=new Cn(41943040,Cn.DEFAULT_COLLECTION_PERCENTILE,Cn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Cn.DISABLED=new Cn(-1,0,0);class gp{constructor(e,n,s,r){this.userId=e,this.wt=n,this.indexManager=s,this.referenceDelegate=r,this.gn={}}static se(e,n,s,r){ie(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new gp(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Br(e).J({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=la(e),o=Br(e);return o.add({}).next(a=>{ie(typeof a=="number");const c=new Dv(a,n,s,r),l=function(d,f,p){const _=p.baseMutations.map(b=>uu(d.ne,b)),v=p.mutations.map(b=>uu(d.ne,b));return{userId:f,batchId:p.batchId,localWriteTimeMs:p.localWriteTime.toMillis(),baseMutations:_,mutations:v}}(this.wt,this.userId,c),u=[];let h=new Re((d,f)=>ue(d.canonicalString(),f.canonicalString()));for(const d of r){const f=xR(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),u.push(o.put(l)),u.push(i.put(f,z6))}return h.forEach(d=>{u.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.gn[a]=c.keys()}),w.waitFor(u).next(()=>c)})}lookupMutationBatch(e,n){return Br(e).get(n).next(s=>s?(ie(s.userId===this.userId),Hi(this.wt,s)):null)}yn(e,n){return this.gn[n]?w.resolve(this.gn[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.gn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return Br(e).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(ie(a.batchId>=s),i=Hi(this.wt,a)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return Br(e).J({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Br(e).K("userMutationsIndex",n).next(s=>s.map(r=>Hi(this.wt,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=qh(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return la(e).J({range:r},(o,a,c)=>{const[l,u,h]=o,d=qs(u);if(l===this.userId&&n.path.isEqual(d))return Br(e).get(h).next(f=>{if(!f)throw H();ie(f.userId===this.userId),i.push(Hi(this.wt,f))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Re(ue);const r=[];return n.forEach(i=>{const o=qh(this.userId,i.path),a=IDBKeyRange.lowerBound(o),c=la(e).J({range:a},(l,u,h)=>{const[d,f,p]=l,_=qs(f);d===this.userId&&i.path.isEqual(_)?s=s.add(p):h.done()});r.push(c)}),w.waitFor(r).next(()=>this.pn(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=qh(this.userId,s),o=IDBKeyRange.lowerBound(i);let a=new Re(ue);return la(e).J({range:o},(c,l,u)=>{const[h,d,f]=c,p=qs(d);h===this.userId&&s.isPrefixOf(p)?p.length===r&&(a=a.add(f)):u.done()}).next(()=>this.pn(e,a))}pn(e,n){const s=[],r=[];return n.forEach(i=>{r.push(Br(e).get(i).next(o=>{if(o===null)throw H();ie(o.userId===this.userId),s.push(Hi(this.wt,o))}))}),w.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return LR(e.ee,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.In(n.batchId)}),w.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}In(e){delete this.gn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return w.resolve();const s=IDBKeyRange.lowerBound([this.userId]),r=[];return la(e).J({range:s},(i,o,a)=>{if(i[0]===this.userId){const c=qs(i[1]);r.push(c)}else a.done()}).next(()=>{ie(r.length===0)})})}containsKey(e,n){return FR(e,this.userId,n)}Tn(e){return $R(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function FR(t,e,n){const s=qh(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return la(t).J({range:i,H:!0},(a,c,l)=>{const[u,h,d]=a;u===e&&h===r&&(o=!0),l.done()}).next(()=>o)}function Br(t){return Kt(t,"mutations")}function la(t){return Kt(t,"documentMutations")}function $R(t){return Kt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e){this.En=e}next(){return this.En+=2,this.En}static An(){return new Do(0)}static Rn(){return new Do(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vK{constructor(e,n){this.referenceDelegate=e,this.wt=n}allocateTargetId(e){return this.bn(e).next(n=>{const s=new Do(n.highestTargetId);return n.highestTargetId=s.next(),this.Pn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.bn(e).next(n=>re.fromTimestamp(new Ze(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.bn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.bn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Pn(e,r)))}addTargetData(e,n){return this.vn(e,n).next(()=>this.bn(e).next(s=>(s.targetCount+=1,this.Vn(n,s),this.Pn(e,s))))}updateTargetData(e,n){return this.vn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>na(e).delete(n.targetId)).next(()=>this.bn(e)).next(s=>(ie(s.targetCount>0),s.targetCount-=1,this.Pn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return na(e).J((o,a)=>{const c=Yc(a);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>w.waitFor(i)).next(()=>r)}forEachTarget(e,n){return na(e).J((s,r)=>{const i=Yc(r);n(i)})}bn(e){return VI(e).get("targetGlobalKey").next(n=>(ie(n!==null),n))}Pn(e,n){return VI(e).put("targetGlobalKey",n)}vn(e,n){return na(e).put(MR(this.wt,n))}Vn(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.bn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=Ao(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return na(e).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{const l=Yc(a);Wu(n,l.target)&&(i=l,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=zr(e);return n.forEach(o=>{const a=wn(o.path);r.push(i.put({targetId:s,path:a})),r.push(this.referenceDelegate.addReference(e,s,o))}),w.waitFor(r)}removeMatchingKeys(e,n,s){const r=zr(e);return w.forEach(n,i=>{const o=wn(i.path);return w.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=zr(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=zr(e);let i=de();return r.J({range:s,H:!0},(o,a,c)=>{const l=qs(o[1]),u=new U(l);i=i.add(u)}).next(()=>i)}containsKey(e,n){const s=wn(n.path),r=IDBKeyRange.bound([s],[VA(s)],!1,!0);let i=0;return zr(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,l)=>{o!==0&&(i++,l.done())}).next(()=>i>0)}te(e,n){return na(e).get(n).next(s=>s?Yc(s):null)}}function na(t){return Kt(t,"targets")}function VI(t){return Kt(t,"targetGlobal")}function zr(t){return Kt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qI([t,e],[n,s]){const r=ue(t,n);return r===0?ue(e,s):r}class wK{constructor(e){this.Sn=e,this.buffer=new Re(qI),this.Dn=0}Cn(){return++this.Dn}xn(e){const n=[e,this.Cn()];if(this.buffer.size<this.Sn)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();qI(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class bK{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.Nn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.kn(6e4)}stop(){this.Nn&&(this.Nn.cancel(),this.Nn=null)}get started(){return this.Nn!==null}kn(e){x("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Nn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Nn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xi(n)?x("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Ri(n)}await this.kn(3e5)})}}class IK{constructor(e,n){this.On=e,this.params=n}calculateTargetCount(e,n){return this.On.Mn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return w.resolve(xn.ot);const s=new wK(n);return this.On.forEachTarget(e,r=>s.xn(r.sequenceNumber)).next(()=>this.On.Fn(e,r=>s.xn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.On.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.On.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(x("LruGarbageCollector","Garbage collection skipped; disabled"),w.resolve(BI)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(x("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),BI):this.$n(e,n))}getCacheSize(e){return this.On.getCacheSize(e)}$n(e,n){let s,r,i,o,a,c,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(x("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),r=this.params.maximumSequenceNumbersToCollect):r=h,o=Date.now(),this.nthSequenceNumber(e,r))).next(h=>(s=h,a=Date.now(),this.removeTargets(e,s,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(h=>(l=Date.now(),Hm()<=pe.DEBUG&&x("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${i} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(l-c)+`ms
Total Duration: ${l-u}ms`),w.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:h})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EK{constructor(e,n){this.db=e,this.garbageCollector=function(s,r){return new IK(s,r)}(this,n)}Mn(e){const n=this.Bn(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}Bn(e){let n=0;return this.Fn(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Fn(e,n){return this.Ln(e,(s,r)=>n(r))}addReference(e,n,s){return Eh(e,s)}removeReference(e,n,s){return Eh(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return Eh(e,n)}Un(e,n){return function(s,r){let i=!1;return $R(s).Y(o=>FR(s,o,r).next(a=>(a&&(i=!0),w.resolve(!a)))).next(()=>i)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Ln(e,(o,a)=>{if(a<=n){const c=this.Un(e,o).next(l=>{if(!l)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,re.min()),zr(e).delete([0,wn(o.path)])))});r.push(c)}}).next(()=>w.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return Eh(e,n)}Ln(e,n){const s=zr(e);let r,i=xn.ot;return s.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(i!==xn.ot&&n(new U(qs(r)),i),i=l,r=c):i=xn.ot}).next(()=>{i!==xn.ot&&n(new U(qs(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Eh(t,e){return zr(t).put(function(n,s){return{targetId:0,path:wn(n.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UR{constructor(){this.changes=new Ni(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ke.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?w.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TK{constructor(e){this.wt=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return Fi(e).put(s)}removeEntry(e,n,s){return Fi(e).delete(function(r,i){const o=r.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],$d(i),o[o.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.qn(e,s)))}getEntry(e,n){let s=Ke.newInvalidDocument(n);return Fi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bc(n))},(r,i)=>{s=this.Kn(n,i)}).next(()=>s)}Gn(e,n){let s={size:0,document:Ke.newInvalidDocument(n)};return Fi(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Bc(n))},(r,i)=>{s={document:this.Kn(n,i),size:Ud(i)}}).next(()=>s)}getEntries(e,n){let s=Nn();return this.Qn(e,n,(r,i)=>{const o=this.Kn(r,i);s=s.insert(r,o)}).next(()=>s)}jn(e,n){let s=Nn(),r=new rt(U.comparator);return this.Qn(e,n,(i,o)=>{const a=this.Kn(i,o);s=s.insert(i,a),r=r.insert(i,Ud(o))}).next(()=>({documents:s,Wn:r}))}Qn(e,n,s){if(n.isEmpty())return w.resolve();let r=new Re(HI);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(Bc(r.first()),Bc(r.last())),o=r.getIterator();let a=o.getNext();return Fi(e).J({index:"documentKeyIndex",range:i},(c,l,u)=>{const h=U.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&HI(a,h)<0;)s(a,null),a=o.getNext();a&&a.isEqual(h)&&(s(a,l),a=o.hasNext()?o.getNext():null),a?u.q(Bc(a)):u.done()}).next(()=>{for(;a;)s(a,null),a=o.hasNext()?o.getNext():null})}getAllFromCollection(e,n,s){const r=[n.popLast().toArray(),n.lastSegment(),$d(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],i=[n.popLast().toArray(),n.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fi(e).K(IDBKeyRange.bound(r,i,!0)).next(o=>{let a=Nn();for(const c of o){const l=this.Kn(U.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);a=a.insert(l.key,l)}return a})}getAllFromCollectionGroup(e,n,s,r){let i=Nn();const o=KI(n,s),a=KI(n,Jn.max());return Fi(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,u)=>{const h=this.Kn(U.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);i=i.insert(h.key,h),i.size===r&&u.done()}).next(()=>i)}newChangeBuffer(e){return new SK(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return jI(e).get("remoteDocumentGlobalKey").next(n=>(ie(!!n),n))}qn(e,n){return jI(e).put("remoteDocumentGlobalKey",n)}Kn(e,n){if(n){const s=uK(this.wt,n);if(!(s.isNoDocument()&&s.version.isEqual(re.min())))return s}return Ke.newInvalidDocument(e)}}function BR(t){return new TK(t)}class SK extends UR{constructor(e,n){super(),this.zn=e,this.trackRemovals=n,this.Hn=new Ni(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new Re((i,o)=>ue(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const a=this.Hn.get(i);if(n.push(this.zn.removeEntry(e,i,a.readTime)),o.isValidDocument()){const c=NI(this.zn.wt,o);r=r.add(i.path.popLast()),s+=Ud(c)-a.size,n.push(this.zn.addEntry(e,i,c))}else if(s-=a.size,this.trackRemovals){const c=NI(this.zn.wt,o.convertToNoDocument(re.min()));n.push(this.zn.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.zn.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.zn.updateMetadata(e,s)),w.waitFor(n)}getFromCache(e,n){return this.zn.Gn(e,n).next(s=>(this.Hn.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.zn.jn(e,n).next(({documents:s,Wn:r})=>(r.forEach((i,o)=>{this.Hn.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function jI(t){return Kt(t,"remoteDocumentGlobal")}function Fi(t){return Kt(t,"remoteDocumentsV14")}function Bc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function KI(t,e){const n=e.documentKey.path.toArray();return[t,$d(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function HI(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=ue(n[i],s[i]),r)return r;return r=ue(n.length,s.length),r||(r=ue(n[n.length-2],s[s.length-2]),r||ue(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CK{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VR{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.getBaseDocument(e,n,s))).next(r=>(s!==null&&pl(s.mutation,r,Gn.empty(),Ze.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,de()).next(()=>s))}getLocalViewOfDocuments(e,n,s=de()){const r=Vs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=Qc();return i.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=Vs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,de()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,s,r){let i=Nn();const o=gl(),a=gl();return n.forEach((c,l)=>{const u=s.get(l.key);r.has(l.key)&&(u===void 0||u.mutation instanceof Dr)?i=i.insert(l.key,l):u!==void 0&&(o.set(l.key,u.mutation.getFieldMask()),pl(u.mutation,l,u.mutation.getFieldMask(),Ze.now()))}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((l,u)=>o.set(l,u)),n.forEach((l,u)=>{var h;return a.set(l,new CK(u,(h=o.get(l))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const s=gl();let r=new rt((o,a)=>o-a),i=de();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(c=>{const l=n.get(c);if(l===null)return;let u=s.get(c)||Gn.empty();u=a.applyToLocalView(l,u),s.set(c,u);const h=(r.get(a.batchId)||de()).add(c);r=r.insert(a.batchId,h)})}).next(()=>{const o=[],a=r.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),l=c.key,u=c.value,h=_R();u.forEach(d=>{if(!i.has(d)){const f=hR(n.get(d),s.get(d));f!==null&&h.set(d,f),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,l,h))}return w.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s){return function(r){return U.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Rv(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s):this.getDocumentsMatchingCollectionQuery(e,n,s)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):w.resolve(Vs());let a=-1,c=i;return o.next(l=>w.forEach(l,(u,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),i.get(u)?w.resolve():this.getBaseDocument(e,u,h).next(d=>{c=c.insert(u,d)}))).next(()=>this.populateOverlays(e,l,i)).next(()=>this.computeViews(e,c,l,de())).next(u=>({batchId:a,changes:mR(u)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new U(n)).next(s=>{let r=Qc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s){const r=n.collectionGroup;let i=Qc();return this.indexManager.getCollectionParents(e,r).next(o=>w.forEach(o,a=>{const c=function(l,u){return new Pr(u,null,l.explicitOrderBy.slice(),l.filters.slice(),l.limit,l.limitType,l.startAt,l.endAt)}(n,a.child(r));return this.getDocumentsMatchingCollectionQuery(e,c,s).next(l=>{l.forEach((u,h)=>{i=i.insert(u,h)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,n,s){let r;return this.remoteDocumentCache.getAllFromCollection(e,n.path,s).next(i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId))).next(i=>{i.forEach((a,c)=>{const l=c.getKey();r.get(l)===null&&(r=r.insert(l,Ke.newInvalidDocument(l)))});let o=Qc();return r.forEach((a,c)=>{const l=i.get(a);l!==void 0&&pl(l.mutation,c,Gn.empty(),Ze.now()),xv(n,c)&&(o=o.insert(a,c))}),o})}getBaseDocument(e,n,s){return s===null||s.mutation.type===1?this.remoteDocumentCache.getEntry(e,n):w.resolve(Ke.newInvalidDocument(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kK{constructor(e){this.wt=e,this.Jn=new Map,this.Yn=new Map}getBundleMetadata(e,n){return w.resolve(this.Jn.get(n))}saveBundleMetadata(e,n){var s;return this.Jn.set(n.id,{id:(s=n).id,version:s.version,createTime:Ot(s.createTime)}),w.resolve()}getNamedQuery(e,n){return w.resolve(this.Yn.get(n))}saveNamedQuery(e,n){return this.Yn.set(n.name,function(s){return{name:s.name,query:Lv(s.bundledQuery),readTime:Ot(s.readTime)}}(n)),w.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AK{constructor(){this.overlays=new rt(U.comparator),this.Xn=new Map}getOverlay(e,n){return w.resolve(this.overlays.get(n))}getOverlays(e,n){const s=Vs();return w.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ie(e,n,i)}),w.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Xn.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Xn.delete(s)),w.resolve()}getOverlaysForCollection(e,n,s){const r=Vs(),i=n.length+1,o=new U(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,l=c.getKey();if(!n.isPrefixOf(l.path))break;l.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return w.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new rt((l,u)=>l-u);const o=this.overlays.getIterator();for(;o.hasNext();){const l=o.getNext().value;if(l.getKey().getCollectionGroup()===n&&l.largestBatchId>s){let u=i.get(l.largestBatchId);u===null&&(u=Vs(),i=i.insert(l.largestBatchId,u)),u.set(l.getKey(),l)}}const a=Vs(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,u)=>a.set(l,u)),!(a.size()>=r)););return w.resolve(a)}ie(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Xn.get(r.largestBatchId).delete(s.key);this.Xn.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new Mv(n,s));let i=this.Xn.get(n);i===void 0&&(i=de(),this.Xn.set(n,i)),this.Xn.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(){this.Zn=new Re(kt.ts),this.es=new Re(kt.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,n){const s=new kt(e,n);this.Zn=this.Zn.add(s),this.es=this.es.add(s)}ss(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.rs(new kt(e,n))}os(e,n){e.forEach(s=>this.removeReference(s,n))}us(e){const n=new U(new be([])),s=new kt(n,e),r=new kt(n,e+1),i=[];return this.es.forEachInRange([s,r],o=>{this.rs(o),i.push(o.key)}),i}cs(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const n=new U(new be([])),s=new kt(n,e),r=new kt(n,e+1);let i=de();return this.es.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new kt(e,0),s=this.Zn.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class kt{constructor(e,n){this.key=e,this.ls=n}static ts(e,n){return U.comparator(e.key,n.key)||ue(e.ls,n.ls)}static ns(e,n){return ue(e.ls,n.ls)||U.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RK{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new Re(kt.ts)}checkEmpty(e){return w.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Dv(i,n,s,r);this.mutationQueue.push(o);for(const a of r)this.ds=this.ds.add(new kt(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return w.resolve(o)}lookupMutationBatch(e,n){return w.resolve(this._s(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.ws(s),i=r<0?0:r;return w.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return w.resolve(this.mutationQueue.length===0?-1:this.fs-1)}getAllMutationBatches(e){return w.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new kt(n,0),r=new kt(n,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([s,r],o=>{const a=this._s(o.ls);i.push(a)}),w.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new Re(ue);return n.forEach(r=>{const i=new kt(r,0),o=new kt(r,Number.POSITIVE_INFINITY);this.ds.forEachInRange([i,o],a=>{s=s.add(a.ls)})}),w.resolve(this.gs(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;U.isDocumentKey(i)||(i=i.child(""));const o=new kt(new U(i),0);let a=new Re(ue);return this.ds.forEachWhile(c=>{const l=c.key.path;return!!s.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.ls)),!0)},o),w.resolve(this.gs(a))}gs(e){const n=[];return e.forEach(s=>{const r=this._s(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ie(this.ys(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.ds;return w.forEach(n.mutations,r=>{const i=new kt(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.ds=s})}In(e){}containsKey(e,n){const s=new kt(n,0),r=this.ds.firstAfterOrEqual(s);return w.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,w.resolve()}ys(e,n){return this.ws(e)}ws(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}_s(e){const n=this.ws(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xK{constructor(e){this.ps=e,this.docs=new rt(U.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.ps(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return w.resolve(s?s.document.mutableCopy():Ke.newInvalidDocument(n))}getEntries(e,n){let s=Nn();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Ke.newInvalidDocument(r))}),w.resolve(s)}getAllFromCollection(e,n,s){let r=Nn();const i=new U(n.child("")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:a,value:{document:c}}=o.getNext();if(!n.isPrefixOf(a.path))break;a.path.length>n.length+1||Tv(KA(c),s)<=0||(r=r.insert(c.key,c.mutableCopy()))}return w.resolve(r)}getAllFromCollectionGroup(e,n,s,r){H()}Is(e,n){return w.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new NK(this)}getSize(e){return w.resolve(this.size)}}class NK extends UR{constructor(e){super(),this.zn=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.zn.addEntry(e,r)):this.zn.removeEntry(s)}),w.waitFor(n)}getFromCache(e,n){return this.zn.getEntry(e,n)}getAllFromCache(e,n){return this.zn.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PK{constructor(e){this.persistence=e,this.Ts=new Ni(n=>Ao(n),Wu),this.lastRemoteSnapshotVersion=re.min(),this.highestTargetId=0,this.Es=0,this.As=new $v,this.targetCount=0,this.Rs=Do.An()}forEachTarget(e,n){return this.Ts.forEach((s,r)=>n(r)),w.resolve()}getLastRemoteSnapshotVersion(e){return w.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return w.resolve(this.Es)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),w.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Es&&(this.Es=n),w.resolve()}vn(e){this.Ts.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.Rs=new Do(n),this.highestTargetId=n),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}addTargetData(e,n){return this.vn(n),this.targetCount+=1,w.resolve()}updateTargetData(e,n){return this.vn(n),w.resolve()}removeTargetData(e,n){return this.Ts.delete(n.target),this.As.us(n.targetId),this.targetCount-=1,w.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Ts.forEach((o,a)=>{a.sequenceNumber<=n&&s.get(a.targetId)===null&&(this.Ts.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)}),w.waitFor(i).next(()=>r)}getTargetCount(e){return w.resolve(this.targetCount)}getTargetData(e,n){const s=this.Ts.get(n)||null;return w.resolve(s)}addMatchingKeys(e,n,s){return this.As.ss(n,s),w.resolve()}removeMatchingKeys(e,n,s){this.As.os(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),w.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.As.us(n),w.resolve()}getMatchingKeysForTargetId(e,n){const s=this.As.hs(n);return w.resolve(s)}containsKey(e,n){return w.resolve(this.As.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qR{constructor(e,n){this.bs={},this.overlays={},this.Ps=new xn(0),this.vs=!1,this.vs=!0,this.referenceDelegate=e(this),this.Vs=new PK(this),this.indexManager=new _K,this.remoteDocumentCache=function(s){return new xK(s)}(s=>this.referenceDelegate.Ss(s)),this.wt=new OR(n),this.Ds=new kK(this.wt)}start(){return Promise.resolve()}shutdown(){return this.vs=!1,Promise.resolve()}get started(){return this.vs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new AK,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.bs[e.toKey()];return s||(s=new RK(n,this.referenceDelegate),this.bs[e.toKey()]=s),s}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ds}runTransaction(e,n,s){x("MemoryPersistence","Starting transaction:",e);const r=new DK(this.Ps.next());return this.referenceDelegate.Cs(),s(r).next(i=>this.referenceDelegate.xs(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Ns(e,n){return w.or(Object.values(this.bs).map(s=>()=>s.containsKey(e,n)))}}class DK extends WA{constructor(e){super(),this.currentSequenceNumber=e}}class mp{constructor(e){this.persistence=e,this.ks=new $v,this.Os=null}static Ms(e){return new mp(e)}get Fs(){if(this.Os)return this.Os;throw H()}addReference(e,n,s){return this.ks.addReference(s,n),this.Fs.delete(s.toString()),w.resolve()}removeReference(e,n,s){return this.ks.removeReference(s,n),this.Fs.add(s.toString()),w.resolve()}markPotentiallyOrphaned(e,n){return this.Fs.add(n.toString()),w.resolve()}removeTarget(e,n){this.ks.us(n.targetId).forEach(r=>this.Fs.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Fs.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}Cs(){this.Os=new Set}xs(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return w.forEach(this.Fs,s=>{const r=U.fromPath(s);return this.$s(e,r).next(i=>{i||n.removeEntry(r,re.min())})}).next(()=>(this.Os=null,n.apply(e)))}updateLimboDocument(e,n){return this.$s(e,n).next(s=>{s?this.Fs.delete(n.toString()):this.Fs.add(n.toString())})}Ss(e){return 0}$s(e,n){return w.or([()=>w.resolve(this.ks.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ns(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OK{constructor(e){this.wt=e}O(e,n,s,r){const i=new up("createOrUpgrade",n);s<1&&r>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xI,{unique:!0}),a.createObjectStore("documentMutations")}(e),WI(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=w.resolve();return s<3&&r>=3&&(s!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),WI(e)),o=o.next(()=>function(a){const c=a.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:re.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").K().next(l=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xI,{unique:!0});const u=c.store("mutations"),h=l.map(d=>u.put(d));return w.waitFor(h)})}(e,i))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.Bs(i))),s<6&&r>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Ls(i)))),s<7&&r>=7&&(o=o.next(()=>this.Us(i))),s<8&&r>=8&&(o=o.next(()=>this.qs(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.Ks(i))),s<11&&r>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(a){const c=a.createObjectStore("documentOverlays",{keyPath:iK});c.createIndex("collectionPathOverlayIndex",oK,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",aK,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(a){const c=a.createObjectStore("remoteDocumentsV14",{keyPath:G6});c.createIndex("documentKeyIndex",Q6),c.createIndex("collectionGroupIndex",Y6)}(e)).next(()=>this.Gs(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.Qs(e,i))),s<15&&r>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:tK}).createIndex("sequenceNumberIndex",nK,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:sK}).createIndex("documentKeyIndex",rK,{unique:!1})}(e))),o}Ls(e){let n=0;return e.store("remoteDocuments").J((s,r)=>{n+=Ud(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}Bs(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.K().next(r=>w.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.K("userMutationsIndex",o).next(a=>w.forEach(a,c=>{ie(c.userId===i.userId);const l=Hi(this.wt,c);return LR(e,i.userId,l).next(()=>{})}))}))}Us(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.J((o,a)=>{const c=new be(o),l=function(u){return[0,wn(u)]}(c);i.push(n.get(l).next(u=>u?w.resolve():(h=>n.put({targetId:0,path:wn(h),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>w.waitFor(i))})}qs(e,n){e.createObjectStore("collectionParents",{keyPath:eK});const s=n.store("collectionParents"),r=new Fv,i=o=>{if(r.add(o)){const a=o.lastSegment(),c=o.popLast();return s.put({collectionId:a,parent:wn(c)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const c=new be(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,c],l)=>{const u=qs(a);return i(u.popLast())}))}Ks(e){const n=e.store("targets");return n.J((s,r)=>{const i=Yc(r),o=MR(this.wt,i);return n.put(o)})}Gs(e,n){const s=n.store("remoteDocuments"),r=[];return s.J((i,o)=>{const a=n.store("remoteDocumentsV14"),c=(l=o,l.document?new U(be.fromString(l.document.name).popFirst(5)):l.noDocument?U.fromSegments(l.noDocument.path):l.unknownDocument?U.fromSegments(l.unknownDocument.path):H()).path.toArray();var l;/**
* @license
* Copyright 2017 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/const u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(u))}).next(()=>w.waitFor(r))}Qs(e,n){const s=n.store("mutations"),r=BR(this.wt),i=new qR(mp.Ms,this.wt.ne);return s.K().next(o=>{const a=new Map;return o.forEach(c=>{var l;let u=(l=a.get(c.userId))!==null&&l!==void 0?l:de();Hi(this.wt,c).keys().forEach(h=>u=u.add(h)),a.set(c.userId,u)}),w.forEach(a,(c,l)=>{const u=new xt(l),h=pp.se(this.wt,u),d=i.getIndexManager(u),f=gp.se(u,this.wt,d,i.referenceDelegate);return new VR(r,f,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Jm(n,xn.ot),c).next()})})}}function WI(t){t.createObjectStore("targetDocuments",{keyPath:J6}).createIndex("documentTargetsIndex",Z6,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",X6,{unique:!0}),t.createObjectStore("targetGlobal")}const mg="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Uv{constructor(e,n,s,r,i,o,a,c,l,u,h=14){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.js=i,this.window=o,this.document=a,this.Ws=l,this.zs=u,this.Hs=h,this.Ps=null,this.vs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Js=null,this.inForeground=!1,this.Ys=null,this.Xs=null,this.Zs=Number.NEGATIVE_INFINITY,this.ti=d=>Promise.resolve(),!Uv.V())throw new k(I.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new EK(this,r),this.ei=n+"main",this.wt=new OR(c),this.ni=new ws(this.ei,this.Hs,new OK(this.wt)),this.Vs=new vK(this.referenceDelegate,this.wt),this.remoteDocumentCache=BR(this.wt),this.Ds=new hK,this.window&&this.window.localStorage?this.si=this.window.localStorage:(this.si=null,u===!1&&ft("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ii().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(I.FAILED_PRECONDITION,mg);return this.ri(),this.oi(),this.ui(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Vs.getHighestSequenceNumber(e))}).then(e=>{this.Ps=new xn(e,this.Ws)}).then(()=>{this.vs=!0}).catch(e=>(this.ni&&this.ni.close(),Promise.reject(e)))}ci(e){return this.ti=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.ni.F(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.js.enqueueAndForget(async()=>{this.started&&await this.ii()}))}ii(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Th(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.ai(e).next(n=>{n||(this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)))})}).next(()=>this.hi(e)).next(n=>this.isPrimary&&!n?this.li(e).next(()=>!1):!!n&&this.fi(e).next(()=>!0))).catch(e=>{if(xi(e))return x("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return x("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.js.enqueueRetryable(()=>this.ti(e)),this.isPrimary=e})}ai(e){return Vc(e).get("owner").next(n=>w.resolve(this.di(n)))}_i(e){return Th(e).delete(this.clientId)}async wi(){if(this.isPrimary&&!this.mi(this.Zs,18e5)){this.Zs=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=Kt(n,"clientMetadata");return s.K().next(r=>{const i=this.gi(r,18e5),o=r.filter(a=>i.indexOf(a)===-1);return w.forEach(o,a=>s.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.si)for(const n of e)this.si.removeItem(this.yi(n.clientId))}}ui(){this.Xs=this.js.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ii().then(()=>this.wi()).then(()=>this.ui()))}di(e){return!!e&&e.ownerId===this.clientId}hi(e){return this.zs?w.resolve(!0):Vc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)){if(this.di(n)&&this.networkEnabled)return!0;if(!this.di(n)){if(!n.allowTabSynchronization)throw new k(I.FAILED_PRECONDITION,mg);return!1}}return!(!this.networkEnabled||!this.inForeground)||Th(e).K().next(s=>this.gi(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(i||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&x("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.vs=!1,this.Ii(),this.Xs&&(this.Xs.cancel(),this.Xs=null),this.Ti(),this.Ei(),await this.ni.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Jm(e,xn.ot);return this.li(n).next(()=>this._i(n))}),this.ni.close(),this.Ai()}gi(e,n){return e.filter(s=>this.mi(s.updateTimeMs,n)&&!this.pi(s.clientId))}Ri(){return this.runTransaction("getActiveClients","readonly",e=>Th(e).K().next(n=>this.gi(n,18e5).map(s=>s.clientId)))}get started(){return this.vs}getMutationQueue(e,n){return gp.se(e,this.wt,n,this.referenceDelegate)}getTargetCache(){return this.Vs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new yK(e,this.wt.ne.databaseId)}getDocumentOverlayCache(e){return pp.se(this.wt,e)}getBundleCache(){return this.Ds}runTransaction(e,n,s){x("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=(o=this.Hs)===15?lK:o===14?DR:o===13?PR:o===12?cK:o===11?NR:void H();var o;let a;return this.ni.runTransaction(e,r,i,c=>(a=new Jm(c,this.Ps?this.Ps.next():xn.ot),n==="readwrite-primary"?this.ai(a).next(l=>!!l||this.hi(a)).next(l=>{if(!l)throw ft(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.js.enqueueRetryable(()=>this.ti(!1)),new k(I.FAILED_PRECONDITION,HA);return s(a)}).next(l=>this.fi(a).next(()=>l)):this.bi(a).next(()=>s(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}bi(e){return Vc(e).get("owner").next(n=>{if(n!==null&&this.mi(n.leaseTimestampMs,5e3)&&!this.pi(n.ownerId)&&!this.di(n)&&!(this.zs||this.allowTabSynchronization&&n.allowTabSynchronization))throw new k(I.FAILED_PRECONDITION,mg)})}fi(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vc(e).put("owner",n)}static V(){return ws.V()}li(e){const n=Vc(e);return n.get("owner").next(s=>this.di(s)?(x("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):w.resolve())}mi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||(ft(`Detected an update time that is in the future: ${e} > ${s}`),!1))}ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ys=()=>{this.js.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.ii()))},this.document.addEventListener("visibilitychange",this.Ys),this.inForeground=this.document.visibilityState==="visible")}Ti(){this.Ys&&(this.document.removeEventListener("visibilitychange",this.Ys),this.Ys=null)}oi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Js=()=>{this.Ii(),ZO()&&navigator.appVersion.match(/Version\/1[45]/)&&this.js.enterRestrictedMode(!0),this.js.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Js))}Ei(){this.Js&&(this.window.removeEventListener("pagehide",this.Js),this.Js=null)}pi(e){var n;try{const s=((n=this.si)===null||n===void 0?void 0:n.getItem(this.yi(e)))!==null;return x("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return ft("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Ii(){if(this.si)try{this.si.setItem(this.yi(this.clientId),String(Date.now()))}catch(e){ft("Failed to set zombie client id.",e)}}Ai(){if(this.si)try{this.si.removeItem(this.yi(this.clientId))}catch{}}yi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vc(t){return Kt(t,"owner")}function Th(t){return Kt(t,"clientMetadata")}function Bv(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vv{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.Pi=s,this.vi=r}static Vi(e,n){let s=de(),r=de();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Vv(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jR{constructor(){this.Si=!1}initialize(e,n){this.Di=e,this.indexManager=n,this.Si=!0}getDocumentsMatchingQuery(e,n,s,r){return this.Ci(e,n).next(i=>i||this.xi(e,n,r,s)).next(i=>i||this.Ni(e,n))}Ci(e,n){return w.resolve(null)}xi(e,n,s,r){return v6(n)||r.isEqual(re.min())?this.Ni(e,n):this.Di.getDocuments(e,s).next(i=>{const o=this.ki(n,i);return this.Oi(n,o,s,r)?this.Ni(e,n):(Hm()<=pe.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Qm(n)),this.Mi(e,o,n,jA(r,-1)))})}ki(e,n){let s=new Re(sR(e));return n.forEach((r,i)=>{xv(e,i)&&(s=s.add(i))}),s}Oi(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ni(e,n){return Hm()<=pe.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",Qm(n)),this.Di.getDocumentsMatchingQuery(e,n,Jn.min())}Mi(e,n,s,r){return this.Di.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MK{constructor(e,n,s,r){this.persistence=e,this.Fi=n,this.wt=r,this.$i=new rt(ue),this.Bi=new Ni(i=>Ao(i),Wu),this.Li=new Map,this.Ui=e.getRemoteDocumentCache(),this.Vs=e.getTargetCache(),this.Ds=e.getBundleCache(),this.qi(s)}qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VR(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.$i))}}function KR(t,e,n,s){return new MK(t,e,n,s)}async function HR(t,e){const n=q(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.qi(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],a=[];let c=de();for(const l of r){o.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}for(const l of i){a.push(l.batchId);for(const u of l.mutations)c=c.add(u.key)}return n.localDocuments.getDocuments(s,c).next(l=>({Ki:l,removedBatchIds:o,addedBatchIds:a}))})})}function LK(t,e){const n=q(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.Ui.newChangeBuffer({trackRemovals:!0});return function(o,a,c,l){const u=c.batch,h=u.keys();let d=w.resolve();return h.forEach(f=>{d=d.next(()=>l.getEntry(a,f)).next(p=>{const _=c.docVersions.get(f);ie(_!==null),p.version.compareTo(_)<0&&(u.applyToRemoteDocument(p,c),p.isValidDocument()&&(p.setReadTime(c.commitVersion),l.addEntry(p)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,u))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(o){let a=de();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function WR(t){const e=q(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Vs.getLastRemoteSnapshotVersion(n))}function FK(t,e){const n=q(t),s=e.snapshotVersion;let r=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Ui.newChangeBuffer({trackRemovals:!0});r=n.$i;const a=[];e.targetChanges.forEach((u,h)=>{const d=r.get(h);if(!d)return;a.push(n.Vs.removeMatchingKeys(i,u.removedDocuments,h).next(()=>n.Vs.addMatchingKeys(i,u.addedDocuments,h)));let f=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.has(h)?f=f.withResumeToken(Tt.EMPTY_BYTE_STRING,re.min()).withLastLimboFreeSnapshotVersion(re.min()):u.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(u.resumeToken,s)),r=r.insert(h,f),function(p,_,v){return p.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-p.snapshotVersion.toMicroseconds()>=3e8?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(d,f,u)&&a.push(n.Vs.updateTargetData(i,f))});let c=Nn(),l=de();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(zR(i,o,e.documentUpdates).next(u=>{c=u.Gi,l=u.Qi})),!s.isEqual(re.min())){const u=n.Vs.getLastRemoteSnapshotVersion(i).next(h=>n.Vs.setTargetsMetadata(i,i.currentSequenceNumber,s));a.push(u)}return w.waitFor(a).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,l)).next(()=>c)}).then(i=>(n.$i=r,i))}function zR(t,e,n){let s=de(),r=de();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=Nn();return n.forEach((a,c)=>{const l=i.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(re.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):x("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Gi:o,Qi:r}})}function $K(t,e){const n=q(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function za(t,e){const n=q(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Vs.getTargetData(s,e).next(i=>i?(r=i,w.resolve(r)):n.Vs.allocateTargetId(s).next(o=>(r=new ii(e,o,0,s.currentSequenceNumber),n.Vs.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.$i.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(s.targetId,s),n.Bi.set(e,s.targetId)),s})}async function Ga(t,e,n){const s=q(t),r=s.$i.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!xi(o))throw o;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.$i=s.$i.remove(e),s.Bi.delete(r.target)}function Bd(t,e,n){const s=q(t);let r=re.min(),i=de();return s.persistence.runTransaction("Execute query","readonly",o=>function(a,c,l){const u=q(a),h=u.Bi.get(l);return h!==void 0?w.resolve(u.$i.get(h)):u.Vs.getTargetData(c,l)}(s,o,hs(e)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,s.Vs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{i=c})}).next(()=>s.Fi.getDocumentsMatchingQuery(o,e,n?r:re.min(),n?i:de())).next(a=>(YR(s,nR(e),a),{documents:a,ji:i})))}function GR(t,e){const n=q(t),s=q(n.Vs),r=n.$i.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.te(i,e).next(o=>o?o.target:null))}function QR(t,e){const n=q(t),s=n.Li.get(e)||re.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.Ui.getAllFromCollectionGroup(r,e,jA(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>(YR(n,e,r),r))}function YR(t,e,n){let s=re.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.Li.set(e,s)}async function UK(t,e,n,s){const r=q(t);let i=de(),o=Nn();for(const l of n){const u=e.Wi(l.metadata.name);l.document&&(i=i.add(u));const h=e.zi(l);h.setReadTime(e.Hi(l.metadata.readTime)),o=o.insert(u,h)}const a=r.Ui.newChangeBuffer({trackRemovals:!0}),c=await za(r,function(l){return hs(_c(be.fromString(`__bundle__/docs/${l}`)))}(s));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>zR(l,a,o).next(u=>(a.apply(l),u)).next(u=>r.Vs.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.Vs.addMatchingKeys(l,i,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,u.Gi,u.Qi)).next(()=>u.Gi)))}async function BK(t,e,n=de()){const s=await za(t,hs(Lv(e.bundledQuery))),r=q(t);return r.persistence.runTransaction("Save named query","readwrite",i=>{const o=Ot(e.readTime);if(s.snapshotVersion.compareTo(o)>=0)return r.Ds.saveNamedQuery(i,e);const a=s.withResumeToken(Tt.EMPTY_BYTE_STRING,o);return r.$i=r.$i.insert(a.targetId,a),r.Vs.updateTargetData(i,a).next(()=>r.Vs.removeMatchingKeysForTargetId(i,s.targetId)).next(()=>r.Vs.addMatchingKeys(i,n,s.targetId)).next(()=>r.Ds.saveNamedQuery(i,e))})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zI(t,e){return`firestore_clients_${t}_${e}`}function GI(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function _g(t,e){return`firestore_targets_${t}_${e}`}class Vd{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Ji(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new k(r.error.code,r.error.message))),o?new Vd(e,n,r.state,i):(ft("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ml{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Ji(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new k(s.error.code,s.error.message))),i?new ml(e,s.state,r):(ft("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Yi(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class qd{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Ji(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=fp();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=QA(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new qd(e,i):(ft("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class qv{constructor(e,n){this.clientId=e,this.onlineState=n}static Ji(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new qv(n.clientId,n.onlineState):(ft("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Zm{constructor(){this.activeTargetIds=fp()}Xi(e){this.activeTargetIds=this.activeTargetIds.add(e)}Zi(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Yi(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class yg{constructor(e,n,s,r,i){this.window=e,this.js=n,this.persistenceKey=s,this.tr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.er=this.nr.bind(this),this.sr=new rt(ue),this.started=!1,this.ir=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.rr=zI(this.persistenceKey,this.tr),this.ur=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.sr=this.sr.insert(this.tr,new Zm),this.cr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.ar=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.hr=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.lr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.dr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this.er)}static V(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ri();for(const s of e){if(s===this.tr)continue;const r=this.getItem(zI(this.persistenceKey,s));if(r){const i=qd.Ji(s,r);i&&(this.sr=this.sr.insert(i.clientId,i))}}this._r();const n=this.storage.getItem(this.lr);if(n){const s=this.wr(n);s&&this.mr(s)}for(const s of this.ir)this.nr(s);this.ir=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ur,JSON.stringify(e))}getAllActiveQueryTargets(){return this.gr(this.sr)}isActiveQueryTarget(e){let n=!1;return this.sr.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.yr(e,"pending")}updateMutationState(e,n,s){this.yr(e,n,s),this.pr(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){const s=this.storage.getItem(_g(this.persistenceKey,e));if(s){const r=ml.Ji(e,s);r&&(n=r.state)}}return this.Ir.Xi(e),this._r(),n}removeLocalQueryTarget(e){this.Ir.Zi(e),this._r()}isLocalQueryTarget(e){return this.Ir.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(_g(this.persistenceKey,e))}updateQueryState(e,n,s){this.Tr(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.pr(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Er(e)}notifyBundleLoaded(e){this.Ar(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.er),this.removeItem(this.rr),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return x("SharedClientState","READ",e,n),n}setItem(e,n){x("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){x("SharedClientState","REMOVE",e),this.storage.removeItem(e)}nr(e){const n=e;if(n.storageArea===this.storage){if(x("SharedClientState","EVENT",n.key,n.newValue),n.key===this.rr)return void ft("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.js.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.cr.test(n.key)){if(n.newValue==null){const s=this.Rr(n.key);return this.br(s,null)}{const s=this.Pr(n.key,n.newValue);if(s)return this.br(s.clientId,s)}}else if(this.ar.test(n.key)){if(n.newValue!==null){const s=this.vr(n.key,n.newValue);if(s)return this.Vr(s)}}else if(this.hr.test(n.key)){if(n.newValue!==null){const s=this.Sr(n.key,n.newValue);if(s)return this.Dr(s)}}else if(n.key===this.lr){if(n.newValue!==null){const s=this.wr(n.newValue);if(s)return this.mr(s)}}else if(n.key===this.ur){const s=function(r){let i=xn.ot;if(r!=null)try{const o=JSON.parse(r);ie(typeof o=="number"),i=o}catch(o){ft("SharedClientState","Failed to read sequence number from WebStorage",o)}return i}(n.newValue);s!==xn.ot&&this.sequenceNumberHandler(s)}else if(n.key===this.dr){const s=this.Cr(n.newValue);await Promise.all(s.map(r=>this.syncEngine.Nr(r)))}}}else this.ir.push(n)})}}get Ir(){return this.sr.get(this.tr)}_r(){this.setItem(this.rr,this.Ir.Yi())}yr(e,n,s){const r=new Vd(this.currentUser,e,n,s),i=GI(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Yi())}pr(e){const n=GI(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Er(e){const n={clientId:this.tr,onlineState:e};this.storage.setItem(this.lr,JSON.stringify(n))}Tr(e,n,s){const r=_g(this.persistenceKey,e),i=new ml(e,n,s);this.setItem(r,i.Yi())}Ar(e){const n=JSON.stringify(Array.from(e));this.setItem(this.dr,n)}Rr(e){const n=this.cr.exec(e);return n?n[1]:null}Pr(e,n){const s=this.Rr(e);return qd.Ji(s,n)}vr(e,n){const s=this.ar.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return Vd.Ji(new xt(i),r,n)}Sr(e,n){const s=this.hr.exec(e),r=Number(s[1]);return ml.Ji(r,n)}wr(e){return qv.Ji(e)}Cr(e){return JSON.parse(e)}async Vr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.kr(e.batchId,e.state,e.error);x("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Dr(e){return this.syncEngine.Or(e.targetId,e.state,e.error)}br(e,n){const s=n?this.sr.insert(e,n):this.sr.remove(e),r=this.gr(this.sr),i=this.gr(s),o=[],a=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||a.push(c)}),this.syncEngine.Mr(o,a).then(()=>{this.sr=s})}mr(e){this.sr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}gr(e){let n=fp();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class XR{constructor(){this.Fr=new Zm,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}updateQueryState(e,n,s){this.$r[e]=n}removeLocalQueryTarget(e){this.Fr.Zi(e)}isLocalQueryTarget(e){return this.Fr.activeTargetIds.has(e)}clearQueryState(e){delete this.$r[e]}getAllActiveQueryTargets(){return this.Fr.activeTargetIds}isActiveQueryTarget(e){return this.Fr.activeTargetIds.has(e)}start(){return this.Fr=new Zm,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VK{Br(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QI{constructor(){this.Lr=()=>this.Ur(),this.qr=()=>this.Kr(),this.Gr=[],this.Qr()}Br(e){this.Gr.push(e)}shutdown(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}Qr(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}Ur(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Gr)e(0)}Kr(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Gr)e(1)}static V(){return typeof window!="undefined"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qK={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jK{constructor(e){this.jr=e.jr,this.Wr=e.Wr}zr(e){this.Hr=e}Jr(e){this.Yr=e}onMessage(e){this.Xr=e}close(){this.Wr()}send(e){this.jr(e)}Zr(){this.Hr()}eo(e){this.Yr(e)}no(e){this.Xr(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KK extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http";this.so=n+"://"+e.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}ro(e,n,s,r,i){const o=this.oo(e,n);x("RestConnection","Sending: ",o,s);const a={};return this.uo(a,r,i),this.co(e,o,a,s).then(c=>(x("RestConnection","Received: ",c),c),c=>{throw tu("RestConnection",`${e} failed with error: `,c,"url: ",o,"request:",s),c})}ao(e,n,s,r,i){return this.ro(e,n,s,r,i)}uo(e,n,s){e["X-Goog-Api-Client"]="gl-js/ fire/"+mc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((r,i)=>e[i]=r),s&&s.headers.forEach((r,i)=>e[i]=r)}oo(e,n){const s=qK[e];return`${this.so}/v1/${n}:${s}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}co(e,n,s,r){return new Promise((i,o)=>{const a=new Vj;a.listenOnce($j.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case pg.NO_ERROR:const l=a.getResponseJson();x("Connection","XHR received:",JSON.stringify(l)),i(l);break;case pg.TIMEOUT:x("Connection",'RPC "'+e+'" timed out'),o(new k(I.DEADLINE_EXCEEDED,"Request time out"));break;case pg.HTTP_ERROR:const u=a.getStatus();if(x("Connection",'RPC "'+e+'" failed with status:',u,"response text:",a.getResponseText()),u>0){const h=a.getResponseJson().error;if(h&&h.status&&h.message){const d=function(f){const p=f.toLowerCase().replace(/_/g,"-");return Object.values(I).indexOf(p)>=0?p:I.UNKNOWN}(h.status);o(new k(d,h.message))}else o(new k(I.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new k(I.UNAVAILABLE,"Connection failed."));break;default:H()}}finally{x("Connection",'RPC "'+e+'" completed.')}});const c=JSON.stringify(r);a.send(n,"POST",c,s,15)})}ho(e,n,s){const r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Lj(),o=Fj(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new Bj({})),this.uo(a.initMessageHeaders,n,s),df()||vu()||XO()||B_()||JO()||yu()||(a.httpHeadersOverwriteParam="$httpHeaders");const c=r.join("");x("Connection","Creating WebChannel: "+c,a);const l=i.createWebChannel(c,a);let u=!1,h=!1;const d=new jK({jr:p=>{h?x("Connection","Not sending because WebChannel is closed:",p):(u||(x("Connection","Opening WebChannel transport."),l.open(),u=!0),x("Connection","WebChannel sending:",p),l.send(p))},Wr:()=>l.close()}),f=(p,_,v)=>{p.listen(_,b=>{try{v(b)}catch(N){setTimeout(()=>{throw N},0)}})};return f(l,vh.EventType.OPEN,()=>{h||x("Connection","WebChannel transport opened.")}),f(l,vh.EventType.CLOSE,()=>{h||(h=!0,x("Connection","WebChannel transport closed"),d.eo())}),f(l,vh.EventType.ERROR,p=>{h||(h=!0,tu("Connection","WebChannel transport errored:",p),d.eo(new k(I.UNAVAILABLE,"The operation could not be completed")))}),f(l,vh.EventType.MESSAGE,p=>{var _;if(!h){const v=p.data[0];ie(!!v);const b=v,N=b.error||((_=b[0])===null||_===void 0?void 0:_.error);if(N){x("Connection","WebChannel received error:",N);const T=N.status;let $=function(te){const J=ut[te];if(J!==void 0)return pR(J)}(T),z=N.message;$===void 0&&($=I.INTERNAL,z="Unknown error status: "+T+" with message "+N.message),h=!0,d.eo(new k($,z)),l.close()}else x("Connection","WebChannel received:",v),d.no(v)}}),f(o,Uj.STAT_EVENT,p=>{p.stat===oI.PROXY?x("Connection","Detected buffering proxy"):p.stat===oI.NOPROXY&&x("Connection","Detected no buffering proxy")}),setTimeout(()=>{d.Zr()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JR(){return typeof window!="undefined"?window:null}function jh(){return typeof document!="undefined"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xu(t){return new M6(t,!0)}class jv{constructor(e,n,s=1e3,r=1.5,i=6e4){this.js=e,this.timerId=n,this.lo=s,this.fo=r,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}reset(){this.wo=0}po(){this.wo=this._o}Io(e){this.cancel();const n=Math.floor(this.wo+this.To()),s=Math.max(0,Date.now()-this.yo),r=Math.max(0,n-s);r>0&&x("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.wo} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.mo=this.js.enqueueAfterDelay(this.timerId,r,()=>(this.yo=Date.now(),e())),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}Eo(){this.mo!==null&&(this.mo.skipDelay(),this.mo=null)}cancel(){this.mo!==null&&(this.mo.cancel(),this.mo=null)}To(){return(Math.random()-.5)*this.wo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,n,s,r,i,o,a,c){this.js=e,this.Ao=s,this.Ro=r,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new jv(e,n)}Do(){return this.state===1||this.state===5||this.Co()}Co(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.xo()}async stop(){this.Do()&&await this.close(0)}No(){this.state=0,this.So.reset()}ko(){this.Co()&&this.vo===null&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,()=>this.Oo()))}Mo(e){this.Fo(),this.stream.send(e)}async Oo(){if(this.Co())return this.close(0)}Fo(){this.vo&&(this.vo.cancel(),this.vo=null)}$o(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}async close(e,n){this.Fo(),this.$o(),this.So.cancel(),this.Po++,e!==4?this.So.reset():n&&n.code===I.RESOURCE_EXHAUSTED?(ft(n.toString()),ft("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===I.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Bo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Jr(n)}Bo(){}auth(){this.state=1;const e=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Po===n&&this.Uo(s,r)},s=>{e(()=>{const r=new k(I.UNKNOWN,"Fetching auth token failed: "+s.message);return this.qo(r)})})}Uo(e,n){const s=this.Lo(this.Po);this.stream=this.Ko(e,n),this.stream.zr(()=>{s(()=>(this.state=2,this.Vo=this.js.enqueueAfterDelay(this.Ro,1e4,()=>(this.Co()&&(this.state=3),Promise.resolve())),this.listener.zr()))}),this.stream.Jr(r=>{s(()=>this.qo(r))}),this.stream.onMessage(r=>{s(()=>this.onMessage(r))})}xo(){this.state=5,this.So.Io(async()=>{this.state=0,this.start()})}qo(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Lo(e){return n=>{this.js.enqueueAndForget(()=>this.Po===e?n():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class HK extends ZR{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.wt=i}Ko(e,n){return this.bo.ho("Listen",e,n)}onMessage(e){this.So.reset();const n=$6(this.wt,e),s=function(r){if(!("targetChange"in r))return re.min();const i=r.targetChange;return i.targetIds&&i.targetIds.length?re.min():i.readTime?Ot(i.readTime):re.min()}(e);return this.listener.Go(n,s)}Qo(e){const n={};n.database=lu(this.wt),n.addTarget=function(r,i){let o;const a=i.target;return o=Ld(a)?{documents:SR(r,a)}:{query:CR(r,a)},o.targetId=i.targetId,i.resumeToken.approximateByteSize()>0?o.resumeToken=wR(r,i.resumeToken):i.snapshotVersion.compareTo(re.min())>0&&(o.readTime=au(r,i.snapshotVersion.toTimestamp())),o}(this.wt,e);const s=B6(this.wt,e);s&&(n.labels=s),this.Mo(n)}jo(e){const n={};n.database=lu(this.wt),n.removeTarget=e,this.Mo(n)}}class WK extends ZR{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.wt=i,this.Wo=!1}get zo(){return this.Wo}start(){this.Wo=!1,this.lastStreamToken=void 0,super.start()}Bo(){this.Wo&&this.Ho([])}Ko(e,n){return this.bo.ho("Write",e,n)}onMessage(e){if(ie(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();const n=U6(e.writeResults,e.commitTime),s=Ot(e.commitTime);return this.listener.Jo(s,n)}return ie(!e.writeResults||e.writeResults.length===0),this.Wo=!0,this.listener.Yo()}Xo(){const e={};e.database=lu(this.wt),this.Mo(e)}Ho(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>uu(this.wt,s))};this.Mo(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zK extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.bo=s,this.wt=r,this.Zo=!1}tu(){if(this.Zo)throw new k(I.FAILED_PRECONDITION,"The client has already been terminated.")}ro(e,n,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ro(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new k(I.UNKNOWN,r.toString())})}ao(e,n,s){return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.bo.ao(e,n,s,r,i)).catch(r=>{throw r.name==="FirebaseError"?(r.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new k(I.UNKNOWN,r.toString())})}terminate(){this.Zo=!0}}class GK{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}iu(){this.eu===0&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.nu=null,this.ou("Backend didn't respond within 10 seconds."),this.ru("Offline"),Promise.resolve())))}uu(e){this.state==="Online"?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ru("Offline")))}set(e){this.cu(),this.eu=0,e==="Online"&&(this.su=!1),this.ru(e)}ru(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ou(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.su?(ft(n),this.su=!1):x("OnlineStateTracker",n)}cu(){this.nu!==null&&(this.nu.cancel(),this.nu=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QK{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br(o=>{s.enqueueAndForget(async()=>{Pi(this)&&(x("RemoteStore","Restarting streams for network reachability change."),await async function(a){const c=q(a);c.lu.add(4),await wc(c),c._u.set("Unknown"),c.lu.delete(4),await Ju(c)}(this))})}),this._u=new GK(s,r)}}async function Ju(t){if(Pi(t))for(const e of t.fu)await e(!0)}async function wc(t){for(const e of t.fu)await e(!1)}function _p(t,e){const n=q(t);n.hu.has(e.targetId)||(n.hu.set(e.targetId,e),Wv(n)?Hv(n):Ic(n).Co()&&Kv(n,e))}function hu(t,e){const n=q(t),s=Ic(n);n.hu.delete(e),s.Co()&&ex(n,e),n.hu.size===0&&(s.Co()?s.ko():Pi(n)&&n._u.set("Unknown"))}function Kv(t,e){t.wu.Nt(e.targetId),Ic(t).Qo(e)}function ex(t,e){t.wu.Nt(e),Ic(t).jo(e)}function Hv(t){t.wu=new P6({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),te:e=>t.hu.get(e)||null}),Ic(t).start(),t._u.iu()}function Wv(t){return Pi(t)&&!Ic(t).Do()&&t.hu.size>0}function Pi(t){return q(t).lu.size===0}function tx(t){t.wu=void 0}async function YK(t){t.hu.forEach((e,n)=>{Kv(t,e)})}async function XK(t,e){tx(t),Wv(t)?(t._u.uu(e),Hv(t)):t._u.set("Unknown")}async function JK(t,e,n){if(t._u.set("Online"),e instanceof vR&&e.state===2&&e.cause)try{await async function(s,r){const i=r.cause;for(const o of r.targetIds)s.hu.has(o)&&(await s.remoteSyncer.rejectListen(o,i),s.hu.delete(o),s.wu.removeTarget(o))}(t,e)}catch(s){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await jd(t,s)}else if(e instanceof Vh?t.wu.Ut(e):e instanceof yR?t.wu.zt(e):t.wu.Gt(e),!n.isEqual(re.min()))try{const s=await WR(t.localStore);n.compareTo(s)>=0&&await function(r,i){const o=r.wu.Yt(i);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){const l=r.hu.get(c);l&&r.hu.set(c,l.withResumeToken(a.resumeToken,i))}}),o.targetMismatches.forEach(a=>{const c=r.hu.get(a);if(!c)return;r.hu.set(a,c.withResumeToken(Tt.EMPTY_BYTE_STRING,c.snapshotVersion)),ex(r,a);const l=new ii(c.target,a,1,c.sequenceNumber);Kv(r,l)}),r.remoteSyncer.applyRemoteEvent(o)}(t,n)}catch(s){x("RemoteStore","Failed to raise snapshot:",s),await jd(t,s)}}async function jd(t,e,n){if(!xi(e))throw e;t.lu.add(1),await wc(t),t._u.set("Offline"),n||(n=()=>WR(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{x("RemoteStore","Retrying IndexedDB access"),await n(),t.lu.delete(1),await Ju(t)})}function nx(t,e){return e().catch(n=>jd(t,n,e))}async function bc(t){const e=q(t),n=Ii(e);let s=e.au.length>0?e.au[e.au.length-1].batchId:-1;for(;ZK(e);)try{const r=await $K(e.localStore,s);if(r===null){e.au.length===0&&n.ko();break}s=r.batchId,eH(e,r)}catch(r){await jd(e,r)}sx(e)&&rx(e)}function ZK(t){return Pi(t)&&t.au.length<10}function eH(t,e){t.au.push(e);const n=Ii(t);n.Co()&&n.zo&&n.Ho(e.mutations)}function sx(t){return Pi(t)&&!Ii(t).Do()&&t.au.length>0}function rx(t){Ii(t).start()}async function tH(t){Ii(t).Xo()}async function nH(t){const e=Ii(t);for(const n of t.au)e.Ho(n.mutations)}async function sH(t,e,n){const s=t.au.shift(),r=Ov.from(s,e,n);await nx(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await bc(t)}async function rH(t,e){e&&Ii(t).zo&&await async function(n,s){if(r=s.code,fR(r)&&r!==I.ABORTED){const i=n.au.shift();Ii(n).No(),await nx(n,()=>n.remoteSyncer.rejectFailedWrite(i.batchId,s)),await bc(n)}var r}(t,e),sx(t)&&rx(t)}async function YI(t,e){const n=q(t);n.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");const s=Pi(n);n.lu.add(3),await wc(n),s&&n._u.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.lu.delete(3),await Ju(n)}async function e_(t,e){const n=q(t);e?(n.lu.delete(2),await Ju(n)):e||(n.lu.add(2),await wc(n),n._u.set("Unknown"))}function Ic(t){return t.mu||(t.mu=function(e,n,s){const r=q(e);return r.tu(),new HK(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:YK.bind(null,t),Jr:XK.bind(null,t),Go:JK.bind(null,t)}),t.fu.push(async e=>{e?(t.mu.No(),Wv(t)?Hv(t):t._u.set("Unknown")):(await t.mu.stop(),tx(t))})),t.mu}function Ii(t){return t.gu||(t.gu=function(e,n,s){const r=q(e);return r.tu(),new WK(n,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,s)}(t.datastore,t.asyncQueue,{zr:tH.bind(null,t),Jr:rH.bind(null,t),Yo:nH.bind(null,t),Jo:sH.bind(null,t)}),t.fu.push(async e=>{e?(t.gu.No(),await bc(t)):(await t.gu.stop(),t.au.length>0&&(x("RemoteStore",`Stopping write stream with ${t.au.length} pending writes`),t.au=[]))})),t.gu}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zv{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new Dt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,a=new zv(e,n,o,r,i);return a.start(s),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new k(I.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ec(t,e){if(ft("AsyncQueue",`${e}: ${t}`),xi(t))return new k(I.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(e){this.comparator=e?(n,s)=>e(n,s)||U.comparator(n.key,s.key):(n,s)=>U.comparator(n.key,s.key),this.keyedMap=Qc(),this.sortedSet=new rt(this.comparator)}static emptySet(e){return new Ta(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ta)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Ta;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(){this.yu=new rt(U.comparator)}track(e){const n=e.doc.key,s=this.yu.get(n);s?e.type!==0&&s.type===3?this.yu=this.yu.insert(n,e):e.type===3&&s.type!==1?this.yu=this.yu.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.yu=this.yu.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.yu=this.yu.remove(n):e.type===1&&s.type===2?this.yu=this.yu.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.yu=this.yu.insert(n,{type:2,doc:e.doc}):H():this.yu=this.yu.insert(n,e)}pu(){const e=[];return this.yu.inorderTraversal((n,s)=>{e.push(s)}),e}}class Qa{constructor(e,n,s,r,i,o,a,c){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c}static fromInitialDocuments(e,n,s,r){const i=[];return n.forEach(o=>{i.push({type:0,doc:o})}),new Qa(e,n,Ta.emptySet(n),i,s,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&zu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iH{constructor(){this.Iu=void 0,this.listeners=[]}}class oH{constructor(){this.queries=new Ni(e=>tR(e),zu),this.onlineState="Unknown",this.Tu=new Set}}async function Gv(t,e){const n=q(t),s=e.query;let r=!1,i=n.queries.get(s);if(i||(r=!0,i=new iH),r)try{i.Iu=await n.onListen(s)}catch(o){const a=Ec(o,`Initialization of query '${Qm(e.query)}' failed`);return void e.onError(a)}n.queries.set(s,i),i.listeners.push(e),e.Eu(n.onlineState),i.Iu&&e.Au(i.Iu)&&Yv(n)}async function Qv(t,e){const n=q(t),s=e.query;let r=!1;const i=n.queries.get(s);if(i){const o=i.listeners.indexOf(e);o>=0&&(i.listeners.splice(o,1),r=i.listeners.length===0)}if(r)return n.queries.delete(s),n.onUnlisten(s)}function aH(t,e){const n=q(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const a of o.listeners)a.Au(r)&&(s=!0);o.Iu=r}}s&&Yv(n)}function cH(t,e,n){const s=q(t),r=s.queries.get(e);if(r)for(const i of r.listeners)i.onError(n);s.queries.delete(e)}function Yv(t){t.Tu.forEach(e=>{e.next()})}class Xv{constructor(e,n,s){this.query=e,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=s||{}}Au(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new Qa(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let n=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),n=!0):this.Vu(e,this.onlineState)&&(this.Su(e),n=!0),this.Pu=e,n}onError(e){this.Ru.error(e)}Eu(e){this.onlineState=e;let n=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),n=!0),n}Vu(e,n){if(!e.fromCache)return!0;const s=n!=="Offline";return(!this.options.Du||!s)&&(!e.docs.isEmpty()||n==="Offline")}vu(e){if(e.docChanges.length>0)return!0;const n=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Su(e){e=Qa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lH{constructor(e,n){this.payload=e,this.byteLength=n}Cu(){return"metadata"in this.payload}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JI{constructor(e){this.wt=e}Wi(e){return Ws(this.wt,e)}zi(e){return e.metadata.exists?TR(this.wt,e.document,!1):Ke.newNoDocument(this.Wi(e.metadata.name),this.Hi(e.metadata.readTime))}Hi(e){return Ot(e)}}class uH{constructor(e,n,s){this.xu=e,this.localStore=n,this.wt=s,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=ix(e)}Nu(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.payload.namedQuery)this.queries.push(e.payload.namedQuery);else if(e.payload.documentMetadata){this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++n;const s=be.fromString(e.payload.documentMetadata.name);this.collectionGroups.add(s.get(s.length-2))}else e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ku(e){const n=new Map,s=new JI(this.wt);for(const r of e)if(r.metadata.queries){const i=s.Wi(r.metadata.name);for(const o of r.metadata.queries){const a=(n.get(o)||de()).add(i);n.set(o,a)}}return n}async complete(){const e=await UK(this.localStore,new JI(this.wt),this.documents,this.xu.id),n=this.ku(this.documents);for(const s of this.queries)await BK(this.localStore,s,n.get(s.name));return this.progress.taskState="Success",{progress:this.progress,Ou:this.collectionGroups,Mu:e}}}function ix(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(e){this.key=e}}class ax{constructor(e){this.key=e}}class cx{constructor(e,n){this.query=e,this.Fu=n,this.$u=null,this.current=!1,this.Bu=de(),this.mutatedKeys=de(),this.Lu=sR(e),this.Uu=new Ta(this.Lu)}get qu(){return this.Fu}Ku(e,n){const s=n?n.Gu:new XI,r=n?n.Uu:this.Uu;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,a=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((u,h)=>{const d=r.get(u),f=xv(this.query,h)?h:null,p=!!d&&this.mutatedKeys.has(d.key),_=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations);let v=!1;d&&f?d.data.isEqual(f.data)?p!==_&&(s.track({type:3,doc:f}),v=!0):this.Qu(d,f)||(s.track({type:2,doc:f}),v=!0,(c&&this.Lu(f,c)>0||l&&this.Lu(f,l)<0)&&(a=!0)):!d&&f?(s.track({type:0,doc:f}),v=!0):d&&!f&&(s.track({type:1,doc:d}),v=!0,(c||l)&&(a=!0)),v&&(f?(o=o.add(f),i=_?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),s.track({type:1,doc:u})}return{Uu:o,Gu:s,Oi:a,mutatedKeys:i}}Qu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s){const r=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;const i=e.Gu.pu();i.sort((l,u)=>function(h,d){const f=p=>{switch(p){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return H()}};return f(h)-f(d)}(l.type,u.type)||this.Lu(l.doc,u.doc)),this.ju(s);const o=n?this.Wu():[],a=this.Bu.size===0&&this.current?1:0,c=a!==this.$u;return this.$u=a,i.length!==0||c?{snapshot:new Qa(this.query,e.Uu,r,i,e.mutatedKeys,a===0,c,!1),zu:o}:{zu:o}}Eu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new XI,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}Hu(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}ju(e){e&&(e.addedDocuments.forEach(n=>this.Fu=this.Fu.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Fu=this.Fu.delete(n)),this.current=e.current)}Wu(){if(!this.current)return[];const e=this.Bu;this.Bu=de(),this.Uu.forEach(s=>{this.Hu(s.key)&&(this.Bu=this.Bu.add(s.key))});const n=[];return e.forEach(s=>{this.Bu.has(s)||n.push(new ax(s))}),this.Bu.forEach(s=>{e.has(s)||n.push(new ox(s))}),n}Ju(e){this.Fu=e.ji,this.Bu=de();const n=this.Ku(e.documents);return this.applyChanges(n,!0)}Yu(){return Qa.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,this.$u===0)}}class hH{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class dH{constructor(e){this.key=e,this.Xu=!1}}class fH{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new Ni(a=>tR(a),zu),this.ec=new Map,this.nc=new Set,this.sc=new rt(U.comparator),this.ic=new Map,this.rc=new $v,this.oc={},this.uc=new Map,this.cc=Do.Rn(),this.onlineState="Unknown",this.ac=void 0}get isPrimaryClient(){return this.ac===!0}}async function pH(t,e){const n=nw(t);let s,r;const i=n.tc.get(e);if(i)s=i.targetId,n.sharedClientState.addLocalQueryTarget(s),r=i.view.Yu();else{const o=await za(n.localStore,hs(e));n.isPrimaryClient&&_p(n.remoteStore,o);const a=n.sharedClientState.addLocalQueryTarget(o.targetId);s=o.targetId,r=await Jv(n,e,s,a==="current")}return r}async function Jv(t,e,n,s){t.hc=(u,h,d)=>async function(f,p,_,v){let b=p.view.Ku(_);b.Oi&&(b=await Bd(f.localStore,p.query,!1).then(({documents:$})=>p.view.Ku($,b)));const N=v&&v.targetChanges.get(p.targetId),T=p.view.applyChanges(b,f.isPrimaryClient,N);return t_(f,p.targetId,T.zu),T.snapshot}(t,u,h,d);const r=await Bd(t.localStore,e,!0),i=new cx(e,r.ji),o=i.Ku(r.documents),a=Yu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline"),c=i.applyChanges(o,t.isPrimaryClient,a);t_(t,n,c.zu);const l=new hH(e,n,i);return t.tc.set(e,l),t.ec.has(n)?t.ec.get(n).push(e):t.ec.set(n,[e]),c.snapshot}async function gH(t,e){const n=q(t),s=n.tc.get(e),r=n.ec.get(s.targetId);if(r.length>1)return n.ec.set(s.targetId,r.filter(i=>!zu(i,e))),void n.tc.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(s.targetId),n.sharedClientState.isActiveQueryTarget(s.targetId)||await Ga(n.localStore,s.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(s.targetId),hu(n.remoteStore,s.targetId),Ya(n,s.targetId)}).catch(Ri)):(Ya(n,s.targetId),await Ga(n.localStore,s.targetId,!0))}async function mH(t,e,n){const s=sw(t);try{const r=await function(i,o){const a=q(i),c=Ze.now(),l=o.reduce((d,f)=>d.add(f.key),de());let u,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let f=Nn(),p=de();return a.Ui.getEntries(d,l).next(_=>{f=_,f.forEach((v,b)=>{b.isValidDocument()||(p=p.add(v))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,f)).next(_=>{u=_;const v=[];for(const b of o){const N=C6(b,u.get(b.key).overlayedDocument);N!=null&&v.push(new Dr(b.key,N,XA(N.value.mapValue),tt.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,v,o)}).next(_=>{h=_;const v=_.applyToLocalDocumentSet(u,p);return a.documentOverlayCache.saveOverlays(d,_.batchId,v)})}).then(()=>({batchId:h.batchId,changes:mR(u)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(i,o,a){let c=i.oc[i.currentUser.toKey()];c||(c=new rt(ue)),c=c.insert(o,a),i.oc[i.currentUser.toKey()]=c}(s,r.batchId,n),await Or(s,r.changes),await bc(s.remoteStore)}catch(r){const i=Ec(r,"Failed to persist write");n.reject(i)}}async function lx(t,e){const n=q(t);try{const s=await FK(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.ic.get(i);o&&(ie(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.Xu=!0:r.modifiedDocuments.size>0?ie(o.Xu):r.removedDocuments.size>0&&(ie(o.Xu),o.Xu=!1))}),await Or(n,s,e)}catch(s){await Ri(s)}}function ZI(t,e,n){const s=q(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.tc.forEach((i,o)=>{const a=o.view.Eu(e);a.snapshot&&r.push(a.snapshot)}),function(i,o){const a=q(i);a.onlineState=o;let c=!1;a.queries.forEach((l,u)=>{for(const h of u.listeners)h.Eu(o)&&(c=!0)}),c&&Yv(a)}(s.eventManager,e),r.length&&s.Zu.Go(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function _H(t,e,n){const s=q(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.ic.get(e),i=r&&r.key;if(i){let o=new rt(U.comparator);o=o.insert(i,Ke.newNoDocument(i,re.min()));const a=de().add(i),c=new Qu(re.min(),new Map,new Re(ue),o,a);await lx(s,c),s.sc=s.sc.remove(i),s.ic.delete(e),tw(s)}else await Ga(s.localStore,e,!1).then(()=>Ya(s,e,n)).catch(Ri)}async function yH(t,e){const n=q(t),s=e.batch.batchId;try{const r=await LK(n.localStore,e);ew(n,s,null),Zv(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Or(n,r)}catch(r){await Ri(r)}}async function vH(t,e,n){const s=q(t);try{const r=await function(i,o){const a=q(i);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return a.mutationQueue.lookupMutationBatch(c,o).next(u=>(ie(u!==null),l=u.keys(),a.mutationQueue.removeMutationBatch(c,u))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,l,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>a.localDocuments.getDocuments(c,l))})}(s.localStore,e);ew(s,e,n),Zv(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Or(s,r)}catch(r){await Ri(r)}}async function wH(t,e){const n=q(t);Pi(n.remoteStore)||x("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const s=await function(i){const o=q(i);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(n.localStore);if(s===-1)return void e.resolve();const r=n.uc.get(s)||[];r.push(e),n.uc.set(s,r)}catch(s){const r=Ec(s,"Initialization of waitForPendingWrites() operation failed");e.reject(r)}}function Zv(t,e){(t.uc.get(e)||[]).forEach(n=>{n.resolve()}),t.uc.delete(e)}function ew(t,e,n){const s=q(t);let r=s.oc[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.oc[s.currentUser.toKey()]=r}}function Ya(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.ec.get(e))t.tc.delete(s),n&&t.Zu.lc(s,n);t.ec.delete(e),t.isPrimaryClient&&t.rc.us(e).forEach(s=>{t.rc.containsKey(s)||ux(t,s)})}function ux(t,e){t.nc.delete(e.path.canonicalString());const n=t.sc.get(e);n!==null&&(hu(t.remoteStore,n),t.sc=t.sc.remove(e),t.ic.delete(n),tw(t))}function t_(t,e,n){for(const s of n)s instanceof ox?(t.rc.addReference(s.key,e),bH(t,s)):s instanceof ax?(x("SyncEngine","Document no longer in limbo: "+s.key),t.rc.removeReference(s.key,e),t.rc.containsKey(s.key)||ux(t,s.key)):H()}function bH(t,e){const n=e.key,s=n.path.canonicalString();t.sc.get(n)||t.nc.has(s)||(x("SyncEngine","New document in limbo: "+n),t.nc.add(s),tw(t))}function tw(t){for(;t.nc.size>0&&t.sc.size<t.maxConcurrentLimboResolutions;){const e=t.nc.values().next().value;t.nc.delete(e);const n=new U(be.fromString(e)),s=t.cc.next();t.ic.set(s,new dH(n)),t.sc=t.sc.insert(n,s),_p(t.remoteStore,new ii(hs(_c(n.path)),s,2,xn.ot))}}async function Or(t,e,n){const s=q(t),r=[],i=[],o=[];s.tc.isEmpty()||(s.tc.forEach((a,c)=>{o.push(s.hc(c,e,n).then(l=>{if(l){s.isPrimaryClient&&s.sharedClientState.updateQueryState(c.targetId,l.fromCache?"not-current":"current"),r.push(l);const u=Vv.Vi(c.targetId,l);i.push(u)}}))}),await Promise.all(o),s.Zu.Go(r),await async function(a,c){const l=q(a);try{await l.persistence.runTransaction("notifyLocalViewChanges","readwrite",u=>w.forEach(c,h=>w.forEach(h.Pi,d=>l.persistence.referenceDelegate.addReference(u,h.targetId,d)).next(()=>w.forEach(h.vi,d=>l.persistence.referenceDelegate.removeReference(u,h.targetId,d)))))}catch(u){if(!xi(u))throw u;x("LocalStore","Failed to update sequence numbers: "+u)}for(const u of c){const h=u.targetId;if(!u.fromCache){const d=l.$i.get(h),f=d.snapshotVersion,p=d.withLastLimboFreeSnapshotVersion(f);l.$i=l.$i.insert(h,p)}}}(s.localStore,i))}async function IH(t,e){const n=q(t);if(!n.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());const s=await HR(n.localStore,e);n.currentUser=e,function(r,i){r.uc.forEach(o=>{o.forEach(a=>{a.reject(new k(I.CANCELLED,i))})}),r.uc.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Or(n,s.Ki)}}function EH(t,e){const n=q(t),s=n.ic.get(e);if(s&&s.Xu)return de().add(s.key);{let r=de();const i=n.ec.get(e);if(!i)return r;for(const o of i){const a=n.tc.get(o);r=r.unionWith(a.view.qu)}return r}}async function TH(t,e){const n=q(t),s=await Bd(n.localStore,e.query,!0),r=e.view.Ju(s);return n.isPrimaryClient&&t_(n,e.targetId,r.zu),r}async function SH(t,e){const n=q(t);return QR(n.localStore,e).then(s=>Or(n,s))}async function CH(t,e,n,s){const r=q(t),i=await function(o,a){const c=q(o),l=q(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",u=>l.yn(u,a).next(h=>h?c.localDocuments.getDocuments(u,h):w.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await bc(r.remoteStore):n==="acknowledged"||n==="rejected"?(ew(r,e,s||null),Zv(r,e),function(o,a){q(q(o).mutationQueue).In(a)}(r.localStore,e)):H(),await Or(r,i)):x("SyncEngine","Cannot apply mutation batch with id: "+e)}async function kH(t,e){const n=q(t);if(nw(n),sw(n),e===!0&&n.ac!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await eE(n,s.toArray());n.ac=!0,await e_(n.remoteStore,!0);for(const i of r)_p(n.remoteStore,i)}else if(e===!1&&n.ac!==!1){const s=[];let r=Promise.resolve();n.ec.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(Ya(n,o),Ga(n.localStore,o,!0))),hu(n.remoteStore,o)}),await r,await eE(n,s),function(i){const o=q(i);o.ic.forEach((a,c)=>{hu(o.remoteStore,c)}),o.rc.cs(),o.ic=new Map,o.sc=new rt(U.comparator)}(n),n.ac=!1,await e_(n.remoteStore,!1)}}async function eE(t,e,n){const s=q(t),r=[],i=[];for(const o of e){let a;const c=s.ec.get(o);if(c&&c.length!==0){a=await za(s.localStore,hs(c[0]));for(const l of c){const u=s.tc.get(l),h=await TH(s,u);h.snapshot&&i.push(h.snapshot)}}else{const l=await GR(s.localStore,o);a=await za(s.localStore,l),await Jv(s,hx(l),o,!1)}r.push(a)}return s.Zu.Go(i),r}function hx(t){return ZA(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function AH(t){const e=q(t);return q(q(e.localStore).persistence).Ri()}async function RH(t,e,n,s){const r=q(t);if(r.ac)return void x("SyncEngine","Ignoring unexpected query state notification.");const i=r.ec.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await QR(r.localStore,nR(i[0])),a=Qu.createSynthesizedRemoteEventForCurrentChange(e,n==="current");await Or(r,o,a);break}case"rejected":await Ga(r.localStore,e,!0),Ya(r,e,s);break;default:H()}}async function xH(t,e,n){const s=nw(t);if(s.ac){for(const r of e){if(s.ec.has(r)){x("SyncEngine","Adding an already active target "+r);continue}const i=await GR(s.localStore,r),o=await za(s.localStore,i);await Jv(s,hx(i),o.targetId,!1),_p(s.remoteStore,o)}for(const r of n)s.ec.has(r)&&await Ga(s.localStore,r,!1).then(()=>{hu(s.remoteStore,r),Ya(s,r)}).catch(Ri)}}function nw(t){const e=q(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=lx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=EH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_H.bind(null,e),e.Zu.Go=aH.bind(null,e.eventManager),e.Zu.lc=cH.bind(null,e.eventManager),e}function sw(t){const e=q(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=yH.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=vH.bind(null,e),e}function NH(t,e,n){const s=q(t);(async function(r,i,o){try{const a=await i.getMetadata();if(await function(h,d){const f=q(h),p=Ot(d.createTime);return f.persistence.runTransaction("hasNewerBundle","readonly",_=>f.Ds.getBundleMetadata(_,d.id)).then(_=>!!_&&_.createTime.compareTo(p)>=0)}(r.localStore,a))return await i.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(ix(a));const c=new uH(a,r.localStore,i.wt);let l=await i.fc();for(;l;){const h=await c.Nu(l);h&&o._updateProgress(h),l=await i.fc()}const u=await c.complete();return await Or(r,u.Mu,void 0),await function(h,d){const f=q(h);return f.persistence.runTransaction("Save bundle","readwrite",p=>f.Ds.saveBundleMetadata(p,d))}(r.localStore,a),o._completeWith(u.progress),Promise.resolve(u.Ou)}catch(a){return tu("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(s,e,n).then(r=>{s.sharedClientState.notifyBundleLoaded(r)})}class dx{constructor(){this.synchronizeTabs=!1}async initialize(e){this.wt=Xu(e.databaseInfo.databaseId),this.sharedClientState=this.dc(e),this.persistence=this._c(e),await this.persistence.start(),this.localStore=this.wc(e),this.gcScheduler=this.mc(e,this.localStore),this.indexBackfillerScheduler=this.gc(e,this.localStore)}mc(e,n){return null}gc(e,n){return null}wc(e){return KR(this.persistence,new jR,e.initialUser,this.wt)}_c(e){return new qR(mp.Ms,this.wt)}dc(e){return new XR}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class fx extends dx{constructor(e,n,s){super(),this.yc=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.yc.initialize(this,e),await sw(this.yc.syncEngine),await bc(this.yc.remoteStore),await this.persistence.ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wc(e){return KR(this.persistence,new jR,e.initialUser,this.wt)}mc(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new bK(s,e.asyncQueue,n)}gc(e,n){const s=new s6(n,this.persistence);return new n6(e.asyncQueue,s)}_c(e){const n=Bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Cn.withCacheSize(this.cacheSizeBytes):Cn.DEFAULT;return new Uv(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,JR(),jh(),this.wt,this.sharedClientState,!!this.forceOwnership)}dc(e){return new XR}}class PH extends fx{constructor(e,n){super(e,n,!1),this.yc=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.yc.syncEngine;this.sharedClientState instanceof yg&&(this.sharedClientState.syncEngine={kr:CH.bind(null,n),Or:RH.bind(null,n),Mr:xH.bind(null,n),Ri:AH.bind(null,n),Nr:SH.bind(null,n)},await this.sharedClientState.start()),await this.persistence.ci(async s=>{await kH(this.yc.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}dc(e){const n=JR();if(!yg.V(n))throw new k(I.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Bv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new yg(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class rw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>ZI(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=IH.bind(null,this.syncEngine),await e_(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new oH}createDatastore(e){const n=Xu(e.databaseInfo.databaseId),s=(r=e.databaseInfo,new KK(r));var r;return function(i,o,a,c){return new zK(i,o,a,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return n=this.localStore,s=this.datastore,r=e.asyncQueue,i=a=>ZI(this.syncEngine,a,0),o=QI.V()?new QI:new VK,new QK(n,s,r,i,o);var n,s,r,i,o}createSyncEngine(e,n){return function(s,r,i,o,a,c,l){const u=new fH(s,r,i,o,a,c);return l&&(u.ac=!0),u}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return async function(e){const n=q(e);x("RemoteStore","RemoteStore shutting down."),n.lu.add(5),await wc(n),n.du.shutdown(),n._u.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tE(t,e=10240){let n=0;return{async read(){if(n<t.byteLength){const s={value:t.slice(n,n+e),done:!1};return n+=e,s}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ic(this.observer.next,e)}error(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Tc(){this.muted=!0}Ic(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DH{constructor(e,n){this.Ec=e,this.wt=n,this.metadata=new Dt,this.buffer=new Uint8Array,this.Ac=new TextDecoder("utf-8"),this.Rc().then(s=>{s&&s.Cu()?this.metadata.resolve(s.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(s==null?void 0:s.payload)}`))},s=>this.metadata.reject(s))}close(){return this.Ec.cancel()}async getMetadata(){return this.metadata.promise}async fc(){return await this.getMetadata(),this.Rc()}async Rc(){const e=await this.bc();if(e===null)return null;const n=this.Ac.decode(e),s=Number(n);isNaN(s)&&this.Pc(`length string (${n}) is not valid number`);const r=await this.vc(s);return new lH(JSON.parse(r),e.length+s)}Vc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async bc(){for(;this.Vc()<0&&!await this.Sc(););if(this.buffer.length===0)return null;const e=this.Vc();e<0&&this.Pc("Reached the end of bundle when a length string is expected.");const n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n}async vc(e){for(;this.buffer.length<e;)await this.Sc()&&this.Pc("Reached the end of bundle when more is expected.");const n=this.Ac.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n}Pc(e){throw this.Ec.cancel(),new Error(`Invalid bundle format: ${e}`)}async Sc(){const e=await this.Ec.read();if(!e.done){const n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OH{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new k(I.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const n=await async function(s,r){const i=q(s),o=lu(i.wt)+"/documents",a={documents:r.map(h=>cu(i.wt,h))},c=await i.ao("BatchGetDocuments",o,a),l=new Map;c.forEach(h=>{const d=F6(i.wt,h);l.set(d.key.toString(),d)});const u=[];return r.forEach(h=>{const d=l.get(h.toString());ie(!!d),u.push(d)}),u}(this.datastore,e);return n.forEach(s=>this.recordVersion(s)),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(s){this.lastWriteError=s}this.writtenDocs.add(e.toString())}delete(e){this.write(new vc(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,s)=>{const r=U.fromPath(s);this.mutations.push(new Nv(r,this.precondition(r)))}),await async function(n,s){const r=q(n),i=lu(r.wt)+"/documents",o={writes:s.map(a=>uu(r.wt,a))};await r.ro("Commit",i,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw H();n=re.min()}const s=this.readVersions.get(e.key.toString());if(s){if(!n.isEqual(s))throw new k(I.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?tt.updateTime(n):tt.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(re.min()))throw new k(I.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return tt.updateTime(n)}return tt.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MH{constructor(e,n,s,r,i){this.asyncQueue=e,this.datastore=n,this.options=s,this.updateFunction=r,this.deferred=i,this.Dc=s.maxAttempts,this.So=new jv(this.asyncQueue,"transaction_retry")}run(){this.Dc-=1,this.Cc()}Cc(){this.So.Io(async()=>{const e=new OH(this.datastore),n=this.xc(e);n&&n.then(s=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(s)}).catch(r=>{this.Nc(r)}))}).catch(s=>{this.Nc(s)})})}xc(e){try{const n=this.updateFunction(e);return!Hu(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Nc(e){this.Dc>0&&this.kc(e)?(this.Dc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Cc(),Promise.resolve()))):this.deferred.reject(e)}kc(e){if(e.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||!fR(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LH{constructor(e,n,s,r){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=xt.UNAUTHENTICATED,this.clientId=BA.I(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(s,async i=>{x("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(s,i=>(x("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(I.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=Ec(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function px(t,e){t.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");const n=await t.getConfiguration();await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await HR(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t.offlineComponents=e}async function gx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await iw(t);x("FirestoreClient","Initializing OnlineComponentProvider");const s=await t.getConfiguration();await e.initialize(n,s),t.setCredentialChangeListener(r=>YI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>YI(e.remoteStore,i)),t.onlineComponents=e}async function iw(t){return t.offlineComponents||(x("FirestoreClient","Using default OfflineComponentProvider"),await px(t,new dx)),t.offlineComponents}async function vp(t){return t.onlineComponents||(x("FirestoreClient","Using default OnlineComponentProvider"),await gx(t,new rw)),t.onlineComponents}function mx(t){return iw(t).then(e=>e.persistence)}function ow(t){return iw(t).then(e=>e.localStore)}function _x(t){return vp(t).then(e=>e.remoteStore)}function aw(t){return vp(t).then(e=>e.syncEngine)}async function Xa(t){const e=await vp(t),n=e.eventManager;return n.onListen=pH.bind(null,e.syncEngine),n.onUnlisten=gH.bind(null,e.syncEngine),n}function FH(t){return t.asyncQueue.enqueue(async()=>{const e=await mx(t),n=await _x(t);return e.setNetworkEnabled(!0),function(s){const r=q(s);return r.lu.delete(0),Ju(r)}(n)})}function $H(t){return t.asyncQueue.enqueue(async()=>{const e=await mx(t),n=await _x(t);return e.setNetworkEnabled(!1),async function(s){const r=q(s);r.lu.add(0),await wc(r),r._u.set("Offline")}(n)})}function UH(t,e){const n=new Dt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await function(a,c){const l=q(a);return l.persistence.runTransaction("read document","readonly",u=>l.localDocuments.getDocument(u,c))}(s,r);o.isFoundDocument()?i.resolve(o):o.isNoDocument()?i.resolve(null):i.reject(new k(I.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){const a=Ec(o,`Failed to get document '${r} from cache`);i.reject(a)}}(await ow(t),e,n)),n.promise}function yx(t,e,n={}){const s=new Dt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new yp({next:h=>{i.enqueueAndForget(()=>Qv(r,u));const d=h.docs.has(o);!d&&h.fromCache?c.reject(new k(I.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new k(I.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Xv(_c(o.path),l,{includeMetadataChanges:!0,Du:!0});return Gv(r,u)}(await Xa(t),t.asyncQueue,e,n,s)),s.promise}function BH(t,e){const n=new Dt;return t.asyncQueue.enqueueAndForget(async()=>async function(s,r,i){try{const o=await Bd(s,r,!0),a=new cx(r,o.ji),c=a.Ku(o.documents),l=a.applyChanges(c,!1);i.resolve(l.snapshot)}catch(o){const a=Ec(o,`Failed to execute query '${r} against cache`);i.reject(a)}}(await ow(t),e,n)),n.promise}function vx(t,e,n={}){const s=new Dt;return t.asyncQueue.enqueueAndForget(async()=>function(r,i,o,a,c){const l=new yp({next:h=>{i.enqueueAndForget(()=>Qv(r,u)),h.fromCache&&a.source==="server"?c.reject(new k(I.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),u=new Xv(o,l,{includeMetadataChanges:!0,Du:!0});return Gv(r,u)}(await Xa(t),t.asyncQueue,e,n,s)),s.promise}function VH(t,e){const n=new yp(e);return t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.add(r),r.next()}(await Xa(t),n)),()=>{n.Tc(),t.asyncQueue.enqueueAndForget(async()=>function(s,r){q(s).Tu.delete(r)}(await Xa(t),n))}}function qH(t,e,n){const s=new Dt;return t.asyncQueue.enqueueAndForget(async()=>{const r=await function(i){return vp(i).then(o=>o.datastore)}(t);new MH(t.asyncQueue,r,n,e,s).run()}),s.promise}function jH(t,e,n,s){const r=function(i,o){let a;return a=typeof i=="string"?new TextEncoder().encode(i):i,function(c,l){return new DH(c,l)}(function(c,l){if(c instanceof Uint8Array)return tE(c,l);if(c instanceof ArrayBuffer)return tE(new Uint8Array(c),l);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(n,Xu(e));t.asyncQueue.enqueueAndForget(async()=>{NH(await aw(t),r,s)})}function KH(t,e){return t.asyncQueue.enqueue(async()=>function(n,s){const r=q(n);return r.persistence.runTransaction("Get named query","readonly",i=>r.Ds.getNamedQuery(i,s))}(await ow(t),e))}const nE=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cw(t,e,n){if(!n)throw new k(I.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function wx(t,e,n,s){if(e===!0&&s===!0)throw new k(I.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function sE(t){if(!U.isDocumentKey(t))throw new k(I.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rE(t){if(U.isDocumentKey(t))throw new k(I.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function wp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":H()}function Ee(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new k(I.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=wp(t);throw new k(I.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function bx(t,e){if(e<=0)throw new k(I.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iE{constructor(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new k(I.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new k(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,wx("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e,n,s){this._authCredentials=n,this._appCheckCredentials=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new iE({}),this._settingsFrozen=!1,e instanceof kr?this._databaseId=e:(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new k(I.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new kr(r.options.projectId)}(e))}get app(){if(!this._app)throw new k(I.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new k(I.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new iE(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Kj;switch(n.type){case"gapi":const s=n.client;return ie(!(typeof s!="object"||s===null||!s.auth||!s.auth.getAuthHeaderValueForFirstParty)),new Gj(s,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new k(I.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const n=nE.get(e);n&&(x("ComponentProvider","Removing Datastore"),nE.delete(e),n.terminate())}(this),Promise.resolve()}}function HH(t,e,n,s={}){var r;const i=(t=Ee(t,Zu))._getSettings();if(i.host!=="firestore.googleapis.com"&&i.host!==e&&tu("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},i),{host:`${e}:${n}`,ssl:!1})),s.mockUserToken){let o,a;if(typeof s.mockUserToken=="string")o=s.mockUserToken,a=xt.MOCK_USER;else{o=$_(s.mockUserToken,(r=t._app)===null||r===void 0?void 0:r.options.projectId);const c=s.mockUserToken.sub||s.mockUserToken.user_id;if(!c)throw new k(I.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");a=new xt(c)}t._authCredentials=new Hj(new UA(o,a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ze{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ze(this.firestore,e,this._key)}}class cn{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new cn(this.firestore,e,this._query)}}class zs extends cn{constructor(e,n,s){super(e,n,_c(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ze(this.firestore,null,new U(e))}withConverter(e){return new zs(this.firestore,e,this._path)}}function Ix(t,e,...n){if(t=A(t),cw("collection","path",e),t instanceof Zu){const s=be.fromString(e,...n);return rE(s),new zs(t,null,s)}{if(!(t instanceof ze||t instanceof zs))throw new k(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(be.fromString(e,...n));return rE(s),new zs(t.firestore,null,s)}}function WH(t,e){if(t=Ee(t,Zu),cw("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new k(I.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new cn(t,null,function(n){return new Pr(be.emptyPath(),n)}(e))}function Kd(t,e,...n){if(t=A(t),arguments.length===1&&(e=BA.I()),cw("doc","path",e),t instanceof Zu){const s=be.fromString(e,...n);return sE(s),new ze(t,null,new U(s))}{if(!(t instanceof ze||t instanceof zs))throw new k(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(be.fromString(e,...n));return sE(s),new ze(t.firestore,t instanceof zs?t.converter:null,new U(s))}}function Ex(t,e){return t=A(t),e=A(e),(t instanceof ze||t instanceof zs)&&(e instanceof ze||e instanceof zs)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function Tx(t,e){return t=A(t),e=A(e),t instanceof cn&&e instanceof cn&&t.firestore===e.firestore&&zu(t._query,e._query)&&t.converter===e.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zH{constructor(){this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new jv(this,"async_queue_retry"),this.Kc=()=>{const n=jh();n&&x("AsyncQueue","Visibility state changed to "+n.visibilityState),this.So.Eo()};const e=jh();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Kc)}get isShuttingDown(){return this.Fc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Gc(),this.Qc(e)}enterRestrictedMode(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;const n=jh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Kc)}}enqueue(e){if(this.Gc(),this.Fc)return new Promise(()=>{});const n=new Dt;return this.Qc(()=>this.Fc&&this.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Mc.push(e),this.jc()))}async jc(){if(this.Mc.length!==0){try{await this.Mc[0](),this.Mc.shift(),this.So.reset()}catch(e){if(!xi(e))throw e;x("AsyncQueue","Operation failed with retryable error: "+e)}this.Mc.length>0&&this.So.Io(()=>this.jc())}}Qc(e){const n=this.Oc.then(()=>(this.Lc=!0,e().catch(s=>{this.Bc=s,this.Lc=!1;const r=function(i){let o=i.message||"";return i.stack&&(o=i.stack.includes(i.message)?i.stack:i.message+`
`+i.stack),o}(s);throw ft("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.Lc=!1,s))));return this.Oc=n,n}enqueueAfterDelay(e,n,s){this.Gc(),this.qc.indexOf(e)>-1&&(n=0);const r=zv.createAndSchedule(this,e,n,s,i=>this.Wc(i));return this.$c.push(r),r}Gc(){this.Bc&&H()}verifyOperationInProgress(){}async zc(){let e;do e=this.Oc,await e;while(e!==this.Oc)}Hc(e){for(const n of this.$c)if(n.timerId===e)return!0;return!1}Jc(e){return this.zc().then(()=>{this.$c.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.$c)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.zc()})}Yc(e){this.qc.push(e)}Wc(e){const n=this.$c.indexOf(e);this.$c.splice(n,1)}}function n_(t){return function(e,n){if(typeof e!="object"||e===null)return!1;const s=e;for(const r of n)if(r in s&&typeof s[r]=="function")return!0;return!1}(t,["next","error","complete"])}class GH{constructor(){this._progressObserver={},this._taskCompletionResolver=new Dt,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,s){this._progressObserver={next:e,error:n,complete:s}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QH=-1;class it extends Zu{constructor(e,n,s){super(e,n,s),this.type="firestore",this._queue=new zH,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Sx(this),this._firestoreClient.terminate()}}function Ht(t){return t._firestoreClient||Sx(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function Sx(t){var e;const n=t._freezeSettings(),s=function(r,i,o,a){return new o6(r,i,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new LH(t._authCredentials,t._appCheckCredentials,t._queue,s)}function YH(t,e){kx(t=Ee(t,it));const n=Ht(t),s=t._freezeSettings(),r=new rw;return Cx(n,r,new fx(r,s.cacheSizeBytes,e==null?void 0:e.forceOwnership))}function XH(t){kx(t=Ee(t,it));const e=Ht(t),n=t._freezeSettings(),s=new rw;return Cx(e,s,new PH(s,n.cacheSizeBytes))}function Cx(t,e,n){const s=new Dt;return t.asyncQueue.enqueue(async()=>{try{await px(t,n),await gx(t,e),s.resolve()}catch(r){if(!function(i){return i.name==="FirebaseError"?i.code===I.FAILED_PRECONDITION||i.code===I.UNIMPLEMENTED:typeof DOMException!="undefined"&&i instanceof DOMException?i.code===22||i.code===20||i.code===11:!0}(r))throw r;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),s.reject(r)}}).then(()=>s.promise)}function JH(t){if(t._initialized&&!t._terminated)throw new k(I.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Dt;return t._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(n){if(!ws.V())return Promise.resolve();const s=n+"main";await ws.delete(s)}(Bv(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}}),e.promise}function ZH(t){return function(e){const n=new Dt;return e.asyncQueue.enqueueAndForget(async()=>wH(await aw(e),n)),n.promise}(Ht(t=Ee(t,it)))}function eW(t){return FH(Ht(t=Ee(t,it)))}function tW(t){return $H(Ht(t=Ee(t,it)))}function nW(t,e){const n=Ht(t=Ee(t,it)),s=new GH;return jH(n,t._databaseId,e,s),s}function sW(t,e){return KH(Ht(t=Ee(t,it)),e).then(n=>n?new cn(t,null,n.query):null)}function kx(t){if(t._initialized||t._terminated)throw new k(I.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new k(I.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nr{constructor(e){this._byteString=e}static fromBase64String(e){try{return new nr(Tt.fromBase64String(e))}catch(n){throw new k(I.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new nr(Tt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new k(I.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new k(I.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ue(this._lat,e._lat)||ue(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rW=/^__.*__$/;class iW{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms):new yc(e,this.data,n,this.fieldTransforms)}}class Ax{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Dr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function Rx(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw H()}}class Ip{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.wt=s,this.ignoreUndefinedProperties=r,i===void 0&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Zc(){return this.settings.Zc}ta(e){return new Ip(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ea(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.sa(e),r}ia(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.ta({path:s,na:!1});return r.Xc(),r}ra(e){return this.ta({path:void 0,na:!0})}oa(e){return Hd(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Xc(){if(this.path)for(let e=0;e<this.path.length;e++)this.sa(this.path.get(e))}sa(e){if(e.length===0)throw this.oa("Document fields must not be empty");if(Rx(this.Zc)&&rW.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}class oW{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.wt=s||Xu(e)}aa(e,n,s,r=!1){return new Ip({Zc:e,methodName:n,ca:s,path:at.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}function zo(t){const e=t._freezeSettings(),n=Xu(t._databaseId);return new oW(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ep(t,e,n,s,r,i={}){const o=t.aa(i.merge||i.mergeFields?2:0,e,n,r);dw("Data must be an object, but it was:",o,s);const a=Px(s,o);let c,l;if(i.merge)c=new Gn(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const h of i.mergeFields){const d=s_(e,h,n);if(!o.contains(d))throw new k(I.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);Ox(u,d)||u.push(d)}c=new Gn(u),l=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,l=o.fieldTransforms;return new iW(new Gt(a),c,l)}class eh extends Wo{_toFieldTransform(e){if(e.Zc!==2)throw e.Zc===1?e.oa(`${this._methodName}() can only appear at the top level of your update data`):e.oa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof eh}}function xx(t,e,n){return new Ip({Zc:3,ca:e.settings.ca,methodName:t._methodName,na:n},e.databaseId,e.wt,e.ignoreUndefinedProperties)}class lw extends Wo{_toFieldTransform(e){return new Gu(e.path,new Ha)}isEqual(e){return e instanceof lw}}class aW extends Wo{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=xx(this,e,!0),s=this.ha.map(i=>Go(i,n)),r=new Ro(s);return new Gu(e.path,r)}isEqual(e){return this===e}}class cW extends Wo{constructor(e,n){super(e),this.ha=n}_toFieldTransform(e){const n=xx(this,e,!0),s=this.ha.map(i=>Go(i,n)),r=new xo(s);return new Gu(e.path,r)}isEqual(e){return this===e}}class lW extends Wo{constructor(e,n){super(e),this.la=n}_toFieldTransform(e){const n=new Wa(e.wt,oR(e.wt,this.la));return new Gu(e.path,n)}isEqual(e){return this===e}}function uw(t,e,n,s){const r=t.aa(1,e,n);dw("Data must be an object, but it was:",r,s);const i=[],o=Gt.empty();Ho(s,(c,l)=>{const u=fw(e,c,n);l=A(l);const h=r.ia(u);if(l instanceof eh)i.push(u);else{const d=Go(l,h);d!=null&&(i.push(u),o.set(u,d))}});const a=new Gn(i);return new Ax(o,a,r.fieldTransforms)}function hw(t,e,n,s,r,i){const o=t.aa(1,e,n),a=[s_(e,s,n)],c=[r];if(i.length%2!=0)throw new k(I.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(s_(e,i[d])),c.push(i[d+1]);const l=[],u=Gt.empty();for(let d=a.length-1;d>=0;--d)if(!Ox(l,a[d])){const f=a[d];let p=c[d];p=A(p);const _=o.ia(f);if(p instanceof eh)l.push(f);else{const v=Go(p,_);v!=null&&(l.push(f),u.set(f,v))}}const h=new Gn(l);return new Ax(u,h,o.fieldTransforms)}function Nx(t,e,n,s=!1){return Go(n,t.aa(s?4:3,e))}function Go(t,e){if(Dx(t=A(t)))return dw("Unsupported field value:",e,t),Px(t,e);if(t instanceof Wo)return function(n,s){if(!Rx(s.Zc))throw s.oa(`${n._methodName}() can only be used with update() and set()`);if(!s.path)throw s.oa(`${n._methodName}() is not currently supported inside arrays`);const r=n._toFieldTransform(s);r&&s.fieldTransforms.push(r)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.na&&e.Zc!==4)throw e.oa("Nested arrays are not supported");return function(n,s){const r=[];let i=0;for(const o of n){let a=Go(o,s.ra(i));a==null&&(a={nullValue:"NULL_VALUE"}),r.push(a),i++}return{arrayValue:{values:r}}}(t,e)}return function(n,s){if((n=A(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return oR(s.wt,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const r=Ze.fromDate(n);return{timestampValue:au(s.wt,r)}}if(n instanceof Ze){const r=new Ze(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:au(s.wt,r)}}if(n instanceof bp)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof nr)return{bytesValue:wR(s.wt,n._byteString)};if(n instanceof ze){const r=s.databaseId,i=n.firestore._databaseId;if(!i.isEqual(r))throw s.oa(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:Pv(n.firestore._databaseId||s.databaseId,n._key.path)}}throw s.oa(`Unsupported field value: ${wp(n)}`)}(t,e)}function Px(t,e){const n={};return zA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ho(t,(s,r)=>{const i=Go(r,e.ea(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function Dx(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Ze||t instanceof bp||t instanceof nr||t instanceof ze||t instanceof Wo)}function dw(t,e,n){if(!Dx(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const s=wp(n);throw s==="an object"?e.oa(t+" a custom object"):e.oa(t+" "+s)}}function s_(t,e,n){if((e=A(e))instanceof Ei)return e._internalPath;if(typeof e=="string")return fw(t,e);throw Hd("Field path arguments must be of type string or ",t,!1,void 0,n)}const uW=new RegExp("[~\\*/\\[\\]]");function fw(t,e,n){if(e.search(uW)>=0)throw Hd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ei(...e.split("."))._internalPath}catch{throw Hd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Hd(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new k(I.INVALID_ARGUMENT,a+t+c)}function Ox(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new ze(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new hW(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Tp("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class hW extends du{data(){return super.data()}}function Tp(t,e){return typeof e=="string"?fw(t,e):e instanceof Ei?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Ar extends du{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new _l(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(Tp("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class _l extends Ar{data(e={}){return super.data(e)}}class Ti{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new ro(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new _l(this._firestore,this._userDataWriter,s.key,s,new ro(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new k(I.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,r){if(s._snapshot.oldDocs.isEmpty()){let i=0;return s._snapshot.docChanges.map(o=>({type:"added",doc:new _l(s._firestore,s._userDataWriter,o.doc.key,o.doc,new ro(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter),oldIndex:-1,newIndex:i++}))}{let i=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>r||o.type!==3).map(o=>{const a=new _l(s._firestore,s._userDataWriter,o.doc.key,o.doc,new ro(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,l=-1;return o.type!==0&&(c=i.indexOf(o.doc.key),i=i.delete(o.doc.key)),o.type!==1&&(i=i.add(o.doc),l=i.indexOf(o.doc.key)),{type:dW(o.type),doc:a,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function dW(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return H()}}function Mx(t,e){return t instanceof Ar&&e instanceof Ar?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Ti&&e instanceof Ti&&t._firestore===e._firestore&&Tx(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new k(I.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class th{}function Vr(t,...e){for(const n of e)t=n._apply(t);return t}class fW extends th{constructor(e,n,s){super(),this.fa=e,this.da=n,this._a=s,this.type="where"}_apply(e){const n=zo(e.firestore),s=function(r,i,o,a,c,l,u){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new k(I.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){aE(u,l);const f=[];for(const p of u)f.push(oE(a,r,p));h={arrayValue:{values:f}}}else h=oE(a,r,u)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||aE(u,l),h=Nx(o,i,u,l==="in"||l==="not-in");const d=Qt.create(c,l,h);return function(f,p){if(p.ht()){const v=Av(f);if(v!==null&&!v.isEqual(p.field))throw new k(I.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${v.toString()}' and '${p.field.toString()}'`);const b=kv(f);b!==null&&Vx(f,p.field,b)}const _=function(v,b){for(const N of v.filters)if(b.indexOf(N.op)>=0)return N.op;return null}(f,function(v){switch(v){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(p.op));if(_!==null)throw _===p.op?new k(I.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${p.op.toString()}' filter.`):new k(I.INVALID_ARGUMENT,`Invalid query. You cannot use '${p.op.toString()}' filters with '${_.toString()}' filters.`)}(r,d),d}(e._query,"where",n,e.firestore._databaseId,this.fa,this.da,this._a);return new cn(e.firestore,e.converter,function(r,i){const o=r.filters.concat([i]);return new Pr(r.path,r.collectionGroup,r.explicitOrderBy.slice(),o,r.limit,r.limitType,r.startAt,r.endAt)}(e._query,s))}}function pW(t,e,n){const s=e,r=Tp("where",t);return new fW(r,s,n)}class gW extends th{constructor(e,n){super(),this.fa=e,this.wa=n,this.type="orderBy"}_apply(e){const n=function(s,r,i){if(s.startAt!==null)throw new k(I.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new k(I.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ea(r,i);return function(a,c){if(kv(a)===null){const l=Av(a);l!==null&&Vx(a,l,c.field)}}(s,o),o}(e._query,this.fa,this.wa);return new cn(e.firestore,e.converter,function(s,r){const i=s.explicitOrderBy.concat([r]);return new Pr(s.path,s.collectionGroup,i,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function mW(t,e="asc"){const n=e,s=Tp("orderBy",t);return new gW(s,n)}class Fx extends th{constructor(e,n,s){super(),this.type=e,this.ma=n,this.ga=s}_apply(e){return new cn(e.firestore,e.converter,eR(e._query,this.ma,this.ga))}}function _W(t){return bx("limit",t),new Fx("limit",t,"F")}function yW(t){return bx("limitToLast",t),new Fx("limitToLast",t,"L")}class $x extends th{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=Bx(e,this.type,this.ya,this.pa);return new cn(e.firestore,e.converter,function(s,r){return new Pr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,r,s.endAt)}(e._query,n))}}function vW(...t){return new $x("startAt",t,!0)}function wW(...t){return new $x("startAfter",t,!1)}class Ux extends th{constructor(e,n,s){super(),this.type=e,this.ya=n,this.pa=s}_apply(e){const n=Bx(e,this.type,this.ya,this.pa);return new cn(e.firestore,e.converter,function(s,r){return new Pr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),s.limit,s.limitType,s.startAt,r)}(e._query,n))}}function bW(...t){return new Ux("endBefore",t,!1)}function IW(...t){return new Ux("endAt",t,!0)}function Bx(t,e,n,s){if(n[0]=A(n[0]),n[0]instanceof du)return function(r,i,o,a,c){if(!a)throw new k(I.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const l=[];for(const u of Ka(r))if(u.field.isKeyField())l.push(ko(i,a.key));else{const h=a.data.field(u.field);if(Cv(h))throw new k(I.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){const d=u.field.canonicalString();throw new k(I.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}l.push(h)}return new bi(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,s);{const r=zo(t.firestore);return function(i,o,a,c,l,u){const h=i.explicitOrderBy;if(l.length>h.length)throw new k(I.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const d=[];for(let f=0;f<l.length;f++){const p=l[f];if(h[f].field.isKeyField()){if(typeof p!="string")throw new k(I.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof p}`);if(!Rv(i)&&p.indexOf("/")!==-1)throw new k(I.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${p}' contains a slash.`);const _=i.path.child(be.fromString(p));if(!U.isDocumentKey(_))throw new k(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);const v=new U(_);d.push(ko(o,v))}else{const _=Nx(a,c,p);d.push(_)}}return new bi(d,u)}(t._query,t.firestore._databaseId,r,e,n,s)}}function oE(t,e,n){if(typeof(n=A(n))=="string"){if(n==="")throw new k(I.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Rv(e)&&n.indexOf("/")!==-1)throw new k(I.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(be.fromString(n));if(!U.isDocumentKey(s))throw new k(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return ko(t,new U(s))}if(n instanceof ze)return ko(t,n._key);throw new k(I.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wp(n)}.`)}function aE(t,e){if(!Array.isArray(t)||t.length===0)throw new k(I.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(t.length>10)throw new k(I.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function Vx(t,e,n){if(!n.isEqual(e))throw new k(I.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EW={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{convertValue(e,n="none"){switch(Co(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(So(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw H()}}convertObject(e,n){const s={};return Ho(e.fields,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertGeoPoint(e){return new bp(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=GA(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(su(e));default:return null}}convertTimestamp(e){const n=vi(e);return new Ze(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=be.fromString(e);ie(RR(s));const r=new kr(s.get(1),s.get(3)),i=new U(s.popFirst(5));return r.isEqual(n)||ft(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sp(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}class TW extends pw{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SW{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=zo(e)}set(e,n,s){this._verifyNotCommitted();const r=Gr(e,this._firestore),i=Sp(r.converter,n,s),o=Ep(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,tt.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=Gr(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof Ei?hw(this._dataReader,"WriteBatch.update",i._key,n,s,r):uw(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,tt.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Gr(e,this._firestore);return this._mutations=this._mutations.concat(new vc(n._key,tt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(I.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Gr(t,e){if((t=A(t)).firestore!==e)throw new k(I.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CW(t){t=Ee(t,ze);const e=Ee(t.firestore,it);return yx(Ht(e),t._key).then(n=>gw(e,t,n))}class Qo extends pw{constructor(e){super(),this.firestore=e}convertBytes(e){return new nr(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new ze(this.firestore,null,n)}}function kW(t){t=Ee(t,ze);const e=Ee(t.firestore,it),n=Ht(e),s=new Qo(e);return UH(n,t._key).then(r=>new Ar(e,s,t._key,r,new ro(r!==null&&r.hasLocalMutations,!0),t.converter))}function AW(t){t=Ee(t,ze);const e=Ee(t.firestore,it);return yx(Ht(e),t._key,{source:"server"}).then(n=>gw(e,t,n))}function RW(t){t=Ee(t,cn);const e=Ee(t.firestore,it),n=Ht(e),s=new Qo(e);return Lx(t._query),vx(n,t._query).then(r=>new Ti(e,s,t,r))}function xW(t){t=Ee(t,cn);const e=Ee(t.firestore,it),n=Ht(e),s=new Qo(e);return BH(n,t._query).then(r=>new Ti(e,s,t,r))}function NW(t){t=Ee(t,cn);const e=Ee(t.firestore,it),n=Ht(e),s=new Qo(e);return vx(n,t._query,{source:"server"}).then(r=>new Ti(e,s,t,r))}function cE(t,e,n){t=Ee(t,ze);const s=Ee(t.firestore,it),r=Sp(t.converter,e,n);return nh(s,[Ep(zo(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,tt.none())])}function lE(t,e,n,...s){t=Ee(t,ze);const r=Ee(t.firestore,it),i=zo(r);let o;return o=typeof(e=A(e))=="string"||e instanceof Ei?hw(i,"updateDoc",t._key,e,n,s):uw(i,"updateDoc",t._key,e),nh(r,[o.toMutation(t._key,tt.exists(!0))])}function PW(t){return nh(Ee(t.firestore,it),[new vc(t._key,tt.none())])}function DW(t,e){const n=Ee(t.firestore,it),s=Kd(t),r=Sp(t.converter,e);return nh(n,[Ep(zo(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,tt.exists(!1))]).then(()=>s)}function qx(t,...e){var n,s,r;t=A(t);let i={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||n_(e[o])||(i=e[o],o++);const a={includeMetadataChanges:i.includeMetadataChanges};if(n_(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(s=h.error)===null||s===void 0?void 0:s.bind(h),e[o+2]=(r=h.complete)===null||r===void 0?void 0:r.bind(h)}let c,l,u;if(t instanceof ze)l=Ee(t.firestore,it),u=_c(t._key.path),c={next:h=>{e[o]&&e[o](gw(l,t,h))},error:e[o+1],complete:e[o+2]};else{const h=Ee(t,cn);l=Ee(h.firestore,it),u=h._query;const d=new Qo(l);c={next:f=>{e[o]&&e[o](new Ti(l,d,h,f))},error:e[o+1],complete:e[o+2]},Lx(t._query)}return function(h,d,f,p){const _=new yp(p),v=new Xv(d,_,f);return h.asyncQueue.enqueueAndForget(async()=>Gv(await Xa(h),v)),()=>{_.Tc(),h.asyncQueue.enqueueAndForget(async()=>Qv(await Xa(h),v))}}(Ht(l),u,a,c)}function OW(t,e){return VH(Ht(t=Ee(t,it)),n_(e)?e:{next:e})}function nh(t,e){return function(n,s){const r=new Dt;return n.asyncQueue.enqueueAndForget(async()=>mH(await aw(n),s,r)),r.promise}(Ht(t),e)}function gw(t,e,n){const s=n.docs.get(e._key),r=new Qo(t);return new Ar(t,r,e._key,s,new ro(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW extends class{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=zo(e)}get(e){const n=Gr(e,this._firestore),s=new TW(this._firestore);return this._transaction.lookup([n._key]).then(r=>{if(!r||r.length!==1)return H();const i=r[0];if(i.isFoundDocument())return new du(this._firestore,s,i.key,i,n.converter);if(i.isNoDocument())return new du(this._firestore,s,n._key,null,n.converter);throw H()})}set(e,n,s){const r=Gr(e,this._firestore),i=Sp(r.converter,n,s),o=Ep(this._dataReader,"Transaction.set",r._key,i,r.converter!==null,s);return this._transaction.set(r._key,o),this}update(e,n,s,...r){const i=Gr(e,this._firestore);let o;return o=typeof(n=A(n))=="string"||n instanceof Ei?hw(this._dataReader,"Transaction.update",i._key,n,s,r):uw(this._dataReader,"Transaction.update",i._key,n),this._transaction.update(i._key,o),this}delete(e){const n=Gr(e,this._firestore);return this._transaction.delete(n._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=Gr(e,this._firestore),s=new Qo(this._firestore);return super.get(e).then(r=>new Ar(this._firestore,s,n._key,r._document,new ro(!1,!1),n.converter))}}function LW(t,e,n){t=Ee(t,it);const s=Object.assign(Object.assign({},EW),n);return function(r){if(r.maxAttempts<1)throw new k(I.INVALID_ARGUMENT,"Max attempts must be at least 1")}(s),qH(Ht(t),r=>e(new MW(t,r)),s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FW(){return new eh("deleteField")}function $W(){return new lw("serverTimestamp")}function UW(...t){return new aW("arrayUnion",t)}function BW(...t){return new cW("arrayRemove",t)}function VW(t){return new lW("increment",t)}(function(t,e=!0){(function(n){mc=n})(ir),st(new Te("firestore",(n,{options:s})=>{const r=n.getProvider("app").getImmediate(),i=new it(r,new Wj(n.getProvider("auth-internal")),new Yj(n.getProvider("app-check-internal")));return s=Object.assign({useFetchStreams:e},s),i._setSettings(s),i},"PUBLIC")),Ae(aI,"3.4.10",t),Ae(aI,"3.4.10","esm2017")})();const qW="@firebase/firestore-compat",jW="0.1.19";/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new k("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uE(){if(typeof Uint8Array=="undefined")throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function hE(){if(!r6())throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}class fu{constructor(e){this._delegate=e}static fromBase64String(e){return hE(),new fu(nr.fromBase64String(e))}static fromUint8Array(e){return uE(),new fu(nr.fromUint8Array(e))}toBase64(){return hE(),this._delegate.toBase64()}toUint8Array(){return uE(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r_(t){return KW(t,["next","error","complete"])}function KW(t,e){if(typeof t!="object"||t===null)return!1;const n=t;for(const s of e)if(s in n&&typeof n[s]=="function")return!0;return!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HW{enableIndexedDbPersistence(e,n){return YH(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return XH(e._delegate)}clearIndexedDbPersistence(e){return JH(e._delegate)}}class jx{constructor(e,n,s){this._delegate=n,this._persistenceProvider=s,this.INTERNAL={delete:()=>this.terminate()},e instanceof kr||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&tu("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,s={}){HH(this._delegate,e,n,s)}enableNetwork(){return eW(this._delegate)}disableNetwork(){return tW(this._delegate)}enablePersistence(e){let n=!1,s=!1;return e&&(n=!!e.synchronizeTabs,s=!!e.experimentalForceOwningTab,wx("synchronizeTabs",n,"experimentalForceOwningTab",s)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,s)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return ZH(this._delegate)}onSnapshotsInSync(e){return OW(this._delegate,e)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ja(this,Ix(this._delegate,e))}catch(n){throw fn(n,"collection()","Firestore.collection()")}}doc(e){try{return new os(this,Kd(this._delegate,e))}catch(n){throw fn(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new dn(this,WH(this._delegate,e))}catch(n){throw fn(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return LW(this._delegate,n=>e(new Kx(this,n)))}batch(){return Ht(this._delegate),new Hx(new SW(this._delegate,e=>nh(this._delegate,e)))}loadBundle(e){return nW(this._delegate,e)}namedQuery(e){return sW(this._delegate,e).then(n=>n?new dn(this,n):null)}}class Cp extends pw{constructor(e){super(),this.firestore=e}convertBytes(e){return new fu(new nr(e))}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return os.forKey(n,this.firestore,null)}}function WW(t){qj(t)}class Kx{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Cp(e)}get(e){const n=io(e);return this._delegate.get(n).then(s=>new pu(this._firestore,new Ar(this._firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,n.converter)))}set(e,n,s){const r=io(e);return s?(mw("Transaction.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=io(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=io(e);return this._delegate.delete(n),this}}class Hx{constructor(e){this._delegate=e}set(e,n,s){const r=io(e);return s?(mw("WriteBatch.set",s),this._delegate.set(r,n,s)):this._delegate.set(r,n),this}update(e,n,s,...r){const i=io(e);return arguments.length===2?this._delegate.update(i,n):this._delegate.update(i,n,s,...r),this}delete(e){const n=io(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}}class Oo{constructor(e,n,s){this._firestore=e,this._userDataWriter=n,this._delegate=s}fromFirestore(e,n){const s=new _l(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new gu(this._firestore,s),n!=null?n:{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){const s=Oo.INSTANCES;let r=s.get(e);r||(r=new WeakMap,s.set(e,r));let i=r.get(n);return i||(i=new Oo(e,new Cp(e),n),r.set(n,i)),i}}Oo.INSTANCES=new WeakMap;class os{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Cp(e)}static forPath(e,n,s){if(e.length%2!==0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new os(n,new ze(n._delegate,s,new U(e)))}static forKey(e,n,s){return new os(n,new ze(n._delegate,s,e))}get id(){return this._delegate.id}get parent(){return new Ja(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ja(this.firestore,Ix(this._delegate,e))}catch(n){throw fn(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=A(e),e instanceof ze?Ex(this._delegate,e):!1}set(e,n){n=mw("DocumentReference.set",n);try{return n?cE(this._delegate,e,n):cE(this._delegate,e)}catch(s){throw fn(s,"setDoc()","DocumentReference.set()")}}update(e,n,...s){try{return arguments.length===1?lE(this._delegate,e):lE(this._delegate,e,n,...s)}catch(r){throw fn(r,"updateDoc()","DocumentReference.update()")}}delete(){return PW(this._delegate)}onSnapshot(...e){const n=Wx(e),s=zx(e,r=>new pu(this.firestore,new Ar(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return qx(this._delegate,n,s)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=kW(this._delegate):(e==null?void 0:e.source)==="server"?n=AW(this._delegate):n=CW(this._delegate),n.then(s=>new pu(this.firestore,new Ar(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)))}withConverter(e){return new os(this.firestore,e?this._delegate.withConverter(Oo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function fn(t,e,n){return t.message=t.message.replace(e,n),t}function Wx(t){for(const e of t)if(typeof e=="object"&&!r_(e))return e;return{}}function zx(t,e){var n,s;let r;return r_(t[0])?r=t[0]:r_(t[1])?r=t[1]:typeof t[0]=="function"?r={next:t[0],error:t[1],complete:t[2]}:r={next:t[1],error:t[2],complete:t[3]},{next:i=>{r.next&&r.next(e(i))},error:(n=r.error)===null||n===void 0?void 0:n.bind(r),complete:(s=r.complete)===null||s===void 0?void 0:s.bind(r)}}class pu{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new os(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return Mx(this._delegate,e._delegate)}}class gu extends pu{data(e){const n=this._delegate.data(e);return jj(n!==void 0),n}}class dn{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Cp(e)}where(e,n,s){try{return new dn(this.firestore,Vr(this._delegate,pW(e,n,s)))}catch(r){throw fn(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new dn(this.firestore,Vr(this._delegate,mW(e,n)))}catch(s){throw fn(s,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new dn(this.firestore,Vr(this._delegate,_W(e)))}catch(n){throw fn(n,"limit()","Query.limit()")}}limitToLast(e){try{return new dn(this.firestore,Vr(this._delegate,yW(e)))}catch(n){throw fn(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new dn(this.firestore,Vr(this._delegate,vW(...e)))}catch(n){throw fn(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new dn(this.firestore,Vr(this._delegate,wW(...e)))}catch(n){throw fn(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new dn(this.firestore,Vr(this._delegate,bW(...e)))}catch(n){throw fn(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new dn(this.firestore,Vr(this._delegate,IW(...e)))}catch(n){throw fn(n,"endAt()","Query.endAt()")}}isEqual(e){return Tx(this._delegate,e._delegate)}get(e){let n;return(e==null?void 0:e.source)==="cache"?n=xW(this._delegate):(e==null?void 0:e.source)==="server"?n=NW(this._delegate):n=RW(this._delegate),n.then(s=>new i_(this.firestore,new Ti(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)))}onSnapshot(...e){const n=Wx(e),s=zx(e,r=>new i_(this.firestore,new Ti(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return qx(this._delegate,n,s)}withConverter(e){return new dn(this.firestore,e?this._delegate.withConverter(Oo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class zW{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new gu(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class i_{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new dn(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new gu(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new zW(this._firestore,n))}forEach(e,n){this._delegate.forEach(s=>{e.call(n,new gu(this._firestore,s))})}isEqual(e){return Mx(this._delegate,e._delegate)}}class Ja extends dn{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new os(this.firestore,e):null}doc(e){try{return e===void 0?new os(this.firestore,Kd(this._delegate)):new os(this.firestore,Kd(this._delegate,e))}catch(n){throw fn(n,"doc()","CollectionReference.doc()")}}add(e){return DW(this._delegate,e).then(n=>new os(this.firestore,n))}isEqual(e){return Ex(this._delegate,e._delegate)}withConverter(e){return new Ja(this.firestore,e?this._delegate.withConverter(Oo.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function io(t){return Ee(t,ze)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(...e){this._delegate=new Ei(...e)}static documentId(){return new _w(at.keyField().canonicalString())}isEqual(e){return e=A(e),e instanceof Ei?this._delegate._internalPath.isEqual(e._internalPath):!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi{constructor(e){this._delegate=e}static serverTimestamp(){const e=$W();return e._methodName="FieldValue.serverTimestamp",new Gi(e)}static delete(){const e=FW();return e._methodName="FieldValue.delete",new Gi(e)}static arrayUnion(...e){const n=UW(...e);return n._methodName="FieldValue.arrayUnion",new Gi(n)}static arrayRemove(...e){const n=BW(...e);return n._methodName="FieldValue.arrayRemove",new Gi(n)}static increment(e){const n=VW(e);return n._methodName="FieldValue.increment",new Gi(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GW={Firestore:jx,GeoPoint:bp,Timestamp:Ze,Blob:fu,Transaction:Kx,WriteBatch:Hx,DocumentReference:os,DocumentSnapshot:pu,Query:dn,QueryDocumentSnapshot:gu,QuerySnapshot:i_,CollectionReference:Ja,FieldPath:_w,FieldValue:Gi,setLogLevel:WW,CACHE_SIZE_UNLIMITED:QH};function QW(t,e){t.INTERNAL.registerComponent(new Te("firestore-compat",n=>{const s=n.getProvider("app-compat").getImmediate(),r=n.getProvider("firestore").getImmediate();return e(s,r)},"PUBLIC").setServiceProps(Object.assign({},GW)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YW(t){QW(t,(e,n)=>new jx(e,n,new HW)),t.registerVersion(qW,jW)}YW(jt);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XW="type.googleapis.com/google.protobuf.Int64Value",JW="type.googleapis.com/google.protobuf.UInt64Value";function Gx(t,e){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=e(t[s]));return n}function o_(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>o_(e));if(typeof t=="function"||typeof t=="object")return Gx(t,e=>o_(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Wd(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case XW:case JW:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Wd(e)):typeof t=="function"||typeof t=="object"?Gx(t,e=>Wd(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qx="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dE={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Sa extends lt{constructor(e,n,s){super(`${Qx}/${e}`,n||""),this.details=s}}function ZW(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ez(t,e){let n=ZW(t),s=n,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!dE[o])return new Sa("internal","internal");n=dE[o],s=o}const a=i.message;typeof a=="string"&&(s=a),r=i.details,r!==void 0&&(r=Wd(r))}}catch{}return n==="ok"?null:new Sa(n,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e,n,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(!!this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(){if(this.appCheck){const e=await this.appCheck.getToken();return e.error?null:e.token}return null}async getContext(){const e=await this.getAuthToken(),n=await this.getMessagingToken(),s=await this.getAppCheckToken();return{authToken:e,messagingToken:n,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fE="us-central1";function nz(t){let e=null;return{promise:new Promise((n,s)=>{e=setTimeout(()=>{s(new Sa("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class sz{constructor(e,n,s,r,i=fE,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new tz(n,s,r),this.cancelAllRequests=new Promise(a=>{this.deleteService=()=>Promise.resolve(a())});try{const a=new URL(i);this.customDomain=a.origin,this.region=fE}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function rz(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function iz(t,e,n){return s=>cz(t,e,s,n||{})}function oz(t,e,n){return s=>Yx(t,e,s,n||{})}async function az(t,e,n,s){n["Content-Type"]="application/json";let r;try{r=await s(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await r.json()}catch{}return{status:r.status,json:i}}function cz(t,e,n,s){const r=t._url(e);return Yx(t,r,n,s)}async function Yx(t,e,n,s){n=o_(n);const r={data:n},i={},o=await t.contextProvider.getContext();o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const a=s.timeout||7e4,c=nz(a),l=await Promise.race([az(e,r,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!l)throw new Sa("cancelled","Firebase Functions instance was deleted.");const u=ez(l.status,l.json);if(u)throw u;if(!l.json)throw new Sa("internal","Response is not valid JSON object.");let h=l.json.data;if(typeof h=="undefined"&&(h=l.json.result),typeof h=="undefined")throw new Sa("internal","Response is missing data field.");return{data:Wd(h)}}const pE="@firebase/functions",gE="0.8.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lz="auth-internal",uz="app-check-internal",hz="messaging-internal";function dz(t,e){const n=(s,{instanceIdentifier:r})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(lz),a=s.getProvider(hz),c=s.getProvider(uz);return new sz(i,o,a,c,r,t)};st(new Te(Qx,n,"PUBLIC").setMultipleInstances(!0)),Ae(pE,gE,e),Ae(pE,gE,"esm2017")}function mE(t,e,n){rz(A(t),e,n)}function fz(t,e,n){return iz(A(t),e,n)}function pz(t,e,n){return oz(A(t),e,n)}dz(fetch.bind(self));const gz="@firebase/functions-compat",mz="0.2.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xx{constructor(e,n){this.app=e,this._delegate=n,this._region=this._delegate.region,this._customDomain=this._delegate.customDomain}httpsCallable(e,n){return fz(this._delegate,e,n)}httpsCallableFromURL(e,n){return pz(this._delegate,e,n)}useFunctionsEmulator(e){const n=e.match("[a-zA-Z]+://([a-zA-Z0-9.-]+)(?::([0-9]+))?");if(n==null)throw new lt("functions","No origin provided to useFunctionsEmulator()");if(n[2]==null)throw new lt("functions","Port missing in origin provided to useFunctionsEmulator()");return mE(this._delegate,n[1],Number(n[2]))}useEmulator(e,n){return mE(this._delegate,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _z="us-central1",yz=(t,{instanceIdentifier:e})=>{const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("functions").getImmediate({identifier:e!=null?e:_z});return new Xx(n,s)};function vz(){const t={Functions:Xx};jt.INTERNAL.registerComponent(new Te("functions-compat",yz,"PUBLIC").setServiceProps(t).setMultipleInstances(!0))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */vz();jt.registerVersion(gz,mz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wz="/firebase-messaging-sw.js",bz="/firebase-cloud-messaging-push-scope",Jx="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Iz="https://fcmregistrations.googleapis.com/v1",Zx="google.c.a.c_id",Ez="google.c.a.c_l",Tz="google.c.a.ts",Sz="google.c.a.e";var _E;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(_E||(_E={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var mu;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(mu||(mu={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ar(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Cz(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg="fcm_token_details_db",kz=5,yE="fcm_token_object_Store";async function Az(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(vg))return null;let e=null;return(await rc(vg,kz,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(yE))return;const c=o.objectStore(yE),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:ar(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:ar(u.auth),p256dh:ar(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:ar(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:ar(u.auth),p256dh:ar(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:ar(u.vapidKey)}}}}}})).close(),await ma(vg),await ma("fcm_vapid_details_db"),await ma("undefined"),Rz(e)?e:null}function Rz(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xz="firebase-messaging-database",Nz=1,Mo="firebase-messaging-store";let wg=null;function yw(){return wg||(wg=rc(xz,Nz,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Mo)}}})),wg}async function eN(t){const e=ww(t),s=await(await yw()).transaction(Mo).objectStore(Mo).get(e);if(s)return s;{const r=await Az(t.appConfig.senderId);if(r)return await vw(t,r),r}}async function vw(t,e){const n=ww(t),r=(await yw()).transaction(Mo,"readwrite");return await r.objectStore(Mo).put(e,n),await r.done,e}async function Pz(t){const e=ww(t),s=(await yw()).transaction(Mo,"readwrite");await s.objectStore(Mo).delete(e),await s.done}function ww({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dz={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},bn=new En("messaging","Messaging",Dz);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oz(t,e){const n=await Iw(t),s=nN(e),r={method:"POST",headers:n,body:JSON.stringify(s)};let i;try{i=await(await fetch(bw(t.appConfig),r)).json()}catch(o){throw bn.create("token-subscribe-failed",{errorInfo:o})}if(i.error){const o=i.error.message;throw bn.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw bn.create("token-subscribe-no-token");return i.token}async function Mz(t,e){const n=await Iw(t),s=nN(e.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(s)};let i;try{i=await(await fetch(`${bw(t.appConfig)}/${e.token}`,r)).json()}catch(o){throw bn.create("token-update-failed",{errorInfo:o})}if(i.error){const o=i.error.message;throw bn.create("token-update-failed",{errorInfo:o})}if(!i.token)throw bn.create("token-update-no-token");return i.token}async function tN(t,e){const n=await Iw(t),s={method:"DELETE",headers:n};try{const i=await(await fetch(`${bw(t.appConfig)}/${e}`,s)).json();if(i.error){const o=i.error.message;throw bn.create("token-unsubscribe-failed",{errorInfo:o})}}catch(r){throw bn.create("token-unsubscribe-failed",{errorInfo:r})}}function bw({projectId:t}){return`${Iz}/projects/${t}/registrations`}async function Iw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function nN({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==Jx&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lz=7*24*60*60*1e3;async function Fz(t){const e=await Uz(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:ar(e.getKey("auth")),p256dh:ar(e.getKey("p256dh"))},s=await eN(t.firebaseDependencies);if(s){if(Bz(s.subscriptionOptions,n))return Date.now()>=s.createTime+Lz?$z(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await tN(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return vE(t.firebaseDependencies,n)}else return vE(t.firebaseDependencies,n)}async function sN(t){const e=await eN(t.firebaseDependencies);e&&(await tN(t.firebaseDependencies,e.token),await Pz(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function $z(t,e){try{const n=await Mz(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await vw(t.firebaseDependencies,s),n}catch(n){throw await sN(t),n}}async function vE(t,e){const s={token:await Oz(t,e),createTime:Date.now(),subscriptionOptions:e};return await vw(t,s),s.token}async function Uz(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Cz(e)})}function Bz(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wE(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return Vz(e,t),qz(e,t),jz(e,t),e}function Vz(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function qz(t,e){!e.data||(t.data=e.data)}function jz(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kz(t){return typeof t=="object"&&!!t&&Zx in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */rN("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");rN("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");function rN(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hz(t){if(!t||!t.options)throw bg("App Configuration Object");if(!t.name)throw bg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw bg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function bg(t){return bn.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=Hz(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iN(t){var e;try{t.swRegistration=await navigator.serviceWorker.register(wz,{scope:bz}),t.swRegistration.update().catch(()=>{})}catch(n){throw bn.create("failed-service-worker-registration",{browserErrorMessage:(e=n)===null||e===void 0?void 0:e.message})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(t,e){if(!e&&!t.swRegistration&&await iN(t),!(!e&&!!t.swRegistration)){if(!(e instanceof ServiceWorkerRegistration))throw bn.create("invalid-sw-registration");t.swRegistration=e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gz(t,e){e?t.vapidKey=e:t.vapidKey||(t.vapidKey=Jx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oN(t,e){if(!navigator)throw bn.create("only-available-in-window");if(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted")throw bn.create("permission-blocked");return await Gz(t,e==null?void 0:e.vapidKey),await zz(t,e==null?void 0:e.serviceWorkerRegistration),Fz(t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qz(t,e,n){const s=Yz(e);(await t.firebaseDependencies.analyticsProvider.get()).logEvent(s,{message_id:n[Zx],message_name:n[Ez],message_time:n[Tz],message_device_time:Math.floor(Date.now()/1e3)})}function Yz(t){switch(t){case mu.NOTIFICATION_CLICKED:return"notification_open";case mu.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xz(t,e){const n=e.data;if(!n.isFirebaseMessaging)return;t.onMessageHandler&&n.messageType===mu.PUSH_RECEIVED&&(typeof t.onMessageHandler=="function"?t.onMessageHandler(wE(n)):t.onMessageHandler.next(wE(n)));const s=n.data;Kz(s)&&s[Sz]==="1"&&await Qz(t,n.messageType,s)}const bE="@firebase/messaging",IE="0.9.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jz=t=>{const e=new Wz(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",n=>Xz(e,n)),e},Zz=t=>{const e=t.getProvider("messaging").getImmediate();return{getToken:s=>oN(e,s)}};function e8(){st(new Te("messaging",Jz,"PUBLIC")),st(new Te("messaging-internal",Zz,"PRIVATE")),Ae(bE,IE),Ae(bE,IE,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t8(t){if(!navigator)throw bn.create("only-available-in-window");return t.swRegistration||await iN(t),sN(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n8(t,e){if(!navigator)throw bn.create("only-available-in-window");return t.onMessageHandler=e,()=>{t.onMessageHandler=null}}async function s8(t,e){return t=A(t),oN(t,e)}function r8(t){return t=A(t),t8(t)}function i8(t,e){return t=A(t),n8(t,e)}e8();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",o8="https://fcmregistrations.googleapis.com/v1",cN="FCM_MSG",a8="google.c.a.c_id",c8=3,l8=1;var zd;(function(t){t[t.DATA_MESSAGE=1]="DATA_MESSAGE",t[t.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"})(zd||(zd={}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except
 * in compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License
 * is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing permissions and limitations under
 * the License.
 */var Gd;(function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"})(Gd||(Gd={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cr(t){const e=new Uint8Array(t);return btoa(String.fromCharCode(...e)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function u8(t){const e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),s=atob(n),r=new Uint8Array(s.length);for(let i=0;i<s.length;++i)r[i]=s.charCodeAt(i);return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="fcm_token_details_db",h8=5,EE="fcm_token_object_Store";async function d8(t){if("databases"in indexedDB&&!(await indexedDB.databases()).map(i=>i.name).includes(Ig))return null;let e=null;return(await rc(Ig,h8,{upgrade:async(s,r,i,o)=>{var a;if(r<2||!s.objectStoreNames.contains(EE))return;const c=o.objectStore(EE),l=await c.index("fcmSenderId").get(t);if(await c.clear(),!!l){if(r===2){const u=l;if(!u.auth||!u.p256dh||!u.endpoint)return;e={token:u.fcmToken,createTime:(a=u.createTime)!==null&&a!==void 0?a:Date.now(),subscriptionOptions:{auth:u.auth,p256dh:u.p256dh,endpoint:u.endpoint,swScope:u.swScope,vapidKey:typeof u.vapidKey=="string"?u.vapidKey:cr(u.vapidKey)}}}else if(r===3){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:cr(u.auth),p256dh:cr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:cr(u.vapidKey)}}}else if(r===4){const u=l;e={token:u.fcmToken,createTime:u.createTime,subscriptionOptions:{auth:cr(u.auth),p256dh:cr(u.p256dh),endpoint:u.endpoint,swScope:u.swScope,vapidKey:cr(u.vapidKey)}}}}}})).close(),await ma(Ig),await ma("fcm_vapid_details_db"),await ma("undefined"),f8(e)?e:null}function f8(t){if(!t||!t.subscriptionOptions)return!1;const{subscriptionOptions:e}=t;return typeof t.createTime=="number"&&t.createTime>0&&typeof t.token=="string"&&t.token.length>0&&typeof e.auth=="string"&&e.auth.length>0&&typeof e.p256dh=="string"&&e.p256dh.length>0&&typeof e.endpoint=="string"&&e.endpoint.length>0&&typeof e.swScope=="string"&&e.swScope.length>0&&typeof e.vapidKey=="string"&&e.vapidKey.length>0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p8="firebase-messaging-database",g8=1,Lo="firebase-messaging-store";let Eg=null;function Ew(){return Eg||(Eg=rc(p8,g8,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(Lo)}}})),Eg}async function Tw(t){const e=Cw(t),s=await(await Ew()).transaction(Lo).objectStore(Lo).get(e);if(s)return s;{const r=await d8(t.appConfig.senderId);if(r)return await Sw(t,r),r}}async function Sw(t,e){const n=Cw(t),r=(await Ew()).transaction(Lo,"readwrite");return await r.objectStore(Lo).put(e,n),await r.done,e}async function m8(t){const e=Cw(t),s=(await Ew()).transaction(Lo,"readwrite");await s.objectStore(Lo).delete(e),await s.done}function Cw({appConfig:t}){return t.appId}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _8={["missing-app-config-values"]:'Missing App configuration value: "{$valueName}"',["only-available-in-window"]:"This method is available in a Window context.",["only-available-in-sw"]:"This method is available in a service worker context.",["permission-default"]:"The notification permission was not granted and dismissed instead.",["permission-blocked"]:"The notification permission was not granted and blocked instead.",["unsupported-browser"]:"This browser doesn't support the API's required to use the Firebase SDK.",["indexed-db-unsupported"]:"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)",["failed-service-worker-registration"]:"We are unable to register the default service worker. {$browserErrorMessage}",["token-subscribe-failed"]:"A problem occurred while subscribing the user to FCM: {$errorInfo}",["token-subscribe-no-token"]:"FCM returned no token when subscribing the user to push.",["token-unsubscribe-failed"]:"A problem occurred while unsubscribing the user from FCM: {$errorInfo}",["token-update-failed"]:"A problem occurred while updating the user from FCM: {$errorInfo}",["token-update-no-token"]:"FCM returned no token when updating the user to push.",["use-sw-after-get-token"]:"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",["invalid-sw-registration"]:"The input to useServiceWorker() must be a ServiceWorkerRegistration.",["invalid-bg-handler"]:"The input to setBackgroundMessageHandler() must be a function.",["invalid-vapid-key"]:"The public VAPID key must be a string.",["use-vapid-key-after-get-token"]:"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Gs=new En("messaging","Messaging",_8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function y8(t,e){const n=await Aw(t),s=uN(e),r={method:"POST",headers:n,body:JSON.stringify(s)};let i;try{i=await(await fetch(kw(t.appConfig),r)).json()}catch(o){throw Gs.create("token-subscribe-failed",{errorInfo:o})}if(i.error){const o=i.error.message;throw Gs.create("token-subscribe-failed",{errorInfo:o})}if(!i.token)throw Gs.create("token-subscribe-no-token");return i.token}async function v8(t,e){const n=await Aw(t),s=uN(e.subscriptionOptions),r={method:"PATCH",headers:n,body:JSON.stringify(s)};let i;try{i=await(await fetch(`${kw(t.appConfig)}/${e.token}`,r)).json()}catch(o){throw Gs.create("token-update-failed",{errorInfo:o})}if(i.error){const o=i.error.message;throw Gs.create("token-update-failed",{errorInfo:o})}if(!i.token)throw Gs.create("token-update-no-token");return i.token}async function lN(t,e){const n=await Aw(t),s={method:"DELETE",headers:n};try{const i=await(await fetch(`${kw(t.appConfig)}/${e}`,s)).json();if(i.error){const o=i.error.message;throw Gs.create("token-unsubscribe-failed",{errorInfo:o})}}catch(r){throw Gs.create("token-unsubscribe-failed",{errorInfo:r})}}function kw({projectId:t}){return`${o8}/projects/${t}/registrations`}async function Aw({appConfig:t,installations:e}){const n=await e.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":`FIS ${n}`})}function uN({p256dh:t,auth:e,endpoint:n,vapidKey:s}){const r={web:{endpoint:n,auth:e,p256dh:t}};return s!==aN&&(r.web.applicationPubKey=s),r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w8=7*24*60*60*1e3;async function b8(t){const e=await E8(t.swRegistration,t.vapidKey),n={vapidKey:t.vapidKey,swScope:t.swRegistration.scope,endpoint:e.endpoint,auth:cr(e.getKey("auth")),p256dh:cr(e.getKey("p256dh"))},s=await Tw(t.firebaseDependencies);if(s){if(T8(s.subscriptionOptions,n))return Date.now()>=s.createTime+w8?I8(t,{token:s.token,createTime:Date.now(),subscriptionOptions:n}):s.token;try{await lN(t.firebaseDependencies,s.token)}catch(r){console.warn(r)}return TE(t.firebaseDependencies,n)}else return TE(t.firebaseDependencies,n)}async function a_(t){const e=await Tw(t.firebaseDependencies);e&&(await lN(t.firebaseDependencies,e.token),await m8(t.firebaseDependencies));const n=await t.swRegistration.pushManager.getSubscription();return n?n.unsubscribe():!0}async function I8(t,e){try{const n=await v8(t.firebaseDependencies,e),s=Object.assign(Object.assign({},e),{token:n,createTime:Date.now()});return await Sw(t.firebaseDependencies,s),n}catch(n){throw await a_(t),n}}async function TE(t,e){const s={token:await y8(t,e),createTime:Date.now(),subscriptionOptions:e};return await Sw(t,s),s.token}async function E8(t,e){const n=await t.pushManager.getSubscription();return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:u8(e)})}function T8(t,e){const n=e.vapidKey===t.vapidKey,s=e.endpoint===t.endpoint,r=e.auth===t.auth,i=e.p256dh===t.p256dh;return n&&s&&r&&i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S8(t){const e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcmMessageId};return C8(e,t),k8(e,t),A8(e,t),e}function C8(t,e){if(!e.notification)return;t.notification={};const n=e.notification.title;n&&(t.notification.title=n);const s=e.notification.body;s&&(t.notification.body=s);const r=e.notification.image;r&&(t.notification.image=r)}function k8(t,e){!e.data||(t.data=e.data)}function A8(t,e){var n,s,r,i,o;if(!e.fcmOptions&&!(!((n=e.notification)===null||n===void 0)&&n.click_action))return;t.fcmOptions={};const a=(r=(s=e.fcmOptions)===null||s===void 0?void 0:s.link)!==null&&r!==void 0?r:(i=e.notification)===null||i===void 0?void 0:i.click_action;a&&(t.fcmOptions.link=a);const c=(o=e.fcmOptions)===null||o===void 0?void 0:o.analytics_label;c&&(t.fcmOptions.analyticsLabel=c)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R8(t){return typeof t=="object"&&!!t&&a8 in t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x8(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hN("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o");hN("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");async function N8(t,e){const n=P8(e,await t.firebaseDependencies.installations.getId());D8(t,n)}function P8(t,e){var n,s;const r={};return t.from&&(r.project_number=t.from),t.fcmMessageId&&(r.message_id=t.fcmMessageId),r.instance_id=e,t.notification?r.message_type=zd.DISPLAY_NOTIFICATION.toString():r.message_type=zd.DATA_MESSAGE.toString(),r.sdk_platform=c8.toString(),r.package_name=self.origin.replace(/(^\w+:|^)\/\//,""),t.collapse_key&&(r.collapse_key=t.collapse_key),r.event=l8.toString(),!((n=t.fcmOptions)===null||n===void 0)&&n.analytics_label&&(r.analytics_label=(s=t.fcmOptions)===null||s===void 0?void 0:s.analytics_label),r}function D8(t,e){const n={};n.event_time_ms=Math.floor(Date.now()).toString(),n.source_extension_json_proto3=JSON.stringify(e),t.logEvents.push(n)}function hN(t,e){const n=[];for(let s=0;s<t.length;s++)n.push(t.charAt(s)),s<e.length&&n.push(e.charAt(s));return n.join("")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O8(t,e){var n,s;const{newSubscription:r}=t;if(!r){await a_(e);return}const i=await Tw(e.firebaseDependencies);await a_(e),e.vapidKey=(s=(n=i==null?void 0:i.subscriptionOptions)===null||n===void 0?void 0:n.vapidKey)!==null&&s!==void 0?s:aN,await b8(e)}async function M8(t,e){const n=$8(t);if(!n)return;e.deliveryMetricsExportedToBigQueryEnabled&&await N8(e,n);const s=await dN();if(B8(s))return V8(s,n);if(n.notification&&await q8(F8(n)),!!e&&e.onBackgroundMessageHandler){const r=S8(n);typeof e.onBackgroundMessageHandler=="function"?await e.onBackgroundMessageHandler(r):e.onBackgroundMessageHandler.next(r)}}async function L8(t){var e,n;const s=(n=(e=t.notification)===null||e===void 0?void 0:e.data)===null||n===void 0?void 0:n[cN];if(s){if(t.action)return}else return;t.stopImmediatePropagation(),t.notification.close();const r=j8(s);if(!r)return;const i=new URL(r,self.location.href),o=new URL(self.location.origin);if(i.host!==o.host)return;let a=await U8(i);if(a?a=await a.focus():(a=await self.clients.openWindow(r),await x8(3e3)),!!a)return s.messageType=Gd.NOTIFICATION_CLICKED,s.isFirebaseMessaging=!0,a.postMessage(s)}function F8(t){const e=Object.assign({},t.notification);return e.data={[cN]:t},e}function $8({data:t}){if(!t)return null;try{return t.json()}catch{return null}}async function U8(t){const e=await dN();for(const n of e){const s=new URL(n.url,self.location.href);if(t.host===s.host)return n}return null}function B8(t){return t.some(e=>e.visibilityState==="visible"&&!e.url.startsWith("chrome-extension://"))}function V8(t,e){e.isFirebaseMessaging=!0,e.messageType=Gd.PUSH_RECEIVED;for(const n of t)n.postMessage(e)}function dN(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function q8(t){var e;const{actions:n}=t,{maxActions:s}=Notification;return n&&s&&n.length>s&&console.warn(`This browser only supports ${s} actions. The remaining actions will not be displayed.`),self.registration.showNotification((e=t.title)!==null&&e!==void 0?e:"",t)}function j8(t){var e,n,s;const r=(n=(e=t.fcmOptions)===null||e===void 0?void 0:e.link)!==null&&n!==void 0?n:(s=t.notification)===null||s===void 0?void 0:s.click_action;return r||(R8(t.data)?self.location.origin:null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K8(t){if(!t||!t.options)throw Tg("App Configuration Object");if(!t.name)throw Tg("App Name");const e=["projectId","apiKey","appId","messagingSenderId"],{options:n}=t;for(const s of e)if(!n[s])throw Tg(s);return{appName:t.name,projectId:n.projectId,apiKey:n.apiKey,appId:n.appId,senderId:n.messagingSenderId}}function Tg(t){return Gs.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H8{constructor(e,n,s){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const r=K8(e);this.firebaseDependencies={app:e,appConfig:r,installations:n,analyticsProvider:s}}_delete(){return Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8=t=>{const e=new H8(t.getProvider("app").getImmediate(),t.getProvider("installations-internal").getImmediate(),t.getProvider("analytics-internal"));return self.addEventListener("push",n=>{n.waitUntil(M8(n,e))}),self.addEventListener("pushsubscriptionchange",n=>{n.waitUntil(O8(n,e))}),self.addEventListener("notificationclick",n=>{n.waitUntil(L8(n))}),e};function z8(){st(new Te("messaging-sw",W8,"PUBLIC"))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G8(t,e){if(self.document!==void 0)throw Gs.create("only-available-in-sw");return t.onBackgroundMessageHandler=e,()=>{t.onBackgroundMessageHandler=null}}function Q8(t,e){return t=A(t),G8(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */z8();const Y8="@firebase/messaging-compat",X8="0.1.14";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J8(){return self&&"ServiceWorkerGlobalScope"in self?eG():Z8()}function Z8(){return typeof window!="undefined"&&Mn()&&ff()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}function eG(){return Mn()&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}class SE{constructor(e,n){this.app=e,this._delegate=n,this.app=e,this._delegate=n}async getToken(e){return s8(this._delegate,e)}async deleteToken(){return r8(this._delegate)}onMessage(e){return i8(this._delegate,e)}onBackgroundMessage(e){return Q8(this._delegate,e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tG=t=>self&&"ServiceWorkerGlobalScope"in self?new SE(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging-sw").getImmediate()):new SE(t.getProvider("app-compat").getImmediate(),t.getProvider("messaging").getImmediate()),nG={isSupported:J8};function sG(){jt.INTERNAL.registerComponent(new Te("messaging-compat",tG,"PUBLIC").setServiceProps(nG))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sG();jt.registerVersion(Y8,X8);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN="firebasestorage.googleapis.com",pN="storageBucket",rG=2*60*1e3,iG=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot extends lt{constructor(e,n){super(Sg(e),`Firebase Storage: ${n} (${Sg(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ot.prototype)}_codeEquals(e){return Sg(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function Sg(t){return"storage/"+t}function Rw(){const t="An unknown error occurred, please check the error payload for server response.";return new ot("unknown",t)}function oG(t){return new ot("object-not-found","Object '"+t+"' does not exist.")}function aG(t){return new ot("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function cG(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new ot("unauthenticated",t)}function lG(){return new ot("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function uG(t){return new ot("unauthorized","User does not have permission to access '"+t+"'.")}function hG(){return new ot("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function gN(){return new ot("canceled","User canceled the upload/download.")}function dG(t){return new ot("invalid-url","Invalid URL '"+t+"'.")}function fG(t){return new ot("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function pG(){return new ot("no-default-bucket","No default bucket found. Did you set the '"+pN+"' property when initializing the app?")}function mN(){return new ot("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function gG(){return new ot("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function mG(){return new ot("no-download-url","The given file does not have any download URLs.")}function Ca(t){return new ot("invalid-argument",t)}function _N(){return new ot("app-deleted","The Firebase app was deleted.")}function yN(t){return new ot("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function yl(t,e){return new ot("invalid-format","String does not match format '"+t+"': "+e)}function qc(t){throw new ot("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=rn.makeFromUrl(e,n)}catch{return new rn(e,"")}if(s.path==="")return s;throw fG(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function l($){$.path_=decodeURIComponent($.path)}const u="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",f=new RegExp(`^https?://${h}/${u}/b/${r}/o${d}`,"i"),p={bucket:1,path:3},_=n===fN?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",b=new RegExp(`^https?://${_}/${r}/${v}`,"i"),T=[{regex:a,indices:c,postModify:i},{regex:f,indices:p,postModify:l},{regex:b,indices:{bucket:1,path:2},postModify:l}];for(let $=0;$<T.length;$++){const z=T[$],te=z.regex.exec(e);if(te){const J=te[z.indices.bucket];let ae=te[z.indices.path];ae||(ae=""),s=new rn(J,ae),z.postModify(s);break}}if(s==null)throw dG(e);return s}}class _G{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yG(t,e,n){let s=1,r=null,i=null,o=!1,a=0;function c(){return a===2}let l=!1;function u(...v){l||(l=!0,e.apply(null,v))}function h(v){r=setTimeout(()=>{r=null,t(f,c())},v)}function d(){i&&clearTimeout(i)}function f(v,...b){if(l){d();return}if(v){d(),u.call(null,v,...b);return}if(c()||o){d(),u.call(null,v,...b);return}s<64&&(s*=2);let T;a===1?(a=2,T=0):T=(s+Math.random())*1e3,h(T)}let p=!1;function _(v){p||(p=!0,d(),!l&&(r!==null?(v||(a=2),clearTimeout(r),h(0)):v||(a=1)))}return h(0),i=setTimeout(()=>{o=!0,_(!0)},n),_}function vG(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wG(t){return t!==void 0}function bG(t){return typeof t=="function"}function IG(t){return typeof t=="object"&&!Array.isArray(t)}function kp(t){return typeof t=="string"||t instanceof String}function CE(t){return xw()&&t instanceof Blob}function xw(){return typeof Blob!="undefined"}function c_(t,e,n,s){if(s<e)throw Ca(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw Ca(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Di(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function vN(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fo;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(fo||(fo={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EG{constructor(e,n,s,r,i,o,a,c,l,u,h){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=c,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((d,f)=>{this.resolve_=d,this.reject_=f,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new Sh(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const c=a.loaded,l=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,l)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===fo.NO_ERROR,c=i.getStatus();if(!a||this.isRetryStatusCode_(c)){const u=i.getErrorCode()===fo.ABORT;s(!1,new Sh(!1,null,u));return}const l=this.successCodes_.indexOf(c)!==-1;s(!0,new Sh(l,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,a=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(a,a.getResponse());wG(c)?i(c):i()}catch(c){o(c)}else if(a!==null){const c=Rw();c.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,c)):o(c)}else if(r.canceled){const c=this.appDelete_?_N():gN();o(c)}else{const c=hG();o(c)}};this.canceled_?n(!1,new Sh(!1,null,!0)):this.backoffId_=yG(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vG(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const n=e>=500&&e<600,r=[408,429].indexOf(e)!==-1,i=this.additionalRetryCodes_.indexOf(e)!==-1;return n||r||i}}class Sh{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function TG(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function SG(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e!=null?e:"AppManager")}function CG(t,e){e&&(t["X-Firebase-GMPID"]=e)}function kG(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function AG(t,e,n,s,r,i){const o=vN(t.urlParams),a=t.url+o,c=Object.assign({},t.headers);return CG(c,e),TG(c,n),SG(c,i),kG(c,s),new EG(a,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RG(){return typeof BlobBuilder!="undefined"?BlobBuilder:typeof WebKitBlobBuilder!="undefined"?WebKitBlobBuilder:void 0}function xG(...t){const e=RG();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if(xw())return new Blob(t);throw new ot("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function NG(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const as={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Cg{constructor(e,n){this.data=e,this.contentType=n||null}}function wN(t,e){switch(t){case as.RAW:return new Cg(bN(e));case as.BASE64:case as.BASE64URL:return new Cg(IN(t,e));case as.DATA_URL:return new Cg(OG(e),MG(e))}throw Rw()}function bN(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function DG(t){let e;try{e=decodeURIComponent(t)}catch{throw yl(as.DATA_URL,"Malformed data URL.")}return bN(e)}function IN(t,e){switch(t){case as.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw yl(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case as.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw yl(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=PG(e)}catch{throw yl(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class EN{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw yl(as.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=LG(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function OG(t){const e=new EN(t);return e.base64?IN(as.BASE64,e.rest):DG(e.rest)}function MG(t){return new EN(t).contentType}function LG(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hr{constructor(e,n){let s=0,r="";CE(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(CE(this.data_)){const s=this.data_,r=NG(s,e,n);return r===null?null:new hr(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new hr(s,!0)}}static getBlob(...e){if(xw()){const n=e.map(s=>s instanceof hr?s.data_:s);return new hr(xG.apply(null,n))}else{const n=e.map(o=>kp(o)?wN(as.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let a=0;a<o.length;a++)r[i++]=o[a]}),new hr(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nw(t){let e;try{e=JSON.parse(t)}catch{return null}return IG(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FG(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function $G(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function TN(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UG(t,e){return e}class un{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||UG}}let Ch=null;function BG(t){return!kp(t)||t.length<2?t:TN(t)}function Ap(){if(Ch)return Ch;const t=[];t.push(new un("bucket")),t.push(new un("generation")),t.push(new un("metageneration")),t.push(new un("name","fullPath",!0));function e(i,o){return BG(o)}const n=new un("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new un("size");return r.xform=s,t.push(r),t.push(new un("timeCreated")),t.push(new un("updated")),t.push(new un("md5Hash",null,!0)),t.push(new un("cacheControl",null,!0)),t.push(new un("contentDisposition",null,!0)),t.push(new un("contentEncoding",null,!0)),t.push(new un("contentLanguage",null,!0)),t.push(new un("contentType",null,!0)),t.push(new un("metadata","customMetadata",!0)),Ch=t,Ch}function VG(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new rn(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function qG(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return VG(s,t),s}function SN(t,e,n){const s=Nw(e);return s===null?null:qG(t,s,n)}function jG(t,e,n,s){const r=Nw(e);if(r===null||!kp(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(l=>{const u=t.bucket,h=t.fullPath,d="/b/"+o(u)+"/o/"+o(h),f=Di(d,n,s),p=vN({alt:"media",token:l});return f+p})[0]}function Pw(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE="prefixes",AE="items";function KG(t,e,n){const s={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[kE])for(const r of n[kE]){const i=r.replace(/\/$/,""),o=t._makeStorageReference(new rn(e,i));s.prefixes.push(o)}if(n[AE])for(const r of n[AE]){const i=t._makeStorageReference(new rn(e,r.name));s.items.push(i)}return s}function HG(t,e,n){const s=Nw(n);return s===null?null:KG(t,e,s)}class Mr{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qs(t){if(!t)throw Rw()}function Rp(t,e){function n(s,r){const i=SN(t,r,e);return Qs(i!==null),i}return n}function WG(t,e){function n(s,r){const i=HG(t,e,r);return Qs(i!==null),i}return n}function zG(t,e){function n(s,r){const i=SN(t,r,e);return Qs(i!==null),jG(i,r,t.host,t._protocol)}return n}function Tc(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=lG():r=cG():n.getStatus()===402?r=aG(t.bucket):n.getStatus()===403?r=uG(t.path):r=s,r.serverResponse=s.serverResponse,r}return e}function xp(t){const e=Tc(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=oG(t.path)),i.serverResponse=r.serverResponse,i}return n}function CN(t,e,n){const s=e.fullServerUrl(),r=Di(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Mr(r,i,Rp(t,n),o);return a.errorHandler=xp(e),a}function GG(t,e,n,s,r){const i={};e.isRoot?i.prefix="":i.prefix=e.path+"/",n&&n.length>0&&(i.delimiter=n),s&&(i.pageToken=s),r&&(i.maxResults=r);const o=e.bucketOnlyServerUrl(),a=Di(o,t.host,t._protocol),c="GET",l=t.maxOperationRetryTime,u=new Mr(a,c,WG(t,e.bucket),l);return u.urlParams=i,u.errorHandler=Tc(e),u}function QG(t,e,n){const s=e.fullServerUrl(),r=Di(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,a=new Mr(r,i,zG(t,n),o);return a.errorHandler=xp(e),a}function YG(t,e,n,s){const r=e.fullServerUrl(),i=Di(r,t.host,t._protocol),o="PATCH",a=Pw(n,s),c={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime,u=new Mr(i,o,Rp(t,s),l);return u.headers=c,u.body=a,u.errorHandler=xp(e),u}function XG(t,e){const n=e.fullServerUrl(),s=Di(n,t.host,t._protocol),r="DELETE",i=t.maxOperationRetryTime;function o(c,l){}const a=new Mr(s,r,o,i);return a.successCodes=[200,204],a.errorHandler=xp(e),a}function JG(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function kN(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=JG(null,e)),s}function ZG(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let T="";for(let $=0;$<2;$++)T=T+Math.random().toString().slice(2);return T}const c=a();o["Content-Type"]="multipart/related; boundary="+c;const l=kN(e,s,r),u=Pw(l,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+c+`\r
Content-Type: `+l.contentType+`\r
\r
`,d=`\r
--`+c+"--",f=hr.getBlob(h,s,d);if(f===null)throw mN();const p={name:l.fullPath},_=Di(i,t.host,t._protocol),v="POST",b=t.maxUploadRetryTime,N=new Mr(_,v,Rp(t,n),b);return N.urlParams=p,N.headers=o,N.body=f.uploadData(),N.errorHandler=Tc(e),N}class Qd{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function Dw(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Qs(!1)}return Qs(!!n&&(e||["active"]).indexOf(n)!==-1),n}function e7(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=kN(e,s,r),a={name:o.fullPath},c=Di(i,t.host,t._protocol),l="POST",u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},h=Pw(o,n),d=t.maxUploadRetryTime;function f(_){Dw(_);let v;try{v=_.getResponseHeader("X-Goog-Upload-URL")}catch{Qs(!1)}return Qs(kp(v)),v}const p=new Mr(c,l,f,d);return p.urlParams=a,p.headers=u,p.body=h,p.errorHandler=Tc(e),p}function t7(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(l){const u=Dw(l,["active","final"]);let h=null;try{h=l.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Qs(!1)}h||Qs(!1);const d=Number(h);return Qs(!isNaN(d)),new Qd(d,s.size(),u==="final")}const o="POST",a=t.maxUploadRetryTime,c=new Mr(n,o,i,a);return c.headers=r,c.errorHandler=Tc(e),c}const RE=256*1024;function n7(t,e,n,s,r,i,o,a){const c=new Qd(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw gG();const l=c.total-c.current;let u=l;r>0&&(u=Math.min(u,r));const h=c.current,d=h+u,p={"X-Goog-Upload-Command":u===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${c.current}`},_=s.slice(h,d);if(_===null)throw mN();function v($,z){const te=Dw($,["active","final"]),J=c.current+u,ae=s.size();let Ne;return te==="final"?Ne=Rp(e,i)($,z):Ne=null,new Qd(J,ae,te==="final",Ne)}const b="POST",N=e.maxUploadRetryTime,T=new Mr(n,b,v,N);return T.headers=p,T.body=_.uploadData(),T.progressCallback=a||null,T.errorHandler=Tc(t),T}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7={STATE_CHANGED:"state_changed"},pn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function kg(t){switch(t){case"running":case"pausing":case"canceling":return pn.RUNNING;case"paused":return pn.PAUSED;case"success":return pn.SUCCESS;case"canceled":return pn.CANCELED;case"error":return pn.ERROR;default:return pn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e,n,s){if(bG(e)||n!=null||s!=null)this.next=e,this.error=n!=null?n:void 0,this.complete=s!=null?s:void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sa(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class i7{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=fo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=fo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=fo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw qc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw qc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw qc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw qc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw qc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class o7 extends i7{initXhr(){this.xhr_.responseType="text"}}function Us(){return new o7}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=Ap(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{this._request=void 0,this._chunkMultiplier=1,r._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=r,this._transition("error"))},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals("canceled")?this.completeTransitions_():(this._error=r,this._transition("error"))},this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=e7(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Us,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=t7(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,Us,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=RE*this._chunkMultiplier,n=new Qd(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=n7(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const a=this._ref.storage._makeRequest(o,Us,r,i);this._request=a,a.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){RE*this._chunkMultiplier<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=CN(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,Us,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=ZG(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,Us,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=gN(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=kg(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new r7(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(kg(this._state)){case pn.SUCCESS:sa(this._resolve.bind(null,this.snapshot))();break;case pn.CANCELED:case pn.ERROR:const n=this._reject;sa(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(kg(this._state)){case pn.RUNNING:case pn.PAUSED:e.next&&sa(e.next.bind(e,this.snapshot))();break;case pn.SUCCESS:e.complete&&sa(e.complete.bind(e))();break;case pn.CANCELED:case pn.ERROR:e.error&&sa(e.error.bind(e,this._error))();break;default:e.error&&sa(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fo{constructor(e,n){this._service=e,n instanceof rn?this._location=n:this._location=rn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Fo(e,n)}get root(){const e=new rn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return TN(this._location.path)}get storage(){return this._service}get parent(){const e=FG(this._location.path);if(e===null)return null;const n=new rn(this._location.bucket,e);return new Fo(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw yN(e)}}function a7(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new AN(t,new hr(e),n)}function c7(t){const e={prefixes:[],items:[]};return RN(t,e).then(()=>e)}async function RN(t,e,n){const r=await xN(t,{pageToken:n});e.prefixes.push(...r.prefixes),e.items.push(...r.items),r.nextPageToken!=null&&await RN(t,e,r.nextPageToken)}function xN(t,e){e!=null&&typeof e.maxResults=="number"&&c_("options.maxResults",1,1e3,e.maxResults);const n=e||{},s=GG(t.storage,t._location,"/",n.pageToken,n.maxResults);return t.storage.makeRequestWithTokens(s,Us)}function l7(t){t._throwIfRoot("getMetadata");const e=CN(t.storage,t._location,Ap());return t.storage.makeRequestWithTokens(e,Us)}function u7(t,e){t._throwIfRoot("updateMetadata");const n=YG(t.storage,t._location,e,Ap());return t.storage.makeRequestWithTokens(n,Us)}function h7(t){t._throwIfRoot("getDownloadURL");const e=QG(t.storage,t._location,Ap());return t.storage.makeRequestWithTokens(e,Us).then(n=>{if(n===null)throw mG();return n})}function d7(t){t._throwIfRoot("deleteObject");const e=XG(t.storage,t._location);return t.storage.makeRequestWithTokens(e,Us)}function NN(t,e){const n=$G(t._location.path,e),s=new rn(t._location.bucket,n);return new Fo(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f7(t){return/^[A-Za-z]+:\/\//.test(t)}function p7(t,e){return new Fo(t,e)}function PN(t,e){if(t instanceof Ow){const n=t;if(n._bucket==null)throw pG();const s=new Fo(n,n._bucket);return e!=null?PN(s,e):s}else return e!==void 0?NN(t,e):t}function g7(t,e){if(e&&f7(e)){if(t instanceof Ow)return p7(t,e);throw Ca("To use ref(service, url), the first argument must be a Storage instance.")}else return PN(t,e)}function xE(t,e){const n=e==null?void 0:e[pN];return n==null?null:rn.makeFromBucketSpec(n,t)}function m7(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:$_(r,t.app.options.projectId))}class Ow{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=fN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=rG,this._maxUploadRetryTime=iG,this._requests=new Set,r!=null?this._bucket=rn.makeFromBucketSpec(r,this._host):this._bucket=xE(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=rn.makeFromBucketSpec(this._url,e):this._bucket=xE(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){c_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){c_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Fo(this,e)}_makeRequest(e,n,s,r){if(this._deleted)return new _G(_N());{const i=AG(e,this._appId,s,r,n,this._firebaseVersion);return this._requests.add(i),i.getPromise().then(()=>this._requests.delete(i),()=>this._requests.delete(i)),i}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const NE="@firebase/storage",PE="0.9.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7="storage";function y7(t,e,n){return t=A(t),a7(t,e,n)}function v7(t){return t=A(t),l7(t)}function w7(t,e){return t=A(t),u7(t,e)}function b7(t,e){return t=A(t),xN(t,e)}function I7(t){return t=A(t),c7(t)}function E7(t){return t=A(t),h7(t)}function T7(t){return t=A(t),d7(t)}function DE(t,e){return t=A(t),g7(t,e)}function S7(t,e){return NN(t,e)}function C7(t,e,n,s={}){m7(t,e,n,s)}function k7(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new Ow(n,s,r,e,ir)}function A7(){st(new Te(_7,k7,"PUBLIC").setMultipleInstances(!0)),Ae(NE,PE,""),Ae(NE,PE,"esm2017")}A7();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n,s){this._delegate=e,this.task=n,this.ref=s}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new kh(this._delegate.snapshot,this,this._ref)}then(e,n){return this._delegate.then(s=>{if(e)return e(new kh(s,this,this._ref))},n)}on(e,n,s,r){let i;return n&&(typeof n=="function"?i=o=>n(new kh(o,this,this._ref)):i={next:n.next?o=>n.next(new kh(o,this,this._ref)):void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,i,s||void 0,r||void 0)}}class ME{constructor(e,n){this._delegate=e,this._service=n}get prefixes(){return this._delegate.prefixes.map(e=>new br(e,this._service))}get items(){return this._delegate.items.map(e=>new br(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,n){this._delegate=e,this.storage=n}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const n=S7(this._delegate,e);return new br(n,this.storage)}get root(){return new br(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return e==null?null:new br(e,this.storage)}put(e,n){return this._throwIfRoot("put"),new OE(y7(this._delegate,e,n),this)}putString(e,n=as.RAW,s){this._throwIfRoot("putString");const r=wN(n,e),i=Object.assign({},s);return i.contentType==null&&r.contentType!=null&&(i.contentType=r.contentType),new OE(new AN(this._delegate,new hr(r.data,!0),i),this)}listAll(){return I7(this._delegate).then(e=>new ME(e,this.storage))}list(e){return b7(this._delegate,e||void 0).then(n=>new ME(n,this.storage))}getMetadata(){return v7(this._delegate)}updateMetadata(e){return w7(this._delegate,e)}getDownloadURL(){return E7(this._delegate)}delete(){return this._throwIfRoot("delete"),T7(this._delegate)}_throwIfRoot(e){if(this._delegate._location.path==="")throw yN(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DN{constructor(e,n){this.app=e,this._delegate=n}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(LE(e))throw Ca("ref() expected a child path but got a URL, use refFromURL instead.");return new br(DE(this._delegate,e),this)}refFromURL(e){if(!LE(e))throw Ca("refFromURL() expected a full URL but got a child path, use ref() instead.");try{rn.makeFromUrl(e,this._delegate.host)}catch{throw Ca("refFromUrl() expected a valid full URL but got an invalid one.")}return new br(DE(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,n,s={}){C7(this._delegate,e,n,s)}}function LE(t){return/^[A-Za-z]+:\/\//.test(t)}const R7="@firebase/storage-compat",x7="0.1.15";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N7="storage-compat";function P7(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("storage").getImmediate({identifier:e});return new DN(n,s)}function D7(t){const e={TaskState:pn,TaskEvent:s7,StringFormat:as,Storage:DN,Reference:br};t.INTERNAL.registerComponent(new Te(N7,P7,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(R7,x7)}D7(jt);const FE="@firebase/performance",l_="0.5.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ON=l_,O7="FB-PERF-TRACE-START",M7="FB-PERF-TRACE-STOP",u_="FB-PERF-TRACE-MEASURE",MN="_wt_",LN="_fp",FN="_fcp",$N="_fid",UN="@firebase/performance/config",BN="@firebase/performance/configexpire",L7="performance",VN="Performance";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7={["trace started"]:"Trace {$traceName} was started before.",["trace stopped"]:"Trace {$traceName} is not running.",["nonpositive trace startTime"]:"Trace {$traceName} startTime should be positive.",["nonpositive trace duration"]:"Trace {$traceName} duration should be positive.",["no window"]:"Window is not available.",["no app id"]:"App id is not available.",["no project id"]:"Project id is not available.",["no api key"]:"Api key is not available.",["invalid cc log"]:"Attempted to queue invalid cc event",["FB not default"]:"Performance can only start when Firebase app instance is the default one.",["RC response not ok"]:"RC response is not ok",["invalid attribute name"]:"Attribute name {$attributeName} is invalid.",["invalid attribute value"]:"Attribute value {$attributeValue} is invalid.",["invalid custom metric name"]:"Custom metric name {$customMetricName} is invalid",["invalid String merger input"]:"Input for String merger is invalid, contact support team to resolve.",["already initialized"]:"initializePerformance() has already been called with different options. To avoid this error, call initializePerformance() with the same options as when it was originally called, or call getPerformance() to return the already initialized instance."},nn=new En(L7,VN,F7);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sr=new rr(VN);sr.logLevel=pe.INFO;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ag,qN;class Mt{constructor(e){if(this.window=e,!e)throw nn.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}getUrl(){return this.windowLocation.href.split("?")[0]}mark(e){!this.performance||!this.performance.mark||this.performance.mark(e)}measure(e,n,s){!this.performance||!this.performance.measure||this.performance.measure(e,n,s)}getEntriesByType(e){return!this.performance||!this.performance.getEntriesByType?[]:this.performance.getEntriesByType(e)}getEntriesByName(e){return!this.performance||!this.performance.getEntriesByName?[]:this.performance.getEntriesByName(e)}getTimeOrigin(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)}requiredApisAvailable(){return!fetch||!Promise||!ff()?(sr.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1):Mn()?!0:(sr.info("IndexedDB is not supported by current browswer"),!1)}setupObserver(e,n){if(!this.PerformanceObserver)return;new this.PerformanceObserver(r=>{for(const i of r.getEntries())n(i)}).observe({entryTypes:[e]})}static getInstance(){return Ag===void 0&&(Ag=new Mt(qN)),Ag}}function $7(t){qN=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jN;function U7(t){const e=t.getId();return e.then(n=>{jN=n}),e}function Mw(){return jN}function B7(t){const e=t.getToken();return e.then(n=>{}),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(t,e){const n=t.length-e.length;if(n<0||n>1)throw nn.create("invalid String merger input");const s=[];for(let r=0;r<t.length;r++)s.push(t.charAt(r)),e.length>r&&s.push(e.charAt(r));return s.join("")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rg;class Wn{constructor(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=$E("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=$E("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}getFlTransportFullUrl(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)}static getInstance(){return Rg===void 0&&(Rg=new Wn),Rg}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ka;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"})(ka||(ka={}));const V7=["firebase_","google_","ga_"],q7=new RegExp("^[a-zA-Z]\\w*$"),j7=40,K7=100;function H7(){const t=Mt.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function KN(){switch(Mt.getInstance().document.visibilityState){case"visible":return ka.VISIBLE;case"hidden":return ka.HIDDEN;default:return ka.UNKNOWN}}function W7(){const e=Mt.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}function z7(t){return t.length===0||t.length>j7?!1:!V7.some(n=>t.startsWith(n))&&!!t.match(q7)}function G7(t){return t.length!==0&&t.length<=K7}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HN(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.appId;if(!n)throw nn.create("no app id");return n}function Q7(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.projectId;if(!n)throw nn.create("no project id");return n}function Y7(t){var e;const n=(e=t.options)===null||e===void 0?void 0:e.apiKey;if(!n)throw nn.create("no api key");return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X7="0.0.1",gs={loggingEnabled:!0},J7="FIREBASE_INSTALLATIONS_AUTH";function Z7(t,e){const n=e9();return n?(UE(n),Promise.resolve()):s9(t,e).then(UE).then(s=>t9(s),()=>{})}function e9(){const t=Mt.getInstance().localStorage;if(!t)return;const e=t.getItem(BN);if(!e||!r9(e))return;const n=t.getItem(UN);if(!!n)try{return JSON.parse(n)}catch{return}}function t9(t){const e=Mt.getInstance().localStorage;!t||!e||(e.setItem(UN,JSON.stringify(t)),e.setItem(BN,String(Date.now()+Wn.getInstance().configTimeToLive*60*60*1e3)))}const n9="Could not fetch config, will use default configs";function s9(t,e){return B7(t.installations).then(n=>{const s=Q7(t.app),r=Y7(t.app),i=`https://firebaseremoteconfig.googleapis.com/v1/projects/${s}/namespaces/fireperf:fetch?key=${r}`,o=new Request(i,{method:"POST",headers:{Authorization:`${J7} ${n}`},body:JSON.stringify({app_instance_id:e,app_instance_id_token:n,app_id:HN(t.app),app_version:ON,sdk_version:X7})});return fetch(o).then(a=>{if(a.ok)return a.json();throw nn.create("RC response not ok")})}).catch(()=>{sr.info(n9)})}function UE(t){if(!t)return t;const e=Wn.getInstance(),n=t.entries||{};return n.fpr_enabled!==void 0?e.loggingEnabled=String(n.fpr_enabled)==="true":e.loggingEnabled=gs.loggingEnabled,n.fpr_log_source?e.logSource=Number(n.fpr_log_source):gs.logSource&&(e.logSource=gs.logSource),n.fpr_log_endpoint_url?e.logEndPointUrl=n.fpr_log_endpoint_url:gs.logEndPointUrl&&(e.logEndPointUrl=gs.logEndPointUrl),n.fpr_log_transport_key?e.transportKey=n.fpr_log_transport_key:gs.transportKey&&(e.transportKey=gs.transportKey),n.fpr_vc_network_request_sampling_rate!==void 0?e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate):gs.networkRequestsSamplingRate!==void 0&&(e.networkRequestsSamplingRate=gs.networkRequestsSamplingRate),n.fpr_vc_trace_sampling_rate!==void 0?e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate):gs.tracesSamplingRate!==void 0&&(e.tracesSamplingRate=gs.tracesSamplingRate),e.logTraceAfterSampling=BE(e.tracesSamplingRate),e.logNetworkAfterSampling=BE(e.networkRequestsSamplingRate),t}function r9(t){return Number(t)>Date.now()}function BE(t){return Math.random()<=t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lw=1,xg;function WN(t){return Lw=2,xg=xg||o9(t),xg}function i9(){return Lw===3}function o9(t){return a9().then(()=>U7(t.installations)).then(e=>Z7(t,e)).then(()=>VE(),()=>VE())}function a9(){const t=Mt.getInstance().document;return new Promise(e=>{if(t&&t.readyState!=="complete"){const n=()=>{t.readyState==="complete"&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()})}function VE(){Lw=3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw=10*1e3,c9=5.5*1e3,zN=3,l9=1e3;let Yd=zN,oi=[],qE=!1;function u9(){qE||(Np(c9),qE=!0)}function Np(t){setTimeout(()=>{if(Yd!==0){if(!oi.length)return Np(Fw);h9()}},t)}function h9(){const t=oi.splice(0,l9),e=t.map(s=>({source_extension_json_proto3:s.message,event_time_ms:String(s.eventTime)})),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:Wn.getInstance().logSource,log_event:e};d9(n,t).catch(()=>{oi=[...t,...oi],Yd--,sr.info(`Tries left: ${Yd}.`),Np(Fw)})}function d9(t,e){return f9(t).then(n=>(n.ok||sr.info("Call to Firebase backend failed."),n.json())).then(n=>{const s=Number(n.nextRequestWaitMillis);let r=Fw;isNaN(s)||(r=Math.max(s,r));const i=n.logResponseDetails;Array.isArray(i)&&i.length>0&&i[0].responseAction==="RETRY_REQUEST_LATER"&&(oi=[...e,...oi],sr.info("Retry transport request later.")),Yd=zN,Np(r)})}function f9(t){const e=Wn.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}function p9(t){if(!t.eventTime||!t.message)throw nn.create("invalid cc log");oi=[...oi,t]}function g9(t){return(...e)=>{const n=t(...e);p9({message:n,eventTime:Date.now()})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ng;function GN(t,e){Ng||(Ng=g9(_9)),Ng(t,e)}function Ah(t){const e=Wn.getInstance();!e.instrumentationEnabled&&t.isAuto||!e.dataCollectionEnabled&&!t.isAuto||!Mt.getInstance().requiredApisAvailable()||t.isAuto&&KN()!==ka.VISIBLE||(i9()?Pg(t):WN(t.performanceController).then(()=>Pg(t),()=>Pg(t)))}function Pg(t){if(!Mw())return;const e=Wn.getInstance();!e.loggingEnabled||!e.logTraceAfterSampling||setTimeout(()=>GN(t,1),0)}function m9(t){const e=Wn.getInstance();if(!e.instrumentationEnabled)return;const n=t.url,s=e.logEndPointUrl.split("?")[0],r=e.flTransportEndpointUrl.split("?")[0];n===s||n===r||!e.loggingEnabled||!e.logNetworkAfterSampling||setTimeout(()=>GN(t,0),0)}function _9(t,e){return e===0?y9(t):v9(t)}function y9(t){const e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:QN(t.performanceController.app),network_request_metric:e};return JSON.stringify(n)}function v9(t){const e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};Object.keys(t.counters).length!==0&&(e.counters=t.counters);const n=t.getAttributes();Object.keys(n).length!==0&&(e.custom_attributes=n);const s={application_info:QN(t.performanceController.app),trace_metric:e};return JSON.stringify(s)}function QN(t){return{google_app_id:HN(t),app_instance_id:Mw(),web_app_info:{sdk_version:ON,page_url:Mt.getInstance().getUrl(),service_worker_status:H7(),visibility_state:KN(),effective_connection_type:W7()},application_process_state:0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w9=100,b9="_",I9=[LN,FN,$N];function E9(t,e){return t.length===0||t.length>w9?!1:e&&e.startsWith(MN)&&I9.indexOf(t)>-1||!t.startsWith(b9)}function T9(t){const e=Math.floor(t);return e<t&&sr.info(`Metric value should be an Integer, setting the value as : ${e}.`),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e,n,s=!1,r){this.performanceController=e,this.name=n,this.isAuto=s,this.state=1,this.customAttributes={},this.counters={},this.api=Mt.getInstance(),this.randomId=Math.floor(Math.random()*1e6),this.isAuto||(this.traceStartMark=`${O7}-${this.randomId}-${this.name}`,this.traceStopMark=`${M7}-${this.randomId}-${this.name}`,this.traceMeasure=r||`${u_}-${this.randomId}-${this.name}`,r&&this.calculateTraceMetrics())}start(){if(this.state!==1)throw nn.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2}stop(){if(this.state!==2)throw nn.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Ah(this)}record(e,n,s){if(e<=0)throw nn.create("nonpositive trace startTime",{traceName:this.name});if(n<=0)throw nn.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(n*1e3),this.startTimeUs=Math.floor(e*1e3),s&&s.attributes&&(this.customAttributes=Object.assign({},s.attributes)),s&&s.metrics)for(const r of Object.keys(s.metrics))isNaN(Number(s.metrics[r]))||(this.counters[r]=Math.floor(Number(s.metrics[r])));Ah(this)}incrementMetric(e,n=1){this.counters[e]===void 0?this.putMetric(e,n):this.putMetric(e,this.counters[e]+n)}putMetric(e,n){if(E9(e,this.name))this.counters[e]=T9(n!=null?n:0);else throw nn.create("invalid custom metric name",{customMetricName:e})}getMetric(e){return this.counters[e]||0}putAttribute(e,n){const s=z7(e),r=G7(n);if(s&&r){this.customAttributes[e]=n;return}if(!s)throw nn.create("invalid attribute name",{attributeName:e});if(!r)throw nn.create("invalid attribute value",{attributeValue:n})}getAttribute(e){return this.customAttributes[e]}removeAttribute(e){this.customAttributes[e]!==void 0&&delete this.customAttributes[e]}getAttributes(){return Object.assign({},this.customAttributes)}setStartTime(e){this.startTimeUs=e}setDuration(e){this.durationUs=e}calculateTraceMetrics(){const e=this.api.getEntriesByName(this.traceMeasure),n=e&&e[0];n&&(this.durationUs=Math.floor(n.duration*1e3),this.startTimeUs=Math.floor((n.startTime+this.api.getTimeOrigin())*1e3))}static createOobTrace(e,n,s,r){const i=Mt.getInstance().getUrl();if(!i)return;const o=new ai(e,MN+i,!0),a=Math.floor(Mt.getInstance().getTimeOrigin()*1e3);o.setStartTime(a),n&&n[0]&&(o.setDuration(Math.floor(n[0].duration*1e3)),o.putMetric("domInteractive",Math.floor(n[0].domInteractive*1e3)),o.putMetric("domContentLoadedEventEnd",Math.floor(n[0].domContentLoadedEventEnd*1e3)),o.putMetric("loadEventEnd",Math.floor(n[0].loadEventEnd*1e3)));const c="first-paint",l="first-contentful-paint";if(s){const u=s.find(d=>d.name===c);u&&u.startTime&&o.putMetric(LN,Math.floor(u.startTime*1e3));const h=s.find(d=>d.name===l);h&&h.startTime&&o.putMetric(FN,Math.floor(h.startTime*1e3)),r&&o.putMetric($N,Math.floor(r*1e3))}Ah(o)}static createUserTimingTrace(e,n){const s=new ai(e,n,!1,n);Ah(s)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(t,e){const n=e;if(!n||n.responseStart===void 0)return;const s=Mt.getInstance().getTimeOrigin(),r=Math.floor((n.startTime+s)*1e3),i=n.responseStart?Math.floor((n.responseStart-n.startTime)*1e3):void 0,o=Math.floor((n.responseEnd-n.startTime)*1e3),a=n.name&&n.name.split("?")[0],c={performanceController:t,url:a,responsePayloadBytes:n.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o};m9(c)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S9=5e3;function KE(t){!Mw()||(setTimeout(()=>k9(t),0),setTimeout(()=>C9(t),0),setTimeout(()=>A9(t),0))}function C9(t){const e=Mt.getInstance(),n=e.getEntriesByType("resource");for(const s of n)jE(t,s);e.setupObserver("resource",s=>jE(t,s))}function k9(t){const e=Mt.getInstance(),n=e.getEntriesByType("navigation"),s=e.getEntriesByType("paint");if(e.onFirstInputDelay){let r=setTimeout(()=>{ai.createOobTrace(t,n,s),r=void 0},S9);e.onFirstInputDelay(i=>{r&&(clearTimeout(r),ai.createOobTrace(t,n,s,i))})}else ai.createOobTrace(t,n,s)}function A9(t){const e=Mt.getInstance(),n=e.getEntriesByType("measure");for(const s of n)HE(t,s);e.setupObserver("measure",s=>HE(t,s))}function HE(t,e){const n=e.name;n.substring(0,u_.length)!==u_&&ai.createUserTimingTrace(t,n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R9{constructor(e,n){this.app=e,this.installations=n,this.initialized=!1}_init(e){this.initialized||((e==null?void 0:e.dataCollectionEnabled)!==void 0&&(this.dataCollectionEnabled=e.dataCollectionEnabled),(e==null?void 0:e.instrumentationEnabled)!==void 0&&(this.instrumentationEnabled=e.instrumentationEnabled),Mt.getInstance().requiredApisAvailable()?wu().then(n=>{n&&(u9(),WN(this).then(()=>KE(this),()=>KE(this)),this.initialized=!0)}).catch(n=>{sr.info(`Environment doesn't support IndexedDB: ${n}`)}):sr.info('Firebase Performance cannot start if the browser does not support "Fetch" and "Promise", or cookies are disabled.'))}set instrumentationEnabled(e){Wn.getInstance().instrumentationEnabled=e}get instrumentationEnabled(){return Wn.getInstance().instrumentationEnabled}set dataCollectionEnabled(e){Wn.getInstance().dataCollectionEnabled=e}get dataCollectionEnabled(){return Wn.getInstance().dataCollectionEnabled}}const x9="[DEFAULT]";function N9(t,e){return t=A(t),new ai(t,e)}const P9=(t,{options:e})=>{const n=t.getProvider("app").getImmediate(),s=t.getProvider("installations-internal").getImmediate();if(n.name!==x9)throw nn.create("FB not default");if(typeof window=="undefined")throw nn.create("no window");$7(window);const r=new R9(n,s);return r._init(e),r};function D9(){st(new Te("performance",P9,"PUBLIC")),Ae(FE,l_),Ae(FE,l_,"esm2017")}D9();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O9{constructor(e,n){this.app=e,this._delegate=n}get instrumentationEnabled(){return this._delegate.instrumentationEnabled}set instrumentationEnabled(e){this._delegate.instrumentationEnabled=e}get dataCollectionEnabled(){return this._delegate.dataCollectionEnabled}set dataCollectionEnabled(e){this._delegate.dataCollectionEnabled=e}trace(e){return N9(this._delegate,e)}}const M9="@firebase/performance-compat",L9="0.1.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F9(t){t.INTERNAL.registerComponent(new Te("performance-compat",$9,"PUBLIC")),t.registerVersion(M9,L9)}function $9(t){const e=t.getProvider("app-compat").getImmediate(),n=t.getProvider("performance").getImmediate();return new O9(e,n)}F9(jt);const Dg="@firebase/remote-config",WE="0.3.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9="remote-config";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V9={["registration-window"]:"Undefined window object. This SDK only supports usage in a browser environment.",["registration-project-id"]:"Undefined project identifier. Check Firebase app initialization.",["registration-api-key"]:"Undefined API key. Check Firebase app initialization.",["registration-app-id"]:"Undefined app identifier. Check Firebase app initialization.",["storage-open"]:"Error thrown when opening storage. Original error: {$originalErrorMessage}.",["storage-get"]:"Error thrown when reading from storage. Original error: {$originalErrorMessage}.",["storage-set"]:"Error thrown when writing to storage. Original error: {$originalErrorMessage}.",["storage-delete"]:"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",["fetch-client-network"]:"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",["fetch-timeout"]:'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',["fetch-throttle"]:'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',["fetch-client-parse"]:"Fetch client could not parse response. Original error: {$originalErrorMessage}.",["fetch-status"]:"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",["indexed-db-unavailable"]:"Indexed DB is not supported by current browser"},kn=new En("remoteconfig","Remote Config",V9);function q9(t,e){return t instanceof lt&&t.code.indexOf(e)!==-1}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9=!1,K9="",zE=0,H9=["1","true","t","yes","y","on"];class Og{constructor(e,n=K9){this._source=e,this._value=n}asString(){return this._value}asBoolean(){return this._source==="static"?j9:H9.indexOf(this._value.toLowerCase())>=0}asNumber(){if(this._source==="static")return zE;let e=Number(this._value);return isNaN(e)&&(e=zE),e}getSource(){return this._source}}async function YN(t){const e=A(t),[n,s]=await Promise.all([e._storage.getLastSuccessfulFetchResponse(),e._storage.getActiveConfigEtag()]);return!n||!n.config||!n.eTag||n.eTag===s?!1:(await Promise.all([e._storageCache.setActiveConfig(n.config),e._storage.setActiveConfigEtag(n.eTag)]),!0)}function XN(t){const e=A(t);return e._initializePromise||(e._initializePromise=e._storageCache.loadFromStorage().then(()=>{e._isInitializationComplete=!0})),e._initializePromise}async function JN(t){const e=A(t),n=new U9;setTimeout(async()=>{n.abort()},e.settings.fetchTimeoutMillis);try{await e._client.fetch({cacheMaxAgeMillis:e.settings.minimumFetchIntervalMillis,signal:n}),await e._storageCache.setLastFetchStatus("success")}catch(s){const r=q9(s,"fetch-throttle")?"throttle":"failure";throw await e._storageCache.setLastFetchStatus(r),s}}function W9(t){const e=A(t);return X9(e._storageCache.getActiveConfig(),e.defaultConfig).reduce((n,s)=>(n[s]=sh(t,s),n),{})}function z9(t,e){return sh(A(t),e).asBoolean()}function G9(t,e){return sh(A(t),e).asNumber()}function Q9(t,e){return sh(A(t),e).asString()}function sh(t,e){const n=A(t);n._isInitializationComplete||n._logger.debug(`A value was requested for key "${e}" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.`);const s=n._storageCache.getActiveConfig();return s&&s[e]!==void 0?new Og("remote",s[e]):n.defaultConfig&&n.defaultConfig[e]!==void 0?new Og("default",String(n.defaultConfig[e])):(n._logger.debug(`Returning static value for key "${e}". Define a default or remote value if this is unintentional.`),new Og("static"))}function Y9(t,e){const n=A(t);switch(e){case"debug":n._logger.logLevel=pe.DEBUG;break;case"silent":n._logger.logLevel=pe.SILENT;break;default:n._logger.logLevel=pe.ERROR}}function X9(t={},e={}){return Object.keys(Object.assign(Object.assign({},t),e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J9{constructor(e,n,s,r){this.client=e,this.storage=n,this.storageCache=s,this.logger=r}isCachedDataFresh(e,n){if(!n)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const s=Date.now()-n,r=s<=e;return this.logger.debug(`Config fetch cache check. Cache age millis: ${s}. Cache max age millis (minimumFetchIntervalMillis setting): ${e}. Is cache hit: ${r}.`),r}async fetch(e){const[n,s]=await Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()]);if(s&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n))return s;e.eTag=s&&s.eTag;const r=await this.client.fetch(e),i=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return r.status===200&&i.push(this.storage.setLastSuccessfulFetchResponse(r)),await Promise.all(i),r}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z9(t=navigator){return t.languages&&t.languages[0]||t.language}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(e,n,s,r,i,o){this.firebaseInstallations=e,this.sdkVersion=n,this.namespace=s,this.projectId=r,this.apiKey=i,this.appId=o}async fetch(e){var n,s,r;const[i,o]=await Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()]),c=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${this.projectId}/namespaces/${this.namespace}:fetch?key=${this.apiKey}`,l={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},u={sdk_version:this.sdkVersion,app_instance_id:i,app_instance_id_token:o,app_id:this.appId,language_code:Z9()},h={method:"POST",headers:l,body:JSON.stringify(u)},d=fetch(c,h),f=new Promise((T,$)=>{e.signal.addEventListener(()=>{const z=new Error("The operation was aborted.");z.name="AbortError",$(z)})});let p;try{await Promise.race([d,f]),p=await d}catch(T){let $="fetch-client-network";throw((n=T)===null||n===void 0?void 0:n.name)==="AbortError"&&($="fetch-timeout"),kn.create($,{originalErrorMessage:(s=T)===null||s===void 0?void 0:s.message})}let _=p.status;const v=p.headers.get("ETag")||void 0;let b,N;if(p.status===200){let T;try{T=await p.json()}catch($){throw kn.create("fetch-client-parse",{originalErrorMessage:(r=$)===null||r===void 0?void 0:r.message})}b=T.entries,N=T.state}if(N==="INSTANCE_STATE_UNSPECIFIED"?_=500:N==="NO_CHANGE"?_=304:(N==="NO_TEMPLATE"||N==="EMPTY_CONFIG")&&(b={}),_!==304&&_!==200)throw kn.create("fetch-status",{httpStatus:_});return{status:_,eTag:v,config:b}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tQ(t,e){return new Promise((n,s)=>{const r=Math.max(e-Date.now(),0),i=setTimeout(n,r);t.addEventListener(()=>{clearTimeout(i),s(kn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function nQ(t){if(!(t instanceof lt)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class sQ{constructor(e,n){this.client=e,this.storage=n}async fetch(e){const n=await this.storage.getThrottleMetadata()||{backoffCount:0,throttleEndTimeMillis:Date.now()};return this.attemptFetch(e,n)}async attemptFetch(e,{throttleEndTimeMillis:n,backoffCount:s}){await tQ(e.signal,n);try{const r=await this.client.fetch(e);return await this.storage.deleteThrottleMetadata(),r}catch(r){if(!nQ(r))throw r;const i={throttleEndTimeMillis:Date.now()+ed(s),backoffCount:s+1};return await this.storage.setThrottleMetadata(i),this.attemptFetch(e,i)}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rQ=60*1e3,iQ=12*60*60*1e3;class oQ{constructor(e,n,s,r,i){this.app=e,this._client=n,this._storageCache=s,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:rQ,minimumFetchIntervalMillis:iQ},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kh(t,e){var n;const s=t.target.error||void 0;return kn.create(e,{originalErrorMessage:s&&((n=s)===null||n===void 0?void 0:n.message)})}const qi="app_namespace_store",aQ="firebase_remote_config",cQ=1;function lQ(){return new Promise((t,e)=>{var n;try{const s=indexedDB.open(aQ,cQ);s.onerror=r=>{e(Kh(r,"storage-open"))},s.onsuccess=r=>{t(r.target.result)},s.onupgradeneeded=r=>{const i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(qi,{keyPath:"compositeKey"})}}}catch(s){e(kn.create("storage-open",{originalErrorMessage:(n=s)===null||n===void 0?void 0:n.message}))}})}class uQ{constructor(e,n,s,r=lQ()){this.appId=e,this.appName=n,this.namespace=s,this.openDbPromise=r}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(e){return this.set("last_fetch_status",e)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(e){return this.set("last_successful_fetch_timestamp_millis",e)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(e){return this.set("last_successful_fetch_response",e)}getActiveConfig(){return this.get("active_config")}setActiveConfig(e){return this.set("active_config",e)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(e){return this.set("active_config_etag",e)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(e){return this.set("throttle_metadata",e)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}async get(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([qi],"readonly").objectStore(qi),c=this.createCompositeKey(e);try{const l=a.get(c);l.onerror=u=>{r(Kh(u,"storage-get"))},l.onsuccess=u=>{const h=u.target.result;s(h?h.value:void 0)}}catch(l){r(kn.create("storage-get",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}async set(e,n){const s=await this.openDbPromise;return new Promise((r,i)=>{var o;const c=s.transaction([qi],"readwrite").objectStore(qi),l=this.createCompositeKey(e);try{const u=c.put({compositeKey:l,value:n});u.onerror=h=>{i(Kh(h,"storage-set"))},u.onsuccess=()=>{r()}}catch(u){i(kn.create("storage-set",{originalErrorMessage:(o=u)===null||o===void 0?void 0:o.message}))}})}async delete(e){const n=await this.openDbPromise;return new Promise((s,r)=>{var i;const a=n.transaction([qi],"readwrite").objectStore(qi),c=this.createCompositeKey(e);try{const l=a.delete(c);l.onerror=u=>{r(Kh(u,"storage-delete"))},l.onsuccess=()=>{s()}}catch(l){r(kn.create("storage-delete",{originalErrorMessage:(i=l)===null||i===void 0?void 0:i.message}))}})}createCompositeKey(e){return[this.appId,this.appName,this.namespace,e].join()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hQ{constructor(e){this.storage=e}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}async loadFromStorage(){const e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),s=this.storage.getActiveConfig(),r=await e;r&&(this.lastFetchStatus=r);const i=await n;i&&(this.lastSuccessfulFetchTimestampMillis=i);const o=await s;o&&(this.activeConfig=o)}setLastFetchStatus(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)}setLastSuccessfulFetchTimestampMillis(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)}setActiveConfig(e){return this.activeConfig=e,this.storage.setActiveConfig(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dQ(){st(new Te(B9,t,"PUBLIC").setMultipleInstances(!0)),Ae(Dg,WE),Ae(Dg,WE,"esm2017");function t(e,{instanceIdentifier:n}){const s=e.getProvider("app").getImmediate(),r=e.getProvider("installations-internal").getImmediate();if(typeof window=="undefined")throw kn.create("registration-window");if(!Mn())throw kn.create("indexed-db-unavailable");const{projectId:i,apiKey:o,appId:a}=s.options;if(!i)throw kn.create("registration-project-id");if(!o)throw kn.create("registration-api-key");if(!a)throw kn.create("registration-app-id");n=n||"firebase";const c=new uQ(a,s.name,n),l=new hQ(c),u=new rr(Dg);u.logLevel=pe.ERROR;const h=new eQ(r,ir,n,i,o,a),d=new sQ(h,c),f=new J9(d,c,l,u),p=new oQ(s,f,l,c,u);return XN(p),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fQ(t){return t=A(t),await JN(t),YN(t)}async function pQ(){if(!Mn())return!1;try{return await wu()}catch{return!1}}dQ();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gQ{constructor(e,n){this.app=e,this._delegate=n}get defaultConfig(){return this._delegate.defaultConfig}set defaultConfig(e){this._delegate.defaultConfig=e}get fetchTimeMillis(){return this._delegate.fetchTimeMillis}get lastFetchStatus(){return this._delegate.lastFetchStatus}get settings(){return this._delegate.settings}set settings(e){this._delegate.settings=e}activate(){return YN(this._delegate)}ensureInitialized(){return XN(this._delegate)}fetch(){return JN(this._delegate)}fetchAndActivate(){return fQ(this._delegate)}getAll(){return W9(this._delegate)}getBoolean(e){return z9(this._delegate,e)}getNumber(e){return G9(this._delegate,e)}getString(e){return Q9(this._delegate,e)}getValue(e){return sh(this._delegate,e)}setLogLevel(e){Y9(this._delegate,e)}}const mQ="@firebase/remote-config-compat",_Q="0.1.10";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yQ(t){t.INTERNAL.registerComponent(new Te("remoteConfig-compat",vQ,"PUBLIC").setMultipleInstances(!0).setServiceProps({isSupported:pQ})),t.registerVersion(mQ,_Q)}function vQ(t,{instanceIdentifier:e}){const n=t.getProvider("app-compat").getImmediate(),s=t.getProvider("remote-config").getImmediate({identifier:e});return new gQ(n,s)}yQ(jt);var wQ="firebase",bQ="9.8.3";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jt.registerVersion(wQ,bQ,"app-compat");var IQ="firebase",EQ="9.8.3";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */console.warn(`
It looks like you're using the development build of the Firebase JS SDK.
When deploying Firebase apps to production, it is advisable to only import
the individual SDK components you intend to use.

For the module builds, these are available in the following manner
(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):

CommonJS Modules:
const firebase = require('firebase/app');
require('firebase/<PACKAGE>');

ES Modules:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';

Typescript:
import firebase from 'firebase/app';
import 'firebase/<PACKAGE>';
`);jt.registerVersion(IQ,EQ,"compat");const TQ={apiKey:"AIzaSyCP4_q_7nhJ-uw_jL7lrG82F21QUGIz4IU",authDomain:"project-fe2-bd154.firebaseapp.com",databaseURL:"https://project-fe2-bd154-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"project-fe2-bd154",storageBucket:"project-fe2-bd154.appspot.com",messagingSenderId:"741201503430",appId:"1:741201503430:web:a045c89c365cda2ef223c7",measurementId:"G-XNH60ZCK3N"},ZN=H_(TQ);UU(ZN);const Ir=On(ZN);/*!
  * vue-router v4.0.15
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const eP=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Sc=t=>eP?Symbol(t):"_vr_"+t,SQ=Sc("rvlm"),GE=Sc("rvd"),Pp=Sc("r"),tP=Sc("rl"),h_=Sc("rvl"),ua=typeof window!="undefined";function CQ(t){return t.__esModule||eP&&t[Symbol.toStringTag]==="Module"}const Fe=Object.assign;function Mg(t,e){const n={};for(const s in e){const r=e[s];n[s]=Array.isArray(r)?r.map(t):t(r)}return n}const vl=()=>{},kQ=/\/$/,AQ=t=>t.replace(kQ,"");function Lg(t,e,n="/"){let s,r={},i="",o="";const a=e.indexOf("?"),c=e.indexOf("#",a>-1?a:0);return a>-1&&(s=e.slice(0,a),i=e.slice(a+1,c>-1?c:e.length),r=t(i)),c>-1&&(s=s||e.slice(0,c),o=e.slice(c,e.length)),s=PQ(s!=null?s:e,n),{fullPath:s+(i&&"?")+i+o,path:s,query:r,hash:o}}function RQ(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function QE(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function xQ(t,e,n){const s=e.matched.length-1,r=n.matched.length-1;return s>-1&&s===r&&Za(e.matched[s],n.matched[r])&&nP(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function Za(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function nP(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!NQ(t[n],e[n]))return!1;return!0}function NQ(t,e){return Array.isArray(t)?YE(t,e):Array.isArray(e)?YE(e,t):t===e}function YE(t,e){return Array.isArray(e)?t.length===e.length&&t.every((n,s)=>n===e[s]):t.length===1&&t[0]===e}function PQ(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),s=t.split("/");let r=n.length-1,i,o;for(i=0;i<s.length;i++)if(o=s[i],!(r===1||o==="."))if(o==="..")r--;else break;return n.slice(0,r).join("/")+"/"+s.slice(i-(i===s.length?1:0)).join("/")}var _u;(function(t){t.pop="pop",t.push="push"})(_u||(_u={}));var wl;(function(t){t.back="back",t.forward="forward",t.unknown=""})(wl||(wl={}));function DQ(t){if(!t)if(ua){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),AQ(t)}const OQ=/^[^#]+#/;function MQ(t,e){return t.replace(OQ,"#")+e}function LQ(t,e){const n=document.documentElement.getBoundingClientRect(),s=t.getBoundingClientRect();return{behavior:e.behavior,left:s.left-n.left-(e.left||0),top:s.top-n.top-(e.top||0)}}const Dp=()=>({left:window.pageXOffset,top:window.pageYOffset});function FQ(t){let e;if("el"in t){const n=t.el,s=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?s?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;e=LQ(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function XE(t,e){return(history.state?history.state.position-e:-1)+t}const d_=new Map;function $Q(t,e){d_.set(t,e)}function UQ(t){const e=d_.get(t);return d_.delete(t),e}let BQ=()=>location.protocol+"//"+location.host;function sP(t,e){const{pathname:n,search:s,hash:r}=e,i=t.indexOf("#");if(i>-1){let a=r.includes(t.slice(i))?t.slice(i).length:1,c=r.slice(a);return c[0]!=="/"&&(c="/"+c),QE(c,"")}return QE(n,t)+s+r}function VQ(t,e,n,s){let r=[],i=[],o=null;const a=({state:d})=>{const f=sP(t,location),p=n.value,_=e.value;let v=0;if(d){if(n.value=f,e.value=d,o&&o===p){o=null;return}v=_?d.position-_.position:0}else s(f);r.forEach(b=>{b(n.value,p,{delta:v,type:_u.pop,direction:v?v>0?wl.forward:wl.back:wl.unknown})})};function c(){o=n.value}function l(d){r.push(d);const f=()=>{const p=r.indexOf(d);p>-1&&r.splice(p,1)};return i.push(f),f}function u(){const{history:d}=window;!d.state||d.replaceState(Fe({},d.state,{scroll:Dp()}),"")}function h(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u),{pauseListeners:c,listen:l,destroy:h}}function JE(t,e,n,s=!1,r=!1){return{back:t,current:e,forward:n,replaced:s,position:window.history.length,scroll:r?Dp():null}}function qQ(t){const{history:e,location:n}=window,s={value:sP(t,n)},r={value:e.state};r.value||i(s.value,{back:null,current:s.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(c,l,u){const h=t.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?t:t.slice(h))+c:BQ()+t+c;try{e[u?"replaceState":"pushState"](l,"",d),r.value=l}catch(f){console.error(f),n[u?"replace":"assign"](d)}}function o(c,l){const u=Fe({},e.state,JE(r.value.back,c,r.value.forward,!0),l,{position:r.value.position});i(c,u,!0),s.value=c}function a(c,l){const u=Fe({},r.value,e.state,{forward:c,scroll:Dp()});i(u.current,u,!0);const h=Fe({},JE(s.value,c,null),{position:u.position+1},l);i(c,h,!1),s.value=c}return{location:s,state:r,push:a,replace:o}}function jQ(t){t=DQ(t);const e=qQ(t),n=VQ(t,e.state,e.location,e.replace);function s(i,o=!0){o||n.pauseListeners(),history.go(i)}const r=Fe({location:"",base:t,go:s,createHref:MQ.bind(null,t)},e,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function KQ(t){return typeof t=="string"||t&&typeof t=="object"}function rP(t){return typeof t=="string"||typeof t=="symbol"}const qr={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},iP=Sc("nf");var ZE;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(ZE||(ZE={}));function ec(t,e){return Fe(new Error,{type:t,[iP]:!0},e)}function jr(t,e){return t instanceof Error&&iP in t&&(e==null||!!(t.type&e))}const eT="[^/]+?",HQ={sensitive:!1,strict:!1,start:!0,end:!0},WQ=/[.+*?^${}()[\]/\\]/g;function zQ(t,e){const n=Fe({},HQ,e),s=[];let r=n.start?"^":"";const i=[];for(const l of t){const u=l.length?[]:[90];n.strict&&!l.length&&(r+="/");for(let h=0;h<l.length;h++){const d=l[h];let f=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(WQ,"\\$&"),f+=40;else if(d.type===1){const{value:p,repeatable:_,optional:v,regexp:b}=d;i.push({name:p,repeatable:_,optional:v});const N=b||eT;if(N!==eT){f+=10;try{new RegExp(`(${N})`)}catch($){throw new Error(`Invalid custom RegExp for param "${p}" (${N}): `+$.message)}}let T=_?`((?:${N})(?:/(?:${N}))*)`:`(${N})`;h||(T=v&&l.length<2?`(?:/${T})`:"/"+T),v&&(T+="?"),r+=T,f+=20,v&&(f+=-8),_&&(f+=-20),N===".*"&&(f+=-50)}u.push(f)}s.push(u)}if(n.strict&&n.end){const l=s.length-1;s[l][s[l].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const o=new RegExp(r,n.sensitive?"":"i");function a(l){const u=l.match(o),h={};if(!u)return null;for(let d=1;d<u.length;d++){const f=u[d]||"",p=i[d-1];h[p.name]=f&&p.repeatable?f.split("/"):f}return h}function c(l){let u="",h=!1;for(const d of t){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const f of d)if(f.type===0)u+=f.value;else if(f.type===1){const{value:p,repeatable:_,optional:v}=f,b=p in l?l[p]:"";if(Array.isArray(b)&&!_)throw new Error(`Provided param "${p}" is an array but it is not repeatable (* or + modifiers)`);const N=Array.isArray(b)?b.join("/"):b;if(!N)if(v)d.length<2&&t.length>1&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${p}"`);u+=N}}return u}return{re:o,score:s,keys:i,parse:a,stringify:c}}function GQ(t,e){let n=0;for(;n<t.length&&n<e.length;){const s=e[n]-t[n];if(s)return s;n++}return t.length<e.length?t.length===1&&t[0]===40+40?-1:1:t.length>e.length?e.length===1&&e[0]===40+40?1:-1:0}function QQ(t,e){let n=0;const s=t.score,r=e.score;for(;n<s.length&&n<r.length;){const i=GQ(s[n],r[n]);if(i)return i;n++}return r.length-s.length}const YQ={type:0,value:""},XQ=/[a-zA-Z0-9_]/;function JQ(t){if(!t)return[[]];if(t==="/")return[[YQ]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(f){throw new Error(`ERR (${n})/"${l}": ${f}`)}let n=0,s=n;const r=[];let i;function o(){i&&r.push(i),i=[]}let a=0,c,l="",u="";function h(){!l||(n===0?i.push({type:0,value:l}):n===1||n===2||n===3?(i.length>1&&(c==="*"||c==="+")&&e(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:u,repeatable:c==="*"||c==="+",optional:c==="*"||c==="?"})):e("Invalid state to consume buffer"),l="")}function d(){l+=c}for(;a<t.length;){if(c=t[a++],c==="\\"&&n!==2){s=n,n=4;continue}switch(n){case 0:c==="/"?(l&&h(),o()):c===":"?(h(),n=1):d();break;case 4:d(),n=s;break;case 1:c==="("?n=2:XQ.test(c)?d():(h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--);break;case 2:c===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+c:n=3:u+=c;break;case 3:h(),n=0,c!=="*"&&c!=="?"&&c!=="+"&&a--,u="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${l}"`),h(),o(),r}function ZQ(t,e,n){const s=zQ(JQ(t.path),n),r=Fe(s,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function eY(t,e){const n=[],s=new Map;e=nT({strict:!1,end:!0,sensitive:!1},e);function r(u){return s.get(u)}function i(u,h,d){const f=!d,p=nY(u);p.aliasOf=d&&d.record;const _=nT(e,u),v=[p];if("alias"in u){const T=typeof u.alias=="string"?[u.alias]:u.alias;for(const $ of T)v.push(Fe({},p,{components:d?d.record.components:p.components,path:$,aliasOf:d?d.record:p}))}let b,N;for(const T of v){const{path:$}=T;if(h&&$[0]!=="/"){const z=h.record.path,te=z[z.length-1]==="/"?"":"/";T.path=h.record.path+($&&te+$)}if(b=ZQ(T,h,_),d?d.alias.push(b):(N=N||b,N!==b&&N.alias.push(b),f&&u.name&&!tT(b)&&o(u.name)),"children"in p){const z=p.children;for(let te=0;te<z.length;te++)i(z[te],b,d&&d.children[te])}d=d||b,c(b)}return N?()=>{o(N)}:vl}function o(u){if(rP(u)){const h=s.get(u);h&&(s.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(o),h.alias.forEach(o))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&s.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return n}function c(u){let h=0;for(;h<n.length&&QQ(u,n[h])>=0&&(u.record.path!==n[h].record.path||!oP(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!tT(u)&&s.set(u.record.name,u)}function l(u,h){let d,f={},p,_;if("name"in u&&u.name){if(d=s.get(u.name),!d)throw ec(1,{location:u});_=d.record.name,f=Fe(tY(h.params,d.keys.filter(N=>!N.optional).map(N=>N.name)),u.params),p=d.stringify(f)}else if("path"in u)p=u.path,d=n.find(N=>N.re.test(p)),d&&(f=d.parse(p),_=d.record.name);else{if(d=h.name?s.get(h.name):n.find(N=>N.re.test(h.path)),!d)throw ec(1,{location:u,currentLocation:h});_=d.record.name,f=Fe({},h.params,u.params),p=d.stringify(f)}const v=[];let b=d;for(;b;)v.unshift(b.record),b=b.parent;return{name:_,path:p,params:f,matched:v,meta:rY(v)}}return t.forEach(u=>i(u)),{addRoute:i,resolve:l,removeRoute:o,getRoutes:a,getRecordMatcher:r}}function tY(t,e){const n={};for(const s of e)s in t&&(n[s]=t[s]);return n}function nY(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:sY(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function sY(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const s in t.components)e[s]=typeof n=="boolean"?n:n[s];return e}function tT(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function rY(t){return t.reduce((e,n)=>Fe(e,n.meta),{})}function nT(t,e){const n={};for(const s in t)n[s]=s in e?e[s]:t[s];return n}function oP(t,e){return e.children.some(n=>n===t||oP(t,n))}const aP=/#/g,iY=/&/g,oY=/\//g,aY=/=/g,cY=/\?/g,cP=/\+/g,lY=/%5B/g,uY=/%5D/g,lP=/%5E/g,hY=/%60/g,uP=/%7B/g,dY=/%7C/g,hP=/%7D/g,fY=/%20/g;function $w(t){return encodeURI(""+t).replace(dY,"|").replace(lY,"[").replace(uY,"]")}function pY(t){return $w(t).replace(uP,"{").replace(hP,"}").replace(lP,"^")}function f_(t){return $w(t).replace(cP,"%2B").replace(fY,"+").replace(aP,"%23").replace(iY,"%26").replace(hY,"`").replace(uP,"{").replace(hP,"}").replace(lP,"^")}function gY(t){return f_(t).replace(aY,"%3D")}function mY(t){return $w(t).replace(aP,"%23").replace(cY,"%3F")}function _Y(t){return t==null?"":mY(t).replace(oY,"%2F")}function Xd(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function yY(t){const e={};if(t===""||t==="?")return e;const s=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<s.length;++r){const i=s[r].replace(cP," "),o=i.indexOf("="),a=Xd(o<0?i:i.slice(0,o)),c=o<0?null:Xd(i.slice(o+1));if(a in e){let l=e[a];Array.isArray(l)||(l=e[a]=[l]),l.push(c)}else e[a]=c}return e}function sT(t){let e="";for(let n in t){const s=t[n];if(n=gY(n),s==null){s!==void 0&&(e+=(e.length?"&":"")+n);continue}(Array.isArray(s)?s.map(i=>i&&f_(i)):[s&&f_(s)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+n,i!=null&&(e+="="+i))})}return e}function vY(t){const e={};for(const n in t){const s=t[n];s!==void 0&&(e[n]=Array.isArray(s)?s.map(r=>r==null?null:""+r):s==null?s:""+s)}return e}function jc(){let t=[];function e(s){return t.push(s),()=>{const r=t.indexOf(s);r>-1&&t.splice(r,1)}}function n(){t=[]}return{add:e,list:()=>t,reset:n}}function Wr(t,e,n,s,r){const i=s&&(s.enterCallbacks[r]=s.enterCallbacks[r]||[]);return()=>new Promise((o,a)=>{const c=h=>{h===!1?a(ec(4,{from:n,to:e})):h instanceof Error?a(h):KQ(h)?a(ec(2,{from:e,to:h})):(i&&s.enterCallbacks[r]===i&&typeof h=="function"&&i.push(h),o())},l=t.call(s&&s.instances[r],e,n,c);let u=Promise.resolve(l);t.length<3&&(u=u.then(c)),u.catch(h=>a(h))})}function Fg(t,e,n,s){const r=[];for(const i of t)for(const o in i.components){let a=i.components[o];if(!(e!=="beforeRouteEnter"&&!i.instances[o]))if(wY(a)){const l=(a.__vccOpts||a)[e];l&&r.push(Wr(l,n,s,i,o))}else{let c=a();r.push(()=>c.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${i.path}"`));const u=CQ(l)?l.default:l;i.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&Wr(d,n,s,i,o)()}))}}return r}function wY(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function rT(t){const e=Ks(Pp),n=Ks(tP),s=Qe(()=>e.resolve(Pn(t.to))),r=Qe(()=>{const{matched:c}=s.value,{length:l}=c,u=c[l-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(Za.bind(null,u));if(d>-1)return d;const f=iT(c[l-2]);return l>1&&iT(u)===f&&h[h.length-1].path!==f?h.findIndex(Za.bind(null,c[l-2])):d}),i=Qe(()=>r.value>-1&&TY(n.params,s.value.params)),o=Qe(()=>r.value>-1&&r.value===n.matched.length-1&&nP(n.params,s.value.params));function a(c={}){return EY(c)?e[Pn(t.replace)?"replace":"push"](Pn(t.to)).catch(vl):Promise.resolve()}return{route:s,href:Qe(()=>s.value.href),isActive:i,isExactActive:o,navigate:a}}const bY=xe({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:rT,setup(t,{slots:e}){const n=cs(rT(t)),{options:s}=Ks(Pp),r=Qe(()=>({[oT(t.activeClass,s.linkActiveClass,"router-link-active")]:n.isActive,[oT(t.exactActiveClass,s.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const i=e.default&&e.default(n);return t.custom?i:nl("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},i)}}}),IY=bY;function EY(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function TY(t,e){for(const n in e){const s=e[n],r=t[n];if(typeof s=="string"){if(s!==r)return!1}else if(!Array.isArray(r)||r.length!==s.length||s.some((i,o)=>i!==r[o]))return!1}return!0}function iT(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const oT=(t,e,n)=>t!=null?t:e!=null?e:n,SY=xe({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const s=Ks(h_),r=Qe(()=>t.route||s.value),i=Ks(GE,0),o=Qe(()=>r.value.matched[i]);Nh(GE,i+1),Nh(SQ,o),Nh(h_,r);const a=_s();return Zc(()=>[a.value,o.value,t.name],([c,l,u],[h,d,f])=>{l&&(l.instances[u]=c,d&&d!==l&&c&&c===h&&(l.leaveGuards.size||(l.leaveGuards=d.leaveGuards),l.updateGuards.size||(l.updateGuards=d.updateGuards))),c&&l&&(!d||!Za(l,d)||!h)&&(l.enterCallbacks[u]||[]).forEach(p=>p(c))},{flush:"post"}),()=>{const c=r.value,l=o.value,u=l&&l.components[t.name],h=t.name;if(!u)return aT(n.default,{Component:u,route:c});const d=l.props[t.name],f=d?d===!0?c.params:typeof d=="function"?d(c):d:null,_=nl(u,Fe({},f,e,{onVnodeUnmounted:v=>{v.component.isUnmounted&&(l.instances[h]=null)},ref:a}));return aT(n.default,{Component:_,route:c})||_}}});function aT(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const CY=SY;function kY(t){const e=eY(t.routes,t),n=t.parseQuery||yY,s=t.stringifyQuery||sT,r=t.history,i=jc(),o=jc(),a=jc(),c=dD(qr);let l=qr;ua&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Mg.bind(null,S=>""+S),h=Mg.bind(null,_Y),d=Mg.bind(null,Xd);function f(S,Q){let V,X;return rP(S)?(V=e.getRecordMatcher(S),X=Q):X=S,e.addRoute(X,V)}function p(S){const Q=e.getRecordMatcher(S);Q&&e.removeRoute(Q)}function _(){return e.getRoutes().map(S=>S.record)}function v(S){return!!e.getRecordMatcher(S)}function b(S,Q){if(Q=Fe({},Q||c.value),typeof S=="string"){const fe=Lg(n,S,Q.path),g=e.resolve({path:fe.path},Q),y=r.createHref(fe.fullPath);return Fe(fe,g,{params:d(g.params),hash:Xd(fe.hash),redirectedFrom:void 0,href:y})}let V;if("path"in S)V=Fe({},S,{path:Lg(n,S.path,Q.path).path});else{const fe=Fe({},S.params);for(const g in fe)fe[g]==null&&delete fe[g];V=Fe({},S,{params:h(S.params)}),Q.params=h(Q.params)}const X=e.resolve(V,Q),De=S.hash||"";X.params=u(d(X.params));const Ve=RQ(s,Fe({},S,{hash:pY(De),path:X.path})),ye=r.createHref(Ve);return Fe({fullPath:Ve,hash:De,query:s===sT?vY(S.query):S.query||{}},X,{redirectedFrom:void 0,href:ye})}function N(S){return typeof S=="string"?Lg(n,S,c.value.path):Fe({},S)}function T(S,Q){if(l!==S)return ec(8,{from:Q,to:S})}function $(S){return J(S)}function z(S){return $(Fe(N(S),{replace:!0}))}function te(S){const Q=S.matched[S.matched.length-1];if(Q&&Q.redirect){const{redirect:V}=Q;let X=typeof V=="function"?V(S):V;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=N(X):{path:X},X.params={}),Fe({query:S.query,hash:S.hash,params:S.params},X)}}function J(S,Q){const V=l=b(S),X=c.value,De=S.state,Ve=S.force,ye=S.replace===!0,fe=te(V);if(fe)return J(Fe(N(fe),{state:De,force:Ve,replace:ye}),Q||V);const g=V;g.redirectedFrom=Q;let y;return!Ve&&xQ(s,X,V)&&(y=ec(16,{to:g,from:X}),Yo(X,X,!0,!1)),(y?Promise.resolve(y):Ne(g,X)).catch(E=>jr(E)?jr(E,2)?E:$n(E):Be(E,g,X)).then(E=>{if(E){if(jr(E,2))return J(Fe(N(E.to),{state:De,force:Ve,replace:ye}),Q||g)}else E=ln(g,X,!0,ye,De);return tn(g,X,E),E})}function ae(S,Q){const V=T(S,Q);return V?Promise.reject(V):Promise.resolve()}function Ne(S,Q){let V;const[X,De,Ve]=AY(S,Q);V=Fg(X.reverse(),"beforeRouteLeave",S,Q);for(const fe of X)fe.leaveGuards.forEach(g=>{V.push(Wr(g,S,Q))});const ye=ae.bind(null,S,Q);return V.push(ye),ra(V).then(()=>{V=[];for(const fe of i.list())V.push(Wr(fe,S,Q));return V.push(ye),ra(V)}).then(()=>{V=Fg(De,"beforeRouteUpdate",S,Q);for(const fe of De)fe.updateGuards.forEach(g=>{V.push(Wr(g,S,Q))});return V.push(ye),ra(V)}).then(()=>{V=[];for(const fe of S.matched)if(fe.beforeEnter&&!Q.matched.includes(fe))if(Array.isArray(fe.beforeEnter))for(const g of fe.beforeEnter)V.push(Wr(g,S,Q));else V.push(Wr(fe.beforeEnter,S,Q));return V.push(ye),ra(V)}).then(()=>(S.matched.forEach(fe=>fe.enterCallbacks={}),V=Fg(Ve,"beforeRouteEnter",S,Q),V.push(ye),ra(V))).then(()=>{V=[];for(const fe of o.list())V.push(Wr(fe,S,Q));return V.push(ye),ra(V)}).catch(fe=>jr(fe,8)?fe:Promise.reject(fe))}function tn(S,Q,V){for(const X of a.list())X(S,Q,V)}function ln(S,Q,V,X,De){const Ve=T(S,Q);if(Ve)return Ve;const ye=Q===qr,fe=ua?history.state:{};V&&(X||ye?r.replace(S.fullPath,Fe({scroll:ye&&fe&&fe.scroll},De)):r.push(S.fullPath,De)),c.value=S,Yo(S,Q,V,ye),$n()}let Fn;function Fr(){Fn||(Fn=r.listen((S,Q,V)=>{const X=b(S),De=te(X);if(De){J(Fe(De,{replace:!0}),X).catch(vl);return}l=X;const Ve=c.value;ua&&$Q(XE(Ve.fullPath,V.delta),Dp()),Ne(X,Ve).catch(ye=>jr(ye,12)?ye:jr(ye,2)?(J(ye.to,X).then(fe=>{jr(fe,20)&&!V.delta&&V.type===_u.pop&&r.go(-1,!1)}).catch(vl),Promise.reject()):(V.delta&&r.go(-V.delta,!1),Be(ye,X,Ve))).then(ye=>{ye=ye||ln(X,Ve,!1),ye&&(V.delta?r.go(-V.delta,!1):V.type===_u.pop&&jr(ye,20)&&r.go(-1,!1)),tn(X,Ve,ye)}).catch(vl)}))}let Zn=jc(),_t=jc(),yt;function Be(S,Q,V){$n(S);const X=_t.list();return X.length?X.forEach(De=>De(S,Q,V)):console.error(S),Promise.reject(S)}function Pe(){return yt&&c.value!==qr?Promise.resolve():new Promise((S,Q)=>{Zn.add([S,Q])})}function $n(S){return yt||(yt=!S,Fr(),Zn.list().forEach(([Q,V])=>S?V(S):Q()),Zn.reset()),S}function Yo(S,Q,V,X){const{scrollBehavior:De}=t;if(!ua||!De)return Promise.resolve();const Ve=!V&&UQ(XE(S.fullPath,0))||(X||!V)&&history.state&&history.state.scroll||null;return x_().then(()=>De(S,Q,Ve)).then(ye=>ye&&FQ(ye)).catch(ye=>Be(ye,S,Q))}const or=S=>r.go(S);let Ns;const es=new Set;return{currentRoute:c,addRoute:f,removeRoute:p,hasRoute:v,getRoutes:_,resolve:b,options:t,push:$,replace:z,go:or,back:()=>or(-1),forward:()=>or(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:_t.add,isReady:Pe,install(S){const Q=this;S.component("RouterLink",IY),S.component("RouterView",CY),S.config.globalProperties.$router=Q,Object.defineProperty(S.config.globalProperties,"$route",{enumerable:!0,get:()=>Pn(c)}),ua&&!Ns&&c.value===qr&&(Ns=!0,$(r.location).catch(De=>{}));const V={};for(const De in qr)V[De]=Qe(()=>c.value[De]);S.provide(Pp,Q),S.provide(tP,cs(V)),S.provide(h_,c);const X=S.unmount;es.add(S),S.unmount=function(){es.delete(S),es.size<1&&(l=qr,Fn&&Fn(),Fn=null,c.value=qr,Ns=!1,yt=!1),X()}}}}function ra(t){return t.reduce((e,n)=>e.then(()=>n()),Promise.resolve())}function AY(t,e){const n=[],s=[],r=[],i=Math.max(e.matched.length,t.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(t.matched.find(l=>Za(l,a))?s.push(a):n.push(a));const c=t.matched[o];c&&(e.matched.find(l=>Za(l,c))||r.push(c))}return[n,s,r]}function dP(){return Ks(Pp)}var RY=!1;/*!
  * pinia v2.0.14
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let fP;const Op=t=>fP=t,pP=Symbol();function p_(t){return t&&typeof t=="object"&&Object.prototype.toString.call(t)==="[object Object]"&&typeof t.toJSON!="function"}var bl;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(bl||(bl={}));function xY(){const t=mT(!0),e=t.run(()=>_s({}));let n=[],s=[];const r=Ra({install(i){Op(r),r._a=i,i.provide(pP,r),i.config.globalProperties.$pinia=r,s.forEach(o=>n.push(o)),s=[]},use(i){return!this._a&&!RY?s.push(i):n.push(i),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return r}const gP=()=>{};function cT(t,e,n,s=gP){t.push(e);const r=()=>{const i=t.indexOf(e);i>-1&&(t.splice(i,1),s())};return!n&&aS()&&P_(r),r}function ia(t,...e){t.slice().forEach(n=>{n(...e)})}function g_(t,e){for(const n in e){if(!e.hasOwnProperty(n))continue;const s=e[n],r=t[n];p_(r)&&p_(s)&&t.hasOwnProperty(n)&&!ct(s)&&!ei(s)?t[n]=g_(r,s):t[n]=s}return t}const NY=Symbol();function PY(t){return!p_(t)||!t.hasOwnProperty(NY)}const{assign:lr}=Object;function DY(t){return!!(ct(t)&&t.effect)}function OY(t,e,n,s){const{state:r,actions:i,getters:o}=e,a=n.state.value[t];let c;function l(){a||(n.state.value[t]=r?r():{});const u=DT(n.state.value[t]);return lr(u,i,Object.keys(o||{}).reduce((h,d)=>(h[d]=Ra(Qe(()=>{Op(n);const f=n._s.get(t);return o[d].call(f,f)})),h),{}))}return c=mP(t,l,e,n,s,!0),c.$reset=function(){const h=r?r():{};this.$patch(d=>{lr(d,h)})},c}function mP(t,e,n={},s,r,i){let o;const a=lr({actions:{}},n),c={deep:!0};let l,u,h=Ra([]),d=Ra([]),f;const p=s.state.value[t];!i&&!p&&(s.state.value[t]={}),_s({});let _;function v(J){let ae;l=u=!1,typeof J=="function"?(J(s.state.value[t]),ae={type:bl.patchFunction,storeId:t,events:f}):(g_(s.state.value[t],J),ae={type:bl.patchObject,payload:J,storeId:t,events:f});const Ne=_=Symbol();x_().then(()=>{_===Ne&&(l=!0)}),u=!0,ia(h,ae,s.state.value[t])}const b=gP;function N(){o.stop(),h=[],d=[],s._s.delete(t)}function T(J,ae){return function(){Op(s);const Ne=Array.from(arguments),tn=[],ln=[];function Fn(_t){tn.push(_t)}function Fr(_t){ln.push(_t)}ia(d,{args:Ne,name:J,store:z,after:Fn,onError:Fr});let Zn;try{Zn=ae.apply(this&&this.$id===t?this:z,Ne)}catch(_t){throw ia(ln,_t),_t}return Zn instanceof Promise?Zn.then(_t=>(ia(tn,_t),_t)).catch(_t=>(ia(ln,_t),Promise.reject(_t))):(ia(tn,Zn),Zn)}}const $={_p:s,$id:t,$onAction:cT.bind(null,d),$patch:v,$reset:b,$subscribe(J,ae={}){const Ne=cT(h,J,ae.detached,()=>tn()),tn=o.run(()=>Zc(()=>s.state.value[t],ln=>{(ae.flush==="sync"?u:l)&&J({storeId:t,type:bl.direct,events:f},ln)},lr({},c,ae)));return Ne},$dispose:N},z=cs(lr({},$));s._s.set(t,z);const te=s._e.run(()=>(o=mT(),o.run(()=>e())));for(const J in te){const ae=te[J];if(ct(ae)&&!DY(ae)||ei(ae))i||(p&&PY(ae)&&(ct(ae)?ae.value=p[J]:g_(ae,p[J])),s.state.value[t][J]=ae);else if(typeof ae=="function"){const Ne=T(J,ae);te[J]=Ne,a.actions[J]=ae}}return lr(z,te),lr(Ce(z),te),Object.defineProperty(z,"$state",{get:()=>s.state.value[t],set:J=>{v(ae=>{lr(ae,J)})}}),s._p.forEach(J=>{lr(z,o.run(()=>J({store:z,app:s._a,pinia:s,options:a})))}),p&&i&&n.hydrate&&n.hydrate(z.$state,p),l=!0,u=!0,z}function _P(t,e,n){let s,r;const i=typeof e=="function";typeof t=="string"?(s=t,r=i?n:e):(r=t,s=t.id);function o(a,c){const l=aS();return a=a||l&&Ks(pP),a&&Op(a),a=fP,a._s.has(s)||(i?mP(s,e,r,a):OY(s,r,a)),a._s.get(s)}return o.$id=s,o}const Rs=_P({id:"users",state:()=>({data:{},token:sessionStorage.getItem("TOKEN"),room:-1}),getters:{getUser:t=>t,setTokens:t=>e=>{t.token=e,sessionStorage.setItem("TOKEN",e)},setRoom:t=>e=>{t.room=e}},actions:{addUser(t){this.data=t},logout(){this.data={},this.token="",sessionStorage.removeItem("TOKEN")}}}),MY=xe({__name:"App",setup(t){const e=Rs(),n=dP();return rC(yr(),async s=>{if(s){const r=gt(On());ks(Ut(r,`users/${s==null?void 0:s.uid}`)).then(i=>{i.exists()?(e.addUser(i.val()),console.log(i.val()),n.push({name:"home"})):console.log("No data available")}).catch(i=>{console.error(i)}),await n.push({name:"home"})}else await n.push({name:"login"})}),(s,r)=>{const i=An("router-view");return W(),ui(i)}}}),LY=["src","draggable","alt"],Le=xe({__name:"AdImage",props:{src:{type:String,required:!0},classes:{type:String,required:!1},draggable:{type:Boolean,default:!1,required:!1},alt:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("img",{src:t.src,class:pt(t.classes),draggable:t.draggable,alt:t.alt},null,10,LY))}}),js=xe({__name:"AdText",props:{tag:{type:String,required:!0,default:"p",validator:t=>["h1","h2","h3","h4","h5","p","span","label"].includes(t)},for:{type:String,required:!1},classes:{type:String,required:!1}},setup(t){const e=t,n=Qe(()=>e.tag==="label"?e.for:null);return(s,r)=>(W(),ui(qD(t.tag),{class:pt(t.classes),for:Pn(n)},{default:dt(()=>[O_(s.$slots,"default")]),_:3},8,["class","for"]))}}),FY=xe({__name:"ImageText",props:{src:{type:String,required:!0},classes:{type:String,required:!1},classesImage:{type:String,required:!1},classesText:{type:String,required:!1},alt:{type:String,required:!1},label:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("div",{class:pt(t.classes)},[L(Le,{class:pt(t.classesImage),src:t.src,alt:t.alt},null,8,["class","src","alt"]),L(js,{tag:"span",class:pt(t.classesText)},{default:dt(()=>[Je(ht(t.label),1)]),_:1},8,["class"])],2))}}),$Y=xe({__name:"PlayUser",props:{srcUser:{type:String,default:"",required:!1},srcRole:{type:String,default:"",required:!1},classImgUser:{type:String,required:!1},classImgRole:{type:String,required:!1},label:{type:String,required:!1},classesLabel:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y(je,null,[L(js,{tag:"span",classes:t.classesLabel},{default:dt(()=>[Je(ht(t.label),1)]),_:1},8,["classes"]),L(Le,{src:t.srcUser,classes:t.classImgUser},null,8,["src","classes"]),L(Le,{src:t.srcRole,classes:t.classImgRole},null,8,["src","classes"])],64))}}),UY=["id","name","placeholder","value"],BY=xe({__name:"AdTextarea",props:{id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},classes:{type:String,required:!1},modelValue:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("textarea",{id:t.id,name:t.name,placeholder:t.placeholder,class:pt(t.classes),value:t.modelValue},null,10,UY))}});var Lr=(t,e)=>{const n=t.__vccOpts||t;for(const[s,r]of e)n[s]=r;return n};const VY=xe({setup(){Rs()},components:{AdTextarea:BY},props:{username:{type:String,required:!1},message:{type:String,required:!1}},data(){return{user:Rs(),message:"",messages:[]}},mounted(){this.getMessage()},updated(){this.scrollToEnd()},methods:{sendMessage(){this.message.length>1&&Va(gt(Ir,`play-${this.user.room}/message`),{username:this.username,message:this.message}),this.message=""},getMessage(){bo(gt(Ir,`play-${this.user.room}/message`),t=>{this.messages=[],t.forEach(e=>{this.messages.push(e.val())})})},scrollToEnd(){var t=document.querySelector(".scroll"),e=t.scrollHeight;t.scrollTop=e}}}),qY={class:"flex flex-col h-full"},jY={class:"basis-93/100 bg-gray-100 border-2 border-gray-300 relative"},KY={class:"absolute inset-0"},HY={class:"scroll overflow-scroll h-full"},WY={class:"break-all pl-2"},zY={key:0},GY={key:1},QY={class:"text-pink-500"},YY={class:"basis-7/100 bg-gray-100 border-2 border-gray-300 h-full relative"},XY={class:"absolute inset-y-0 right-0 px-1.5 cursor-pointer flex h-full"},JY={class:"ov-icon ov-flip-vertical w-6 h-6 my-auto","aria-hidden":"true",viewBox:"0 0 512 512",fill:"#BDC3C8",style:{"font-size":"2.88em"}},ZY=m("path",{d:"M476.59 227.05l-.16-.07L49.35 49.84A23.56 23.56 0 0027.14 52 24.65 24.65 0 0016 72.59v113.29a24 24 0 0019.52 23.57l232.93 43.07a4 4 0 010 7.86L35.53 303.45A24 24 0 0016 327v113.31A23.57 23.57 0 0026.59 460a23.94 23.94 0 0013.22 4 24.55 24.55 0 009.52-1.93L476.4 285.94l.19-.09a32 32 0 000-58.8z"},null,-1),eX=[ZY];function tX(t,e,n,s,r,i){const o=An("ad-textarea");return W(),Y("div",qY,[m("div",jY,[m("div",KY,[m("div",HY,[m("ul",WY,[(W(!0),Y(je,null,ss(t.messages,a=>(W(),Y("li",null,[a.system?(W(),Y("span",GY,ht(a.username),1)):(W(),Y("span",zY,ht(a.username)+": ",1)),m("span",null,ht(a.message),1),m("span",QY,ht(a.system),1)]))),256))])])])]),m("div",YY,[L(o,{onKeyup:qO(t.sendMessage,["enter"]),modelValue:t.message,"onUpdate:modelValue":e[0]||(e[0]=a=>t.message=a),placeholder:"Type your message",classes:"absolute inset-y-0 left-0 right-8 pl-2 pt-1 text-gray-300 resize-none placeholder:text-gray-500/50 focus:outline-none focus:ring-0 overflow-hidden"},null,8,["onKeyup","modelValue"]),m("div",XY,[(W(),Y("svg",JY,eX))])])])}var yP=Lr(VY,[["render",tX]]);const nX=_P({id:"roles",state:()=>({data:[{name:"Villager",imgUrl:"https://www.wolvesville.com/static/media/icon_villager_filled.bf9f7a2c.svg"},{name:"Doctor",imgUrl:"https://www.wolvesville.com/static/media/icon_doctor_filled.20fa62bd.svg"},{name:"Alpha werewolf",imgUrl:"https://www.wolvesville.com/static/media/icon_alpha_werewolf_filled.74166752.svg"},{name:"Corrupter",imgUrl:"https://www.wolvesville.com/static/media/icon_corruptor_filled.aeab23f4.svg"}]}),getters:{getRoles:t=>t},actions:{addRole(t){this.data.push(t)}}}),sX=xe({components:{ImageText:FY,PlayUser:$Y,AdImage:Le,ChatView:yP},data(){return{user:Rs(),users:[{}],roles:nX(),slots:[0,1,2,3],time:{timer:0,totalTime:5}}},mounted(){this.getUsers()},methods:{start(){this.users.length>1&&(this.resetTimer(),this.startTimer())},getUsers(){const t=On(),e=gt(t,`play-${this.user.room}`);bo(e,n=>{const s=n.val();this.users.push(s)}),bo(gt(Ir,"play-"+this.user.room),n=>{this.users=[],n.forEach(s=>{s.key!=="message"&&s.key!=="system"&&this.users.push(s.val())})})},startTimer:function(){this.time.timer=setInterval(()=>this.countdown(),1e3)},stopTimer:function(){clearInterval(this.time.timer),this.time.timer=0},resetTimer:function(){clearInterval(this.time.timer),this.time.totalTime=5,this.time.timer=0},padTime:function(t){return(t<10?"0":"")+t},countdown:function(){if(this.time.totalTime>=0){console.log(this.time.totalTime);const t=this.time.totalTime--;t==5?Va(gt(Ir,`play-${this.user.room}/system`),{message:"Game starting in 5..."}):Va(gt(Ir,`play-${this.user.room}/system`),{message:t})}else this.stopTimer()}}}),rX={id:"play",class:"bg-black/10 bg-background-Play"},iX={class:"flex flex-row h-screen p-4"},oX={class:"basis-3/10 mr-4"},aX={class:"flex flex-col h-full"},cX={class:"basis-1/20 relative"},lX={class:"grid grid-cols-2 bg-gray-100 py-1 mb-2 rounded border border-gray-300"},uX={class:"my-auto px-3"},hX=m("path",{d:"M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"},null,-1),dX=[hX],fX=lf('<div class="justify-self-end my-auto px-4 pb-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-5 h-5 inline-block mr-3"><path d="M495.9 166.6C499.2 175.2 496.4 184.9 489.6 191.2L446.3 230.6C447.4 238.9 448 247.4 448 256C448 264.6 447.4 273.1 446.3 281.4L489.6 320.8C496.4 327.1 499.2 336.8 495.9 345.4C491.5 357.3 486.2 368.8 480.2 379.7L475.5 387.8C468.9 398.8 461.5 409.2 453.4 419.1C447.4 426.2 437.7 428.7 428.9 425.9L373.2 408.1C359.8 418.4 344.1 427 329.2 433.6L316.7 490.7C314.7 499.7 307.7 506.1 298.5 508.5C284.7 510.8 270.5 512 255.1 512C241.5 512 227.3 510.8 213.5 508.5C204.3 506.1 197.3 499.7 195.3 490.7L182.8 433.6C167 427 152.2 418.4 138.8 408.1L83.14 425.9C74.3 428.7 64.55 426.2 58.63 419.1C50.52 409.2 43.12 398.8 36.52 387.8L31.84 379.7C25.77 368.8 20.49 357.3 16.06 345.4C12.82 336.8 15.55 327.1 22.41 320.8L65.67 281.4C64.57 273.1 64 264.6 64 256C64 247.4 64.57 238.9 65.67 230.6L22.41 191.2C15.55 184.9 12.82 175.3 16.06 166.6C20.49 154.7 25.78 143.2 31.84 132.3L36.51 124.2C43.12 113.2 50.52 102.8 58.63 92.95C64.55 85.8 74.3 83.32 83.14 86.14L138.8 103.9C152.2 93.56 167 84.96 182.8 78.43L195.3 21.33C197.3 12.25 204.3 5.04 213.5 3.51C227.3 1.201 241.5 0 256 0C270.5 0 284.7 1.201 298.5 3.51C307.7 5.04 314.7 12.25 316.7 21.33L329.2 78.43C344.1 84.96 359.8 93.56 373.2 103.9L428.9 86.14C437.7 83.32 447.4 85.8 453.4 92.95C461.5 102.8 468.9 113.2 475.5 124.2L480.2 132.3C486.2 143.2 491.5 154.7 495.9 166.6V166.6zM256 336C300.2 336 336 300.2 336 255.1C336 211.8 300.2 175.1 256 175.1C211.8 175.1 176 211.8 176 255.1C176 300.2 211.8 336 256 336z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" class="w-5 h-5 inline-block"><path d="M319.9 320c57.41 0 103.1-46.56 103.1-104c0-57.44-46.54-104-103.1-104c-57.41 0-103.1 46.56-103.1 104C215.9 273.4 262.5 320 319.9 320zM369.9 352H270.1C191.6 352 128 411.7 128 485.3C128 500.1 140.7 512 156.4 512h327.2C499.3 512 512 500.1 512 485.3C512 411.7 448.4 352 369.9 352zM512 160c44.18 0 80-35.82 80-80S556.2 0 512 0c-44.18 0-80 35.82-80 80S467.8 160 512 160zM183.9 216c0-5.449 .9824-10.63 1.609-15.91C174.6 194.1 162.6 192 149.9 192H88.08C39.44 192 0 233.8 0 285.3C0 295.6 7.887 304 17.62 304h199.5C196.7 280.2 183.9 249.7 183.9 216zM128 160c44.18 0 80-35.82 80-80S172.2 0 128 0C83.82 0 48 35.82 48 80S83.82 160 128 160zM551.9 192h-61.84c-12.8 0-24.88 3.037-35.86 8.24C454.8 205.5 455.8 210.6 455.8 216c0 33.71-12.78 64.21-33.16 88h199.7C632.1 304 640 295.6 640 285.3C640 233.8 600.6 192 551.9 192z"></path></svg></div>',1),pX={class:"basis-3/20 mb-4"},gX={class:"grid grid-cols-8 gap-4 bg-gray-100 p-2 mt-4 border border-gray-300 rounded text-center"},mX={class:"basis-4/5 bg-cyan-500"},_X={class:"basis-7/10"},yX={class:"flex flex-col h-full"},vX={class:"basis-9/10"},wX={class:"grid grid-cols-4 grid-rows-4 gap-2 h-full w-full"},bX={class:"bg-sky-400 rounded"},IX={class:"bg-background-Play-User bg-cover bg-no-repeat bg-bottom rounded h-full relative"},EX={class:"bg-sky-400 rounded"},TX={class:"bg-background-Play-User bg-cover bg-no-repeat bg-bottom rounded h-full relative"},SX={class:"basis-1/10"},CX={class:"flex flex-row justify-center items-center h-full gap-4"},kX={class:"border-4 border-gray-500 bg-gray-200 p-3 rounded-full"},AX={class:"border-4 border-gray-500 bg-gray-200 p-3 rounded-full"};function RX(t,e,n,s,r,i){const o=An("image-text"),a=An("chat-view"),c=An("PlayUser"),l=An("ad-image");return W(),Y("div",rX,[m("div",iX,[m("div",oX,[m("div",aX,[m("div",cX,[m("div",lX,[m("div",uX,[(W(),Y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",class:"w-5 h-5 cursor-pointer",onClick:e[0]||(e[0]=u=>t.$router.push({name:"home"}))},dX))]),fX])]),m("div",pX,[m("div",gX,[(W(!0),Y(je,null,ss(t.users.length,u=>(W(),Y("div",{key:u},[L(o,{"classes-text":"text-x truncate xl:whitespace-normal",label:t.roles.data[u-1].name,src:t.roles.data[u-1].imgUrl},null,8,["label","src"])]))),128))])]),m("div",mX,[L(a,{username:t.user.data.name},null,8,["username"])])])]),m("div",_X,[m("div",yX,[m("div",vX,[m("div",wX,[(W(!0),Y(je,null,ss(t.users,u=>(W(),Y("div",bX,[m("div",IX,[L(c,{"src-user":"https://cdn-avatars.wolvesville.com/1e98c23e-b356-4e41-b2d1-a81ae403772f@2x.png","src-role":u.role,label:u.name,"class-img-user":"absolute w-24 absolute left-1/2 transform -translate-x-1/2 bottom-0.5","class-img-role":"absolute w-8 bottom-0.5 right-0","classes-label":"absolute left-1/2 transform -translate-x-1/2 top-1.5 text-white bg-black/40 px-4 py-0.5 rounded"},null,8,["src-role","label"])])]))),256)),(W(!0),Y(je,null,ss(16-t.users.length,u=>(W(),Y("div",EX,[m("div",TX,[L(c,{"src-user":"","src-role":"",label:"","class-img-user":"absolute w-24 absolute left-1/2 transform -translate-x-1/2 bottom-0.5","class-img-role":"absolute w-8 bottom-0.5 right-0","classes-label":"absolute left-1/2 transform -translate-x-1/2 top-1.5 text-white bg-black/40 px-4 py-0.5 rounded"})])]))),256))])]),m("div",SX,[m("div",CX,[m("div",kX,[L(l,{src:"https://www.wolvesville.com/static/media/loudmouth_select.c6c53966.png",classes:"w-8 h-8"})]),m("div",AX,[L(l,{src:"https://www.wolvesville.com/static/media/inventory_tab_rose_packages.23c42fdb.png",classes:"w-8 h-8"})])])])])])])])}var xX=Lr(sX,[["render",RX]]);const NX=xe({__name:"AdRow",props:{coLs:{type:String,required:!1,default:"1"},gap:{type:String,required:!1,default:"4"},classes:{type:String,required:!1}},setup(t){const e=t,n=Qe(()=>`grid-coLs-${e.coLs}`),s=Qe(()=>`gap-${e.gap}`);return(r,i)=>(W(),Y("div",{class:pt(["grid",[Pn(n),Pn(s)]])},[O_(r.$slots,"default")],2))}}),PX=["type"],vP=xe({__name:"AdButton",props:{type:{type:String,required:!1,default:"button",validator:t=>["button","submit","reset"].includes(t)},classes:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("button",{class:pt(t.classes),type:t.type},[O_(e.$slots,"default")],10,PX))}}),DX=xe({components:{AdButton:vP},data(){return{user:Rs(),room:1}},methods:{play:async function(){const t=On();let e=!1;gt(t,`play-${this.room}`);const n=gt(On());for(;!e;)e=await ks(Ut(n,`play-${this.room}`)).then(async s=>{let r=4;return s.child("message")&&(Va(gt(Ir,`play-${this.room}/message`),{username:this.user.data.name,system:" join."}),r++),s.size<r?(await Cs(gt(t,`play-${this.room}/${this.user.data.id}`),{name:this.user.data.name,email:this.user.data.email,room:this.room,role:""}),this.user.room=this.room,await this.$router.push({name:"play"}),!0):(this.room++,!1)})}}}),OX={class:"place-self-center grid grid-cols-1 gap-6 place-items-center"},MX=Je(" PLAY "),LX=Je(" INVENTORY "),FX=Je(" SHOP "),$X=Je(" CLAN "),UX=Je(" ROLES ");function BX(t,e,n,s,r,i){const o=An("ad-button");return W(),Y("div",OX,[L(o,{onClick:t.play,type:"submit",class:"bg-background-Play border-2 text-2xl bg-pink-500 text-white px-20 py-2 font-bold rounded-md"},{default:dt(()=>[MX]),_:1},8,["onClick"]),L(o,{onClick:e[0]||(e[0]=a=>t.$router.push({name:"inventory"})),type:"submit",class:"bg-white text-lg px-8 py-2 font-semibold rounded-md"},{default:dt(()=>[LX]),_:1}),L(o,{onClick:e[1]||(e[1]=a=>t.$router.push({name:"shop"})),type:"submit",class:"bg-white px-8 py-2 font-semibold rounded-md"},{default:dt(()=>[FX]),_:1}),L(o,{type:"submit",class:"bg-white px-8 py-2 font-semibold rounded-md"},{default:dt(()=>[$X]),_:1}),L(o,{type:"submit",class:"bg-white px-7 py-2 font-semibold rounded-md"},{default:dt(()=>[UX]),_:1})])}var VX=Lr(DX,[["render",BX]]);const qX={class:"grid grid-coLs-3 gap-4"},jX=xe({__name:"IconEvent",setup(t){return(e,n)=>(W(),Y("div",qX,[L(Le,{src:"https://www.wolvesville.com/static/media/announcements_icon_dashboard.7d9961eb.png",alt:"announcements_icon_dashboard",classes:"w-14"}),L(Le,{src:"https://www.wolvesville.com/static/media/daily_reward.web.ebe06948.png",alt:"daily_reward",classes:"w-14"}),L(Le,{src:"https://cdn.wolvesville.com/calendars/calendar_bakery_icon.web@2x.png",alt:"calendar_bakery_icon",classes:"w-14"})]))}}),KX={class:"grid grid-rows-4 gap-4"},HX={class:"row-span-2 self-center"},WX={class:"align-bottom mx-auto"},zX=xe({__name:"HomeWolvesville",setup(t){return(e,n)=>(W(),Y("div",KX,[L(Le,{src:"https://www.wolvesville.com/static/media/logo_text.a219eb8e.png",alt:"logo",class:"w-1/2 mx-auto self-end align-bottom"}),m("div",HX,[L(VX)]),m("div",WX,[L(jX)])]))}}),Aa=xe({__name:"TextImage",props:{src:{type:String,required:!0},classes:{type:String,required:!1},classesText:{type:String,required:!1},classesImage:{type:String,required:!1},alt:{type:String,required:!1},label:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("div",{class:pt(t.classes)},[L(js,{tag:"span",class:pt(t.classesText)},{default:dt(()=>[Je(ht(t.label),1)]),_:1},8,["class"]),L(Le,{class:pt(t.classesImage),src:t.src,alt:t.alt},null,8,["class","src","alt"])],2))}}),GX={class:"grid grid-cols-4 gap-2 bg-gray-900/50 h-fit rounded-md py-3 text-white"},QX={class:"my-auto"},YX={key:0,class:"bg-blue-400 h-fit w-fit p-2 rounded-full mx-auto self-center"},XX=m("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})],-1),JX=[XX],ZX={class:"col-span-2"},eJ={key:0},tJ={class:"relative bg-gray-200 rounded-full"},nJ=m("div",{class:"absolute bg-sky-600 text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full h-4",style:{width:"50%"}},null,-1),sJ=Je(" 100/200 "),rJ=m("div",{class:"text-xs font-medium text-blue-100 text-center p-0.5 leading-none rounded-full h-4",style:{width:"100%"}},null,-1),iJ={class:"relative"},oJ=xe({__name:"ProfileEvent",props:{src:{type:String,default:"",required:!1},classesAvatar:{type:String,required:!1},classesDiv:{type:String,required:!1},classesImage:{type:String,required:!1},alt:{type:String,required:!1},label:{type:String,required:!1},nameRouter:{type:String,required:!1},classesText:{type:String,required:!1},checkFiled:{type:String,default:"true",required:!1},classesSeason:{type:String,required:!1},labelSeason:{type:String,required:!1},labelName:{type:String,required:!1}},setup(t){return(e,n)=>(W(),Y("div",GX,[m("div",QX,[t.checkFiled==="true"?(W(),Y("div",YX,JX)):(W(),ui(Le,{key:1,src:t.src,alt:t.alt,class:pt(t.classesImage)},null,8,["src","alt","class"]))]),m("div",ZX,[t.checkFiled==="true"?(W(),Y("div",eJ,[L(js,{tag:"span"},{default:dt(()=>[Je(ht(t.labelName),1)]),_:1}),m("div",tJ,[nJ,L(js,{tag:"span",class:"absolute text-xs font-medium text-center text-black p-0.5 leading-none h-4",style:{width:"100%"}},{default:dt(()=>[sJ]),_:1}),rJ])])):(W(),Y("div",{key:1,class:pt(t.classesSeason)},[L(js,{tag:"span",class:pt(t.classesText)},{default:dt(()=>[Je(ht(t.label),1)]),_:1},8,["class"])],2))]),m("div",iJ,[t.checkFiled==="true"?(W(),ui(Aa,{key:0,label:t.label,classes:t.classesDiv,"classes-text":t.classesText,"classes-image":t.classesImage,alt:t.alt,src:t.src},null,8,["label","classes","classes-text","classes-image","alt","src"])):(W(),Y("div",{key:1,class:pt(t.classesSeason)},[L(js,{tag:"span"},{default:dt(()=>[Je(ht(t.labelSeason),1)]),_:1})],2))])]))}}),aJ=xe({components:{ProfileEvent:oJ},props:{name:{type:String,required:!0}},data(){return{user:Rs()}}}),cJ={class:"w-1/35 absolute inset-y-0 right-0 mt-20"};function lJ(t,e,n,s,r,i){const o=An("profile-event");return W(),Y("div",cJ,[L(o,{label:"28",src:"https://www.wolvesville.com/static/media/rank_03.c0e2cb82.png","classes-text":"absolute text-white mt-0.5 top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2","classes-image":"w-1/2 inline-block","classes-div":"text-center","label-name":t.name},null,8,["label-name"]),L(o,{"check-filed":"false",src:"https://cdn.wolvesville.com/battlePass/icons/bp24@2x.png",label:"New battle pass available!",labelSeason:"Season 24","classes-image":"w-1/2 mx-auto","classes-season":"flex items-center h-full mb-none",class:"text-sm mt-4"})])}var uJ=Lr(aJ,[["render",lJ]]);const hJ={class:"flex flex-col-3"},dJ=xe({__name:"CoinRoseGem",props:{labelCoin:{type:String,required:!0},labelRose:{type:String,required:!0},labelGem:{type:String,required:!0},nameRouterShop:{type:String,default:"home",required:!1}},setup(t){return(e,n)=>(W(),Y("div",hJ,[L(Aa,{"classes-image":"w-5 inline-block ml-1",label:t.labelCoin,src:"https://www.wolvesville.com/static/media/silver_coin.7b125383.png",alt:"silver_coin",onClick:n[0]||(n[0]=s=>e.$router.push({name:t.nameRouterShop}))},null,8,["label"]),L(Aa,{class:"mx-4","classes-image":"w-3 inline-block ml-1",label:t.labelRose,src:"https://www.wolvesville.com/static/media/rose_inventory_single.eb6af861.png",alt:"rose_inventory_single"},null,8,["label"]),L(Aa,{label:t.labelGem,"classes-image":"w-5 inline-block ml-1",src:"https://www.wolvesville.com/static/media/gem.439d7650.png",alt:"gem",onClick:n[1]||(n[1]=s=>e.$router.push({name:t.nameRouterShop}))},null,8,["label"])]))}}),Ls=gt;const fJ={key:0,class:"bg_fullsize"},pJ={class:"box-bg-friend"},gJ={class:"search-form"},mJ={class:"box-form"},_J={style:{"align-items":"center",display:"flex"}},yJ=["onClick"],vJ={class:"absolute w-full"},wJ={class:"flex justify-end"},bJ={class:"bg-gray-900/50 w-fit px-5 py-2 rounded-md"},IJ=m("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 inline-block mb-1",viewBox:"0 0 20 20",fill:"currentColor"},[m("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})],-1),EJ=Je(" Friends "),TJ=m("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-7 w-7",viewBox:"0 0 20 20",fill:"currentColor"},[m("path",{"fill-rule":"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z","clip-rule":"evenodd"})],-1),SJ=[TJ],CJ=m("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-7 w-7",viewBox:"0 0 20 20",fill:"currentColor"},[m("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z","clip-rule":"evenodd"})],-1),kJ=[CJ],Uw=xe({__name:"HomeSeting",props:{labelCoin:{type:String,default:""},labelGem:{type:String,default:""},labelRose:{type:String,default:""},nameRouterShop:{type:String,default:""},nameRouterSettings:{type:String,default:""},nameRouterHelp:{type:String,default:""}},setup(t){const e=t,n=dP(),s=_s(!1),r=_s(!1),i=_s(!1),o=_s("");_s([]);const a=cs({data:[]});let c;N_(()=>{c=yr(),rC(c,f=>{s.value=!!f})});function l(){yr(c.app).signOut(),Rs().logout(),n.push({name:e.nameRouterSettings})}function u(){r.value?(i.value=!0,setTimeout(()=>{r.value=!r.value,i.value=!1},1e3)):r.value=!r.value}function h(){const f=On();Ls(f,"users");const p=ts(Ls(f,"users"),h1("name"),d1(o.value));bo(p,_=>{var v=[];_.forEach(b=>{v.push({name:b.val().name,id:b.val().id})}),a.data=v})}function d(f){var N;const p=On(),_=(N=yr().currentUser)==null?void 0:N.uid;Ls(p,"users/"+_);const v=Ls(On());var b=[];ks(Ut(v,"users/"+_)).then(T=>{T.exists()?(b=T.val()||[],console.log({data:f,arrFriend:b}),Cs(Ls(p,"users/"+_),{email:T.val().email,name:T.val().name,id:T.val().id,token:T.val().token,friend:[f,b]})):console.log("No data available")}).catch(T=>{console.error(T)}),ks(Ut(v,"users/"+f.id)).then(T=>{T.exists()?(b=T.val()||[],console.log({data:f,arrFriend:b}),Cs(Ls(p,"users/"+f.id),{email:T.val().email,name:T.val().name,id:T.val().id,token:T.val().token,friend:[f,b]})):console.log("No data available")}).catch(T=>{console.error(T)})}return(f,p)=>{const _=An("v-icon");return W(),Y(je,null,[r.value?(W(),Y("div",fJ,[m("div",{class:pt(["box-friend",{"close-box-fiend":i.value}])},[m("div",pJ,[L(_,{onClick:u,style:{display:"block",height:"25px",width:"25px"},name:"pr-times"}),m("div",gJ,[Xi(m("input",{type:"text",class:"icon_sreach","onUpdate:modelValue":p[0]||(p[0]=v=>o.value=v),placeholder:"T\xECm ki\u1EBFm"},null,512),[[Ji,o.value]]),L(_,{name:"fc-search",onClick:h})]),m("div",mJ,[(W(!0),Y(je,null,ss(a.data,(v,b)=>(W(),Y("div",{key:b,class:"box-form-nameicon"},[m("div",null,ht(v.name),1),m("div",_J,[m("button",{onClick:N=>d(v),class:"friend",style:{border:"1px solid blue",color:"blue",padding:"2px","margin-right":"5px","font-weight":"200",background:"rgba(255, 255, 255, 0.774)"}}," Add Friend ",8,yJ),L(_,{name:"bi-star-fill"})])]))),128))])])],2)])):kl("",!0),m("div",vJ,[m("div",wJ,[m("div",bJ,[L(dJ,{"label-coin":t.labelCoin,"label-gem":t.labelGem,"label-rose":t.labelRose,"name-router-shop":t.nameRouterShop},null,8,["label-coin","label-gem","label-rose","name-router-shop"])]),m("div",{class:"bg-gray-900/50 w-fit px-5 py-2 rounded-md mx-3",style:{cursor:"pointer"},onClick:u},[IJ,L(js,{tag:"span",class:"m-auto"},{default:dt(()=>[EJ]),_:1})]),m("div",{class:"bg-gray-900/50 w-fit h-fit px-4 py-2 rounded-md cursor-pointer",onClick:l},SJ),m("div",{class:"bg-gray-900/50 w-fit h-fit px-4 py-2 rounded-md mx-3",onClick:p[1]||(p[1]=v=>f.$router.push({name:t.nameRouterHelp}))},kJ)])])],64)}}}),AJ=xe({components:{AdRow:NX,HomeWolvesville:zX,ProfileSeason:uJ,HomeSeting:Uw},data(){return{auth:yr(),user:Rs()}},created(){window.addEventListener("beforeunload",this.deleteUserInRoom),console.log("123")},mounted(){console.log("333"),this.deleteUserInRoom()},methods:{test(){console.log("test1")},async deleteUserInRoom(){var n;console.log((n=this.auth.currentUser)==null?void 0:n.uid);const t=gt(On()),e=On();ks(Ut(t,`play-${this.user.room}/${this.user.data.id}`)).then(async s=>{if(s.exists()){await Cs(gt(e,`play-${this.user.room}/${this.user.data.id}`),{});return}else console.log("No data available")}).catch(s=>{console.error(s)}),ks(Ut(t,`play-${this.user.room}`)).then(async s=>{if(s.exists()){s.size==2&&s.child("message").exists()&&await Cs(gt(e,`play-${this.user.room}`),{});return}else console.log("No data available")}).catch(s=>{console.error(s)})}}}),RJ={id:"main",class:"bg-sky-500/50 h-screen text-white"},xJ={class:"bg-background-Home h-full"},NJ={class:"pt-2"},PJ=Je(" a ");function DJ(t,e,n,s,r,i){const o=An("home-seting"),a=An("profile-season"),c=An("home-wolvesville"),l=An("ad-row");return W(),Y("div",RJ,[m("div",xJ,[m("div",NJ,[L(o,{"label-coin":t.user.data.coin,"label-gem":t.user.data.gem,"label-rose":t.user.data.flower,"name-router-settings":"login"},null,8,["label-coin","label-gem","label-rose"])]),L(a,{name:t.user.data.name},null,8,["name"]),L(l,{"co-ls":"3",class:"h-full text-black"},{default:dt(()=>[L(l,null,{default:dt(()=>[L(c)]),_:1}),L(l,null,{default:dt(()=>[PJ]),_:1})]),_:1})])])}var OJ=Lr(AJ,[["render",DJ]]);const MJ=["type","id","name","placeholder","value"],LJ=xe({__name:"AdInput",props:{type:{type:String,required:!1,default:"text",validator:t=>["text","email","password","checkbox","radio"].includes(t)},id:{type:String,required:!1},name:{type:String,required:!1},placeholder:{type:String,required:!1},classes:{type:String,required:!1},modelValue:{type:[String,Boolean],required:!1}},setup(t){return(e,n)=>(W(),Y("input",{type:t.type,id:t.id,name:t.name,placeholder:t.placeholder,class:pt(t.classes),value:t.modelValue},null,10,MJ))}}),FJ=xe({components:{AdButton:vP,AdInput:LJ},data(){return{user:Rs(),from:{email:"",password:""},error:""}},methods:{facebookSignIn(){const t=new qn,e=yr();e.languageCode="vi",rm(e,t).then(async n=>{const s=n.user,i=qn.credentialFromResult(n).accessToken,o=Ls(On());await ks(Ut(o,`users/${s.uid}`)).then(a=>{a.exists()?this.user.data=a.val():(Cs(gt(Ir,`users/${s.uid}`),{id:s.uid,name:s.displayName,email:s.email,coin:"0",gem:"0",flower:"0",token:i}),this.user.data={id:s.uid,name:s.displayName,email:s.email,coin:"0",gem:"0",flower:"0",token:i})}).catch(a=>{console.error(a)}),await this.$router.push({name:"home"})}).catch(n=>{n.code,n.message,n.customData.email,qn.credentialFromError(n)})},googleSignIn(){const t=new jn;t.addScope("https://www.googleapis.com/auth/contacts.readonly");const e=yr();e.languageCode="vi",rm(e,t).then(async n=>{const r=jn.credentialFromResult(n).accessToken,i=n.user;this.user.setTokens(r);const o=Ls(On());await ks(Ut(o,`users/${i.uid}`)).then(a=>{a.exists()?this.user.data=a.val():(Cs(gt(Ir,`users/${i.uid}`),{id:i.uid,name:i.displayName,email:i.email,coin:"0",gem:"0",flower:"0",token:r}),this.user.data={id:i.uid,name:i.displayName,email:i.email,coin:"0",gem:"0",flower:"0",token:r})}).catch(a=>{console.error(a)}),await this.$router.push({name:"home"})}).catch(n=>{n.code,n.message,n.customData.email,jn.credentialFromError(n)})},submit(){tC(yr(),this.from.email,this.from.password).then(async t=>{this.user.setTokens(await t.user.getIdToken()),await this.$router.push({name:"home"})}).catch(t=>{switch(console.log(t),t.code){case"auth/invalid-email":this.error="Invalid email";break;case"auth/user-not-found":this.error="No account with that email was found";break;case"auth/wrong-password":this.error="incorrect password";break;default:this.error="Email or password is incorrect";break}})}}}),$J={class:"bg-gray-300"},UJ={class:"w-full h-screen flex items-center justify-center"},BJ=m("div",{class:"flex font-bold justify-center mt-6"},[m("img",{class:"h-20 w-20",src:"https://raw.githubusercontent.com/sefyudem/Responsive-Login-Form/master/img/avatar.svg"})],-1),VJ=m("h2",{class:"text-3xl text-center text-gray-700 mb-4"},"Login",-1),qJ={class:"px-12 pb-10"},jJ={key:0,class:"alert alert-danger text-red-500"},KJ={class:"w-full mb-2"},HJ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"email"}," Email ",-1),WJ={class:"flex items-center"},zJ={class:"w-full mb-2"},GJ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"password"}," Password ",-1),QJ={class:"flex items-center"},YJ={class:"text-xs text-gray-500 float-right mb-4"},XJ=Je("Do not have an account? "),JJ=m("button",{type:"submit",class:"w-full py-2 rounded-full bg-green-600 text-gray-100 hover:bg-green-500 focus:outline-none"}," Login ",-1),ZJ={class:"flex items-center justify-center gap-4 mt-4"},eZ={class:"ov-icon w-4 h-4 mr-2","aria-hidden":"true",width:"46.08",height:"46.08",viewBox:"-1.6 -1.6 19.2 19.2",fill:"#2980B9",style:{"font-size":"2.88em"}},tZ=m("path",{d:"M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z"},null,-1),nZ=[tZ],sZ=Je(" Facebook "),rZ=m("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",class:"w-4 h-4 mr-2",viewBox:"0 0 48 48"},[m("defs",null,[m("path",{id:"a",d:"M44.5 20H24v8.5h11.8C34.7 33.9 30.1 37 24 37c-7.2 0-13-5.8-13-13s5.8-13 13-13c3.1 0 5.9 1.1 8.1 2.9l6.4-6.4C34.6 4.1 29.6 2 24 2 11.8 2 2 11.8 2 24s9.8 22 22 22c11 0 21-8 21-22 0-1.3-.2-2.7-.5-4z"})]),m("clipPath",{id:"b"},[m("use",{"xlink:href":"#a",overflow:"visible"})]),m("path",{"clip-path":"url(#b)",fill:"#FBBC05",d:"M0 37V11l17 13z"}),m("path",{"clip-path":"url(#b)",fill:"#EA4335",d:"M0 11l17 13 7-6.1L48 14V0H0z"}),m("path",{"clip-path":"url(#b)",fill:"#34A853",d:"M0 37l30-23 7.9 1L48 0v48H0z"}),m("path",{"clip-path":"url(#b)",fill:"#4285F4",d:"M48 48L17 24l-4-3 35-10z"})],-1),iZ=Je("Google "),oZ=[rZ,iZ];function aZ(t,e,n,s,r,i){return W(),Y("div",$J,[m("div",UJ,[m("form",{class:"w-full md:w-1/3 bg-white rounded-lg",onSubmit:e[5]||(e[5]=hS((...o)=>t.submit&&t.submit(...o),["prevent"]))},[BJ,VJ,m("div",qJ,[t.error?(W(),Y("div",jJ,ht(t.error),1)):kl("",!0),m("div",KJ,[HJ,m("div",WJ,[Xi(m("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.from.email=o),id:"email",type:"text",placeholder:"Email",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.email]])])]),m("div",zJ,[GJ,m("div",QJ,[Xi(m("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.from.password=o),id:"password",type:"password",placeholder:"Password",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.password]])])]),m("span",YJ,[XJ,m("span",{class:"cursor-pointer text-sky-600 hover:text-sky-400",onClick:e[2]||(e[2]=o=>t.$router.push({name:"register"}))},"Register.")]),JJ,m("div",ZJ,[m("button",{onClick:e[3]||(e[3]=(...o)=>t.facebookSignIn&&t.facebookSignIn(...o)),type:"button",class:"flex items-center justify-center w-full px-4 py-2 text-sm text-white text-gray-700 border border-gray-300 rounded-lg hover:border-gray-500 focus:border-gray-500"},[(W(),Y("svg",eZ,nZ)),sZ]),m("button",{type:"button",onClick:e[4]||(e[4]=(...o)=>t.googleSignIn&&t.googleSignIn(...o)),class:"flex items-center justify-center w-full px-4 py-2 text-sm text-white text-gray-700 border border-gray-300 rounded-lg hover:border-gray-500 focus:border-gray-500"},oZ)])])],32)])])}var wP=Lr(FJ,[["render",aZ]]);const cZ=xe({components:{LoginView:wP,ChatView:yP},data(){return{login:{}}},methods:{getUsername(t){this.login.username=t,this.login.showChatView=!0}}}),lZ={class:"bg-white dark:bg-slate-900 rounded-lg px-6 py-8 ring-1 ring-slate-900/5 shadow-xl"},uZ=m("div",null,[m("span",{class:"inline-flex items-center justify-center p-2 bg-indigo-500 rounded-md shadow-lg"},[m("svg",{class:"h-6 w-6 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true"})])],-1),hZ=m("h3",{class:"text-slate-900 dark:text-white mt-5 text-base font-medium tracking-tight"}," Writes Upside-Down ",-1),dZ=m("p",{class:"text-slate-500 dark:text-slate-400 mt-2 text-sm"}," The Zero Gravity Pen can be used to write in any orientation, including upside-down. It even works in outer space. ",-1),fZ=[uZ,hZ,dZ];function pZ(t,e,n,s,r,i){return W(),Y("div",lZ,fZ)}var gZ=Lr(cZ,[["render",pZ]]);const mZ=xe({data(){return{from:{name:"",email:"",password:"",repassword:""},error:""}},methods:{submit(){if(this.from.password!==this.from.repassword){this.error="Password not match";return}else eC(yr(),this.from.email,this.from.password).then(t=>{console.log(t.user.uid),Cs(gt(Ir,`users/${t.user.uid}`),{id:t.user.uid,name:this.from.name,email:this.from.email,token:""}),this.$router.push({name:"login"})}).catch(t=>{this.error=t.message})}}}),_Z={class:"bg-gray-300"},yZ={class:"w-full h-screen flex items-center justify-center"},vZ=m("div",{class:"flex font-bold justify-center mt-6"},[m("img",{class:"h-20 w-20",src:"https://raw.githubusercontent.com/sefyudem/Responsive-Login-Form/master/img/avatar.svg"})],-1),wZ=m("h2",{class:"text-3xl text-center text-gray-700 mb-4"},"Login",-1),bZ={class:"px-12 pb-10"},IZ={key:0,class:"alert alert-danger text-red-500"},EZ={class:"w-full mb-2"},TZ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"name"}," Name ",-1),SZ={class:"flex items-center"},CZ={class:"w-full mb-2"},kZ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"email"}," Email ",-1),AZ={class:"flex items-center"},RZ={class:"w-full mb-2"},xZ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"password"}," Password ",-1),NZ={class:"flex items-center"},PZ={class:"w-full mb-2"},DZ=m("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"repassword"}," Repassword ",-1),OZ={class:"flex items-center"},MZ={class:"text-xs text-gray-500 float-right mb-4"},LZ=Je("Do you already have an account? "),FZ=m("button",{type:"submit",class:"w-full py-2 rounded-full bg-green-600 text-gray-100 hover:bg-green-500 focus:outline-none"}," Register ",-1);function $Z(t,e,n,s,r,i){return W(),Y("div",_Z,[m("div",yZ,[m("form",{class:"w-full md:w-1/3 bg-white rounded-lg",onSubmit:e[5]||(e[5]=hS((...o)=>t.submit&&t.submit(...o),["prevent"]))},[vZ,wZ,m("div",bZ,[t.error?(W(),Y("div",IZ,ht(t.error),1)):kl("",!0),m("div",EZ,[TZ,m("div",SZ,[Xi(m("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>t.from.name=o),id:"name",type:"text",placeholder:"Name",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.name]])])]),m("div",CZ,[kZ,m("div",AZ,[Xi(m("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>t.from.email=o),id:"email",type:"text",placeholder:"Email",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.email]])])]),m("div",RZ,[xZ,m("div",NZ,[Xi(m("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>t.from.password=o),id:"password",type:"password",placeholder:"Password",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.password]])])]),m("div",PZ,[DZ,m("div",OZ,[Xi(m("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>t.from.repassword=o),id:"repassword",type:"password",placeholder:"Repassword",class:"-mx-6 ml-0 px-8 w-full border rounded px-3 py-2 text-gray-700 focus:outline-none"},null,512),[[Ji,t.from.repassword]])])]),m("span",MZ,[LZ,m("span",{class:"cursor-pointer text-sky-600 hover:text-sky-400",onClick:e[4]||(e[4]=o=>t.$router.push({name:"login"}))},"Login.")]),FZ])],32)])])}var UZ=Lr(mZ,[["render",$Z]]);function BZ(t,e){return W(),ui("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[L("path",{"fill-rule":"evenodd",d:"M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z","clip-rule":"evenodd"})])}const VZ={components:{LockClosedIcon:BZ}};function qZ(t,e,n,s,r,i){const o=An("router-view");return W(),ui(o)}var jZ=Lr(VZ,[["render",qZ]]);const KZ={class:"w-screen h-screen bg-black/70 flex flex-col bg-background-Play"},HZ={class:"top relative basis-1/12 text-white"},WZ=m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"w-7 h-7 fill-white"},[m("path",{d:"M447.1 256C447.1 273.7 433.7 288 416 288H109.3l105.4 105.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448s-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H416C433.7 224 447.1 238.3 447.1 256z"})],-1),zZ=[WZ],GZ={class:"mt-2"},QZ={class:"bottom pt-2 pb-1 basis-11/12 h-full relative"},YZ={class:"absolute inset-0"},XZ={class:"scroll overflow-scroll h-full"},JZ={class:"grid grid-rows-3 px-6"},ZZ=lf('<div class="grid grid-cols-4 gap-4 relative pb-4 after:absolute after:left-1/4 after:right-1/4 after:bottom-0 after:border-b-2 after:border-black/50 h-fit"><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/random_item_sets_promotion.729cf2c0.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Outfits </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/luv_outfits_promotion.d664b378.png" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Outfits </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/starter_pack_promotion_shop.01b82243.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Outfits </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/starter_pack_deluxe_promotion_shop.e36cbe21.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Outfits </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="col-span-4 flex flex-row gap-4 mx-auto"><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://cdn.wolvesville.com/promos/sk@3x.jpg" alt=""><span class="absolute top-0 left-0 right-0 text-center text-white bg-shop font-bold"> 3 Days left </span></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://cdn.wolvesville.com/promos/firstmeet@3x.jpg" alt=""><span class="absolute top-0 left-0 right-0 text-center text-white bg-shop font-bold"> 4 Days left </span></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://cdn.wolvesville.com/promos/luciddream@3x.jpg" alt=""><span class="absolute top-0 left-0 right-0 text-center text-white bg-shop font-bold"> 5 Days left </span></div></div></div>',1),eee={class:"grid grid-cols-6 gap-4 mx-40 h-fit mb-4 -mt-2"},tee={class:"h-48 w-full bg-white rounded-md cursor-pointer relative"},nee={class:"absolute left-0 right-0 text-white text-center font-bold bg-gray-400 py-1 rounded-t-md"},see={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},ree=["src"],iee={class:"absolute bottom-0 left-0 right-0 text-white text-center font-bold bg-shop py-1 rounded-b-md"},oee={class:"h-48 w-full bg-white rounded-md cursor-pointer relative"},aee={class:"absolute left-0 right-0 text-white text-center font-bold bg-gray-400 py-1 rounded-t-md"},cee={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},lee=["src"],uee={class:"absolute bottom-0 left-0 right-0 text-white text-center font-bold bg-shop py-1 rounded-b-md"},hee=m("img",{class:"mb-1 w-5 inline-block",src:"https://www.wolvesville.com/static/media/gem_with_white_border.860fb41a.png",alt:""},null,-1),dee={class:"h-48 w-full bg-white rounded-md cursor-pointer relative"},fee={class:"absolute left-0 right-0 text-white text-center font-bold bg-gray-400 py-1 rounded-t-md"},pee={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},gee=["src"],mee={class:"absolute bottom-0 left-0 right-0 text-white text-center font-bold bg-shop py-1 rounded-b-md"},_ee=m("img",{class:"mb-1 w-5 inline-block",src:"https://www.wolvesville.com/static/media/gem_with_white_border.860fb41a.png",alt:""},null,-1),yee={class:"grid grid-cols-4 gap-4 relative py-4 after:absolute after:left-1/4 after:right-1/4 after:top-0 after:border-t-2 after:border-black/50"},vee=lf('<div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/auto_double_xp_promotion_shop.9528515b.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-1 font-bold"> Auto double xp </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/dark_mode_promotion.30c60be2.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Dark mode </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/custom_games_promotion_shop.5beeb140.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-1 font-bold"> Custom games </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div><div class="cursor-pointer relative"><img class="rounded-md h-44 w-full" src="https://www.wolvesville.com/static/media/gift_promotion_shop.729236b1.jpg" alt=""><img class="absolute left-1/4 w-fix-shop top-fix-shop" src="https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png" alt=""><span class="absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-10 font-bold"> Send a gift </span><img class="absolute w-fix-shop top-fix-shop right-1/4" src="https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png" alt=""></div>',4),wee=["onClick"],bee=m("img",{class:"absolute left-1/4 w-fix-shop top-fix-shop",src:"https://www.wolvesville.com/static/media/banner_left_plain.0068a9ae.png",alt:""},null,-1),Iee={class:"absolute top-fix-shop left-1/2 transform -translate-x-1/2 text-white bg-shop px-14 font-bold"},Eee=m("img",{class:"w-4 mb-1 inline-block",src:"https://www.wolvesville.com/static/media/gem_with_white_border.860fb41a.png",alt:""},null,-1),Tee=m("img",{class:"absolute w-fix-shop top-fix-shop right-1/4",src:"https://www.wolvesville.com/static/media/banner_right_plain.25975f7c.png",alt:""},null,-1),See=["src"],Cee={key:0,class:"absolute before:backdrop-blur-3xl before:backdrop-invert before:bg-white/30 before:absolute before:w-screen before:h-screen inset-0 h-screen w-full flex justify-center items-start md:items-center pt-10 md:pt-0"},kee={class:"relative w-10/12 md:w-1/2 h-1/2 md:h-3/4 bg-white rounded shadow-lg"},Aee=m("div",{class:"px-4 py-3 border-b border-gray-200"},[m("h2",{class:"text-xl font-semibold text-gray-600"},"Payment")],-1),Ree=m("div",{class:"w-full p-3"}," Are you sure you want to pay the following amount? ",-1),xee={class:"absolute bottom-0 left-0 px-4 py-3 border-t border-gray-200 w-full flex justify-end items-center gap-3"},Nee={key:1,class:"before:backdrop-blur-3xl before:backdrop-invert before:bg-white/30 before:fixed before:top-0 before:w-screen before:h-screen w-screen h-screen fixed top-0"},Pee=m("svg",{class:"mx-auto mb-4 w-14 h-14 text-gray-400 dark:text-gray-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[m("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),Dee=m("h3",{class:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400"}," You don't have enough gems to buy!!! ",-1),Oee=xe({__name:"ShopView",setup(t){const e=[{quality:400,price:3.22,img:"https://www.wolvesville.com/static/media/gem_pile_1.16b0f75c.svg"},{quality:820,price:6.45,img:"https://www.wolvesville.com/static/media/gem_pile_2.da2a3144.svg"},{quality:1700,price:12.92,img:"https://www.wolvesville.com/static/media/gem_pile_3.71387c26.svg"},{quality:3600,price:26.92,img:"https://www.wolvesville.com/static/media/gem_pile_4.4a1c6d57.svg"},{quality:7300,price:53.85,img:"https://www.wolvesville.com/static/media/gem_pile_5.60890cab.svg"},{quality:15e3,price:107.71,img:"https://www.wolvesville.com/static/media/gem_pile_6.e6d0a420.svg"}],n=[{quality:600,gem:450,img:"https://www.wolvesville.com/static/media/gold_pile_1.bf8eff7e.svg"},{quality:5e3,gem:3400,img:"https://www.wolvesville.com/static/media/gold_pile_4.44ee0b74.svg"},{quality:15e3,gem:9e3,img:"https://www.wolvesville.com/static/media/gold_pile_6.34e08d02.svg"}],s=[{quality:3,gem:320,img:"https://www.wolvesville.com/static/media/loot_box_icon.65f3a9ad.svg"},{quality:30,gem:2600,img:"https://www.wolvesville.com/static/media/loot_box_icon.65f3a9ad.svg"},{quality:100,gem:7400,img:"https://www.wolvesville.com/static/media/loot_box_icon.65f3a9ad.svg"}],r=_s(!1),i=_s(!1),o=Rs(),a=cs({data:{}}),c=cs({data:[]}),l=Ls(On());ks(Ut(l,"shop/hat")).then(f=>{f.exists()?c.data=f.val():console.log("No data available")}).catch(f=>{console.error(f)});function u(f){r.value||(a.data=f),r.value=!r.value}function h(){i.value=!i.value}function d(){if(r.value=!1,console.log(a.data.gem,o.data.gem),+o.data.gem>=+a.data.gem){o.data.gem=String(+o.data.gem-+a.data.gem);const f=Ut(l,`inventories/${o.data.id}/hats`),p={id:a.data.id,img:a.data.img};Va(f,p)}else i.value=!0,console.log("not enough gem")}return(f,p)=>(W(),Y(je,null,[m("div",KZ,[m("div",HZ,[m("div",{class:"absolute top-2 back z-1 py-2 px-4 ml-4 bg-black/50 rounded-md text-white cursor-pointer",onClick:p[0]||(p[0]=_=>f.$router.push({name:"home"}))},zZ),m("div",GZ,[L(Uw,{"label-coin":Pn(o).data.coin,"label-gem":Pn(o).data.gem,"label-rose":Pn(o).data.flower,class:"top-4","name-router-settings":"login"},null,8,["label-coin","label-gem","label-rose"])])]),m("div",QZ,[m("div",YZ,[m("div",XZ,[m("div",JZ,[ZZ,m("div",eee,[(W(),Y(je,null,ss(e,_=>m("div",tee,[m("span",nee,ht(_.quality),1),m("div",see,[m("img",{class:"w-24",src:_.img,alt:""},null,8,ree)]),m("span",iee,ht(_.price)+"$ ",1)])),64)),(W(),Y(je,null,ss(n,_=>m("div",oee,[m("span",aee,ht(_.quality),1),m("div",cee,[m("img",{class:"w-24",src:_.img,alt:""},null,8,lee)]),m("span",uee,[Je(ht(_.gem)+" ",1),hee])])),64)),(W(),Y(je,null,ss(s,_=>m("div",dee,[m("span",fee,ht(_.quality),1),m("div",pee,[m("img",{class:"w-24",src:_.img,alt:""},null,8,gee)]),m("span",mee,[Je(ht(_.gem)+" ",1),_ee])])),64))]),m("div",yee,[vee,(W(!0),Y(je,null,ss(c.data,_=>(W(),Y("div",{class:"cursor-pointer h-44 bg-sky-400 bg-background-Home bg-cover bg-no-repeat relative",onClick:v=>u(_)},[bee,m("span",Iee,[Je(ht(_.gem)+" ",1),Eee]),Tee,m("img",{class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/3 h-28",src:_.img,alt:""},null,8,See)],8,wee))),256))])])])])])]),r.value?(W(),Y("div",Cee,[m("div",kee,[Aee,Ree,m("div",xee,[m("button",{onClick:p[1]||(p[1]=_=>d()),class:"bg-green-500 hover:bg-green-600 px-4 py-2 rounded text-white focus:outline-none"}," Yes "),m("button",{onClick:p[2]||(p[2]=_=>u({id:"",gem:"",img:""})),class:"bg-red-500 hover:bg-red-600 px-4 py-2 rounded text-white focus:outline-none"}," No ")])])])):kl("",!0),i.value?(W(),Y("div",Nee,[m("div",{id:"popup-modal",tabindex:"-1",class:"fixed top-1/2 left-1/2 transform translate-x-1/3 translate-y-1/3 z-50 md:inset-0 h-modal md:h-full"},[m("div",{class:"relative p-4 w-full max-w-md h-full md:h-auto"},[m("div",{class:"relative bg-white rounded-lg shadow dark:bg-gray-700"},[m("div",{class:"p-6 text-center"},[Pee,Dee,m("button",{onClick:h,"data-modal-toggle":"popup-modal",type:"button",class:"text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2"}," OK ")])])])])])):kl("",!0)],64))}}),Mee={class:"w-screen h-screen bg-black/70 flex flex-col bg-background-Play"},Lee={class:"top relative basis-1/12 text-white"},Fee=m("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",class:"w-7 h-7 fill-white"},[m("path",{d:"M447.1 256C447.1 273.7 433.7 288 416 288H109.3l105.4 105.4c12.5 12.5 12.5 32.75 0 45.25C208.4 444.9 200.2 448 192 448s-16.38-3.125-22.62-9.375l-160-160c-12.5-12.5-12.5-32.75 0-45.25l160-160c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25L109.3 224H416C433.7 224 447.1 238.3 447.1 256z"})],-1),$ee=[Fee],Uee={class:"mt-2"},Bee={class:"bottom pt-2 pb-1 px-6 basis-11/12 bg-cyan-500"},Vee={class:"flex flex-row h-full"},qee={class:"basis-1/3 grow"},jee={class:"flex flex-col h-full bg-sky-500/50"},Kee={class:"basis-7/12 bg-background-Home bg-cover bg-no-repeat rounded-md relative"},Hee={class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 skin h-60 w-48"},Wee={class:"h-full relative"},zee={class:"hair absolute bottom-15 left-1/2 transform -translate-x-1/2 z-20"},Gee={class:"eyes absolute bottom-14 left-1/2 transform -translate-x-1/2 z-20"},Qee={class:"mouth absolute bottom-12 left-1/2 transform -translate-x-1/2 z-20"},Yee={class:"head absolute bottom-16 left-1/2 transform -translate-x-1/2 z-10"},Xee={class:"clothes absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10"},Jee={class:"body absolute bottom-8 left-1/2 transform -translate-x-1/2 z-0"},Zee={class:"hat absolute bottom-12 left-1/2 transform -translate-x-1/2 z-20"},ete={class:"basis-5/12 bg-white rounded mt-4 h-full"},tte={class:"flex flex-col h-full"},nte={class:"basis-1/12"},ste={class:"top text-center p-2"},rte=Je(" Avatars "),ite={class:"basis-11/12"},ote={class:"bottom h-full relative"},ate={class:"absolute inset-0"},cte={class:"scroll overflow-scroll h-full"},lte={class:"grid grid-cols-4 gap-4 px-2"},ute={class:"relative h-full w-full"},hte={class:"hair absolute bottom-4.5 left-1/2 transform -translate-x-1/2 z-20"},dte={class:"eyes absolute bottom-5.5 left-1/2 transform -translate-x-1/2 z-20"},fte={class:"mouth absolute bottom-5.5 left-1/2 transform -translate-x-1/2 z-20"},pte={class:"head absolute bottom-5.5 left-1/2 transform -translate-x-1/2 z-10"},gte={class:"clothes absolute bottom-1 left-1/2 transform -translate-x-1/2 z-10"},mte={class:"body absolute bottom-1 left-1/2 transform -translate-x-1/2 z-0"},_te={class:"basis-2/3 flex-none bg-cyan-50 h-full"},yte={class:"flex flex-col h-full"},vte=lf('<div class="basis-1/20 bg-cyan-100"><div class="grid grid-cols-2 py-1 h-full"><div class="justify-self-center self-center font-bold uppercase"> Avatar </div><div class="justify-self-center self-center font-bold uppercase"> Items </div></div></div><div class="basis-1/20"><div class="flex justify-around py-1 h-full"><div class="self-center">Bia m\u1ED9</div><div class="self-center text-sky-400">M\u0169</div><div class="self-center">T\xF3c</div><div class="self-center">M\u1EAFt k\xEDnh</div><div class="self-center">\xC1o</div><div class="self-center">M\u1EAFt</div><div class="self-center">M\xF4i</div><div class="self-center">M\u1EB7t n\u1EA1</div><div class="self-center">Trang ch\xED 1</div><div class="self-center">Trang ch\xED 2</div><div class="self-center">Trang ch\xED 3</div></div></div>',2),wte={class:"basis-9/10 bg-gray-200/50 relative"},bte={class:"absolute inset-0"},Ite={class:"scroll overflow-scroll h-full"},Ete={class:"grid grid-cols-8 gap-4 px-4"},Tte={class:"basis-25/2 bg-gray-400/50 border-2 border-sky-900 h-full w-full rounded-md relative"},Ste={class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},Cte=Je(" None "),kte={class:"basis-25/2 bg-gray-400/50 border-2 border-sky-900 rounded-md p-4"},Ate={class:"basis-25/2 bg-gray-400/50 border-2 border-sky-900 rounded-md p-4"},Rte={class:"basis-25/2 bg-gray-400/50 border-2 border-sky-900 rounded-md p-4 text-white relative"},xte=xe({__name:"InventoryView",setup(t){const e=Rs(),n=cs({data:[]}),s=Ls(On());return ks(Ut(s,`inventories/${e.data.id}/hats`)).then(r=>{r.exists()?n.data=r.val():console.log("No data available")}).catch(r=>{console.error(r)}),(r,i)=>(W(),Y("div",Mee,[m("div",Lee,[m("div",{class:"absolute top-2 back z-10 py-2 px-4 ml-4 bg-black/50 rounded-md text-white cursor-pointer",onClick:i[0]||(i[0]=o=>r.$router.push({name:"home"}))},$ee),m("div",Uee,[L(Uw,{"label-coin":Pn(e).data.coin,"label-gem":Pn(e).data.gem,"label-rose":Pn(e).data.flower,class:"top-4","name-router-settings":"login"},null,8,["label-coin","label-gem","label-rose"])])]),m("div",Bee,[m("div",Vee,[m("div",qee,[m("div",jee,[m("div",Kee,[m("div",Hee,[m("div",Wee,[m("div",zee,[L(Le,{class:"scale-150",src:"https://cdn.wolvesville.com/avatarItems/hair-2.avatar-large@2x.png"})]),m("div",Gee,[L(Le,{class:"w-12 scale-150",src:"https://cdn.wolvesville.com/avatarItems/eyes-standard.avatar-large@2x.png"})]),m("div",Qee,[L(Le,{class:"w-5 scale-150",src:"https://cdn.wolvesville.com/avatarItems/mouth-skin-2.avatar-large@2x.png"})]),m("div",Yee,[L(Le,{class:"w-20 scale-150",src:"https://cdn.wolvesville.com/avatarItems/head-skin-2.avatar-large@2x.png"})]),m("div",Xee,[L(Le,{class:"scale-150",src:"https://cdn.wolvesville.com/avatarItems/clothes-77.avatar-large@2x.png"})]),m("div",Jee,[L(Le,{class:"w-20 scale-150",src:"https://cdn.wolvesville.com/avatarItems/body-skin-2.avatar-large@2x.png"})]),m("div",Zee,[L(Le,{class:"scale-125",src:"https://cdn.wolvesville.com/avatarItems/hat-1.avatar-large@2x.png"})])])])]),m("div",ete,[m("div",tte,[m("div",nte,[m("div",ste,[L(js,{tag:"span"},{default:dt(()=>[rte]),_:1})])]),m("div",ite,[m("div",ote,[m("div",ate,[m("div",cte,[m("div",lte,[(W(),Y(je,null,ss(100,o=>m("div",{key:o,class:"basis-25/2 bg-sky-500/50 bg-background-Home bg-cover bg-no-repeat border-2 border-sky-900 rounded-md text-white h-20 w-28 relative"},[m("div",ute,[m("div",hte,[L(Le,{class:"w-10",src:"https://cdn.wolvesville.com/avatarItems/hair-2.avatar-large@2x.png"})]),m("div",dte,[L(Le,{class:"w-5",src:"https://cdn.wolvesville.com/avatarItems/eyes-standard.avatar-large@2x.png"})]),m("div",fte,[L(Le,{class:"w-2",src:"https://cdn.wolvesville.com/avatarItems/mouth-skin-2.avatar-large@2x.png"})]),m("div",pte,[L(Le,{class:"w-8",src:"https://cdn.wolvesville.com/avatarItems/head-skin-2.avatar-large@2x.png"})]),m("div",gte,[L(Le,{src:"https://cdn.wolvesville.com/avatarItems/clothes-77.avatar-large@2x.png"})]),m("div",mte,[L(Le,{src:"https://cdn.wolvesville.com/avatarItems/body-skin-2.avatar-large@2x.png"})])])])),64))])])])])])])])])]),m("div",_te,[m("div",yte,[vte,m("div",wte,[m("div",bte,[m("div",Ite,[m("div",Ete,[m("div",Tte,[m("div",Ste,[L(js,{tag:"span"},{default:dt(()=>[Cte]),_:1})])]),(W(!0),Y(je,null,ss(n.data,o=>(W(),Y("div",kte,[L(Le,{classes:"h-12 mx-auto",src:o.img},null,8,["src"])]))),256)),m("div",Ate,[L(Le,{classes:"h-12 mx-auto",src:"https://cdn.wolvesville.com/avatarItems/hat-1.store@2x.png"})]),m("div",Rte,[L(Le,{classes:"h-12 mx-auto",src:"https://cdn.wolvesville.com/avatarItems/petfashion-hat-husky.store@2x.png"}),L(Aa,{classes:"absolute bottom-0 right-1",label:"70","classes-text":"text-xs","classes-image":"w-3 inline-block ml-1",src:"https://www.wolvesville.com/static/media/gem.439d7650.png",alt:"gem"})]),(W(),Y(je,null,ss(130,o=>m("div",{key:o,class:"basis-25/2 bg-gray-400/50 border-2 border-sky-900 rounded-md p-4 text-white relative"},[L(Le,{classes:"h-12 mx-auto",src:"https://cdn.wolvesville.com/avatarItems/ineedlove-hat-female.store@2x.png"}),L(Aa,{classes:"absolute bottom-0 right-1",label:"170","classes-text":"text-xs","classes-image":"w-3 inline-block ml-1",src:"https://www.wolvesville.com/static/media/gem.439d7650.png",alt:"gem"})])),64))])])])])])])])])]))}}),Nte=kY({history:jQ("/"),routes:[{path:"/",name:"home",component:OJ,meta:{requiresAuth:!0}},{path:"/",name:"play",component:xX},{path:"/",name:"inventory",component:xte},{path:"/",name:"shop",component:Oee},{path:"/chat",name:"chat",component:gZ},{path:"/auth",redirect:"/login",name:"Auth",component:jZ,meta:{isGuest:!0},children:[{path:"/login",name:"login",component:wP},{path:"/register",name:"register",component:UZ}]}]}),Pte={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;","&":"&amp;"};let Dte=0;var Ote=t=>t.replace(/[<>"&]/g,e=>Pte[e]||e),Mte=t=>t+Dte++;const Qi={},Lte=t=>{const{name:e,paths:n=[],d:s,polygons:r=[],points:i}=t;s&&n.push({d:s}),i&&r.push({points:i}),Qi[e]=Object.assign({},t,{paths:n,polygons:r}),Qi[e].minX||(Qi[e].minX=0),Qi[e].minY||(Qi[e].minY=0)},Fte=(...t)=>{for(const e of t)Lte(e)},$te=xe({name:"OhVueIcon",props:{name:{type:String,validator:t=>!t||t in Qi||(console.warn(`Invalid prop: prop "name" is referring to an unregistered icon "${t}".
Please make sure you have imported this icon before using it.`),!1)},title:String,fill:String,scale:{type:[Number,String],default:1},animation:{validator:t=>["spin","spin-pulse","wrench","ring","pulse","flash","float"].includes(t)},hover:Boolean,flip:{validator:t=>["horizontal","vertical","both"].includes(t)},speed:{validator:t=>t==="fast"||t==="slow"},label:String,inverse:Boolean},setup(t){const e=_s([]),n=cs({outerScale:1.2,x:null,y:null}),s=cs({width:0,height:0}),r=Qe(()=>{const _=Number(t.scale);return isNaN(_)||_<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.'),n.outerScale):_*n.outerScale}),i=Qe(()=>({"ov-icon":!0,"ov-inverse":t.inverse,"ov-flip-horizontal":t.flip==="horizontal","ov-flip-vertical":t.flip==="vertical","ov-flip-both":t.flip==="both","ov-spin":t.animation==="spin","ov-spin-pulse":t.animation==="spin-pulse","ov-wrench":t.animation==="wrench","ov-ring":t.animation==="ring","ov-pulse":t.animation==="pulse","ov-flash":t.animation==="flash","ov-float":t.animation==="float","ov-hover":t.hover,"ov-fast":t.speed==="fast","ov-slow":t.speed==="slow"})),o=Qe(()=>t.name?Qi[t.name]:null),a=Qe(()=>o.value?`${o.value.minX} ${o.value.minY} ${o.value.width} ${o.value.height}`:`0 0 ${l.value} ${u.value}`),c=Qe(()=>{if(!o.value)return 1;const{width:_,height:v}=o.value;return Math.max(_,v)/16}),l=Qe(()=>s.width||o.value&&o.value.width/c.value*r.value||0),u=Qe(()=>s.height||o.value&&o.value.height/c.value*r.value||0),h=Qe(()=>r.value!==1&&{fontSize:r.value+"em"}),d=Qe(()=>{if(!o.value||!o.value.raw)return null;const _={};let v=o.value.raw;return v=v.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,(b,N,T)=>{const $=Mte("vat-");return _[T]=$,` id="${$}"`}),v=v.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,(b,N,T,$)=>{const z=N||$;return z&&_[z]?`#${_[z]}`:b}),v}),f=Qe(()=>o.value&&o.value.attr?o.value.attr:{}),p=()=>{if(!t.name&&t.name!==null&&e.value.length===0)return void console.warn('Invalid prop: prop "name" is required.');if(o.value)return;let _=0,v=0;e.value.forEach(b=>{b.outerScale=r.value,_=Math.max(_,b.width),v=Math.max(v,b.height)}),s.width=_,s.height=v,e.value.forEach(b=>{b.x=(_-b.width)/2,b.y=(v-b.height)/2})};return N_(()=>{p()}),WT(()=>{p()}),ih(rh({},DT(n)),{children:e,icon:o,klass:i,style:h,width:l,height:u,box:a,attribs:f,raw:d})},created(){const t=this.$parent;t&&t.children&&t.children.push(this)},render(){const t=Object.assign({role:this.$attrs.role||(this.label||this.title?"img":null),"aria-label":this.label||null,"aria-hidden":!(this.label||this.title),width:this.width,height:this.height,viewBox:this.box},this.attribs);this.attribs.stroke?t.stroke=this.fill?this.fill:"currentColor":t.fill=this.fill?this.fill:"currentColor",this.x&&(t.x=this.x.toString()),this.y&&(t.y=this.y.toString());let e={class:this.klass,style:this.style};if(e=Object.assign(e,t),this.raw){const r=this.title?`<title>${Ote(this.title)}</title>${this.raw}`:this.raw;e.innerHTML=r}const n=this.title?[nl("title",this.title)]:[],s=(r,i,o)=>nl(r,ih(rh({},i),{key:`${r}-${o}`}));return nl("svg",e,this.raw?void 0:n.concat([this.$slots.default?this.$slots.default():this.icon?[...this.icon.paths.map((r,i)=>s("path",r,i)),...this.icon.polygons.map((r,i)=>s("polygon",r,i))]:[]]))}});function Bw(t,e){e===void 0&&(e={});var n=e.insertAt;if(t&&typeof document!="undefined"){var s=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",n==="top"&&s.firstChild?s.insertBefore(r,s.firstChild):s.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}Bw(`.ov-icon {
  display: inline-block;
  overflow: visible;
  vertical-align: -0.2em;
}
`);Bw(`/* ---------------- spin ---------------- */
.ov-spin:not(.ov-hover),
.ov-spin.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-spin {
  animation: ov-spin 1s linear infinite;
}

.ov-spin:not(.ov-hover).ov-fast,
.ov-spin.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-spin.ov-fast {
  animation: ov-spin 0.7s linear infinite;
}

.ov-spin:not(.ov-hover).ov-slow,
.ov-spin.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-spin.ov-slow {
  animation: ov-spin 2s linear infinite;
}

/* ---------------- spin-pulse ---------------- */

.ov-spin-pulse:not(.ov-hover),
.ov-spin-pulse.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse {
  animation: ov-spin 1s infinite steps(8);
}

.ov-spin-pulse:not(.ov-hover).ov-fast,
.ov-spin-pulse.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse.ov-fast {
  animation: ov-spin 0.7s infinite steps(8);
}

.ov-spin-pulse:not(.ov-hover).ov-slow,
.ov-spin-pulse.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-spin-pulse.ov-slow {
  animation: ov-spin 2s infinite steps(8);
}

@keyframes ov-spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}

/* ---------------- wrench ---------------- */
.ov-wrench:not(.ov-hover),
.ov-wrench.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-wrench {
  animation: ov-wrench 2.5s ease infinite;
}

.ov-wrench:not(.ov-hover).ov-fast,
.ov-wrench.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-wrench.ov-fast {
  animation: ov-wrench 1.2s ease infinite;
}

.ov-wrench:not(.ov-hover).ov-slow,
.ov-wrench.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-wrench.ov-slow {
  animation: ov-wrench 3.7s ease infinite;
}

@keyframes ov-wrench {
  0% {
    transform: rotate(-12deg);
  }

  8% {
    transform: rotate(12deg);
  }

  10%, 28%, 30%, 48%, 50%, 68% {
    transform: rotate(24deg);
  }

  18%, 20%, 38%, 40%, 58%, 60% {
    transform: rotate(-24deg);
  }

  75%, 100% {
    transform: rotate(0deg);
  }
}

/* ---------------- ring ---------------- */
.ov-ring:not(.ov-hover),
.ov-ring.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-ring {
  animation: ov-ring 2s ease infinite;
}

.ov-ring:not(.ov-hover).ov-fast,
.ov-ring.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-ring.ov-fast {
  animation: ov-ring 1s ease infinite;
}

.ov-ring:not(.ov-hover).ov-slow,
.ov-ring.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-ring.ov-slow {
  animation: ov-ring 3s ease infinite;
}

@keyframes ov-ring {
  0% {
    transform: rotate(-15deg);
  }

  2% {
    transform: rotate(15deg);
  }

  4%, 12% {
    transform: rotate(-18deg);
  }

  6% {
    transform: rotate(18deg);
  }

  8% {
    transform: rotate(-22deg);
  }

  10% {
    transform: rotate(22deg);
  }

  12% {
    transform: rotate(-18deg);
  }

  14% {
    transform: rotate(18deg);
  }

  16% {
    transform: rotate(-12deg);
  }

  18% {
    transform: rotate(12deg);
  }

  20%, 100% {
    transform: rotate(0deg);
  }
}

/* ---------------- pulse ---------------- */
.ov-pulse:not(.ov-hover),
.ov-pulse.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-pulse {
  animation: ov-pulse 2s linear infinite;
}

.ov-pulse:not(.ov-hover).ov-fast,
.ov-pulse.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-pulse.ov-fast {
  animation: ov-pulse 1s linear infinite;
}

.ov-pulse:not(.ov-hover).ov-slow,
.ov-pulse.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-pulse.ov-slow {
  animation: ov-pulse 3s linear infinite;
}

@keyframes ov-pulse {
  0% {
    transform: scale(1.1);
  }

  50% {
    transform: scale(0.8);
  }

  100% {
    transform: scale(1.1);
  }
}

/* ---------------- flash ---------------- */
.ov-flash:not(.ov-hover),
.ov-flash.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-flash {
  animation: ov-flash 2s ease infinite;
}

.ov-flash:not(.ov-hover).ov-fast,
.ov-flash.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-flash.ov-fast {
  animation: ov-flash 1s ease infinite;
}

.ov-flash:not(.ov-hover).ov-slow,
.ov-flash.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-flash.ov-slow {
  animation: ov-flash 3s ease infinite;
}

@keyframes ov-flash {
  0%, 100%, 50%{
    opacity: 1;
  }
  25%, 75%{
    opacity: 0;
  }
}

/* ---------------- float ---------------- */
.ov-float:not(.ov-hover),
.ov-float.ov-hover:hover,
.ov-parent.ov-hover:hover > .ov-float {
  animation: ov-float 2s linear infinite;
}

.ov-float:not(.ov-hover).ov-fast,
.ov-float.ov-hover.ov-fast:hover,
.ov-parent.ov-hover:hover > .ov-float.ov-fast {
  animation: ov-float 1s linear infinite;
}

.ov-float:not(.ov-hover).ov-slow,
.ov-float.ov-hover.ov-slow:hover,
.ov-parent.ov-hover:hover > .ov-float.ov-slow {
  animation: ov-float 3s linear infinite;
}

@keyframes ov-float {
  0%, 100% {
    transform: translateY(-3px);
  }
  50% {
    transform: translateY(3px);
  }
}
`);Bw(`.ov-flip-horizontal {
  transform: scale(-1, 1);
}

.ov-flip-vertical {
  transform: scale(1, -1);
}

.ov-flip-both {
  transform: scale(-1, -1);
}

.ov-inverse {
  color: #fff;
}
`);const Ute={name:"bi-star-fill",minX:-1.6,minY:-1.6,width:19.2,height:19.2,raw:'<path d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>'},Bte={name:"fc-search",minX:0,minY:0,width:48,height:48,raw:'<g fill="#616161"><path d="M29.175 31.99l2.828-2.827 12.019 12.019-2.828 2.827z"/><circle cx="20" cy="20" r="16"/></g><path fill="#37474F" d="M32.45 35.34l2.827-2.828 8.696 8.696-2.828 2.828z"/><circle cx="20" cy="20" r="13" fill="#64B5F6"/><path fill="#BBDEFB" d="M26.9 14.2c-1.7-2-4.2-3.2-6.9-3.2s-5.2 1.2-6.9 3.2c-.4.4-.3 1.1.1 1.4.4.4 1.1.3 1.4-.1C16 13.9 17.9 13 20 13s4 .9 5.4 2.5c.2.2.5.4.8.4.2 0 .5-.1.6-.2.4-.4.4-1.1.1-1.5z"/>'},Vte={name:"pr-times",minX:1.2,minY:1.2,width:21.6,height:21.6,raw:'<path d="M13.06 12l4.42-4.42a.75.75 0 10-1.06-1.06L12 10.94 7.58 6.52a.75.75 0 00-1.06 1.06L10.94 12l-4.42 4.42a.75.75 0 000 1.06.75.75 0 001.06 0L12 13.06l4.42 4.42a.75.75 0 001.06 0 .75.75 0 000-1.06z"/>'};Fte(Bte,Ute,Vte);const Mp=HO(MY);Mp.use(xY());Mp.component("v-icon",$te);Mp.use(Nte);Mp.mount("#app");
